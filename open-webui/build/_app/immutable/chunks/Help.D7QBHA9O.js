import{s as Be,l as Oe,i as B,n as we,d as p,B as on,q as hn,e as V,t as Ce,k as $,c as N,a as S,b as Me,o as ee,f as m,g as k,h as He,O as sl,I as gt,u as ke,E as ze,F as Pe,y as We,A as xe,j as ie,p as Ut,D as qe,r as xt,v as $t,w as en,x as tn,Q as Cn,H as ln,S as Hn,N as il,z as Ai,C as Dn,al as lt,T as Yt,U as It,V as Bn,X as dn,K as nn,$ as he,Z as tt,a1 as jl,am as fo,ah as Li,_ as ho,an as bt,a2 as Pl,ao as Ra,ap as Ua,ai as Wa,J as us,aq as fs,R as ds,P as eo,aj as ja,ak as Fa,m as Ya}from"./scheduler.CvZYoJ9P.js";import{S as Ve,i as Ne,t as C,g as Ae,a as P,c as Le,h as hs,f as $e,b as te,d as oe,m as ne,e as le,j as to}from"./index.C1N8d1hw.js";import{g as Ri}from"./globals.D0QH3NT1.js";import{e as wt,u as So,o as Do}from"./each.BAtknz4E.js";import{t as nt}from"./Toaster.svelte_svelte_type_style_lang.ChidyyUD.js";import{h as Pn,b6 as Ui,b7 as ls,b8 as Uo,b9 as Wo,ba as Za,bb as Xa,bc as Wi,bd as Ka,be as qa,bf as Ga,bg as Ja,M as Qa}from"./Messages.HDNB0kvG.js";import{d as xa}from"./dayjs.min.CnqrW7zs.js";import{T as Gt,m as mo}from"./Tooltip.DE9EGTmQ.js";import{A as $a,a as ji,b as ec,E as tc,D as nc,P as lc}from"./EllipsisVertical.EbqDJKvL.js";import{g as jo}from"./entry.BsJDnQad.js";import{p as oc}from"./stores.DXlpsfYI.js";import{t as vl,e as ql,s as go,u as al,p as Fi,k as Yi,m as yl,h as Gn,i as Co,d as bl,c as sc,P as ms,F as vn,G as Rt,j as Mo,H as Jn,J as Yn,W as Zi,g as pl,B as rc,f as gs,r as ic,w as gl,n as ac,x as no,v as cc,y as _l,l as _s}from"./index.Dh8PXriy.js";import{g as uc,t as fc,w as dc,x as hc,y as mc,z as gc,A as co,B as ps,v as Cl,m as Xi,C as _c,b as Jo,l as _o,f as po,D as bs,s as pc,E as lo,d as bc}from"./index.C-Yl_4Dq.js";import{h as vc}from"./index.BAcob18o.js";import{e as Qo,o as Dl,u as oo,a as vs,C as wc,c as ws,b as yc,B as kc}from"./index.C1FCzb-X.js";import{g as Ec}from"./index.CR8c5aJv.js";import{p as Ic,h as Sc,i as Dc}from"./index.CK9F4X6H.js";import{M as Cc,a as Mc,b as Tc,T as Vc,S as Nc,U as zc,q as Pc}from"./index.Uvr8tUJM.js";import{h as Oc,i as ys,j as ks}from"./index.BfIxVW2M.js";import{p as Hc,q as Bc,r as Ac,s as Lc,t as Rc,v as Uc,w as Wc}from"./index.CusVmKHs.js";import{f as Ml}from"./index.Cudv6G18.js";import{t as Ki,s as jc}from"./index.VLQ7Yb5F.js";import{u as Fc}from"./index.DBc44hR_.js";import"./updater.iOEUNrP6.js";import{D as To,M as Sn}from"./Dropdown.Dbsi7U2M.js";import{b as Vo}from"./menu-trigger.BIDVZcLU.js";import{f as Gl}from"./index.DyIcjikr.js";import{g as os,j as Yc,k as Zc,l as Xc}from"./index.mJpT6BTA.js";import{S as qi}from"./Switch.BWN5EyxE.js";import{W as Kc}from"./WrenchSolid.97gG5pSH.js";import{V as qc,R as Gc}from"./RichTextInput.Cf7l-q12.js";import{F as Gi}from"./FileItem.DkJ-o9n2.js";import{g as Jc}from"./index.Hq3gcjjL.js";import{g as Qc}from"./index.B2M52zio.js";import{F as Ji}from"./fuse.CU2r43ac.js";import{r as xc}from"./relativeTime.HIEE8cw9.js";import{S as ss}from"./Spinner.D_9sd18Y.js";import{X as No}from"./XMark.CMt8xzLL.js";import{S as $c}from"./Selector.DA3wAJBu.js";import{f as eu}from"./FileSaver.min.CimDdHIv.js";import{a as tu}from"./index.BnGSMWXY.js";import{M as nu}from"./MenuLines.4na4qWic.js";import"./postcss.BaxBIG1S.js";import{M as lu}from"./Modal.DHNRbNDK.js";import{A as ou}from"./AdvancedParams.B15erOux.js";import{g as su,j as ru,k as iu,l as au}from"./index.B63fC0k8.js";import{V as cu,H as uu}from"./Heart.CcQsrOZE.js";import{C as uo}from"./Collapsible.DXtiMlxc.js";import{w as Je,a as zn,d as Vl}from"./index.CxhOXs-d.js";import{g as rl,a as Fl}from"./spread.CgU5AtxT.js";import{C as fu}from"./ConfirmDialog.BlzuV8fX.js";function du(l){let e;for(;e=l.sourceEvent;)l=e;return l}function Fn(l,e){if(l=du(l),e===void 0&&(e=l.currentTarget),e){var t=e.ownerSVGElement||e;if(t.createSVGPoint){var n=t.createSVGPoint();return n.x=l.clientX,n.y=l.clientY,n=n.matrixTransform(e.getScreenCTM().inverse()),[n.x,n.y]}if(e.getBoundingClientRect){var o=e.getBoundingClientRect();return[l.clientX-o.left-e.clientLeft,l.clientY-o.top-e.clientTop]}}return[l.pageX,l.pageY]}const hu={passive:!1},Yl={capture:!0,passive:!1};function Fo(l){l.stopImmediatePropagation()}function Nl(l){l.preventDefault(),l.stopImmediatePropagation()}function Qi(l){var e=l.document.documentElement,t=Pn(l).on("dragstart.drag",Nl,Yl);"onselectstart"in e?t.on("selectstart.drag",Nl,Yl):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function xi(l,e){var t=l.document.documentElement,n=Pn(l).on("dragstart.drag",null);e&&(n.on("click.drag",Nl,Yl),setTimeout(function(){n.on("click.drag",null)},0)),"onselectstart"in t?n.on("selectstart.drag",null):(t.style.MozUserSelect=t.__noselect,delete t.__noselect)}const so=l=>()=>l;function xo(l,{sourceEvent:e,subject:t,target:n,identifier:o,active:s,x:r,y:i,dx:a,dy:c,dispatch:u}){Object.defineProperties(this,{type:{value:l,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},identifier:{value:o,enumerable:!0,configurable:!0},active:{value:s,enumerable:!0,configurable:!0},x:{value:r,enumerable:!0,configurable:!0},y:{value:i,enumerable:!0,configurable:!0},dx:{value:a,enumerable:!0,configurable:!0},dy:{value:c,enumerable:!0,configurable:!0},_:{value:u}})}xo.prototype.on=function(){var l=this._.on.apply(this._,arguments);return l===this._?this:l};function mu(l){return!l.ctrlKey&&!l.button}function gu(){return this.parentNode}function _u(l,e){return e??{x:l.x,y:l.y}}function pu(){return navigator.maxTouchPoints||"ontouchstart"in this}function bu(){var l=mu,e=gu,t=_u,n=pu,o={},s=Ui("start","drag","end"),r=0,i,a,c,u,f=0;function h(E){E.on("mousedown.drag",d).filter(n).on("touchstart.drag",v).on("touchmove.drag",g,hu).on("touchend.drag touchcancel.drag",w).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function d(E,z){if(!(u||!l.call(this,E,z))){var T=y(this,e.call(this,E,z),E,z,"mouse");T&&(Pn(E.view).on("mousemove.drag",_,Yl).on("mouseup.drag",b,Yl),Qi(E.view),Fo(E),c=!1,i=E.clientX,a=E.clientY,T("start",E))}}function _(E){if(Nl(E),!c){var z=E.clientX-i,T=E.clientY-a;c=z*z+T*T>f}o.mouse("drag",E)}function b(E){Pn(E.view).on("mousemove.drag mouseup.drag",null),xi(E.view,c),Nl(E),o.mouse("end",E)}function v(E,z){if(l.call(this,E,z)){var T=E.changedTouches,I=e.call(this,E,z),H=T.length,O,A;for(O=0;O<H;++O)(A=y(this,I,E,z,T[O].identifier,T[O]))&&(Fo(E),A("start",E,T[O]))}}function g(E){var z=E.changedTouches,T=z.length,I,H;for(I=0;I<T;++I)(H=o[z[I].identifier])&&(Nl(E),H("drag",E,z[I]))}function w(E){var z=E.changedTouches,T=z.length,I,H;for(u&&clearTimeout(u),u=setTimeout(function(){u=null},500),I=0;I<T;++I)(H=o[z[I].identifier])&&(Fo(E),H("end",E,z[I]))}function y(E,z,T,I,H,O){var A=s.copy(),F=Fn(O||T,z),j,Y,M;if((M=t.call(E,new xo("beforestart",{sourceEvent:T,target:h,identifier:H,active:r,x:F[0],y:F[1],dx:0,dy:0,dispatch:A}),I))!=null)return j=M.x-F[0]||0,Y=M.y-F[1]||0,function K(D,W,L){var R=F,X;switch(D){case"start":o[H]=K,X=r++;break;case"end":delete o[H],--r;case"drag":F=Fn(L||W,z),X=r;break}A.call(D,E,new xo(D,{sourceEvent:W,subject:M,target:h,identifier:H,active:X,x:F[0]+j,y:F[1]+Y,dx:F[0]-R[0],dy:F[1]-R[1],dispatch:A}),I)}}return h.filter=function(E){return arguments.length?(l=typeof E=="function"?E:so(!!E),h):l},h.container=function(E){return arguments.length?(e=typeof E=="function"?E:so(E),h):e},h.subject=function(E){return arguments.length?(t=typeof E=="function"?E:so(E),h):t},h.touchable=function(E){return arguments.length?(n=typeof E=="function"?E:so(!!E),h):n},h.on=function(){var E=s.on.apply(s,arguments);return E===s?h:E},h.clickDistance=function(E){return arguments.length?(f=(E=+E)*E,h):Math.sqrt(f)},h}var vu=1e-12;function Es(l){return((l=Math.exp(l))+1/l)/2}function wu(l){return((l=Math.exp(l))-1/l)/2}function yu(l){return((l=Math.exp(2*l))-1)/(l+1)}const ku=function l(e,t,n){function o(s,r){var i=s[0],a=s[1],c=s[2],u=r[0],f=r[1],h=r[2],d=u-i,_=f-a,b=d*d+_*_,v,g;if(b<vu)g=Math.log(h/c)/e,v=function(I){return[i+I*d,a+I*_,c*Math.exp(e*I*g)]};else{var w=Math.sqrt(b),y=(h*h-c*c+n*b)/(2*c*t*w),E=(h*h-c*c-n*b)/(2*h*t*w),z=Math.log(Math.sqrt(y*y+1)-y),T=Math.log(Math.sqrt(E*E+1)-E);g=(T-z)/e,v=function(I){var H=I*g,O=Es(z),A=c/(t*w)*(O*yu(e*H+z)-wu(z));return[i+A*d,a+A*_,c*O/Es(e*H+z)]}}return v.duration=g*1e3*e/Math.SQRT2,v}return o.rho=function(s){var r=Math.max(.001,+s),i=r*r,a=i*i;return l(r,i,a)},o}(Math.SQRT2,2,4),ro=l=>()=>l;function Eu(l,{sourceEvent:e,target:t,transform:n,dispatch:o}){Object.defineProperties(this,{type:{value:l,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:t,enumerable:!0,configurable:!0},transform:{value:n,enumerable:!0,configurable:!0},_:{value:o}})}function Yo(l){l.stopImmediatePropagation()}function Wl(l){l.preventDefault(),l.stopImmediatePropagation()}function Iu(l){return(!l.ctrlKey||l.type==="wheel")&&!l.button}function Su(){var l=this;return l instanceof SVGElement?(l=l.ownerSVGElement||l,l.hasAttribute("viewBox")?(l=l.viewBox.baseVal,[[l.x,l.y],[l.x+l.width,l.y+l.height]]):[[0,0],[l.width.baseVal.value,l.height.baseVal.value]]):[[0,0],[l.clientWidth,l.clientHeight]]}function Is(){return this.__zoom||ls}function Du(l){return-l.deltaY*(l.deltaMode===1?.05:l.deltaMode?1:.002)*(l.ctrlKey?10:1)}function Cu(){return navigator.maxTouchPoints||"ontouchstart"in this}function Mu(l,e,t){var n=l.invertX(e[0][0])-t[0][0],o=l.invertX(e[1][0])-t[1][0],s=l.invertY(e[0][1])-t[0][1],r=l.invertY(e[1][1])-t[1][1];return l.translate(o>n?(n+o)/2:Math.min(0,n)||Math.max(0,o),r>s?(s+r)/2:Math.min(0,s)||Math.max(0,r))}function Tu(){var l=Iu,e=Su,t=Mu,n=Du,o=Cu,s=[0,1/0],r=[[-1/0,-1/0],[1/0,1/0]],i=250,a=ku,c=Ui("start","zoom","end"),u,f,h,d=500,_=150,b=0,v=10;function g(M){M.property("__zoom",Is).on("wheel.zoom",H,{passive:!1}).on("mousedown.zoom",O).on("dblclick.zoom",A).filter(o).on("touchstart.zoom",F).on("touchmove.zoom",j).on("touchend.zoom touchcancel.zoom",Y).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}g.transform=function(M,K,D,W){var L=M.selection?M.selection():M;L.property("__zoom",Is),M!==L?z(M,K,D,W):L.interrupt().each(function(){T(this,arguments).event(W).start().zoom(null,typeof K=="function"?K.apply(this,arguments):K).end()})},g.scaleBy=function(M,K,D,W){g.scaleTo(M,function(){var L=this.__zoom.k,R=typeof K=="function"?K.apply(this,arguments):K;return L*R},D,W)},g.scaleTo=function(M,K,D,W){g.transform(M,function(){var L=e.apply(this,arguments),R=this.__zoom,X=D==null?E(L):typeof D=="function"?D.apply(this,arguments):D,Q=R.invert(X),G=typeof K=="function"?K.apply(this,arguments):K;return t(y(w(R,G),X,Q),L,r)},D,W)},g.translateBy=function(M,K,D,W){g.transform(M,function(){return t(this.__zoom.translate(typeof K=="function"?K.apply(this,arguments):K,typeof D=="function"?D.apply(this,arguments):D),e.apply(this,arguments),r)},null,W)},g.translateTo=function(M,K,D,W,L){g.transform(M,function(){var R=e.apply(this,arguments),X=this.__zoom,Q=W==null?E(R):typeof W=="function"?W.apply(this,arguments):W;return t(ls.translate(Q[0],Q[1]).scale(X.k).translate(typeof K=="function"?-K.apply(this,arguments):-K,typeof D=="function"?-D.apply(this,arguments):-D),R,r)},W,L)};function w(M,K){return K=Math.max(s[0],Math.min(s[1],K)),K===M.k?M:new Uo(K,M.x,M.y)}function y(M,K,D){var W=K[0]-D[0]*M.k,L=K[1]-D[1]*M.k;return W===M.x&&L===M.y?M:new Uo(M.k,W,L)}function E(M){return[(+M[0][0]+ +M[1][0])/2,(+M[0][1]+ +M[1][1])/2]}function z(M,K,D,W){M.on("start.zoom",function(){T(this,arguments).event(W).start()}).on("interrupt.zoom end.zoom",function(){T(this,arguments).event(W).end()}).tween("zoom",function(){var L=this,R=arguments,X=T(L,R).event(W),Q=e.apply(L,R),G=D==null?E(Q):typeof D=="function"?D.apply(L,R):D,ce=Math.max(Q[1][0]-Q[0][0],Q[1][1]-Q[0][1]),se=L.__zoom,ye=typeof K=="function"?K.apply(L,R):K,Se=a(se.invert(G).concat(ce/se.k),ye.invert(G).concat(ce/ye.k));return function(re){if(re===1)re=ye;else{var q=Se(re),Ee=ce/q[2];re=new Uo(Ee,G[0]-q[0]*Ee,G[1]-q[1]*Ee)}X.zoom(null,re)}})}function T(M,K,D){return!D&&M.__zooming||new I(M,K)}function I(M,K){this.that=M,this.args=K,this.active=0,this.sourceEvent=null,this.extent=e.apply(M,K),this.taps=0}I.prototype={event:function(M){return M&&(this.sourceEvent=M),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(M,K){return this.mouse&&M!=="mouse"&&(this.mouse[1]=K.invert(this.mouse[0])),this.touch0&&M!=="touch"&&(this.touch0[1]=K.invert(this.touch0[0])),this.touch1&&M!=="touch"&&(this.touch1[1]=K.invert(this.touch1[0])),this.that.__zoom=K,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(M){var K=Pn(this.that).datum();c.call(M,this.that,new Eu(M,{sourceEvent:this.sourceEvent,target:g,type:M,transform:this.that.__zoom,dispatch:c}),K)}};function H(M,...K){if(!l.apply(this,arguments))return;var D=T(this,K).event(M),W=this.__zoom,L=Math.max(s[0],Math.min(s[1],W.k*Math.pow(2,n.apply(this,arguments)))),R=Fn(M);if(D.wheel)(D.mouse[0][0]!==R[0]||D.mouse[0][1]!==R[1])&&(D.mouse[1]=W.invert(D.mouse[0]=R)),clearTimeout(D.wheel);else{if(W.k===L)return;D.mouse=[R,W.invert(R)],Wo(this),D.start()}Wl(M),D.wheel=setTimeout(X,_),D.zoom("mouse",t(y(w(W,L),D.mouse[0],D.mouse[1]),D.extent,r));function X(){D.wheel=null,D.end()}}function O(M,...K){if(h||!l.apply(this,arguments))return;var D=M.currentTarget,W=T(this,K,!0).event(M),L=Pn(M.view).on("mousemove.zoom",G,!0).on("mouseup.zoom",ce,!0),R=Fn(M,D),X=M.clientX,Q=M.clientY;Qi(M.view),Yo(M),W.mouse=[R,this.__zoom.invert(R)],Wo(this),W.start();function G(se){if(Wl(se),!W.moved){var ye=se.clientX-X,Se=se.clientY-Q;W.moved=ye*ye+Se*Se>b}W.event(se).zoom("mouse",t(y(W.that.__zoom,W.mouse[0]=Fn(se,D),W.mouse[1]),W.extent,r))}function ce(se){L.on("mousemove.zoom mouseup.zoom",null),xi(se.view,W.moved),Wl(se),W.event(se).end()}}function A(M,...K){if(l.apply(this,arguments)){var D=this.__zoom,W=Fn(M.changedTouches?M.changedTouches[0]:M,this),L=D.invert(W),R=D.k*(M.shiftKey?.5:2),X=t(y(w(D,R),W,L),e.apply(this,K),r);Wl(M),i>0?Pn(this).transition().duration(i).call(z,X,W,M):Pn(this).call(g.transform,X,W,M)}}function F(M,...K){if(l.apply(this,arguments)){var D=M.touches,W=D.length,L=T(this,K,M.changedTouches.length===W).event(M),R,X,Q,G;for(Yo(M),X=0;X<W;++X)Q=D[X],G=Fn(Q,this),G=[G,this.__zoom.invert(G),Q.identifier],L.touch0?!L.touch1&&L.touch0[2]!==G[2]&&(L.touch1=G,L.taps=0):(L.touch0=G,R=!0,L.taps=1+!!u);u&&(u=clearTimeout(u)),R&&(L.taps<2&&(f=G[0],u=setTimeout(function(){u=null},d)),Wo(this),L.start())}}function j(M,...K){if(this.__zooming){var D=T(this,K).event(M),W=M.changedTouches,L=W.length,R,X,Q,G;for(Wl(M),R=0;R<L;++R)X=W[R],Q=Fn(X,this),D.touch0&&D.touch0[2]===X.identifier?D.touch0[0]=Q:D.touch1&&D.touch1[2]===X.identifier&&(D.touch1[0]=Q);if(X=D.that.__zoom,D.touch1){var ce=D.touch0[0],se=D.touch0[1],ye=D.touch1[0],Se=D.touch1[1],re=(re=ye[0]-ce[0])*re+(re=ye[1]-ce[1])*re,q=(q=Se[0]-se[0])*q+(q=Se[1]-se[1])*q;X=w(X,Math.sqrt(re/q)),Q=[(ce[0]+ye[0])/2,(ce[1]+ye[1])/2],G=[(se[0]+Se[0])/2,(se[1]+Se[1])/2]}else if(D.touch0)Q=D.touch0[0],G=D.touch0[1];else return;D.zoom("touch",t(y(X,Q,G),D.extent,r))}}function Y(M,...K){if(this.__zooming){var D=T(this,K).event(M),W=M.changedTouches,L=W.length,R,X;for(Yo(M),h&&clearTimeout(h),h=setTimeout(function(){h=null},d),R=0;R<L;++R)X=W[R],D.touch0&&D.touch0[2]===X.identifier?delete D.touch0:D.touch1&&D.touch1[2]===X.identifier&&delete D.touch1;if(D.touch1&&!D.touch0&&(D.touch0=D.touch1,delete D.touch1),D.touch0)D.touch0[1]=this.__zoom.invert(D.touch0[0]);else if(D.end(),D.taps===2&&(X=Fn(X,this),Math.hypot(f[0]-X[0],f[1]-X[1])<v)){var Q=Pn(this).on("dblclick.zoom");Q&&Q.apply(this,arguments)}}}return g.wheelDelta=function(M){return arguments.length?(n=typeof M=="function"?M:ro(+M),g):n},g.filter=function(M){return arguments.length?(l=typeof M=="function"?M:ro(!!M),g):l},g.touchable=function(M){return arguments.length?(o=typeof M=="function"?M:ro(!!M),g):o},g.extent=function(M){return arguments.length?(e=typeof M=="function"?M:ro([[+M[0][0],+M[0][1]],[+M[1][0],+M[1][1]]]),g):e},g.scaleExtent=function(M){return arguments.length?(s[0]=+M[0],s[1]=+M[1],g):[s[0],s[1]]},g.translateExtent=function(M){return arguments.length?(r[0][0]=+M[0][0],r[1][0]=+M[1][0],r[0][1]=+M[0][1],r[1][1]=+M[1][1],g):[[r[0][0],r[0][1]],[r[1][0],r[1][1]]]},g.constrain=function(M){return arguments.length?(t=M,g):t},g.duration=function(M){return arguments.length?(i=+M,g):i},g.interpolate=function(M){return arguments.length?(a=M,g):a},g.on=function(){var M=c.on.apply(c,arguments);return M===c?g:M},g.clickDistance=function(M){return arguments.length?(b=(M=+M)*M,g):Math.sqrt(b)},g.tapDistance=function(M){return arguments.length?(v=+M,g):v},g}function Vu(l){let e,t,n,o,s,r,i;return a(),{feed:c,reset:a};function a(){e=!0,t="",n=0,o=-1,s=void 0,r=void 0,i=""}function c(f){t=t?t+f:f,e&&Nu(t)&&(t=t.slice($i.length)),e=!1;const h=t.length;let d=0,_=!1;for(;d<h;){_&&(t[d]===`
`&&++d,_=!1);let b=-1,v=o,g;for(let w=n;b<0&&w<h;++w)g=t[w],g===":"&&v<0?v=w-d:g==="\r"?(_=!0,b=w-d):g===`
`&&(b=w-d);if(b<0){n=h-d,o=v;break}else n=0,o=-1;u(t,d,v,b),d+=b+1}d===h?t="":d>0&&(t=t.slice(d))}function u(f,h,d,_){if(_===0){i.length>0&&(l({type:"event",id:s,event:r||void 0,data:i.slice(0,-1)}),i="",s=void 0),r=void 0;return}const b=d<0,v=f.slice(h,h+(b?_:d));let g=0;b?g=_:f[h+d+1]===" "?g=d+2:g=d+1;const w=h+g,y=_-g,E=f.slice(w,w+y).toString();if(v==="data")i+=E?"".concat(E,`
`):`
`;else if(v==="event")r=E;else if(v==="id"&&!E.includes("\0"))s=E;else if(v==="retry"){const z=parseInt(E,10);Number.isNaN(z)||l({type:"reconnect-interval",value:z})}}}const $i=[239,187,191];function Nu(l){return $i.every((e,t)=>l.charCodeAt(t)===e)}class zu extends TransformStream{constructor(){let e;super({start(t){e=Vu(n=>{n.type==="event"&&t.enqueue(n)})},transform(t){e.feed(t)}})}}async function Ss(l,e){const t=l.pipeThrough(new TextDecoderStream).pipeThrough(new zu).getReader();let n=Pu(t);return e&&(n=Ou(n)),n}async function*Pu(l){var e,t,n;for(;;){const{value:o,done:s}=await l.read();if(s){yield{done:!0,value:""};break}if(!o)continue;const r=o.data;if(r.startsWith("[DONE]")){yield{done:!0,value:""};break}try{const i=JSON.parse(r);if(console.log(i),i.error){yield{done:!0,value:"",error:i.error};break}if(i.sources){yield{done:!1,value:"",sources:i.sources};continue}if(i.selected_model_id){yield{done:!1,value:"",selectedModelId:i.selected_model_id};continue}yield{done:!1,value:((n=(t=(e=i.choices)==null?void 0:e[0])==null?void 0:t.delta)==null?void 0:n.content)??"",usage:i.usage}}catch(i){console.error("Error extracting delta from SSE event:",i)}}}async function*Ou(l){for await(const e of l){if(e.done){yield e;return}if(e.sources){yield e;continue}let t=e.value;if(t.length<5){yield{done:!1,value:t};continue}for(;t!="";){const n=Math.min(Math.floor(Math.random()*3)+1,t.length);yield{done:!1,value:t.slice(0,n)},(document==null?void 0:document.visibilityState)!=="hidden"&&await Hu(5),t=t.slice(n)}}}const Hu=l=>new Promise(e=>setTimeout(e,l));function Ds(l){let e,t=l[2]&&Cs(l);return{c(){t&&t.c(),e=Oe()},l(n){t&&t.l(n),e=Oe()},m(n,o){t&&t.m(n,o),B(n,e,o)},p(n,o){n[2]?t?(t.p(n,o),o&4&&C(t,1)):(t=Cs(n),t.c(),C(t,1),t.m(e.parentNode,e)):t&&(Ae(),P(t,1,1,()=>{t=null}),Le())},d(n){n&&p(e),t&&t.d(n)}}}function Cs(l){let e,t,n,o,s=l[1].type+"",r,i,a,c,u,f=l[1].content+"",h,d,_,b,v,g,w=l[1].url&&Ms(),y=l[1].url&&Ts(),E=l[1].dismissible&&Vs(l);return{c(){e=V("div"),t=V("div"),n=V("div"),o=V("div"),r=Ce(s),a=$(),w&&w.c(),c=$(),u=V("div"),h=Ce(f),d=$(),y&&y.c(),_=$(),b=V("div"),E&&E.c(),this.h()},l(z){e=N(z,"DIV",{class:!0});var T=S(e);t=N(T,"DIV",{class:!0});var I=S(t);n=N(I,"DIV",{class:!0});var H=S(n);o=N(H,"DIV",{class:!0});var O=S(o);r=Me(O,s),O.forEach(p),a=ee(H),w&&w.l(H),H.forEach(p),c=ee(I),u=N(I,"DIV",{class:!0});var A=S(u);h=Me(A,f),A.forEach(p),I.forEach(p),d=ee(T),y&&y.l(T),_=ee(T),b=N(T,"DIV",{class:!0});var F=S(b);E&&E.l(F),F.forEach(p),T.forEach(p),this.h()},h(){m(o,"class",i="text-xs font-bold "+(l[3][l[1].type]??l[3].info)+" w-fit px-2 rounded uppercase line-clamp-1 mr-0.5"),m(n,"class","flex justify-between self-start"),m(u,"class","flex-1 text-xs text-gray-700 dark:text-white"),m(t,"class","flex flex-col md:flex-row md:items-center flex-1 text-sm w-fit gap-1.5"),m(b,"class","flex self-start"),m(e,"class","top-0 left-0 right-0 p-2 mx-4 px-3 flex justify-center items-center relative rounded-xl border border-gray-50 dark:border-gray-850 text-gray-800 dark:text-gary-100 bg-white dark:bg-gray-900 backdrop-blur-xl z-30")},m(z,T){B(z,e,T),k(e,t),k(t,n),k(n,o),k(o,r),k(n,a),w&&w.m(n,null),k(t,c),k(t,u),k(u,h),k(e,d),y&&y.m(e,null),k(e,_),k(e,b),E&&E.m(b,null),g=!0},p(z,T){(!g||T&2)&&s!==(s=z[1].type+"")&&He(r,s),(!g||T&2&&i!==(i="text-xs font-bold "+(z[3][z[1].type]??z[3].info)+" w-fit px-2 rounded uppercase line-clamp-1 mr-0.5"))&&m(o,"class",i),z[1].url?w||(w=Ms(),w.c(),w.m(n,null)):w&&(w.d(1),w=null),(!g||T&2)&&f!==(f=z[1].content+"")&&He(h,f),z[1].url?y||(y=Ts(),y.c(),y.m(e,_)):y&&(y.d(1),y=null),z[1].dismissible?E?E.p(z,T):(E=Vs(z),E.c(),E.m(b,null)):E&&(E.d(1),E=null)},i(z){g||(z&&sl(()=>{g&&(v||(v=hs(e,Ml,{delay:100,duration:300},!0)),v.run(1))}),g=!0)},o(z){z&&(v||(v=hs(e,Ml,{delay:100,duration:300},!1)),v.run(0)),g=!1},d(z){z&&p(e),w&&w.d(),y&&y.d(),E&&E.d(),z&&v&&v.end()}}}function Ms(l){let e,t='<a class="text-gray-700 dark:text-white text-xs font-semibold underline" href="/assets/files/whitepaper.pdf" target="_blank">Learn More</a> <div class="ml-1 text-gray-400 group-hover:text-gray-600 dark:group-hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="w-4 h-4"><path fill-rule="evenodd" d="M4.22 11.78a.75.75 0 0 1 0-1.06L9.44 5.5H5.75a.75.75 0 0 1 0-1.5h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V6.56l-5.22 5.22a.75.75 0 0 1-1.06 0Z" clip-rule="evenodd"></path></svg></div>';return{c(){e=V("div"),e.innerHTML=t,this.h()},l(n){e=N(n,"DIV",{class:!0,"data-svelte-h":!0}),gt(e)!=="svelte-o2pz5m"&&(e.innerHTML=t),this.h()},h(){m(e,"class","flex md:hidden group w-fit md:items-center")},m(n,o){B(n,e,o)},d(n){n&&p(e)}}}function Ts(l){let e,t='<a class="text-gray-700 dark:text-white text-xs font-semibold underline" href="/" target="_blank">Learn More</a> <div class="ml-1 text-gray-400 group-hover:text-gray-600 dark:group-hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-4"><path fill-rule="evenodd" d="M4.22 11.78a.75.75 0 0 1 0-1.06L9.44 5.5H5.75a.75.75 0 0 1 0-1.5h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V6.56l-5.22 5.22a.75.75 0 0 1-1.06 0Z" clip-rule="evenodd"></path></svg></div>';return{c(){e=V("div"),e.innerHTML=t,this.h()},l(n){e=N(n,"DIV",{class:!0,"data-svelte-h":!0}),gt(e)!=="svelte-1wr7se3"&&(e.innerHTML=t),this.h()},h(){m(e,"class","hidden md:flex group w-fit md:items-center")},m(n,o){B(n,e,o)},d(n){n&&p(e)}}}function Vs(l){let e,t="Ã—",n,o;return{c(){e=V("button"),e.textContent=t,this.h()},l(s){e=N(s,"BUTTON",{class:!0,"data-svelte-h":!0}),gt(e)!=="svelte-o8kh4p"&&(e.textContent=t),this.h()},h(){m(e,"class","-mt-1 -mb-2 -translate-y-[1px] ml-1.5 mr-1 text-gray-400 dark:hover:text-white")},m(s,r){B(s,e,r),n||(o=ke(e,"click",l[5]),n=!0)},p:we,d(s){s&&p(e),n=!1,o()}}}function Bu(l){let e,t=!l[0]&&Ds(l);return{c(){t&&t.c(),e=Oe()},l(n){t&&t.l(n),e=Oe()},m(n,o){t&&t.m(n,o),B(n,e,o)},p(n,[o]){n[0]?t&&(t.d(1),t=null):t?t.p(n,o):(t=Ds(n),t.c(),t.m(e.parentNode,e))},i:we,o:we,d(n){n&&p(e),t&&t.d(n)}}}function Au(l,e,t){const n=on();let{banner:o={id:"",type:"info",title:"",content:"",url:"",dismissable:!0,timestamp:Math.floor(Date.now()/1e3)}}=e,{dismissed:s=!1}=e,r=!1;const i={info:"bg-blue-500/20 text-blue-700 dark:text-blue-200 ",success:"bg-green-500/20 text-green-700 dark:text-green-200",warning:"bg-yellow-500/20 text-yellow-700 dark:text-yellow-200",error:"bg-red-500/20 text-red-700 dark:text-red-200"},a=u=>{t(0,s=!0),n("dismiss",u)};hn(()=>{t(2,r=!0)});const c=()=>{a(o.id)};return l.$$set=u=>{"banner"in u&&t(1,o=u.banner),"dismissed"in u&&t(0,s=u.dismissed)},[s,o,r,i,a,c]}class Lu extends Ve{constructor(e){super(),Ne(this,e,Au,Bu,Be,{banner:1,dismissed:0})}}function Ru(l){let e,t,n;return{c(){e=ze("svg"),t=ze("path"),n=ze("path"),this.h()},l(o){e=Pe(o,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var s=S(e);t=Pe(s,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),S(t).forEach(p),n=Pe(s,"path",{d:!0}),S(n).forEach(p),s.forEach(p),this.h()},h(){m(t,"fill-rule","evenodd"),m(t,"d","M5.625 1.5H9a3.75 3.75 0 0 1 3.75 3.75v1.875c0 1.036.84 1.875 1.875 1.875H16.5a3.75 3.75 0 0 1 3.75 3.75v7.875c0 1.035-.84 1.875-1.875 1.875H5.625a1.875 1.875 0 0 1-1.875-1.875V3.375c0-1.036.84-1.875 1.875-1.875Zm6.905 9.97a.75.75 0 0 0-1.06 0l-3 3a.75.75 0 1 0 1.06 1.06l1.72-1.72V18a.75.75 0 0 0 1.5 0v-4.19l1.72 1.72a.75.75 0 1 0 1.06-1.06l-3-3Z"),m(t,"clip-rule","evenodd"),m(n,"d","M14.25 5.25a5.23 5.23 0 0 0-1.279-3.434 9.768 9.768 0 0 1 6.963 6.963A5.23 5.23 0 0 0 16.5 7.5h-1.875a.375.375 0 0 1-.375-.375V5.25Z"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"viewBox","0 0 24 24"),m(e,"fill","currentColor"),m(e,"class",l[0])},m(o,s){B(o,e,s),k(e,t),k(e,n)},p(o,[s]){s&1&&m(e,"class",o[0])},i:we,o:we,d(o){o&&p(e)}}}function Uu(l,e,t){let{className:n="size-4"}=e;return l.$$set=o=>{"className"in o&&t(0,n=o.className)},[n]}class Wu extends Ve{constructor(e){super(),Ne(this,e,Uu,Ru,Be,{className:0})}}function ju(l){let e,t;return{c(){e=ze("svg"),t=ze("path"),this.h()},l(n){e=Pe(n,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var o=S(e);t=Pe(o,"path",{d:!0}),S(t).forEach(p),o.forEach(p),this.h()},h(){m(t,"d","M21.721 12.752a9.711 9.711 0 0 0-.945-5.003 12.754 12.754 0 0 1-4.339 2.708 18.991 18.991 0 0 1-.214 4.772 17.165 17.165 0 0 0 5.498-2.477ZM14.634 15.55a17.324 17.324 0 0 0 .332-4.647c-.952.227-1.945.347-2.966.347-1.021 0-2.014-.12-2.966-.347a17.515 17.515 0 0 0 .332 4.647 17.385 17.385 0 0 0 5.268 0ZM9.772 17.119a18.963 18.963 0 0 0 4.456 0A17.182 17.182 0 0 1 12 21.724a17.18 17.18 0 0 1-2.228-4.605ZM7.777 15.23a18.87 18.87 0 0 1-.214-4.774 12.753 12.753 0 0 1-4.34-2.708 9.711 9.711 0 0 0-.944 5.004 17.165 17.165 0 0 0 5.498 2.477ZM21.356 14.752a9.765 9.765 0 0 1-7.478 6.817 18.64 18.64 0 0 0 1.988-4.718 18.627 18.627 0 0 0 5.49-2.098ZM2.644 14.752c1.682.971 3.53 1.688 5.49 2.099a18.64 18.64 0 0 0 1.988 4.718 9.765 9.765 0 0 1-7.478-6.816ZM13.878 2.43a9.755 9.755 0 0 1 6.116 3.986 11.267 11.267 0 0 1-3.746 2.504 18.63 18.63 0 0 0-2.37-6.49ZM12 2.276a17.152 17.152 0 0 1 2.805 7.121c-.897.23-1.837.353-2.805.353-.968 0-1.908-.122-2.805-.353A17.151 17.151 0 0 1 12 2.276ZM10.122 2.43a18.629 18.629 0 0 0-2.37 6.49 11.266 11.266 0 0 1-3.746-2.504 9.754 9.754 0 0 1 6.116-3.985Z"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"viewBox","0 0 24 24"),m(e,"fill","currentColor"),m(e,"class",l[0])},m(n,o){B(n,e,o),k(e,t)},p(n,[o]){o&1&&m(e,"class",n[0])},i:we,o:we,d(n){n&&p(e)}}}function Fu(l,e,t){let{className:n="size-4"}=e;return l.$$set=o=>{"className"in o&&t(0,n=o.className)},[n]}class Yu extends Ve{constructor(e){super(),Ne(this,e,Fu,ju,Be,{className:0})}}function Ns(l,e,t){const n=l.slice();return n[19]=e[t],n}function Zu(l){let e;const t=l[9].default,n=xt(t,l,l[16],null);return{c(){n&&n.c()},l(o){n&&n.l(o)},m(o,s){n&&n.m(o,s),e=!0},p(o,s){n&&n.p&&(!e||s&65536)&&$t(n,t,o,o[16],e?tn(t,o[16],s,null):en(o[16]),null)},i(o){e||(C(n,o),e=!0)},o(o){P(n,o),e=!1},d(o){n&&n.d(o)}}}function Xu(l){let e,t;return e=new Gt({props:{content:l[7].t("More"),$$slots:{default:[Zu]},$$scope:{ctx:l}}}),{c(){te(e.$$.fragment)},l(n){oe(e.$$.fragment,n)},m(n,o){ne(e,n,o),t=!0},p(n,o){const s={};o&128&&(s.content=n[7].t("More")),o&65536&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){le(e,n)}}}function zs(l){let e,t,n,o,s=wt(Object.keys(l[5])),r=[];for(let a=0;a<s.length;a+=1)r[a]=Ps(Ns(l,s,a));const i=a=>P(r[a],1,1,()=>{r[a]=null});return{c(){e=V("div");for(let a=0;a<r.length;a+=1)r[a].c();t=$(),n=V("hr"),this.h()},l(a){e=N(a,"DIV",{class:!0});var c=S(e);for(let u=0;u<r.length;u+=1)r[u].l(c);c.forEach(p),t=ee(a),n=N(a,"HR",{class:!0}),this.h()},h(){m(e,"class","max-h-28 overflow-y-auto scrollbar-hidden"),m(n,"class","border-black/5 dark:border-white/5 my-1")},m(a,c){B(a,e,c);for(let u=0;u<r.length;u+=1)r[u]&&r[u].m(e,null);B(a,t,c),B(a,n,c),o=!0},p(a,c){if(c&33){s=wt(Object.keys(a[5]));let u;for(u=0;u<s.length;u+=1){const f=Ns(a,s,u);r[u]?(r[u].p(f,c),C(r[u],1)):(r[u]=Ps(f),r[u].c(),C(r[u],1),r[u].m(e,null))}for(Ae(),u=s.length;u<r.length;u+=1)i(u);Le()}},i(a){if(!o){for(let c=0;c<s.length;c+=1)C(r[c]);o=!0}},o(a){r=r.filter(Boolean);for(let c=0;c<r.length;c+=1)P(r[c]);o=!1},d(a){a&&(p(e),p(t),p(n)),Cn(r,a)}}}function Ku(l){let e,t,n,o,s=l[5][l[19]].name+"",r,i;return t=new Kc({}),{c(){e=V("div"),te(t.$$.fragment),n=$(),o=V("div"),r=Ce(s),this.h()},l(a){e=N(a,"DIV",{class:!0});var c=S(e);oe(t.$$.fragment,c),c.forEach(p),n=ee(a),o=N(a,"DIV",{class:!0});var u=S(o);r=Me(u,s),u.forEach(p),this.h()},h(){m(e,"class","flex-shrink-0"),m(o,"class","truncate")},m(a,c){B(a,e,c),ne(t,e,null),B(a,n,c),B(a,o,c),k(o,r),i=!0},p(a,c){(!i||c&32)&&s!==(s=a[5][a[19]].name+"")&&He(r,s)},i(a){i||(C(t.$$.fragment,a),i=!0)},o(a){P(t.$$.fragment,a),i=!1},d(a){a&&(p(e),p(n),p(o)),le(t)}}}function Ps(l){var d;let e,t,n,o,s,r,i,a,c,u;n=new Gt({props:{content:((d=l[5][l[19]])==null?void 0:d.description)??"",placement:"top-start",className:"flex flex-1 gap-2 items-center",$$slots:{default:[Ku]},$$scope:{ctx:l}}});function f(..._){return l[10](l[19],..._)}r=new qi({props:{state:l[5][l[19]].enabled}}),r.$on("change",f);function h(){return l[11](l[19])}return{c(){e=V("button"),t=V("div"),te(n.$$.fragment),o=$(),s=V("div"),te(r.$$.fragment),i=$(),this.h()},l(_){e=N(_,"BUTTON",{class:!0});var b=S(e);t=N(b,"DIV",{class:!0});var v=S(t);oe(n.$$.fragment,v),v.forEach(p),o=ee(b),s=N(b,"DIV",{class:!0});var g=S(s);oe(r.$$.fragment,g),g.forEach(p),i=ee(b),b.forEach(p),this.h()},h(){m(t,"class","flex-1 truncate"),m(s,"class","flex-shrink-0"),m(e,"class","flex w-full justify-between gap-2 items-center px-3 py-2 text-sm font-medium cursor-pointer rounded-xl")},m(_,b){B(_,e,b),k(e,t),ne(n,t,null),k(e,o),k(e,s),ne(r,s,null),k(e,i),a=!0,c||(u=ke(e,"click",h),c=!0)},p(_,b){var w;l=_;const v={};b&32&&(v.content=((w=l[5][l[19]])==null?void 0:w.description)??""),b&65568&&(v.$$scope={dirty:b,ctx:l}),n.$set(v);const g={};b&32&&(g.state=l[5][l[19]].enabled),r.$set(g)},i(_){a||(C(n.$$.fragment,_),C(r.$$.fragment,_),a=!0)},o(_){P(n.$$.fragment,_),P(r.$$.fragment,_),a=!1},d(_){_&&p(e),le(n),le(r),c=!1,u()}}}function Os(l){let e,t,n,o,s,r=l[7].t("Web Search")+"",i,a,c,u,f,h,d,_;return n=new Yu({}),c=new qi({props:{state:l[1]}}),{c(){e=V("button"),t=V("div"),te(n.$$.fragment),o=$(),s=V("div"),i=Ce(r),a=$(),te(c.$$.fragment),u=$(),f=V("hr"),this.h()},l(b){e=N(b,"BUTTON",{class:!0});var v=S(e);t=N(v,"DIV",{class:!0});var g=S(t);oe(n.$$.fragment,g),o=ee(g),s=N(g,"DIV",{class:!0});var w=S(s);i=Me(w,r),w.forEach(p),g.forEach(p),a=ee(v),oe(c.$$.fragment,v),v.forEach(p),u=ee(b),f=N(b,"HR",{class:!0}),this.h()},h(){m(s,"class","line-clamp-1"),m(t,"class","flex-1 flex items-center gap-2"),m(e,"class","flex w-full justify-between gap-2 items-center px-3 py-2 text-sm font-medium cursor-pointer rounded-xl"),m(f,"class","border-black/5 dark:border-white/5 my-1")},m(b,v){B(b,e,v),k(e,t),ne(n,t,null),k(t,o),k(t,s),k(s,i),k(e,a),ne(c,e,null),B(b,u,v),B(b,f,v),h=!0,d||(_=ke(e,"click",l[12]),d=!0)},p(b,v){(!h||v&128)&&r!==(r=b[7].t("Web Search")+"")&&He(i,r);const g={};v&2&&(g.state=b[1]),c.$set(g)},i(b){h||(C(n.$$.fragment,b),C(c.$$.fragment,b),h=!0)},o(b){P(n.$$.fragment,b),P(c.$$.fragment,b),h=!1},d(b){b&&(p(e),p(u),p(f)),le(n),le(c),d=!1,_()}}}function qu(l){let e,t,n,o=l[7].t("Upload Files")+"",s,r;return e=new Wu({}),{c(){te(e.$$.fragment),t=$(),n=V("div"),s=Ce(o),this.h()},l(i){oe(e.$$.fragment,i),t=ee(i),n=N(i,"DIV",{class:!0});var a=S(n);s=Me(a,o),a.forEach(p),this.h()},h(){m(n,"class","line-clamp-1")},m(i,a){ne(e,i,a),B(i,t,a),B(i,n,a),k(n,s),r=!0},p(i,a){(!r||a&128)&&o!==(o=i[7].t("Upload Files")+"")&&He(s,o)},i(i){r||(C(e.$$.fragment,i),r=!0)},o(i){P(e.$$.fragment,i),r=!1},d(i){i&&(p(t),p(n)),le(e,i)}}}function Gu(l){var a,c;let e=Object.keys(l[5]).length>0,t,n,o,s,r=e&&zs(l),i=((c=(a=l[6])==null?void 0:a.features)==null?void 0:c.enable_web_search)&&Os(l);return o=new Sn({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  font-medium cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800  rounded-xl",$$slots:{default:[qu]},$$scope:{ctx:l}}}),o.$on("click",l[13]),{c(){r&&r.c(),t=$(),i&&i.c(),n=$(),te(o.$$.fragment)},l(u){r&&r.l(u),t=ee(u),i&&i.l(u),n=ee(u),oe(o.$$.fragment,u)},m(u,f){r&&r.m(u,f),B(u,t,f),i&&i.m(u,f),B(u,n,f),ne(o,u,f),s=!0},p(u,f){var d,_;f&32&&(e=Object.keys(u[5]).length>0),e?r?(r.p(u,f),f&32&&C(r,1)):(r=zs(u),r.c(),C(r,1),r.m(t.parentNode,t)):r&&(Ae(),P(r,1,1,()=>{r=null}),Le()),(_=(d=u[6])==null?void 0:d.features)!=null&&_.enable_web_search?i?(i.p(u,f),f&64&&C(i,1)):(i=Os(u),i.c(),C(i,1),i.m(n.parentNode,n)):i&&(Ae(),P(i,1,1,()=>{i=null}),Le());const h={};f&65664&&(h.$$scope={dirty:f,ctx:u}),o.$set(h)},i(u){s||(C(r),C(i),C(o.$$.fragment,u),s=!0)},o(u){P(r),P(i),P(o.$$.fragment,u),s=!1},d(u){u&&(p(t),p(n)),r&&r.d(u),i&&i.d(u),le(o,u)}}}function Ju(l){let e,t,n;return t=new Vo({props:{class:"w-full max-w-[200px] rounded-xl px-1 py-1  border-gray-300/30 dark:border-gray-700/50 z-50 bg-white dark:bg-gray-850 dark:text-white shadow",sideOffset:15,alignOffset:-8,side:"top",align:"start",transition:Gl,$$slots:{default:[Gu]},$$scope:{ctx:l}}}),{c(){e=V("div"),te(t.$$.fragment),this.h()},l(o){e=N(o,"DIV",{slot:!0});var s=S(e);oe(t.$$.fragment,s),s.forEach(p),this.h()},h(){m(e,"slot","content")},m(o,s){B(o,e,s),ne(t,e,null),n=!0},p(o,s){const r={};s&65767&&(r.$$scope={dirty:s,ctx:o}),t.$set(r)},i(o){n||(C(t.$$.fragment,o),n=!0)},o(o){P(t.$$.fragment,o),n=!1},d(o){o&&p(e),le(t)}}}function Qu(l){let e,t,n;function o(r){l[14](r)}let s={$$slots:{content:[Ju],default:[Xu]},$$scope:{ctx:l}};return l[4]!==void 0&&(s.show=l[4]),e=new To({props:s}),We.push(()=>$e(e,"show",o)),e.$on("change",l[15]),{c(){te(e.$$.fragment)},l(r){oe(e.$$.fragment,r)},m(r,i){ne(e,r,i),n=!0},p(r,[i]){const a={};i&65767&&(a.$$scope={dirty:i,ctx:r}),!t&&i&16&&(t=!0,a.show=r[4],xe(()=>t=!1)),e.$set(a)},i(r){n||(C(e.$$.fragment,r),n=!0)},o(r){P(e.$$.fragment,r),n=!1},d(r){le(e,r)}}}function xu(l,e,t){let n,o,s;ie(l,vl,T=>t(17,n=T)),ie(l,ql,T=>t(6,o=T));let{$$slots:r={},$$scope:i}=e;const a=Ut("i18n");ie(l,a,T=>t(7,s=T));let{uploadFilesHandler:c}=e,{selectedToolIds:u=[]}=e,{webSearchEnabled:f}=e,{onClose:h}=e,d={},_=!1;const b=async()=>{n===null&&await vl.set(await os(localStorage.token)),t(5,d=n.reduce((T,I,H,O)=>(T[I.id]={name:I.name,description:I.meta.description,enabled:u.includes(I.id)},T),{}))},v=async(T,I)=>{const H=I.detail;await qe(),H?t(0,u=[...u,T]):t(0,u=u.filter(O=>O!==T))},g=T=>{t(5,d[T].enabled=!d[T].enabled,d)},w=()=>{t(1,f=!f)},y=()=>{c()};function E(T){_=T,t(4,_)}const z=T=>{T.detail===!1&&h()};return l.$$set=T=>{"uploadFilesHandler"in T&&t(2,c=T.uploadFilesHandler),"selectedToolIds"in T&&t(0,u=T.selectedToolIds),"webSearchEnabled"in T&&t(1,f=T.webSearchEnabled),"onClose"in T&&t(3,h=T.onClose),"$$scope"in T&&t(16,i=T.$$scope)},l.$$.update=()=>{l.$$.dirty&16&&_&&b()},[u,f,c,h,_,d,o,s,a,r,v,g,w,y,E,z,i]}class $u extends Ve{constructor(e){super(),Ne(this,e,xu,Qu,Be,{uploadFilesHandler:2,selectedToolIds:0,webSearchEnabled:1,onClose:3})}}function ef(l){let e,t;return{c(){e=ze("svg"),t=ze("path"),this.h()},l(n){e=Pe(n,"svg",{"aria-hidden":!0,xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var o=S(e);t=Pe(o,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),S(t).forEach(p),o.forEach(p),this.h()},h(){m(t,"fill-rule","evenodd"),m(t,"d","M12 5a7 7 0 0 0-7 7v1.17c.313-.11.65-.17 1-.17h2a1 1 0 0 1 1 1v6a1 1 0 0 1-1 1H6a3 3 0 0 1-3-3v-6a9 9 0 0 1 18 0v6a3 3 0 0 1-3 3h-2a1 1 0 0 1-1-1v-6a1 1 0 0 1 1-1h2c.35 0 .687.06 1 .17V12a7 7 0 0 0-7-7Z"),m(t,"clip-rule","evenodd"),m(e,"aria-hidden","true"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"fill","currentColor"),m(e,"viewBox","0 0 24 24"),m(e,"stroke-width",l[1]),m(e,"stroke","currentColor"),m(e,"class",l[0])},m(n,o){B(n,e,o),k(e,t)},p(n,[o]){o&2&&m(e,"stroke-width",n[1]),o&1&&m(e,"class",n[0])},i:we,o:we,d(n){n&&p(e)}}}function tf(l,e,t){let{className:n="w-4 h-4"}=e,{strokeWidth:o="0"}=e;return l.$$set=s=>{"className"in s&&t(0,n=s.className),"strokeWidth"in s&&t(1,o=s.strokeWidth)},[n,o]}class nf extends Ve{constructor(e){super(),Ne(this,e,tf,ef,Be,{className:0,strokeWidth:1})}}function Hs(l){let e,t,n,o,s,r,i;return s=new $a({}),{c(){e=V("div"),t=V("div"),n=V("div"),o=V("div"),te(s.$$.fragment),this.h()},l(a){e=N(a,"DIV",{class:!0,id:!0,role:!0,"aria-label":!0});var c=S(e);t=N(c,"DIV",{class:!0});var u=S(t);n=N(u,"DIV",{class:!0});var f=S(n);o=N(f,"DIV",{class:!0});var h=S(o);oe(s.$$.fragment,h),h.forEach(p),f.forEach(p),u.forEach(p),c.forEach(p),this.h()},h(){m(o,"class","max-w-md"),m(n,"class","m-auto pt-64 flex flex-col justify-center"),m(t,"class","absolute w-full h-full backdrop-blur bg-gray-800/40 flex justify-center"),m(e,"class",r="fixed "+(l[2]?"left-0 md:left-[260px] md:w-[calc(100%-260px)]":"left-0")+" fixed top-0 right-0 bottom-0 w-full h-full flex z-[9999] touch-none pointer-events-none"),m(e,"id","dropzone"),m(e,"role","region"),m(e,"aria-label","Drag and Drop Container")},m(a,c){B(a,e,c),k(e,t),k(t,n),k(n,o),ne(s,o,null),l[3](e),i=!0},p(a,c){(!i||c&4&&r!==(r="fixed "+(a[2]?"left-0 md:left-[260px] md:w-[calc(100%-260px)]":"left-0")+" fixed top-0 right-0 bottom-0 w-full h-full flex z-[9999] touch-none pointer-events-none"))&&m(e,"class",r)},i(a){i||(C(s.$$.fragment,a),i=!0)},o(a){P(s.$$.fragment,a),i=!1},d(a){a&&p(e),le(s),l[3](null)}}}function lf(l){let e,t,n=l[0]&&Hs(l);return{c(){n&&n.c(),e=Oe()},l(o){n&&n.l(o),e=Oe()},m(o,s){n&&n.m(o,s),B(o,e,s),t=!0},p(o,[s]){o[0]?n?(n.p(o,s),s&1&&C(n,1)):(n=Hs(o),n.c(),C(n,1),n.m(e.parentNode,e)):n&&(Ae(),P(n,1,1,()=>{n=null}),Le())},i(o){t||(C(n),t=!0)},o(o){P(n),t=!1},d(o){o&&p(e),n&&n.d(o)}}}function of(l,e,t){let n;ie(l,go,i=>t(2,n=i));let{show:o=!1}=e,s=null;function r(i){We[i?"unshift":"push"](()=>{s=i,t(1,s)})}return l.$$set=i=>{"show"in i&&t(0,o=i.show)},l.$$.update=()=>{l.$$.dirty&3&&(o&&s?(document.body.appendChild(s),document.body.style.overflow="hidden"):s&&(document.body.removeChild(s),document.body.style.overflow="unset"))},[o,s,n,r]}class sf extends Ve{constructor(e){super(),Ne(this,e,of,lf,Be,{show:0})}}function Bs(l,e,t){const n=l.slice();return n[0]=e[t],n[15]=t,n}function As(l){let e,t,n,o,s,r,i,a='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-3 h-3"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"></path></svg>',c,u,f=l[3].t("Tip: Update multiple variable slots consecutively by pressing the tab key in the chat input after each replacement.")+"",h,d=wt(l[2]),_=[];for(let b=0;b<d.length;b+=1)_[b]=Ls(Bs(l,d,b));return{c(){e=V("div"),t=V("div"),n=V("div"),o=V("div");for(let b=0;b<_.length;b+=1)_[b].c();s=$(),r=V("div"),i=V("div"),i.innerHTML=a,c=$(),u=V("div"),h=Ce(f),this.h()},l(b){e=N(b,"DIV",{id:!0,class:!0});var v=S(e);t=N(v,"DIV",{class:!0});var g=S(t);n=N(g,"DIV",{class:!0});var w=S(n);o=N(w,"DIV",{class:!0});var y=S(o);for(let T=0;T<_.length;T+=1)_[T].l(y);y.forEach(p),s=ee(w),r=N(w,"DIV",{class:!0});var E=S(r);i=N(E,"DIV",{"data-svelte-h":!0}),gt(i)!=="svelte-cdi12d"&&(i.innerHTML=a),c=ee(E),u=N(E,"DIV",{class:!0});var z=S(u);h=Me(z,f),z.forEach(p),E.forEach(p),w.forEach(p),g.forEach(p),v.forEach(p),this.h()},h(){m(o,"class","m-1 overflow-y-auto p-1 space-y-0.5 scrollbar-hidden"),m(u,"class","line-clamp-1"),m(r,"class","px-2 pt-0.5 pb-1 text-xs text-gray-600 dark:text-gray-100 bg-white dark:bg-gray-900 rounded-b-xl flex items-center space-x-1"),m(n,"class","max-h-60 flex flex-col w-full rounded-xl bg-white dark:bg-gray-900 dark:text-gray-100"),m(t,"class","flex w-full rounded-xl border border-gray-50 dark:border-gray-850"),m(e,"id","commands-container"),m(e,"class","pl-3 pr-14 mb-3 text-left w-full absolute bottom-0 left-0 right-0 z-10")},m(b,v){B(b,e,v),k(e,t),k(t,n),k(n,o);for(let g=0;g<_.length;g+=1)_[g]&&_[g].m(o,null);k(n,s),k(n,r),k(r,i),k(r,c),k(r,u),k(u,h)},p(b,v){if(v&38){d=wt(b[2]);let g;for(g=0;g<d.length;g+=1){const w=Bs(b,d,g);_[g]?_[g].p(w,v):(_[g]=Ls(w),_[g].c(),_[g].m(o,null))}for(;g<_.length;g+=1)_[g].d(1);_.length=d.length}v&8&&f!==(f=b[3].t("Tip: Update multiple variable slots consecutively by pressing the tab key in the chat input after each replacement.")+"")&&He(h,f)},d(b){b&&p(e),Cn(_,b)}}}function Ls(l){let e,t,n=l[0].command+"",o,s,r,i=l[0].title+"",a,c,u,f,h;function d(){return l[11](l[0])}function _(){return l[12](l[15])}return{c(){e=V("button"),t=V("div"),o=Ce(n),s=$(),r=V("div"),a=Ce(i),c=$(),this.h()},l(b){e=N(b,"BUTTON",{class:!0,type:!0});var v=S(e);t=N(v,"DIV",{class:!0});var g=S(t);o=Me(g,n),g.forEach(p),s=ee(v),r=N(v,"DIV",{class:!0});var w=S(r);a=Me(w,i),w.forEach(p),c=ee(v),v.forEach(p),this.h()},h(){m(t,"class","font-medium text-black dark:text-gray-100"),m(r,"class","text-xs text-gray-600 dark:text-gray-100"),m(e,"class",u="px-3 py-1.5 rounded-xl w-full text-left "+(l[15]===l[1]?"  bg-gray-50 dark:bg-gray-850 selected-command-option-button":"")),m(e,"type","button")},m(b,v){B(b,e,v),k(e,t),k(t,o),k(e,s),k(e,r),k(r,a),k(e,c),f||(h=[ke(e,"click",d),ke(e,"mousemove",_),ke(e,"focus",af)],f=!0)},p(b,v){l=b,v&4&&n!==(n=l[0].command+"")&&He(o,n),v&4&&i!==(i=l[0].title+"")&&He(a,i),v&2&&u!==(u="px-3 py-1.5 rounded-xl w-full text-left "+(l[15]===l[1]?"  bg-gray-50 dark:bg-gray-850 selected-command-option-button":""))&&m(e,"class",u)},d(b){b&&p(e),f=!1,ln(h)}}}function rf(l){let e,t=l[2].length>0&&As(l);return{c(){t&&t.c(),e=Oe()},l(n){t&&t.l(n),e=Oe()},m(n,o){t&&t.m(n,o),B(n,e,o)},p(n,[o]){n[2].length>0?t?t.p(n,o):(t=As(n),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:we,o:we,d(n){n&&p(e),t&&t.d(n)}}}const af=()=>{};function cf(l,e,t){let n,o,s;ie(l,al,g=>t(13,n=g)),ie(l,Fi,g=>t(10,s=g));const r=Ut("i18n");ie(l,r,g=>t(3,o=g));let{files:i}=e,{prompt:a=""}=e,{command:c=""}=e,u=0,f=[];const h=()=>{t(1,u=Math.max(0,u-1))},d=()=>{t(1,u=Math.min(u+1,f.length-1))},_=async g=>{let w=g.content;if(g.content.includes("{{CLIPBOARD}}")){const z=await navigator.clipboard.readText().catch(H=>(nt.error(o.t("Failed to read clipboard contents")),"{{CLIPBOARD}}")),T=await navigator.clipboard.read();let I=null;for(const H of T)for(const O of H.types)if(O.startsWith("image/")){const A=await H.getType(O);I=URL.createObjectURL(A)}I&&t(6,i=[...i,{type:"image",url:I}]),w=w.replaceAll("{{CLIPBOARD}}",z)}if(g.content.includes("{{USER_LOCATION}}")){const z=await uc();w=w.replaceAll("{{USER_LOCATION}}",String(z))}if(g.content.includes("{{USER_NAME}}")){console.log(n);const z=n.name||"User";w=w.replaceAll("{{USER_NAME}}",z)}if(g.content.includes("{{USER_LANGUAGE}}")){const z=localStorage.getItem("locale")||"en-US";w=w.replaceAll("{{USER_LANGUAGE}}",z)}if(g.content.includes("{{CURRENT_DATE}}")){const z=fc();w=w.replaceAll("{{CURRENT_DATE}}",z)}if(g.content.includes("{{CURRENT_TIME}}")){const z=dc();w=w.replaceAll("{{CURRENT_TIME}}",z)}if(g.content.includes("{{CURRENT_DATETIME}}")){const z=hc();w=w.replaceAll("{{CURRENT_DATETIME}}",z)}if(g.content.includes("{{CURRENT_TIMEZONE}}")){const z=mc();w=w.replaceAll("{{CURRENT_TIMEZONE}}",z)}if(g.content.includes("{{CURRENT_WEEKDAY}}")){const z=gc();w=w.replaceAll("{{CURRENT_WEEKDAY}}",z)}t(0,a=w);const y=document.getElementById("chat-input-container"),E=document.getElementById("chat-input");await qe(),y&&(y.style.height="",y.style.height=Math.min(y.scrollHeight,200)+"px"),await qe(),E&&(E.focus(),E.dispatchEvent(new Event("input")))},b=g=>{_(g)},v=g=>{t(1,u=g)};return l.$$set=g=>{"files"in g&&t(6,i=g.files),"prompt"in g&&t(0,a=g.prompt),"command"in g&&t(7,c=g.command)},l.$$.update=()=>{l.$$.dirty&1152&&t(2,f=s.filter(g=>g.command.toLowerCase().includes(c.toLowerCase())).sort((g,w)=>g.title.localeCompare(w.title))),l.$$.dirty&128&&c&&t(1,u=0)},[a,u,f,o,r,_,i,c,h,d,s,b,v]}class uf extends Ve{constructor(e){super(),Ne(this,e,cf,rf,Be,{files:6,prompt:0,command:7,selectUp:8,selectDown:9})}get selectUp(){return this.$$.ctx[8]}get selectDown(){return this.$$.ctx[9]}}function Rs(l,e,t){const n=l.slice();return n[19]=e[t],n[21]=t,n}function Us(l){let e,t,n,o,s,r,i,a=wt(l[2]),c=[];for(let d=0;d<a.length;d+=1)c[d]=Ws(Rs(l,a,d));function u(d,_){var b,v;if(_&1&&(r=null),_&1&&(i=null),r==null&&(r=!!d[0].split(" ").some(bf)),r)return _f;if(i==null&&(i=!!((v=(b=d[0].split(" "))==null?void 0:b.at(0))!=null&&v.substring(1).startsWith("http"))),i)return gf}let f=u(l,-1),h=f&&f(l);return{c(){e=V("div"),t=V("div"),n=V("div"),o=V("div");for(let d=0;d<c.length;d+=1)c[d].c();s=$(),h&&h.c(),this.h()},l(d){e=N(d,"DIV",{id:!0,class:!0});var _=S(e);t=N(_,"DIV",{class:!0});var b=S(t);n=N(b,"DIV",{class:!0});var v=S(n);o=N(v,"DIV",{class:!0});var g=S(o);for(let w=0;w<c.length;w+=1)c[w].l(g);s=ee(g),h&&h.l(g),g.forEach(p),v.forEach(p),b.forEach(p),_.forEach(p),this.h()},h(){m(o,"class","m-1 overflow-y-auto p-1 rounded-r-xl space-y-0.5 scrollbar-hidden"),m(n,"class","max-h-60 flex flex-col w-full rounded-xl bg-white dark:bg-gray-900 dark:text-gray-100"),m(t,"class","flex w-full rounded-xl border border-gray-50 dark:border-gray-850"),m(e,"id","commands-container"),m(e,"class","pl-3 pr-14 mb-3 text-left w-full absolute bottom-0 left-0 right-0 z-10")},m(d,_){B(d,e,_),k(e,t),k(t,n),k(n,o);for(let b=0;b<c.length;b+=1)c[b]&&c[b].m(o,null);k(o,s),h&&h.m(o,null)},p(d,_){if(_&38){a=wt(d[2]);let b;for(b=0;b<a.length;b+=1){const v=Rs(d,a,b);c[b]?c[b].p(v,_):(c[b]=Ws(v),c[b].c(),c[b].m(o,s))}for(;b<c.length;b+=1)c[b].d(1);c.length=a.length}f===(f=u(d,_))&&h?h.p(d,_):(h&&h.d(1),h=f&&f(d),h&&(h.c(),h.m(o,null)))},d(d){d&&p(e),Cn(c,d),h&&h.d()}}}function ff(l){let e,t="Collection";return{c(){e=V("div"),e.textContent=t,this.h()},l(n){e=N(n,"DIV",{class:!0,"data-svelte-h":!0}),gt(e)!=="svelte-2leuop"&&(e.textContent=t),this.h()},h(){m(e,"class","bg-green-500/20 text-green-700 dark:text-green-200 rounded uppercase text-xs font-bold px-1 flex-shrink-0")},m(n,o){B(n,e,o)},d(n){n&&p(e)}}}function df(l){let e,t="File";return{c(){e=V("div"),e.textContent=t,this.h()},l(n){e=N(n,"DIV",{class:!0,"data-svelte-h":!0}),gt(e)!=="svelte-1hk0ird"&&(e.textContent=t),this.h()},h(){m(e,"class","bg-gray-500/20 text-gray-700 dark:text-gray-200 rounded uppercase text-xs font-bold px-1 flex-shrink-0")},m(n,o){B(n,e,o)},d(n){n&&p(e)}}}function hf(l){let e,t="Document";return{c(){e=V("div"),e.textContent=t,this.h()},l(n){e=N(n,"DIV",{class:!0,"data-svelte-h":!0}),gt(e)!=="svelte-o57xc2"&&(e.textContent=t),this.h()},h(){m(e,"class","bg-gray-500/20 text-gray-700 dark:text-gray-200 rounded uppercase text-xs font-bold px-1 flex-shrink-0")},m(n,o){B(n,e,o)},d(n){n&&p(e)}}}function mf(l){let e,t="Legacy";return{c(){e=V("div"),e.textContent=t,this.h()},l(n){e=N(n,"DIV",{class:!0,"data-svelte-h":!0}),gt(e)!=="svelte-1dukunw"&&(e.textContent=t),this.h()},h(){m(e,"class","bg-gray-500/20 text-gray-700 dark:text-gray-200 rounded uppercase text-xs font-bold px-1 flex-shrink-0")},m(n,o){B(n,e,o)},d(n){n&&p(e)}}}function Ws(l){var E,z;let e,t,n,o,s,r=((E=l[19])==null?void 0:E.name)+"",i,a,c,u=((z=l[19])==null?void 0:z.description)+"",f,h,d,_;function b(T,I){var H,O,A;return T[19].legacy?mf:(O=(H=T[19])==null?void 0:H.meta)!=null&&O.document?hf:((A=T[19])==null?void 0:A.type)==="file"?df:ff}let v=b(l),g=v(l);function w(){return l[13](l[19])}function y(){return l[14](l[21])}return{c(){e=V("button"),t=V("div"),n=V("div"),g.c(),o=$(),s=V("div"),i=Ce(r),a=$(),c=V("div"),f=Ce(u),this.h()},l(T){e=N(T,"BUTTON",{class:!0,type:!0});var I=S(e);t=N(I,"DIV",{});var H=S(t);n=N(H,"DIV",{class:!0});var O=S(n);g.l(O),o=ee(O),s=N(O,"DIV",{class:!0});var A=S(s);i=Me(A,r),A.forEach(p),O.forEach(p),a=ee(H),c=N(H,"DIV",{class:!0});var F=S(c);f=Me(F,u),F.forEach(p),H.forEach(p),I.forEach(p),this.h()},h(){m(s,"class","line-clamp-1"),m(n,"class","font-medium text-black dark:text-gray-100 flex items-center gap-1"),m(c,"class","text-xs text-gray-600 dark:text-gray-100 line-clamp-1"),m(e,"class",h="px-3 py-1.5 rounded-xl w-full text-left flex justify-between items-center "+(l[21]===l[1]?" bg-gray-50 dark:bg-gray-850 dark:text-gray-100 selected-command-option-button":"")),m(e,"type","button")},m(T,I){B(T,e,I),k(e,t),k(t,n),g.m(n,null),k(n,o),k(n,s),k(s,i),k(t,a),k(t,c),k(c,f),d||(_=[ke(e,"click",w),ke(e,"mousemove",y)],d=!0)},p(T,I){var H,O;l=T,v!==(v=b(l))&&(g.d(1),g=v(l),g&&(g.c(),g.m(n,o))),I&4&&r!==(r=((H=l[19])==null?void 0:H.name)+"")&&He(i,r),I&4&&u!==(u=((O=l[19])==null?void 0:O.description)+"")&&He(f,u),I&2&&h!==(h="px-3 py-1.5 rounded-xl w-full text-left flex justify-between items-center "+(l[21]===l[1]?" bg-gray-50 dark:bg-gray-850 dark:text-gray-100 selected-command-option-button":""))&&m(e,"class",h)},d(T){T&&p(e),g.d(),d=!1,ln(_)}}}function gf(l){var f,h;let e,t,n=((h=(f=l[0].split(" "))==null?void 0:f.at(0))==null?void 0:h.substring(1))+"",o,s,r,i=l[3].t("Web")+"",a,c,u;return{c(){e=V("button"),t=V("div"),o=Ce(n),s=$(),r=V("div"),a=Ce(i),this.h()},l(d){e=N(d,"BUTTON",{class:!0,type:!0});var _=S(e);t=N(_,"DIV",{class:!0});var b=S(t);o=Me(b,n),b.forEach(p),s=ee(_),r=N(_,"DIV",{class:!0});var v=S(r);a=Me(v,i),v.forEach(p),_.forEach(p),this.h()},h(){m(t,"class","font-medium text-black dark:text-gray-100 line-clamp-1"),m(r,"class","text-xs text-gray-600 line-clamp-1"),m(e,"class","px-3 py-1.5 rounded-xl w-full text-left bg-gray-50 dark:bg-gray-850 dark:text-gray-100 selected-command-option-button"),m(e,"type","button")},m(d,_){B(d,e,_),k(e,t),k(t,o),k(e,s),k(e,r),k(r,a),c||(u=ke(e,"click",l[16]),c=!0)},p(d,_){var b,v;_&1&&n!==(n=((v=(b=d[0].split(" "))==null?void 0:b.at(0))==null?void 0:v.substring(1))+"")&&He(o,n),_&8&&i!==(i=d[3].t("Web")+"")&&He(a,i)},d(d){d&&p(e),c=!1,u()}}}function _f(l){var f,h;let e,t,n=((h=(f=l[0].split(" "))==null?void 0:f.at(0))==null?void 0:h.substring(1))+"",o,s,r,i=l[3].t("Youtube")+"",a,c,u;return{c(){e=V("button"),t=V("div"),o=Ce(n),s=$(),r=V("div"),a=Ce(i),this.h()},l(d){e=N(d,"BUTTON",{class:!0,type:!0});var _=S(e);t=N(_,"DIV",{class:!0});var b=S(t);o=Me(b,n),b.forEach(p),s=ee(_),r=N(_,"DIV",{class:!0});var v=S(r);a=Me(v,i),v.forEach(p),_.forEach(p),this.h()},h(){m(t,"class","font-medium text-black dark:text-gray-100 line-clamp-1"),m(r,"class","text-xs text-gray-600 line-clamp-1"),m(e,"class","px-3 py-1.5 rounded-xl w-full text-left bg-gray-50 dark:bg-gray-850 dark:text-gray-100 selected-command-option-button"),m(e,"type","button")},m(d,_){B(d,e,_),k(e,t),k(t,o),k(e,s),k(e,r),k(r,a),c||(u=ke(e,"click",l[15]),c=!0)},p(d,_){var b,v;_&1&&n!==(n=((v=(b=d[0].split(" "))==null?void 0:b.at(0))==null?void 0:v.substring(1))+"")&&He(o,n),_&8&&i!==(i=d[3].t("Youtube")+"")&&He(a,i)},d(d){d&&p(e),c=!1,u()}}}function pf(l){var o,s;let e=l[2].length>0||((s=(o=l[0].split(" "))==null?void 0:o.at(0))==null?void 0:s.substring(1).startsWith("http")),t,n=e&&Us(l);return{c(){n&&n.c(),t=Oe()},l(r){n&&n.l(r),t=Oe()},m(r,i){n&&n.m(r,i),B(r,t,i)},p(r,[i]){var a,c;i&5&&(e=r[2].length>0||((c=(a=r[0].split(" "))==null?void 0:a.at(0))==null?void 0:c.substring(1).startsWith("http"))),e?n?n.p(r,i):(n=Us(r),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},i:we,o:we,d(r){r&&p(t),n&&n.d(r)}}}const bf=l=>l.substring(1).startsWith("https://www.youtube.com")||l.substring(1).startsWith("https://youtu.be");function vf(l,e,t){let n,o;ie(l,Yi,T=>t(17,n=T)),xa.extend(xc);const s=Ut("i18n");ie(l,s,T=>t(3,o=T));let{prompt:r=""}=e,{command:i=""}=e;const a=on();let c=0,u=[],f=null,h=[];const d=()=>{t(1,c=Math.max(0,c-1))},_=()=>{t(1,c=Math.min(c+1,h.length-1))},b=async T=>{a("select",T),t(0,r=co(r,i));const I=document.getElementById("chat-input");await qe(),I==null||I.focus(),await qe()},v=async T=>{a("url",T),t(0,r=co(r,i));const I=document.getElementById("chat-input");await qe(),I==null||I.focus(),await qe()},g=async T=>{a("youtube",T),t(0,r=co(r,i));const I=document.getElementById("chat-input");await qe(),I==null||I.focus(),await qe()};hn(()=>{let T=n.filter(A=>{var F;return(F=A==null?void 0:A.meta)==null?void 0:F.document}).map(A=>({...A,type:"file"})),I=T.length>0?[{name:"All Documents",legacy:!0,type:"collection",description:"Deprecated (legacy collection), please create a new knowledge base.",title:o.t("All Documents"),collection_names:T.map(A=>A.id)},...T.reduce((A,F)=>{var j;return[...new Set([...A,...(((j=F==null?void 0:F.meta)==null?void 0:j.tags)??[]).map(Y=>Y.name)])]},[]).map(A=>({name:A,legacy:!0,type:"collection",description:"Deprecated (legacy collection), please create a new knowledge base.",collection_names:T.filter(F=>{var j;return(((j=F==null?void 0:F.meta)==null?void 0:j.tags)??[]).map(Y=>Y.name).includes(A)}).map(F=>F.id)}))]:[],H=n.filter(A=>{var F;return!((F=A==null?void 0:A.meta)!=null&&F.document)}).map(A=>({...A,type:"collection"})),O=n.length>0?[...n.reduce((A,F)=>[...new Set([...A,...((F==null?void 0:F.files)??[]).map(j=>({...j,collection:{name:F.name,description:F.description}}))])],[]).map(A=>{var F,j,Y;return{...A,name:(F=A==null?void 0:A.meta)==null?void 0:F.name,description:`${(j=A==null?void 0:A.collection)==null?void 0:j.name} - ${(Y=A==null?void 0:A.collection)==null?void 0:Y.description}`,type:"file"}})]:[];t(11,u=[...H,...O,...I,...T].map(A=>{var F,j;return{...A,...A!=null&&A.legacy||(F=A==null?void 0:A.meta)!=null&&F.legacy||(j=A==null?void 0:A.meta)!=null&&j.document?{legacy:!0}:{}}})),t(12,f=new Ji(u,{keys:["name","description"]}))});const w=T=>{console.log(T),b(T)},y=T=>{t(1,c=T)},E=()=>{var I,H;const T=(H=(I=r.split(" "))==null?void 0:I.at(0))==null?void 0:H.substring(1);ps(T)?g(T):nt.error(o.t("Oops! Looks like the URL is invalid. Please double-check and try again."))},z=()=>{var I,H;const T=(H=(I=r.split(" "))==null?void 0:I.at(0))==null?void 0:H.substring(1);ps(T)?v(T):nt.error(o.t("Oops! Looks like the URL is invalid. Please double-check and try again."))};return l.$$set=T=>{"prompt"in T&&t(0,r=T.prompt),"command"in T&&t(8,i=T.command)},l.$$.update=()=>{l.$$.dirty&6400&&f&&t(2,h=i.slice(1)?f.search(i).map(T=>T.item):u),l.$$.dirty&256&&i&&t(1,c=0)},[r,c,h,o,s,b,v,g,i,d,_,u,f,w,y,E,z]}class wf extends Ve{constructor(e){super(),Ne(this,e,vf,pf,Be,{prompt:0,command:8,selectUp:9,selectDown:10})}get selectUp(){return this.$$.ctx[9]}get selectDown(){return this.$$.ctx[10]}}function js(l,e,t){const n=l.slice();return n[12]=e[t],n[14]=t,n}function Fs(l){let e,t,n,o,s=wt(l[1]),r=[];for(let i=0;i<s.length;i+=1)r[i]=Ys(js(l,s,i));return{c(){e=V("div"),t=V("div"),n=V("div"),o=V("div");for(let i=0;i<r.length;i+=1)r[i].c();this.h()},l(i){e=N(i,"DIV",{id:!0,class:!0});var a=S(e);t=N(a,"DIV",{class:!0});var c=S(t);n=N(c,"DIV",{class:!0});var u=S(n);o=N(u,"DIV",{class:!0});var f=S(o);for(let h=0;h<r.length;h+=1)r[h].l(f);f.forEach(p),u.forEach(p),c.forEach(p),a.forEach(p),this.h()},h(){m(o,"class","m-1 overflow-y-auto p-1 rounded-r-lg space-y-0.5 scrollbar-hidden"),m(n,"class","max-h-60 flex flex-col w-full rounded-xl bg-white dark:bg-gray-900 dark:text-gray-100"),m(t,"class","flex w-full rounded-xl border border-gray-50 dark:border-gray-850"),m(e,"id","commands-container"),m(e,"class","pl-3 pr-14 mb-3 text-left w-full absolute bottom-0 left-0 right-0 z-10")},m(i,a){B(i,e,a),k(e,t),k(t,n),k(n,o);for(let c=0;c<r.length;c+=1)r[c]&&r[c].m(o,null)},p(i,a){if(a&7){s=wt(i[1]);let c;for(c=0;c<s.length;c+=1){const u=js(i,s,c);r[c]?r[c].p(u,a):(r[c]=Ys(u),r[c].c(),r[c].m(o,null))}for(;c<r.length;c+=1)r[c].d(1);r.length=s.length}},d(i){i&&p(e),Cn(r,i)}}}function Ys(l){let e,t,n,o,s,r,i=l[12].name+"",a,c,u,f,h;function d(){return l[7](l[12])}function _(){return l[8](l[14])}return{c(){e=V("button"),t=V("div"),n=V("img"),r=$(),a=Ce(i),c=$(),this.h()},l(b){e=N(b,"BUTTON",{class:!0,type:!0});var v=S(e);t=N(v,"DIV",{class:!0});var g=S(t);n=N(g,"IMG",{src:!0,alt:!0,class:!0}),r=ee(g),a=Me(g,i),g.forEach(p),c=ee(v),v.forEach(p),this.h()},h(){var b,v,g,w;Hn(n.src,o=((g=(v=(b=l[12])==null?void 0:b.info)==null?void 0:v.meta)==null?void 0:g.profile_image_url)??"/static/favicon.png")||m(n,"src",o),m(n,"alt",s=((w=l[12])==null?void 0:w.name)??l[12].id),m(n,"class","rounded-full size-6 items-center mr-2"),m(t,"class","flex font-medium text-black dark:text-gray-100 line-clamp-1"),m(e,"class",u="px-3 py-1.5 rounded-xl w-full text-left "+(l[14]===l[0]?"bg-gray-50 dark:bg-gray-850 selected-command-option-button":"")),m(e,"type","button")},m(b,v){B(b,e,v),k(e,t),k(t,n),k(t,r),k(t,a),k(e,c),f||(h=[ke(e,"click",d),ke(e,"mousemove",_),ke(e,"focus",kf)],f=!0)},p(b,v){var g,w,y,E;l=b,v&2&&!Hn(n.src,o=((y=(w=(g=l[12])==null?void 0:g.info)==null?void 0:w.meta)==null?void 0:y.profile_image_url)??"/static/favicon.png")&&m(n,"src",o),v&2&&s!==(s=((E=l[12])==null?void 0:E.name)??l[12].id)&&m(n,"alt",s),v&2&&i!==(i=l[12].name+"")&&He(a,i),v&1&&u!==(u="px-3 py-1.5 rounded-xl w-full text-left "+(l[14]===l[0]?"bg-gray-50 dark:bg-gray-850 selected-command-option-button":""))&&m(e,"class",u)},d(b){b&&p(e),f=!1,ln(h)}}}function yf(l){let e,t=l[1].length>0&&Fs(l);return{c(){t&&t.c(),e=Oe()},l(n){t&&t.l(n),e=Oe()},m(n,o){t&&t.m(n,o),B(n,e,o)},p(n,[o]){n[1].length>0?t?t.p(n,o):(t=Fs(n),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:we,o:we,d(n){n&&p(e),t&&t.d(n)}}}const kf=()=>{};function Ef(l,e,t){let n;ie(l,yl,_=>t(6,n=_)),Ut("i18n");const o=on();let{command:s=""}=e,r=0,i=[],a=new Ji(n.filter(_=>{var b,v;return!((v=(b=_==null?void 0:_.info)==null?void 0:b.meta)!=null&&v.hidden)}).map(_=>{var v,g,w,y,E;return{..._,modelName:_==null?void 0:_.name,tags:(w=(g=(v=_==null?void 0:_.info)==null?void 0:v.meta)==null?void 0:g.tags)==null?void 0:w.map(z=>z.name).join(" "),desc:(E=(y=_==null?void 0:_.info)==null?void 0:y.meta)==null?void 0:E.description}}),{keys:["value","tags","modelName"],threshold:.3});const c=()=>{t(0,r=Math.max(0,r-1))},u=()=>{t(0,r=Math.min(r+1,i.length-1))},f=async _=>{t(3,s=""),o("select",_)};hn(async()=>{await qe();const _=document.getElementById("chat-input");await qe(),_==null||_.focus(),await qe()});const h=_=>{f(_)},d=_=>{t(0,r=_)};return l.$$set=_=>{"command"in _&&t(3,s=_.command)},l.$$.update=()=>{l.$$.dirty&72&&t(1,i=s.slice(1)?a.search(s).map(_=>_.item):n.filter(_=>{var b,v;return!((v=(b=_==null?void 0:_.info)==null?void 0:b.meta)!=null&&v.hidden)})),l.$$.dirty&8&&s&&t(0,r=0)},[r,i,f,s,c,u,n,h,d]}class If extends Ve{constructor(e){super(),Ne(this,e,Ef,yf,Be,{command:3,selectUp:4,selectDown:5})}get selectUp(){return this.$$.ctx[4]}get selectDown(){return this.$$.ctx[5]}}function Zs(l){let e,t,n,o;const s=[Df,Sf],r=[];function i(a,c){return a[4]?1:0}return e=i(l),t=r[e]=s[e](l),{c(){t.c(),n=Oe()},l(a){t.l(a),n=Oe()},m(a,c){r[e].m(a,c),B(a,n,c),o=!0},p(a,c){let u=e;e=i(a),e===u?r[e].p(a,c):(Ae(),P(r[u],1,1,()=>{r[u]=null}),Le(),t=r[e],t?t.p(a,c):(t=r[e]=s[e](a),t.c()),C(t,1),t.m(n.parentNode,n))},i(a){o||(C(t),o=!0)},o(a){P(t),o=!1},d(a){a&&p(n),r[e].d(a)}}}function Sf(l){let e,t,n,o,s;return o=new ss({}),{c(){e=V("div"),t=V("div"),n=V("div"),te(o.$$.fragment),this.h()},l(r){e=N(r,"DIV",{id:!0,class:!0});var i=S(e);t=N(i,"DIV",{class:!0});var a=S(t);n=N(a,"DIV",{class:!0});var c=S(n);oe(o.$$.fragment,c),c.forEach(p),a.forEach(p),i.forEach(p),this.h()},h(){m(n,"class","max-h-60 flex flex-col w-full rounded-xl bg-white dark:bg-gray-900 dark:text-gray-100"),m(t,"class","flex w-full rounded-xl border border-gray-50 dark:border-gray-850"),m(e,"id","commands-container"),m(e,"class","pl-3 pr-14 mb-3 text-left w-full absolute bottom-0 left-0 right-0 z-10")},m(r,i){B(r,e,i),k(e,t),k(t,n),ne(o,n,null),s=!0},p:we,i(r){s||(C(o.$$.fragment,r),s=!0)},o(r){P(o.$$.fragment,r),s=!1},d(r){r&&p(e),le(o)}}}function Df(l){let e,t,n,o,s,r,i;const a=[Tf,Mf,Cf],c=[];function u(f,h){var d,_,b;return h&4&&(e=null),h&4&&(t=null),h&4&&(n=null),e==null&&(e=((d=f[2])==null?void 0:d.charAt(0))==="/"),e?0:(t==null&&(t=!!(((_=f[2])==null?void 0:_.charAt(0))==="#"&&f[2].startsWith("#")&&!f[2].includes("# ")||f[2].slice(0,2)==="\\#"&&f[2].startsWith("#")&&!f[2].includes("# "))),t?1:(n==null&&(n=((b=f[2])==null?void 0:b.charAt(0))==="@"),n?2:-1))}return~(o=u(l,-1))&&(s=c[o]=a[o](l)),{c(){s&&s.c(),r=Oe()},l(f){s&&s.l(f),r=Oe()},m(f,h){~o&&c[o].m(f,h),B(f,r,h),i=!0},p(f,h){let d=o;o=u(f,h),o===d?~o&&c[o].p(f,h):(s&&(Ae(),P(c[d],1,1,()=>{c[d]=null}),Le()),~o?(s=c[o],s?s.p(f,h):(s=c[o]=a[o](f),s.c()),C(s,1),s.m(r.parentNode,r)):s=null)},i(f){i||(C(s),i=!0)},o(f){P(s),i=!1},d(f){f&&p(r),~o&&c[o].d(f)}}}function Cf(l){let e,t,n={command:l[2]};return e=new If({props:n}),l[17](e),e.$on("select",l[18]),{c(){te(e.$$.fragment)},l(o){oe(e.$$.fragment,o)},m(o,s){ne(e,o,s),t=!0},p(o,s){const r={};s&4&&(r.command=o[2]),e.$set(r)},i(o){t||(C(e.$$.fragment,o),t=!0)},o(o){P(e.$$.fragment,o),t=!1},d(o){l[17](null),le(e,o)}}}function Mf(l){let e,t,n;function o(r){l[13](r)}let s={command:l[2].includes("\\#")?l[2].slice(2):l[2]};return l[0]!==void 0&&(s.prompt=l[0]),e=new wf({props:s}),l[12](e),We.push(()=>$e(e,"prompt",o)),e.$on("youtube",l[14]),e.$on("url",l[15]),e.$on("select",l[16]),{c(){te(e.$$.fragment)},l(r){oe(e.$$.fragment,r)},m(r,i){ne(e,r,i),n=!0},p(r,i){const a={};i&4&&(a.command=r[2].includes("\\#")?r[2].slice(2):r[2]),!t&&i&1&&(t=!0,a.prompt=r[0],xe(()=>t=!1)),e.$set(a)},i(r){n||(C(e.$$.fragment,r),n=!0)},o(r){P(e.$$.fragment,r),n=!1},d(r){l[12](null),le(e,r)}}}function Tf(l){let e,t,n,o;function s(a){l[10](a)}function r(a){l[11](a)}let i={command:l[2]};return l[0]!==void 0&&(i.prompt=l[0]),l[1]!==void 0&&(i.files=l[1]),e=new uf({props:i}),l[9](e),We.push(()=>$e(e,"prompt",s)),We.push(()=>$e(e,"files",r)),{c(){te(e.$$.fragment)},l(a){oe(e.$$.fragment,a)},m(a,c){ne(e,a,c),o=!0},p(a,c){const u={};c&4&&(u.command=a[2]),!t&&c&1&&(t=!0,u.prompt=a[0],xe(()=>t=!1)),!n&&c&2&&(n=!0,u.files=a[1],xe(()=>n=!1)),e.$set(u)},i(a){o||(C(e.$$.fragment,a),o=!0)},o(a){P(e.$$.fragment,a),o=!1},d(a){l[9](null),le(e,a)}}}function Vf(l){let e,t,n=l[3]&&Zs(l);return{c(){n&&n.c(),e=Oe()},l(o){n&&n.l(o),e=Oe()},m(o,s){n&&n.m(o,s),B(o,e,s),t=!0},p(o,[s]){o[3]?n?(n.p(o,s),s&8&&C(n,1)):(n=Zs(o),n.c(),C(n,1),n.m(e.parentNode,e)):n&&(Ae(),P(n,1,1,()=>{n=null}),Le())},i(o){t||(C(n),t=!0)},o(o){P(n),t=!1},d(o){o&&p(e),n&&n.d(o)}}}function Nf(l,e,t){const n=on();let{prompt:o=""}=e,{files:s=[]}=e,r=!1,i=null;const a=()=>{i==null||i.selectUp()},c=()=>{i==null||i.selectDown()};let u="",f=!1;const h=async()=>{t(4,r=!0),await Promise.all([(async()=>{Fi.set(await Jc(localStorage.token))})(),(async()=>{Yi.set(await Qc(localStorage.token))})()]),t(4,r=!1)};function d(I){We[I?"unshift":"push"](()=>{i=I,t(5,i)})}function _(I){o=I,t(0,o)}function b(I){s=I,t(1,s)}function v(I){We[I?"unshift":"push"](()=>{i=I,t(5,i)})}function g(I){o=I,t(0,o)}const w=I=>{console.log(I),n("upload",{type:"youtube",data:I.detail})},y=I=>{console.log(I),n("upload",{type:"web",data:I.detail})},E=I=>{console.log(I),t(1,s=[...s,{...I.detail,status:"processed"}]),n("select")};function z(I){We[I?"unshift":"push"](()=>{i=I,t(5,i)})}const T=I=>{t(0,o=co(o,u)),n("select",{type:"model",data:I.detail})};return l.$$set=I=>{"prompt"in I&&t(0,o=I.prompt),"files"in I&&t(1,s=I.files)},l.$$.update=()=>{var I,H;l.$$.dirty&1&&t(2,u=((H=(I=o==null?void 0:o.split(`
`).pop())==null?void 0:I.split(" "))==null?void 0:H.pop())??""),l.$$.dirty&4&&t(3,f=["/","#","@"].includes(u==null?void 0:u.charAt(0))||u.slice(0,2)==="\\#"),l.$$.dirty&8&&f&&h()},[o,s,u,f,r,i,n,a,c,d,_,b,v,g,w,y,E,z,T]}class zf extends Ve{constructor(e){super(),Ne(this,e,Nf,Vf,Be,{prompt:0,files:1,selectUp:7,selectDown:8})}get selectUp(){return this.$$.ctx[7]}get selectDown(){return this.$$.ctx[8]}}function Xs(l,e,t){const n=l.slice();return n[77]=e[t],n[79]=t,n}function Ks(l,e,t){const n=l.slice();return n[80]=e[t],n[82]=t,n}function qs(l){var K;let e,t,n,o,s,r,i,a,c,u,f,h,d,_,b,v,g,w,y,E,z,T,I=l[1]===!1&&((K=l[10])==null?void 0:K.currentId)&&Gs(l),H=(l[0]!==void 0||l[4].length>0||l[5])&&Js(l);function O(D){l[37](D)}function A(D){l[38](D)}let F={};l[2]!==void 0&&(F.prompt=l[2]),l[3]!==void 0&&(F.files=l[3]),a=new zf({props:F}),l[36](a),We.push(()=>$e(a,"prompt",O)),We.push(()=>$e(a,"files",A)),a.$on("upload",l[39]),a.$on("select",l[40]);const j=[Hf,Of],Y=[];function M(D,W){return D[14]?0:1}return g=M(l),w=Y[g]=j[g](l),{c(){e=V("div"),t=V("div"),n=V("div"),o=V("div"),I&&I.c(),s=$(),r=V("div"),H&&H.c(),i=$(),te(a.$$.fragment),f=$(),h=V("div"),d=V("div"),_=V("div"),b=V("input"),v=$(),w.c(),this.h()},l(D){e=N(D,"DIV",{class:!0});var W=S(e);t=N(W,"DIV",{class:!0});var L=S(t);n=N(L,"DIV",{class:!0});var R=S(n);o=N(R,"DIV",{class:!0});var X=S(o);I&&I.l(X),X.forEach(p),s=ee(R),r=N(R,"DIV",{class:!0});var Q=S(r);H&&H.l(Q),i=ee(Q),oe(a.$$.fragment,Q),Q.forEach(p),R.forEach(p),L.forEach(p),f=ee(W),h=N(W,"DIV",{class:!0});var G=S(h);d=N(G,"DIV",{class:!0});var ce=S(d);_=N(ce,"DIV",{class:!0});var se=S(_);b=N(se,"INPUT",{type:!0}),v=ee(se),w.l(se),se.forEach(p),ce.forEach(p),G.forEach(p),W.forEach(p),this.h()},h(){m(o,"class","relative"),m(r,"class","w-full relative"),m(n,"class","flex flex-col px-2.5 max-w-6xl w-full"),m(t,"class","-mb-0.5 mx-auto inset-x-0 bg-transparent flex justify-center"),m(b,"type","file"),b.hidden=!0,b.multiple=!0,m(_,"class",""),m(d,"class","max-w-6xl px-4 mx-auto inset-x-0"),m(h,"class",y=l[6]?"bg-transparent":"bg-white dark:bg-gray-900"),m(e,"class","w-full font-primary")},m(D,W){B(D,e,W),k(e,t),k(t,n),k(n,o),I&&I.m(o,null),k(n,s),k(n,r),H&&H.m(r,null),k(r,i),ne(a,r,null),k(e,f),k(e,h),k(h,d),k(d,_),k(_,b),l[41](b),k(_,v),Y[g].m(_,null),E=!0,z||(T=[ke(b,"change",l[42]),ke(b,"change",l[43])],z=!0)},p(D,W){var X;D[1]===!1&&((X=D[10])!=null&&X.currentId)?I?I.p(D,W):(I=Gs(D),I.c(),I.m(o,null)):I&&(I.d(1),I=null),D[0]!==void 0||D[4].length>0||D[5]?H?(H.p(D,W),W[0]&49&&C(H,1)):(H=Js(D),H.c(),C(H,1),H.m(r,i)):H&&(Ae(),P(H,1,1,()=>{H=null}),Le());const L={};!c&&W[0]&4&&(c=!0,L.prompt=D[2],xe(()=>c=!1)),!u&&W[0]&8&&(u=!0,L.files=D[3],xe(()=>u=!1)),a.$set(L);let R=g;g=M(D),g===R?Y[g].p(D,W):(Ae(),P(Y[R],1,1,()=>{Y[R]=null}),Le(),w=Y[g],w?w.p(D,W):(w=Y[g]=j[g](D),w.c()),C(w,1),w.m(_,null)),(!E||W[0]&64&&y!==(y=D[6]?"bg-transparent":"bg-white dark:bg-gray-900"))&&m(h,"class",y)},i(D){E||(C(H),C(a.$$.fragment,D),C(w),E=!0)},o(D){P(H),P(a.$$.fragment,D),P(w),E=!1},d(D){D&&p(e),I&&I.d(),H&&H.d(),l[36](null),le(a),l[41](null),Y[g].d(),z=!1,ln(T)}}}function Gs(l){let e,t,n='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5"><path fill-rule="evenodd" d="M10 3a.75.75 0 01.75.75v10.638l3.96-4.158a.75.75 0 111.08 1.04l-5.25 5.5a.75.75 0 01-1.08 0l-5.25-5.5a.75.75 0 111.08-1.04l3.96 4.158V3.75A.75.75 0 0110 3z" clip-rule="evenodd"></path></svg>',o,s;return{c(){e=V("div"),t=V("button"),t.innerHTML=n,this.h()},l(r){e=N(r,"DIV",{class:!0});var i=S(e);t=N(i,"BUTTON",{class:!0,"data-svelte-h":!0}),gt(t)!=="svelte-h8r9o0"&&(t.innerHTML=n),i.forEach(p),this.h()},h(){m(t,"class","bg-white border border-gray-100 dark:border-none dark:bg-white/20 p-1.5 rounded-full pointer-events-auto"),m(e,"class","absolute -top-12 left-0 right-0 flex justify-center z-30 pointer-events-none")},m(r,i){B(r,e,i),k(e,t),o||(s=ke(t,"click",l[32]),o=!0)},p:we,d(r){r&&p(e),o=!1,s()}}}function Js(l){let e,t,n,o,s=l[4].length>0&&Qs(l),r=l[5]&&er(l),i=l[0]!==void 0&&tr(l);return{c(){e=V("div"),s&&s.c(),t=$(),r&&r.c(),n=$(),i&&i.c(),this.h()},l(a){e=N(a,"DIV",{class:!0});var c=S(e);s&&s.l(c),t=ee(c),r&&r.l(c),n=ee(c),i&&i.l(c),c.forEach(p),this.h()},h(){m(e,"class","px-4 pb-0.5 pt-1.5 text-left w-full flex flex-col absolute bottom-0 left-0 right-0 bg-gradient-to-t from-white dark:from-gray-900 z-10")},m(a,c){B(a,e,c),s&&s.m(e,null),k(e,t),r&&r.m(e,null),k(e,n),i&&i.m(e,null),o=!0},p(a,c){a[4].length>0?s?(s.p(a,c),c[0]&16&&C(s,1)):(s=Qs(a),s.c(),C(s,1),s.m(e,t)):s&&(Ae(),P(s,1,1,()=>{s=null}),Le()),a[5]?r?r.p(a,c):(r=er(a),r.c(),r.m(e,n)):r&&(r.d(1),r=null),a[0]!==void 0?i?(i.p(a,c),c[0]&1&&C(i,1)):(i=tr(a),i.c(),C(i,1),i.m(e,null)):i&&(Ae(),P(i,1,1,()=>{i=null}),Le())},i(a){o||(C(s),C(i),o=!0)},o(a){P(s),P(i),o=!1},d(a){a&&p(e),s&&s.d(),r&&r.d(),i&&i.d()}}}function Qs(l){let e,t,n,o='<span class="relative flex size-2"><span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-yellow-400 opacity-75"></span> <span class="relative inline-flex rounded-full size-2 bg-yellow-500"></span></span>',s,r,i=[],a=new Map,c,u=wt(l[4].map(l[33]));const f=h=>h[82];for(let h=0;h<u.length;h+=1){let d=Ks(l,u,h),_=f(d);a.set(_,i[h]=$s(_,d))}return{c(){e=V("div"),t=V("div"),n=V("div"),n.innerHTML=o,s=$(),r=V("div");for(let h=0;h<i.length;h+=1)i[h].c();this.h()},l(h){e=N(h,"DIV",{class:!0});var d=S(e);t=N(d,"DIV",{class:!0});var _=S(t);n=N(_,"DIV",{class:!0,"data-svelte-h":!0}),gt(n)!=="svelte-1exsj7u"&&(n.innerHTML=o),s=ee(_),r=N(_,"DIV",{class:!0});var b=S(r);for(let v=0;v<i.length;v+=1)i[v].l(b);b.forEach(p),_.forEach(p),d.forEach(p),this.h()},h(){m(n,"class","pl-1"),m(r,"class","translate-y-[0.5px] text-ellipsis line-clamp-1 flex"),m(t,"class","flex items-center gap-2.5 text-sm dark:text-gray-500"),m(e,"class","flex items-center justify-between w-full")},m(h,d){B(h,e,d),k(e,t),k(t,n),k(t,s),k(t,r);for(let _=0;_<i.length;_+=1)i[_]&&i[_].m(r,null);c=!0},p(h,d){d[0]&16777232&&(u=wt(h[4].map(h[33])),Ae(),i=So(i,d,f,1,h,u,a,r,Do,$s,null,Ks),Le())},i(h){if(!c){for(let d=0;d<u.length;d+=1)C(i[d]);c=!0}},o(h){for(let d=0;d<i.length;d+=1)P(i[d]);c=!1},d(h){h&&p(e);for(let d=0;d<i.length;d+=1)i[d].d()}}}function Pf(l){let e=l[80].name+"",t;return{c(){t=Ce(e)},l(n){t=Me(n,e)},m(n,o){B(n,t,o)},p(n,o){o[0]&16777232&&e!==(e=n[80].name+"")&&He(t,e)},d(n){n&&p(t)}}}function xs(l){let e,t=", ";return{c(){e=V("span"),e.textContent=t},l(n){e=N(n,"SPAN",{"data-svelte-h":!0}),gt(e)!=="svelte-1okzske"&&(e.textContent=t)},m(n,o){B(n,e,o)},d(n){n&&p(e)}}}function $s(l,e){var a,c;let t,n,o,s,r;n=new Gt({props:{content:((c=(a=e[80])==null?void 0:a.meta)==null?void 0:c.description)??"",className:" "+(e[82]!==0?"pl-0.5":"")+" flex-shrink-0",placement:"top",$$slots:{default:[Pf]},$$scope:{ctx:e}}});let i=e[82]!==e[4].length-1&&xs();return{key:l,first:null,c(){t=Oe(),te(n.$$.fragment),o=$(),i&&i.c(),s=Oe(),this.h()},l(u){t=Oe(),oe(n.$$.fragment,u),o=ee(u),i&&i.l(u),s=Oe(),this.h()},h(){this.first=t},m(u,f){B(u,t,f),ne(n,u,f),B(u,o,f),i&&i.m(u,f),B(u,s,f),r=!0},p(u,f){var d,_;e=u;const h={};f[0]&16777232&&(h.content=((_=(d=e[80])==null?void 0:d.meta)==null?void 0:_.description)??""),f[0]&16777232&&(h.className=" "+(e[82]!==0?"pl-0.5":"")+" flex-shrink-0"),f[0]&16777232|f[2]&2097152&&(h.$$scope={dirty:f,ctx:e}),n.$set(h),e[82]!==e[4].length-1?i||(i=xs(),i.c(),i.m(s.parentNode,s)):i&&(i.d(1),i=null)},i(u){r||(C(n.$$.fragment,u),r=!0)},o(u){P(n.$$.fragment,u),r=!1},d(u){u&&(p(t),p(o),p(s)),le(n,u),i&&i.d(u)}}}function er(l){let e,t,n,o='<span class="relative flex size-2"><span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"></span> <span class="relative inline-flex rounded-full size-2 bg-green-500"></span></span>',s,r,i=l[22].t("Search the web")+"",a;return{c(){e=V("div"),t=V("div"),n=V("div"),n.innerHTML=o,s=$(),r=V("div"),a=Ce(i),this.h()},l(c){e=N(c,"DIV",{class:!0});var u=S(e);t=N(u,"DIV",{class:!0});var f=S(t);n=N(f,"DIV",{class:!0,"data-svelte-h":!0}),gt(n)!=="svelte-12j611w"&&(n.innerHTML=o),s=ee(f),r=N(f,"DIV",{class:!0});var h=S(r);a=Me(h,i),h.forEach(p),f.forEach(p),u.forEach(p),this.h()},h(){m(n,"class","pl-1"),m(r,"class","translate-y-[0.5px]"),m(t,"class","flex items-center gap-2.5 text-sm dark:text-gray-500"),m(e,"class","flex items-center justify-between w-full")},m(c,u){B(c,e,u),k(e,t),k(t,n),k(t,s),k(t,r),k(r,a)},p(c,u){u[0]&4194304&&i!==(i=c[22].t("Search the web")+"")&&He(a,i)},d(c){c&&p(e)}}}function tr(l){let e,t,n,o,s,r,i,a,c=l[0].name+"",u,f,h,d,_,b,v,g;return _=new No({}),{c(){e=V("div"),t=V("div"),n=V("img"),s=$(),r=V("div"),i=Ce("Talking to "),a=V("span"),u=Ce(c),f=$(),h=V("div"),d=V("button"),te(_.$$.fragment),this.h()},l(w){e=N(w,"DIV",{class:!0});var y=S(e);t=N(y,"DIV",{class:!0});var E=S(t);n=N(E,"IMG",{crossorigin:!0,alt:!0,class:!0,src:!0}),s=ee(E),r=N(E,"DIV",{class:!0});var z=S(r);i=Me(z,"Talking to "),a=N(z,"SPAN",{class:!0});var T=S(a);u=Me(T,c),T.forEach(p),z.forEach(p),E.forEach(p),f=ee(y),h=N(y,"DIV",{});var I=S(h);d=N(I,"BUTTON",{class:!0});var H=S(d);oe(_.$$.fragment,H),H.forEach(p),I.forEach(p),y.forEach(p),this.h()},h(){var w,y,E;m(n,"crossorigin","anonymous"),m(n,"alt","model profile"),m(n,"class","size-3.5 max-w-[28px] object-cover rounded-full"),Hn(n.src,o=((E=(y=(w=l[12].find(l[34]))==null?void 0:w.info)==null?void 0:y.meta)==null?void 0:E.profile_image_url)??(l[22].language==="dg-DG"?"/doge.png":`${bl}/static/favicon.png`))||m(n,"src",o),m(a,"class","font-medium"),m(r,"class","translate-y-[0.5px]"),m(t,"class","pl-[1px] flex items-center gap-2 text-sm dark:text-gray-500"),m(d,"class","flex items-center dark:text-gray-500"),m(e,"class","flex items-center justify-between w-full")},m(w,y){B(w,e,y),k(e,t),k(t,n),k(t,s),k(t,r),k(r,i),k(r,a),k(a,u),k(e,f),k(e,h),k(h,d),ne(_,d,null),b=!0,v||(g=ke(d,"click",l[35]),v=!0)},p(w,y){var E,z,T;(!b||y[0]&4198401&&!Hn(n.src,o=((T=(z=(E=w[12].find(w[34]))==null?void 0:E.info)==null?void 0:z.meta)==null?void 0:T.profile_image_url)??(w[22].language==="dg-DG"?"/doge.png":`${bl}/static/favicon.png`)))&&m(n,"src",o),(!b||y[0]&1)&&c!==(c=w[0].name+"")&&He(u,c)},i(w){b||(C(_.$$.fragment,w),b=!0)},o(w){P(_.$$.fragment,w),b=!1},d(w){w&&p(e),le(_),v=!1,g()}}}function Of(l){var W,L;let e,t,n,o,s,r,i,a,c,u,f,h,d,_,b,v,g,w,y,E,z,T=l[3].length>0&&nr(l);function I(R){l[53](R)}function H(R){l[54](R)}let O={uploadFilesHandler:l[51],onClose:l[52],$$slots:{default:[Rf]},$$scope:{ctx:l}};l[5]!==void 0&&(O.webSearchEnabled=l[5]),l[4]!==void 0&&(O.selectedToolIds=l[4]),r=new $u({props:O}),We.push(()=>$e(r,"webSearchEnabled",I)),We.push(()=>$e(r,"selectedToolIds",H));const A=[Wf,Uf],F=[];function j(R,X){var Q;return((Q=R[25])==null?void 0:Q.richTextInput)??!0?0:1}u=j(l),f=F[u]=A[u](l);let Y=(!((W=l[10])!=null&&W.currentId)||((L=l[10].messages[l[10].currentId])==null?void 0:L.done)==!0)&&sr(l);const M=[Yf,Ff],K=[];function D(R,X){var Q;return!R[10].currentId||((Q=R[10].messages[R[10].currentId])==null?void 0:Q.done)==!0?0:1}return g=D(l),w=K[g]=M[g](l),{c(){e=V("form"),t=V("div"),T&&T.c(),n=$(),o=V("div"),s=V("div"),te(r.$$.fragment),c=$(),f.c(),h=$(),d=V("div"),Y&&Y.c(),b=$(),v=V("div"),w.c(),this.h()},l(R){e=N(R,"FORM",{class:!0});var X=S(e);t=N(X,"DIV",{class:!0,dir:!0});var Q=S(t);T&&T.l(Q),n=ee(Q),o=N(Q,"DIV",{class:!0});var G=S(o);s=N(G,"DIV",{class:!0});var ce=S(s);oe(r.$$.fragment,ce),ce.forEach(p),c=ee(G),f.l(G),h=ee(G),d=N(G,"DIV",{class:!0});var se=S(d);Y&&Y.l(se),se.forEach(p),G.forEach(p),Q.forEach(p),b=ee(X),v=N(X,"DIV",{class:!0});var ye=S(v);w.l(ye),ye.forEach(p),X.forEach(p),this.h()},h(){var R;m(s,"class","ml-0.5 self-end mb-1.5 flex space-x-1"),m(d,"class","self-end mb-2 flex space-x-1 mr-1"),m(o,"class","flex"),m(t,"class","flex-1 flex flex-col relative w-full rounded-3xl px-1.5 bg-gray-50 dark:bg-gray-850 dark:text-gray-100"),m(t,"dir",_=((R=l[25])==null?void 0:R.chatDirection)??"LTR"),m(v,"class","flex items-end w-10"),m(e,"class","w-full flex gap-1.5")},m(R,X){B(R,e,X),k(e,t),T&&T.m(t,null),k(t,n),k(t,o),k(o,s),ne(r,s,null),k(o,c),F[u].m(o,null),k(o,h),k(o,d),Y&&Y.m(d,null),k(e,b),k(e,v),K[g].m(v,null),y=!0,E||(z=ke(e,"submit",Ai(l[70])),E=!0)},p(R,X){var se,ye,Se;R[3].length>0?T?(T.p(R,X),X[0]&8&&C(T,1)):(T=nr(R),T.c(),C(T,1),T.m(t,n)):T&&(Ae(),P(T,1,1,()=>{T=null}),Le());const Q={};X[0]&65536&&(Q.uploadFilesHandler=R[51]),X[2]&2097152&&(Q.$$scope={dirty:X,ctx:R}),!i&&X[0]&32&&(i=!0,Q.webSearchEnabled=R[5],xe(()=>i=!1)),!a&&X[0]&16&&(a=!0,Q.selectedToolIds=R[4],xe(()=>a=!1)),r.$set(Q);let G=u;u=j(R),u===G?F[u].p(R,X):(Ae(),P(F[G],1,1,()=>{F[G]=null}),Le(),f=F[u],f?f.p(R,X):(f=F[u]=A[u](R),f.c()),C(f,1),f.m(o,h)),!((se=R[10])!=null&&se.currentId)||((ye=R[10].messages[R[10].currentId])==null?void 0:ye.done)==!0?Y?(Y.p(R,X),X[0]&1024&&C(Y,1)):(Y=sr(R),Y.c(),C(Y,1),Y.m(d,null)):Y&&(Ae(),P(Y,1,1,()=>{Y=null}),Le()),(!y||X[0]&33554432&&_!==(_=((Se=R[25])==null?void 0:Se.chatDirection)??"LTR"))&&m(t,"dir",_);let ce=g;g=D(R),g===ce?K[g].p(R,X):(Ae(),P(K[ce],1,1,()=>{K[ce]=null}),Le(),w=K[g],w?w.p(R,X):(w=K[g]=M[g](R),w.c()),C(w,1),w.m(v,null))},i(R){y||(C(T),C(r.$$.fragment,R),C(f),C(Y),C(w),y=!0)},o(R){P(T),P(r.$$.fragment,R),P(f),P(Y),P(w),y=!1},d(R){R&&p(e),T&&T.d(),le(r),F[u].d(),Y&&Y.d(),K[g].d(),E=!1,z()}}}function Hf(l){let e,t,n;function o(r){l[44](r)}let s={};return l[14]!==void 0&&(s.recording=l[14]),e=new qc({props:s}),We.push(()=>$e(e,"recording",o)),e.$on("cancel",l[45]),e.$on("confirm",l[46]),{c(){te(e.$$.fragment)},l(r){oe(e.$$.fragment,r)},m(r,i){ne(e,r,i),n=!0},p(r,i){const a={};!t&&i[0]&16384&&(t=!0,a.recording=r[14],xe(()=>t=!1)),e.$set(a)},i(r){n||(C(e.$$.fragment,r),n=!0)},o(r){P(e.$$.fragment,r),n=!1},d(r){le(e,r)}}}function nr(l){let e,t,n=wt(l[3]),o=[];for(let r=0;r<n.length;r+=1)o[r]=or(Xs(l,n,r));const s=r=>P(o[r],1,1,()=>{o[r]=null});return{c(){e=V("div");for(let r=0;r<o.length;r+=1)o[r].c();this.h()},l(r){e=N(r,"DIV",{class:!0});var i=S(e);for(let a=0;a<o.length;a+=1)o[a].l(i);i.forEach(p),this.h()},h(){m(e,"class","mx-1 mt-2.5 mb-1 flex flex-wrap gap-2")},m(r,i){B(r,e,i);for(let a=0;a<o.length;a+=1)o[a]&&o[a].m(e,null);t=!0},p(r,i){if(i[0]&6291977){n=wt(r[3]);let a;for(a=0;a<n.length;a+=1){const c=Xs(r,n,a);o[a]?(o[a].p(c,i),C(o[a],1)):(o[a]=or(c),o[a].c(),C(o[a],1),o[a].m(e,null))}for(Ae(),a=n.length;a<o.length;a+=1)s(a);Le()}},i(r){if(!t){for(let i=0;i<n.length;i+=1)C(o[i]);t=!0}},o(r){o=o.filter(Boolean);for(let i=0;i<o.length;i+=1)P(o[i]);t=!1},d(r){r&&p(e),Cn(o,r)}}}function Bf(l){var s;let e,t;function n(){return l[49](l[79])}function o(){return l[50](l[77])}return e=new Gi({props:{item:l[77],name:l[77].name,type:l[77].type,size:(s=l[77])==null?void 0:s.size,loading:l[77].status==="uploading",dismissible:!0,edit:!0}}),e.$on("dismiss",n),e.$on("click",o),{c(){te(e.$$.fragment)},l(r){oe(e.$$.fragment,r)},m(r,i){ne(e,r,i),t=!0},p(r,i){var c;l=r;const a={};i[0]&8&&(a.item=l[77]),i[0]&8&&(a.name=l[77].name),i[0]&8&&(a.type=l[77].type),i[0]&8&&(a.size=(c=l[77])==null?void 0:c.size),i[0]&8&&(a.loading=l[77].status==="uploading"),e.$set(a)},i(r){t||(C(e.$$.fragment,r),t=!0)},o(r){P(e.$$.fragment,r),t=!1},d(r){le(e,r)}}}function Af(l){let e,t,n,o,s,r,i,a,c='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-4 h-4"><path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"></path></svg>',u,f,h,d,_=(l[0]?l[21].length===0:l[9].length!==l[21].length)&&lr(l);function b(){return l[48](l[79])}return{c(){e=V("div"),t=V("div"),n=V("img"),s=$(),_&&_.c(),r=$(),i=V("div"),a=V("button"),a.innerHTML=c,u=$(),this.h()},l(v){e=N(v,"DIV",{class:!0});var g=S(e);t=N(g,"DIV",{class:!0});var w=S(t);n=N(w,"IMG",{src:!0,alt:!0,class:!0}),s=ee(w),_&&_.l(w),w.forEach(p),r=ee(g),i=N(g,"DIV",{class:!0});var y=S(i);a=N(y,"BUTTON",{class:!0,type:!0,"data-svelte-h":!0}),gt(a)!=="svelte-1lyw8tj"&&(a.innerHTML=c),y.forEach(p),u=ee(g),g.forEach(p),this.h()},h(){Hn(n.src,o=l[77].url)||m(n,"src",o),m(n,"alt","input"),m(n,"class","h-16 w-16 rounded-xl object-cover"),m(t,"class","relative"),m(a,"class","bg-gray-400 text-white border border-white rounded-full group-hover:visible invisible transition"),m(a,"type","button"),m(i,"class","absolute -top-1 -right-1"),m(e,"class","relative group")},m(v,g){B(v,e,g),k(e,t),k(t,n),k(t,s),_&&_.m(t,null),k(e,r),k(e,i),k(i,a),k(e,u),f=!0,h||(d=ke(a,"click",b),h=!0)},p(v,g){l=v,(!f||g[0]&8&&!Hn(n.src,o=l[77].url))&&m(n,"src",o),(l[0]?l[21].length===0:l[9].length!==l[21].length)?_?(_.p(l,g),g[0]&2097665&&C(_,1)):(_=lr(l),_.c(),C(_,1),_.m(t,null)):_&&(Ae(),P(_,1,1,()=>{_=null}),Le())},i(v){f||(C(_),f=!0)},o(v){P(_),f=!1},d(v){v&&p(e),_&&_.d(),h=!1,d()}}}function lr(l){let e,t;return e=new Gt({props:{className:" absolute top-1 left-1",content:l[22].t("{{ models }}",{models:[...l[0]?[l[0]]:l[9]].filter(l[47]).join(", ")}),$$slots:{default:[Lf]},$$scope:{ctx:l}}}),{c(){te(e.$$.fragment)},l(n){oe(e.$$.fragment,n)},m(n,o){ne(e,n,o),t=!0},p(n,o){const s={};o[0]&6291969&&(s.content=n[22].t("{{ models }}",{models:[...n[0]?[n[0]]:n[9]].filter(n[47]).join(", ")})),o[2]&2097152&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){le(e,n)}}}function Lf(l){let e,t;return{c(){e=ze("svg"),t=ze("path"),this.h()},l(n){e=Pe(n,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var o=S(e);t=Pe(o,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),S(t).forEach(p),o.forEach(p),this.h()},h(){m(t,"fill-rule","evenodd"),m(t,"d","M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003ZM12 8.25a.75.75 0 0 1 .75.75v3.75a.75.75 0 0 1-1.5 0V9a.75.75 0 0 1 .75-.75Zm0 8.25a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Z"),m(t,"clip-rule","evenodd"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"viewBox","0 0 24 24"),m(e,"fill","currentColor"),m(e,"class","size-4 fill-yellow-300")},m(n,o){B(n,e,o),k(e,t)},p:we,d(n){n&&p(e)}}}function or(l){let e,t,n,o;const s=[Af,Bf],r=[];function i(a,c){return a[77].type==="image"?0:1}return e=i(l),t=r[e]=s[e](l),{c(){t.c(),n=Oe()},l(a){t.l(a),n=Oe()},m(a,c){r[e].m(a,c),B(a,n,c),o=!0},p(a,c){let u=e;e=i(a),e===u?r[e].p(a,c):(Ae(),P(r[u],1,1,()=>{r[u]=null}),Le(),t=r[e],t?t.p(a,c):(t=r[e]=s[e](a),t.c()),C(t,1),t.m(n.parentNode,n))},i(a){o||(C(t),o=!0)},o(a){P(t),o=!1},d(a){a&&p(n),r[e].d(a)}}}function Rf(l){let e,t='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-5"><path d="M8.75 3.75a.75.75 0 0 0-1.5 0v3.5h-3.5a.75.75 0 0 0 0 1.5h3.5v3.5a.75.75 0 0 0 1.5 0v-3.5h3.5a.75.75 0 0 0 0-1.5h-3.5v-3.5Z"></path></svg>';return{c(){e=V("button"),e.innerHTML=t,this.h()},l(n){e=N(n,"BUTTON",{class:!0,type:!0,"aria-label":!0,"data-svelte-h":!0}),gt(e)!=="svelte-wrouii"&&(e.innerHTML=t),this.h()},h(){m(e,"class","bg-gray-50 hover:bg-gray-100 text-gray-800 dark:bg-gray-850 dark:text-white dark:hover:bg-gray-800 transition rounded-full p-2 outline-none focus:outline-none"),m(e,"type","button"),m(e,"aria-label","More")},m(n,o){B(n,e,o)},p:we,d(n){n&&p(e)}}}function Uf(l){let e,t,n,o;return{c(){e=V("textarea"),this.h()},l(s){e=N(s,"TEXTAREA",{id:!0,class:!0,placeholder:!0,rows:!0}),S(e).forEach(p),this.h()},h(){m(e,"id","chat-input"),m(e,"class","scrollbar-hidden bg-gray-50 dark:bg-gray-850 dark:text-gray-100 outline-none w-full py-3 px-1 rounded-xl resize-none h-[48px]"),m(e,"placeholder",t=l[11]?l[11]:l[22].t("Send a Message")),m(e,"rows","1")},m(s,r){B(s,e,r),l[60](e),Dn(e,l[2]),n||(o=[ke(e,"input",l[61]),ke(e,"keypress",l[62]),ke(e,"keydown",l[63]),ke(e,"input",l[64]),ke(e,"focus",l[65]),ke(e,"paste",l[66])],n=!0)},p(s,r){r[0]&4196352&&t!==(t=s[11]?s[11]:s[22].t("Send a Message"))&&m(e,"placeholder",t),r[0]&4&&Dn(e,s[2])},i:we,o:we,d(s){s&&p(e),l[60](null),n=!1,ln(o)}}}function Wf(l){var i;let e,t,n,o;function s(a){l[56](a)}let r={id:"chat-input",messageInput:!0,shiftEnter:!l[26]||!("ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0),placeholder:l[11]?l[11]:l[22].t("Send a Message"),largeTextAsFile:((i=l[25])==null?void 0:i.largeTextAsFile)??!1};return l[2]!==void 0&&(r.value=l[2]),t=new Gc({props:r}),l[55](t),We.push(()=>$e(t,"value",s)),t.$on("enter",l[57]),t.$on("keypress",Qf),t.$on("keydown",l[58]),t.$on("paste",l[59]),{c(){e=V("div"),te(t.$$.fragment),this.h()},l(a){e=N(a,"DIV",{class:!0});var c=S(e);oe(t.$$.fragment,c),c.forEach(p),this.h()},h(){m(e,"class","scrollbar-hidden text-left bg-gray-50 dark:bg-gray-850 dark:text-gray-100 outline-none w-full py-2.5 px-1 rounded-xl resize-none h-fit max-h-60 overflow-auto")},m(a,c){B(a,e,c),ne(t,e,null),o=!0},p(a,c){var f;const u={};c[0]&67108864&&(u.shiftEnter=!a[26]||!("ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0)),c[0]&4196352&&(u.placeholder=a[11]?a[11]:a[22].t("Send a Message")),c[0]&33554432&&(u.largeTextAsFile=((f=a[25])==null?void 0:f.largeTextAsFile)??!1),!n&&c[0]&4&&(n=!0,u.value=a[2],xe(()=>n=!1)),t.$set(u)},i(a){o||(C(t.$$.fragment,a),o=!0)},o(a){P(t.$$.fragment,a),o=!1},d(a){a&&p(e),l[55](null),le(t)}}}function sr(l){let e,t;return e=new Gt({props:{content:l[22].t("Record voice"),$$slots:{default:[jf]},$$scope:{ctx:l}}}),{c(){te(e.$$.fragment)},l(n){oe(e.$$.fragment,n)},m(n,o){ne(e,n,o),t=!0},p(n,o){const s={};o[0]&4194304&&(s.content=n[22].t("Record voice")),o[0]&4210688|o[2]&2097152&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){le(e,n)}}}function jf(l){let e,t='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5 translate-y-[0.5px]"><path d="M7 4a3 3 0 016 0v6a3 3 0 11-6 0V4z"></path><path d="M5.5 9.643a.75.75 0 00-1.5 0V10c0 3.06 2.29 5.585 5.25 5.954V17.5h-1.5a.75.75 0 000 1.5h4.5a.75.75 0 000-1.5h-1.5v-1.546A6.001 6.001 0 0016 10v-.357a.75.75 0 00-1.5 0V10a4.5 4.5 0 01-9 0v-.357z"></path></svg>',n,o;return{c(){e=V("button"),e.innerHTML=t,this.h()},l(s){e=N(s,"BUTTON",{id:!0,class:!0,type:!0,"aria-label":!0,"data-svelte-h":!0}),gt(e)!=="svelte-11uoyjv"&&(e.innerHTML=t),this.h()},h(){m(e,"id","voice-input-button"),m(e,"class","text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-850 transition rounded-full p-1.5 mr-0.5 self-center"),m(e,"type","button"),m(e,"aria-label","Voice Input")},m(s,r){B(s,e,r),n||(o=ke(e,"click",l[67]),n=!0)},p:we,d(s){s&&p(e),n=!1,o()}}}function Ff(l){let e,t,n;return t=new Gt({props:{content:l[22].t("Stop"),$$slots:{default:[Zf]},$$scope:{ctx:l}}}),{c(){e=V("div"),te(t.$$.fragment),this.h()},l(o){e=N(o,"DIV",{class:!0});var s=S(e);oe(t.$$.fragment,s),s.forEach(p),this.h()},h(){m(e,"class","flex items-center mb-1.5")},m(o,s){B(o,e,s),ne(t,e,null),n=!0},p(o,s){const r={};s[0]&4194304&&(r.content=o[22].t("Stop")),s[0]&256|s[2]&2097152&&(r.$$scope={dirty:s,ctx:o}),t.$set(r)},i(o){n||(C(t.$$.fragment,o),n=!0)},o(o){P(t.$$.fragment,o),n=!1},d(o){o&&p(e),le(t)}}}function Yf(l){let e,t,n,o;const s=[Kf,Xf],r=[];function i(a,c){return a[2]===""?0:1}return e=i(l),t=r[e]=s[e](l),{c(){t.c(),n=Oe()},l(a){t.l(a),n=Oe()},m(a,c){r[e].m(a,c),B(a,n,c),o=!0},p(a,c){let u=e;e=i(a),e===u?r[e].p(a,c):(Ae(),P(r[u],1,1,()=>{r[u]=null}),Le(),t=r[e],t?t.p(a,c):(t=r[e]=s[e](a),t.c()),C(t,1),t.m(n.parentNode,n))},i(a){o||(C(t),o=!0)},o(a){P(t),o=!1},d(a){a&&p(n),r[e].d(a)}}}function Zf(l){let e,t='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="size-6"><path fill-rule="evenodd" d="M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12zm6-2.438c0-.724.588-1.312 1.313-1.312h4.874c.725 0 1.313.588 1.313 1.313v4.874c0 .725-.588 1.313-1.313 1.313H9.564a1.312 1.312 0 01-1.313-1.313V9.564z" clip-rule="evenodd"></path></svg>',n,o;return{c(){e=V("button"),e.innerHTML=t,this.h()},l(s){e=N(s,"BUTTON",{class:!0,"data-svelte-h":!0}),gt(e)!=="svelte-n10htu"&&(e.innerHTML=t),this.h()},h(){m(e,"class","bg-white hover:bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-white dark:hover:bg-gray-800 transition rounded-full p-1.5")},m(s,r){B(s,e,r),n||(o=ke(e,"click",l[69]),n=!0)},p:we,d(s){s&&p(e),n=!1,o()}}}function Xf(l){let e,t,n;return t=new Gt({props:{content:l[22].t("Send message"),$$slots:{default:[qf]},$$scope:{ctx:l}}}),{c(){e=V("div"),te(t.$$.fragment),this.h()},l(o){e=N(o,"DIV",{class:!0});var s=S(e);oe(t.$$.fragment,s),s.forEach(p),this.h()},h(){m(e,"class","flex items-center mb-1")},m(o,s){B(o,e,s),ne(t,e,null),n=!0},p(o,s){const r={};s[0]&4194304&&(r.content=o[22].t("Send message")),s[0]&4|s[2]&2097152&&(r.$$scope={dirty:s,ctx:o}),t.$set(r)},i(o){n||(C(t.$$.fragment,o),n=!0)},o(o){P(t.$$.fragment,o),n=!1},d(o){o&&p(e),le(t)}}}function Kf(l){let e,t,n;return t=new Gt({props:{content:l[22].t("Call"),$$slots:{default:[Gf]},$$scope:{ctx:l}}}),{c(){e=V("div"),te(t.$$.fragment),this.h()},l(o){e=N(o,"DIV",{class:!0});var s=S(e);oe(t.$$.fragment,s),s.forEach(p),this.h()},h(){m(e,"class","flex items-center mb-1")},m(o,s){B(o,e,s),ne(t,e,null),n=!0},p(o,s){const r={};s[0]&4194304&&(r.content=o[22].t("Call")),s[0]&12583424|s[2]&2097152&&(r.$$scope={dirty:s,ctx:o}),t.$set(r)},i(o){n||(C(t.$$.fragment,o),n=!0)},o(o){P(t.$$.fragment,o),n=!1},d(o){o&&p(e),le(t)}}}function qf(l){let e,t,n,o,s;return{c(){e=V("button"),t=ze("svg"),n=ze("path"),this.h()},l(r){e=N(r,"BUTTON",{id:!0,class:!0,type:!0});var i=S(e);t=Pe(i,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var a=S(t);n=Pe(a,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),S(n).forEach(p),a.forEach(p),i.forEach(p),this.h()},h(){m(n,"fill-rule","evenodd"),m(n,"d","M8 14a.75.75 0 0 1-.75-.75V4.56L4.03 7.78a.75.75 0 0 1-1.06-1.06l4.5-4.5a.75.75 0 0 1 1.06 0l4.5 4.5a.75.75 0 0 1-1.06 1.06L8.75 4.56v8.69A.75.75 0 0 1 8 14Z"),m(n,"clip-rule","evenodd"),m(t,"xmlns","http://www.w3.org/2000/svg"),m(t,"viewBox","0 0 16 16"),m(t,"fill","currentColor"),m(t,"class","size-6"),m(e,"id","send-message-button"),m(e,"class",o=(l[2]!==""?"bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 ":"text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled")+" transition rounded-full p-1.5 m-0.5 self-center"),m(e,"type","submit"),e.disabled=s=l[2]===""},m(r,i){B(r,e,i),k(e,t),k(t,n)},p(r,i){i[0]&4&&o!==(o=(r[2]!==""?"bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 ":"text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled")+" transition rounded-full p-1.5 m-0.5 self-center")&&m(e,"class",o),i[0]&4&&s!==(s=r[2]==="")&&(e.disabled=s)},d(r){r&&p(e)}}}function Gf(l){let e,t,n,o,s;return t=new nf({props:{className:"size-6"}}),{c(){e=V("button"),te(t.$$.fragment),this.h()},l(r){e=N(r,"BUTTON",{class:!0,type:!0,"aria-label":!0});var i=S(e);oe(t.$$.fragment,i),i.forEach(p),this.h()},h(){m(e,"class","text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-850 transition rounded-full p-2 self-center"),m(e,"type","button"),m(e,"aria-label","Call")},m(r,i){B(r,e,i),ne(t,e,null),n=!0,o||(s=ke(e,"click",l[68]),o=!0)},p:we,i(r){n||(C(t.$$.fragment,r),n=!0)},o(r){P(t.$$.fragment,r),n=!1},d(r){r&&p(e),le(t),o=!1,s()}}}function Jf(l){let e,t,n,o;e=new sf({props:{show:l[19]}});let s=l[13]&&qs(l);return{c(){te(e.$$.fragment),t=$(),s&&s.c(),n=Oe()},l(r){oe(e.$$.fragment,r),t=ee(r),s&&s.l(r),n=Oe()},m(r,i){ne(e,r,i),B(r,t,i),s&&s.m(r,i),B(r,n,i),o=!0},p(r,i){const a={};i[0]&524288&&(a.show=r[19]),e.$set(a),r[13]?s?(s.p(r,i),i[0]&8192&&C(s,1)):(s=qs(r),s.c(),C(s,1),s.m(n.parentNode,n)):s&&(Ae(),P(s,1,1,()=>{s=null}),Le())},i(r){o||(C(e.$$.fragment,r),C(s),o=!0)},o(r){P(e.$$.fragment,r),P(s),o=!1},d(r){r&&(p(t),p(n)),le(e,r),s&&s.d(r)}}}const Qf=l=>{l=l.detail.event};function xf(l,e,t){let n,o,s,r,i,a,c;ie(l,ql,Z=>t(23,o=Z)),ie(l,al,Z=>t(71,s=Z)),ie(l,yl,Z=>t(12,r=Z)),ie(l,vl,Z=>t(24,i=Z)),ie(l,Gn,Z=>t(25,a=Z)),ie(l,Co,Z=>t(26,c=Z));const u=on(),f=Ut("i18n");ie(l,f,Z=>t(22,n=Z));let{transparentBackground:h=!1}=e,{createMessagePair:d}=e,{stopResponse:_}=e,{autoScroll:b=!1}=e,{atSelectedModel:v}=e,{selectedModels:g}=e,{history:w}=e,{prompt:y=""}=e,{files:E=[]}=e,{selectedToolIds:z=[]}=e,{webSearchEnabled:T=!1}=e,I=!1,H=!1,O,A,F,j,Y=!1,M=null,{placeholder:K=""}=e,D=[];const W=()=>{const Z=document.getElementById("messages-container");Z.scrollTo({top:Z.scrollHeight,behavior:"smooth"})},L=async(Z,Fe=!1)=>{var Qe,et,jt;if((s==null?void 0:s.role)!=="admin"&&!(((et=(Qe=s==null?void 0:s.permissions)==null?void 0:Qe.chat)==null?void 0:et.file_upload)??!0))return nt.error(n.t("You do not have permission to upload files.")),null;console.log(Z);const Ke=Cl(),Ze={type:"file",file:"",id:null,url:"",name:Z.name,collection_name:"",status:"uploading",size:Z.size,error:"",itemId:Ke,...Fe?{context:"full"}:{}};if(Ze.size==0)return nt.error(n.t("You cannot upload an empty file.")),null;if(t(3,E=[...E,Ze]),["audio/mpeg","audio/wav","audio/ogg","audio/x-m4a"].includes(Z.type)){const Et=await Ki(localStorage.token,Z).catch(Ft=>(nt.error(Ft),null));if(Et){console.log(Et);const Ft=new Blob([Et.text],{type:"text/plain"});Z=Xi(Ft,`${Z.name}.txt`),Ze.name=Z.name,Ze.size=Z.size}}try{const Et=await Fc(localStorage.token,Z);Et?(Et.error&&nt.warning(Et.error),Ze.status="uploaded",Ze.file=Et,Ze.id=Et.id,Ze.collection_name=(jt=Et==null?void 0:Et.meta)==null?void 0:jt.collection_name,Ze.url=`${sc}/files/${Et.id}`,t(3,E)):t(3,E=E.filter(Ft=>(Ft==null?void 0:Ft.itemId)!==Ke))}catch(Et){nt.error(Et),t(3,E=E.filter(Ft=>(Ft==null?void 0:Ft.itemId)!==Ke))}},R=async Z=>{Z.forEach(Fe=>{var Ke,Ze,Qe;if(console.log(Fe,Fe.name.split(".").at(-1)),(((Ke=o==null?void 0:o.file)==null?void 0:Ke.max_size)??null)!==null&&Fe.size>(((Ze=o==null?void 0:o.file)==null?void 0:Ze.max_size)??0)*1024*1024){nt.error(n.t("File size should not exceed {{maxSize}} MB.",{maxSize:(Qe=o==null?void 0:o.file)==null?void 0:Qe.max_size}));return}if(["image/gif","image/webp","image/jpeg","image/png"].includes(Fe.type)){if(D.length===0){nt.error(n.t("Selected model(s) do not support image inputs"));return}let et=new FileReader;et.onload=jt=>{t(3,E=[...E,{type:"image",url:`${jt.target.result}`}])},et.readAsDataURL(Fe)}else L(Fe)})},X=Z=>{Z.key==="Escape"&&(console.log("Escape"),t(19,Y=!1))},Q=Z=>{var Fe,Ke;Z.preventDefault(),(Ke=(Fe=Z.dataTransfer)==null?void 0:Fe.types)!=null&&Ke.includes("Files")?t(19,Y=!0):t(19,Y=!1)},G=()=>{t(19,Y=!1)},ce=async Z=>{var Fe,Ke;if(Z.preventDefault(),console.log(Z),(Fe=Z.dataTransfer)!=null&&Fe.files){const Ze=Array.from((Ke=Z.dataTransfer)==null?void 0:Ke.files);Ze&&Ze.length>0&&(console.log(Ze),R(Ze))}t(19,Y=!1)};hn(async()=>{t(13,I=!0),window.setTimeout(()=>{const Fe=document.getElementById("chat-input");Fe==null||Fe.focus()},0),window.addEventListener("keydown",X),await qe();const Z=document.getElementById("chat-container");Z==null||Z.addEventListener("dragover",Q),Z==null||Z.addEventListener("drop",ce),Z==null||Z.addEventListener("dragleave",G)}),il(()=>{console.log("destroy"),window.removeEventListener("keydown",X);const Z=document.getElementById("chat-container");Z&&(Z==null||Z.removeEventListener("dragover",Q),Z==null||Z.removeEventListener("drop",ce),Z==null||Z.removeEventListener("dragleave",G))});const se=()=>{t(1,b=!0),W()},ye=Z=>i?i.find(Fe=>Fe.id===Z):{id:Z,name:Z},Se=Z=>Z.id===v.id,re=()=>{t(0,v=void 0)};function q(Z){We[Z?"unshift":"push"](()=>{F=Z,t(17,F)})}function Ee(Z){y=Z,t(2,y)}function ae(Z){E=Z,t(3,E)}const Ie=Z=>{u("upload",Z.detail)},ge=Z=>{const Fe=Z.detail;(Fe==null?void 0:Fe.type)==="model"&&t(0,v=Fe.data);const Ke=document.getElementById("chat-input");Ke==null||Ke.focus()};function _t(Z){We[Z?"unshift":"push"](()=>{A=Z,t(16,A)})}function me(){j=this.files,t(18,j)}const ct=async()=>{if(j&&j.length>0){const Z=Array.from(j);R(Z)}else nt.error(n.t("File not found."));t(16,A.value="",A)};function ut(Z){H=Z,t(14,H)}const Wt=async()=>{var Z;t(14,H=!1),await qe(),(Z=document.getElementById("chat-input"))==null||Z.focus()},ve=async Z=>{var Ze;const{text:Fe,filename:Ke}=Z.detail;t(2,y=`${y}${Fe} `),t(14,H=!1),await qe(),(Ze=document.getElementById("chat-input"))==null||Ze.focus(),((a==null?void 0:a.speechAutoSend)??!1)&&u("submit",y)},Ue=Z=>!D.includes(Z),st=Z=>{E.splice(Z,1),t(3,E)},yt=Z=>{E.splice(Z,1),t(3,E)},ft=Z=>{console.log(Z)},rt=()=>{A.click()},At=async()=>{await qe();const Z=document.getElementById("chat-input");Z==null||Z.focus()};function _e(Z){T=Z,t(5,T)}function St(Z){z=Z,t(4,z)}function pt(Z){We[Z?"unshift":"push"](()=>{O=Z,t(15,O)})}function ht(Z){y=Z,t(2,y)}const be=async Z=>{if(document.getElementById("commands-container")){Z.preventDefault();const Ke=[...document.getElementsByClassName("selected-command-option-button")].at(-1);if(Ke){Ke==null||Ke.click();return}}y!==""&&u("submit",y)},Vt=async Z=>{Z=Z.detail.event;const Fe=Z.ctrlKey||Z.metaKey,Ke=document.getElementById("commands-container");if(Fe&&Z.key==="Enter"&&Z.shiftKey&&(Z.preventDefault(),d(y)),y===""&&Fe&&Z.key.toLowerCase()==="r"){Z.preventDefault(),console.log("regenerate");const Ze=[...document.getElementsByClassName("regenerate-response-button")].at(-1);Ze==null||Ze.click()}if(y===""&&Z.key=="ArrowUp"){Z.preventDefault();const Ze=[...document.getElementsByClassName("user-message")].at(-1),Qe=[...document.getElementsByClassName("edit-user-message-button")].at(-1);console.log(Ze),Ze.scrollIntoView({block:"center"}),Qe==null||Qe.click()}if(Ke&&Z.key==="ArrowUp"&&(Z.preventDefault(),F.selectUp(),[...document.getElementsByClassName("selected-command-option-button")].at(-1).scrollIntoView({block:"center"})),Ke&&Z.key==="ArrowDown"&&(Z.preventDefault(),F.selectDown(),[...document.getElementsByClassName("selected-command-option-button")].at(-1).scrollIntoView({block:"center"})),Ke&&Z.key==="Tab"){Z.preventDefault();const Ze=[...document.getElementsByClassName("selected-command-option-button")].at(-1);Ze==null||Ze.click()}Z.key==="Escape"&&(console.log("Escape"),t(0,v=void 0),t(4,z=[]),t(5,T=!1))},ue=async Z=>{Z=Z.detail.event,console.log(Z);const Fe=Z.clipboardData||window.clipboardData;if(Fe&&Fe.items){for(const Ke of Fe.items)if(Ke.type.indexOf("image")!==-1){const Ze=Ke.getAsFile(),Qe=new FileReader;Qe.onload=function(et){t(3,E=[...E,{type:"image",url:`${et.target.result}`}])},Qe.readAsDataURL(Ze)}else if(Ke.type==="text/plain"&&((a==null?void 0:a.largeTextAsFile)??!1)){const Ze=Fe.getData("text/plain");if(Ze.length>ms){Z.preventDefault();const Qe=new Blob([Ze],{type:"text/plain"}),et=new File([Qe],`Pasted_Text_${Date.now()}.txt`,{type:"text/plain"});await L(et,!0)}}}};function Re(Z){We[Z?"unshift":"push"](()=>{O=Z,t(15,O)})}function je(){y=this.value,t(2,y)}const Ge=Z=>{(!c||!("ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0))&&(Z.key==="Enter"&&!Z.shiftKey&&Z.preventDefault(),y!==""&&Z.key==="Enter"&&!Z.shiftKey&&u("submit",y))},kt=async Z=>{var Ze;const Fe=Z.ctrlKey||Z.metaKey,Ke=document.getElementById("commands-container");if(Fe&&Z.key==="Enter"&&Z.shiftKey&&(Z.preventDefault(),d(y)),y===""&&Fe&&Z.key.toLowerCase()==="r"){Z.preventDefault(),console.log("regenerate");const Qe=[...document.getElementsByClassName("regenerate-response-button")].at(-1);Qe==null||Qe.click()}if(y===""&&Z.key=="ArrowUp"){Z.preventDefault();const Qe=[...document.getElementsByClassName("user-message")].at(-1),et=[...document.getElementsByClassName("edit-user-message-button")].at(-1);console.log(Qe),Qe.scrollIntoView({block:"center"}),et==null||et.click()}if(Ke&&Z.key==="ArrowUp"&&(Z.preventDefault(),F.selectUp(),[...document.getElementsByClassName("selected-command-option-button")].at(-1).scrollIntoView({block:"center"})),Ke&&Z.key==="ArrowDown"&&(Z.preventDefault(),F.selectDown(),[...document.getElementsByClassName("selected-command-option-button")].at(-1).scrollIntoView({block:"center"})),Ke&&Z.key==="Enter"){Z.preventDefault();const Qe=[...document.getElementsByClassName("selected-command-option-button")].at(-1);Z.shiftKey?t(2,y=`${y}
`):Qe?Qe==null||Qe.click():(Ze=document.getElementById("send-message-button"))==null||Ze.click()}if(Ke&&Z.key==="Tab"){Z.preventDefault();const Qe=[...document.getElementsByClassName("selected-command-option-button")].at(-1);Qe==null||Qe.click()}else if(Z.key==="Tab"){const Qe=_c(y);if(Qe.length>0){const et=Qe.at(0),jt=y;t(2,y=y.substring(0,(et==null?void 0:et.endIndex)+1)),await qe(),Z.target.scrollTop=Z.target.scrollHeight,t(2,y=jt),await qe(),Z.preventDefault(),Z.target.setSelectionRange(et==null?void 0:et.startIndex,et.endIndex+1)}Z.target.style.height="",Z.target.style.height=Math.min(Z.target.scrollHeight,200)+"px"}Z.key==="Escape"&&(console.log("Escape"),t(0,v=void 0),t(4,z=[]),t(5,T=!1))},Dt=async Z=>{Z.target.style.height="",Z.target.style.height=Math.min(Z.target.scrollHeight,200)+"px",t(20,M=null)},Ct=async Z=>{Z.target.style.height="",Z.target.style.height=Math.min(Z.target.scrollHeight,200)+"px"},Nt=async Z=>{const Fe=Z.clipboardData||window.clipboardData;if(Fe&&Fe.items){for(const Ke of Fe.items)if(Ke.type.indexOf("image")!==-1){const Ze=Ke.getAsFile(),Qe=new FileReader;Qe.onload=function(et){t(3,E=[...E,{type:"image",url:`${et.target.result}`}])},Qe.readAsDataURL(Ze)}else if(Ke.type==="text/plain"&&((a==null?void 0:a.largeTextAsFile)??!1)){const Ze=Fe.getData("text/plain");if(Ze.length>ms){Z.preventDefault();const Qe=new Blob([Ze],{type:"text/plain"}),et=new File([Qe],`Pasted_Text_${Date.now()}.txt`,{type:"text/plain"});await L(et,!0)}}}},Ht=async()=>{try{let Z=await navigator.mediaDevices.getUserMedia({audio:!0}).catch(function(Fe){return nt.error(n.t("Permission denied when accessing microphone: {{error}}",{error:Fe})),null});Z&&(t(14,H=!0),Z.getTracks().forEach(Ke=>Ke.stop())),Z=null}catch{nt.error(n.t("Permission denied when accessing microphone"))}},zt=async()=>{if(g.length>1){nt.error(n.t("Select only one model to call"));return}if(o.audio.stt.engine==="web"){nt.error(n.t("Call feature is not supported when using Web STT engine"));return}try{let Z=await navigator.mediaDevices.getUserMedia({audio:!0});Z&&Z.getTracks().forEach(Ke=>Ke.stop()),Z=null,vn.set(!0),Rt.set(!0)}catch{nt.error(n.t("Permission denied when accessing media devices"))}},Jt=()=>{_()},Xt=()=>{u("submit",y)};return l.$$set=Z=>{"transparentBackground"in Z&&t(6,h=Z.transparentBackground),"createMessagePair"in Z&&t(7,d=Z.createMessagePair),"stopResponse"in Z&&t(8,_=Z.stopResponse),"autoScroll"in Z&&t(1,b=Z.autoScroll),"atSelectedModel"in Z&&t(0,v=Z.atSelectedModel),"selectedModels"in Z&&t(9,g=Z.selectedModels),"history"in Z&&t(10,w=Z.history),"prompt"in Z&&t(2,y=Z.prompt),"files"in Z&&t(3,E=Z.files),"selectedToolIds"in Z&&t(4,z=Z.selectedToolIds),"webSearchEnabled"in Z&&t(5,T=Z.webSearchEnabled),"placeholder"in Z&&t(11,K=Z.placeholder)},l.$$.update=()=>{l.$$.dirty[0]&4609&&t(21,D=[...v?[v]:g].filter(Z=>{var Fe,Ke,Ze,Qe;return((Qe=(Ze=(Ke=(Fe=r.find(et=>et.id===Z))==null?void 0:Fe.info)==null?void 0:Ke.meta)==null?void 0:Ze.capabilities)==null?void 0:Qe.vision)??!0}))},[v,b,y,E,z,T,h,d,_,g,w,K,r,I,H,O,A,F,j,Y,M,D,n,o,i,a,c,u,f,W,L,R,se,ye,Se,re,q,Ee,ae,Ie,ge,_t,me,ct,ut,Wt,ve,Ue,st,yt,ft,rt,At,_e,St,pt,ht,be,Vt,ue,Re,je,Ge,kt,Dt,Ct,Nt,Ht,zt,Jt,Xt]}class ea extends Ve{constructor(e){super(),Ne(this,e,xf,Jf,Be,{transparentBackground:6,createMessagePair:7,stopResponse:8,autoScroll:1,atSelectedModel:0,selectedModels:9,history:10,prompt:2,files:3,selectedToolIds:4,webSearchEnabled:5,placeholder:11},null,[-1,-1,-1])}}function rr(l,e,t){const n=l.slice();return n[12]=e[t],n[13]=e,n[14]=t,n}function $f(l){let e,t,n;return t=new Gt({props:{content:l[4].t("Remove Model"),$$slots:{default:[td]},$$scope:{ctx:l}}}),{c(){e=V("div"),te(t.$$.fragment),this.h()},l(o){e=N(o,"DIV",{class:!0});var s=S(e);oe(t.$$.fragment,s),s.forEach(p),this.h()},h(){m(e,"class","self-center mx-1 disabled:text-gray-600 disabled:hover:text-gray-600 -translate-y-[0.5px]")},m(o,s){B(o,e,s),ne(t,e,null),n=!0},p(o,s){const r={};s&16&&(r.content=o[4].t("Remove Model")),s&32771&&(r.$$scope={dirty:s,ctx:o}),t.$set(r)},i(o){n||(C(t.$$.fragment,o),n=!0)},o(o){P(t.$$.fragment,o),n=!1},d(o){o&&p(e),le(t)}}}function ed(l){let e,t,n;return t=new Gt({props:{content:l[4].t("Add Model"),$$slots:{default:[nd]},$$scope:{ctx:l}}}),{c(){e=V("div"),te(t.$$.fragment),this.h()},l(o){e=N(o,"DIV",{class:!0});var s=S(e);oe(t.$$.fragment,s),s.forEach(p),this.h()},h(){m(e,"class","self-center mx-1 disabled:text-gray-600 disabled:hover:text-gray-600 -translate-y-[0.5px]")},m(o,s){B(o,e,s),ne(t,e,null),n=!0},p(o,s){const r={};s&16&&(r.content=o[4].t("Add Model")),s&32771&&(r.$$scope={dirty:s,ctx:o}),t.$set(r)},i(o){n||(C(t.$$.fragment,o),n=!0)},o(o){P(t.$$.fragment,o),n=!1},d(o){o&&p(e),le(t)}}}function td(l){let e,t,n,o,s;function r(){return l[10](l[14])}return{c(){e=V("button"),t=ze("svg"),n=ze("path"),this.h()},l(i){e=N(i,"BUTTON",{"aria-label":!0});var a=S(e);t=Pe(a,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var c=S(t);n=Pe(c,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),S(n).forEach(p),c.forEach(p),a.forEach(p),this.h()},h(){m(n,"stroke-linecap","round"),m(n,"stroke-linejoin","round"),m(n,"d","M19.5 12h-15"),m(t,"xmlns","http://www.w3.org/2000/svg"),m(t,"fill","none"),m(t,"viewBox","0 0 24 24"),m(t,"stroke-width","2"),m(t,"stroke","currentColor"),m(t,"class","size-3"),e.disabled=l[1],m(e,"aria-label","Remove Model")},m(i,a){B(i,e,a),k(e,t),k(t,n),o||(s=ke(e,"click",r),o=!0)},p(i,a){l=i,a&2&&(e.disabled=l[1])},d(i){i&&p(e),o=!1,s()}}}function nd(l){let e,t,n,o,s;return{c(){e=V("button"),t=ze("svg"),n=ze("path"),this.h()},l(r){e=N(r,"BUTTON",{class:!0,"aria-label":!0});var i=S(e);t=Pe(i,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var a=S(t);n=Pe(a,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),S(n).forEach(p),a.forEach(p),i.forEach(p),this.h()},h(){m(n,"stroke-linecap","round"),m(n,"stroke-linejoin","round"),m(n,"d","M12 6v12m6-6H6"),m(t,"xmlns","http://www.w3.org/2000/svg"),m(t,"fill","none"),m(t,"viewBox","0 0 24 24"),m(t,"stroke-width","2"),m(t,"stroke","currentColor"),m(t,"class","size-3.5"),m(e,"class",""),e.disabled=l[1],m(e,"aria-label","Add Model")},m(r,i){B(r,e,i),k(e,t),k(t,n),o||(s=ke(e,"click",l[9]),o=!0)},p(r,i){i&2&&(e.disabled=r[1])},d(r){r&&p(e),o=!1,s()}}}function ir(l){var v,g,w;let e,t,n,o,s,r,i,a,c,u;function f(y){l[8](y,l[12],l[13],l[14])}let h={id:`${l[14]}`,placeholder:l[4].t("Select a model"),items:l[3].map(cr),showTemporaryChatControl:l[5].role==="user"?((w=(g=(v=l[5])==null?void 0:v.permissions)==null?void 0:g.chat)==null?void 0:w.temporary)??!0:!0};l[12]!==void 0&&(h.value=l[12]),o=new $c({props:h}),We.push(()=>$e(o,"value",f));const d=[ed,$f],_=[];function b(y,E){return y[14]===0?0:1}return i=b(l),a=_[i]=d[i](l),{c(){e=V("div"),t=V("div"),n=V("div"),te(o.$$.fragment),r=$(),a.c(),c=$(),this.h()},l(y){e=N(y,"DIV",{class:!0});var E=S(e);t=N(E,"DIV",{class:!0});var z=S(t);n=N(z,"DIV",{class:!0});var T=S(n);oe(o.$$.fragment,T),T.forEach(p),z.forEach(p),r=ee(E),a.l(E),c=ee(E),E.forEach(p),this.h()},h(){m(n,"class","mr-1 max-w-full"),m(t,"class","overflow-hidden w-full"),m(e,"class","flex w-full max-w-fit")},m(y,E){B(y,e,E),k(e,t),k(t,n),ne(o,n,null),k(e,r),_[i].m(e,null),k(e,c),u=!0},p(y,E){var T,I,H;l=y;const z={};E&16&&(z.placeholder=l[4].t("Select a model")),E&8&&(z.items=l[3].map(cr)),E&32&&(z.showTemporaryChatControl=l[5].role==="user"?((H=(I=(T=l[5])==null?void 0:T.permissions)==null?void 0:I.chat)==null?void 0:H.temporary)??!0:!0),!s&&E&1&&(s=!0,z.value=l[12],xe(()=>s=!1)),o.$set(z),a.p(l,E)},i(y){u||(C(o.$$.fragment,y),C(a),u=!0)},o(y){P(o.$$.fragment,y),P(a),u=!1},d(y){y&&p(e),le(o),_[i].d()}}}function ar(l){let e,t,n=l[4].t("Set as default")+"",o,s,r;return{c(){e=V("div"),t=V("button"),o=Ce(n),this.h()},l(i){e=N(i,"DIV",{class:!0});var a=S(e);t=N(a,"BUTTON",{});var c=S(t);o=Me(c,n),c.forEach(p),a.forEach(p),this.h()},h(){m(e,"class","absolute text-left mt-[1px] ml-1 text-[0.7rem] text-gray-500 font-primary")},m(i,a){B(i,e,a),k(e,t),k(t,o),s||(r=ke(t,"click",l[7]),s=!0)},p(i,a){a&16&&n!==(n=i[4].t("Set as default")+"")&&He(o,n)},d(i){i&&p(e),s=!1,r()}}}function ld(l){let e,t,n,o,s=wt(l[0]),r=[];for(let c=0;c<s.length;c+=1)r[c]=ir(rr(l,s,c));const i=c=>P(r[c],1,1,()=>{r[c]=null});let a=l[2]&&ar(l);return{c(){e=V("div");for(let c=0;c<r.length;c+=1)r[c].c();t=$(),a&&a.c(),n=Oe(),this.h()},l(c){e=N(c,"DIV",{class:!0});var u=S(e);for(let f=0;f<r.length;f+=1)r[f].l(u);u.forEach(p),t=ee(c),a&&a.l(c),n=Oe(),this.h()},h(){m(e,"class","flex flex-col w-full items-start")},m(c,u){B(c,e,u);for(let f=0;f<r.length;f+=1)r[f]&&r[f].m(e,null);B(c,t,u),a&&a.m(c,u),B(c,n,u),o=!0},p(c,[u]){if(u&59){s=wt(c[0]);let f;for(f=0;f<s.length;f+=1){const h=rr(c,s,f);r[f]?(r[f].p(h,u),C(r[f],1)):(r[f]=ir(h),r[f].c(),C(r[f],1),r[f].m(e,null))}for(Ae(),f=s.length;f<r.length;f+=1)i(f);Le()}c[2]?a?a.p(c,u):(a=ar(c),a.c(),a.m(n.parentNode,n)):a&&(a.d(1),a=null)},i(c){if(!o){for(let u=0;u<s.length;u+=1)C(r[u]);o=!0}},o(c){r=r.filter(Boolean);for(let u=0;u<r.length;u+=1)P(r[u]);o=!1},d(c){c&&(p(e),p(t),p(n)),Cn(r,c),a&&a.d(c)}}}const cr=l=>({value:l.id,label:l.name,model:l});function od(l,e,t){let n,o,s,r;ie(l,yl,b=>t(3,n=b)),ie(l,Gn,b=>t(11,s=b)),ie(l,al,b=>t(5,r=b));const i=Ut("i18n");ie(l,i,b=>t(4,o=b));let{selectedModels:a=[""]}=e,{disabled:c=!1}=e,{showSetDefault:u=!0}=e;const f=async()=>{if(a.filter(v=>v==="").length){nt.error(o.t("Choose a model before saving..."));return}Gn.set({...s,models:a}),await Oc(localStorage.token,{ui:s}),nt.success(o.t("Default model updated"))};function h(b,v,g,w){g[w]=b,t(0,a),t(3,n)}const d=()=>{t(0,a=[...a,""])},_=b=>{a.splice(b,1),t(0,a),t(3,n)};return l.$$set=b=>{"selectedModels"in b&&t(0,a=b.selectedModels),"disabled"in b&&t(1,c=b.disabled),"showSetDefault"in b&&t(2,u=b.showSetDefault)},l.$$.update=()=>{l.$$.dirty&9&&a.length>0&&n.length>0&&t(0,a=a.map(b=>n.map(v=>v.id).includes(b)?b:""))},[a,c,u,n,o,r,i,f,h,d,_]}class sd extends Ve{constructor(e){super(),Ne(this,e,od,ld,Be,{selectedModels:0,disabled:1,showSetDefault:2})}}function rd(l){let e,t;return{c(){e=ze("svg"),t=ze("path"),this.h()},l(n){e=Pe(n,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var o=S(e);t=Pe(o,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),S(t).forEach(p),o.forEach(p),this.h()},h(){m(t,"stroke-linecap","round"),m(t,"stroke-linejoin","round"),m(t,"d","M9 6.75V15m6-6v8.25m.503 3.498 4.875-2.437c.381-.19.622-.58.622-1.006V4.82c0-.836-.88-1.38-1.628-1.006l-3.869 1.934c-.317.159-.69.159-1.006 0L9.503 3.252a1.125 1.125 0 0 0-1.006 0L3.622 5.689C3.24 5.88 3 6.27 3 6.695V19.18c0 .836.88 1.38 1.628 1.006l3.869-1.934c.317-.159.69-.159 1.006 0l4.994 2.497c.317.158.69.158 1.006 0Z"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"fill","none"),m(e,"viewBox","0 0 24 24"),m(e,"stroke-width",l[1]),m(e,"stroke","currentColor"),m(e,"class",l[0])},m(n,o){B(n,e,o),k(e,t)},p(n,[o]){o&2&&m(e,"stroke-width",n[1]),o&1&&m(e,"class",n[0])},i:we,o:we,d(n){n&&p(e)}}}function id(l,e,t){let{className:n="size-4"}=e,{strokeWidth:o="2"}=e;return l.$$set=s=>{"className"in s&&t(0,n=s.className),"strokeWidth"in s&&t(1,o=s.strokeWidth)},[n,o]}let ad=class extends Ve{constructor(e){super(),Ne(this,e,id,rd,Be,{className:0,strokeWidth:1})}};function cd(l){let e,t;return{c(){e=ze("svg"),t=ze("path"),this.h()},l(n){e=Pe(n,"svg",{xmlns:!0,viewBox:!0,stroke:!0,fill:!0,class:!0,"stroke-width":!0});var o=S(e);t=Pe(o,"path",{d:!0}),S(t).forEach(p),o.forEach(p),this.h()},h(){m(t,"d","M18.75 12.75h1.5a.75.75 0 0 0 0-1.5h-1.5a.75.75 0 0 0 0 1.5ZM12 6a.75.75 0 0 1 .75-.75h7.5a.75.75 0 0 1 0 1.5h-7.5A.75.75 0 0 1 12 6ZM12 18a.75.75 0 0 1 .75-.75h7.5a.75.75 0 0 1 0 1.5h-7.5A.75.75 0 0 1 12 18ZM3.75 6.75h1.5a.75.75 0 1 0 0-1.5h-1.5a.75.75 0 0 0 0 1.5ZM5.25 18.75h-1.5a.75.75 0 0 1 0-1.5h1.5a.75.75 0 0 1 0 1.5ZM3 12a.75.75 0 0 1 .75-.75h7.5a.75.75 0 0 1 0 1.5h-7.5A.75.75 0 0 1 3 12ZM9 3.75a2.25 2.25 0 1 0 0 4.5 2.25 2.25 0 0 0 0-4.5ZM12.75 12a2.25 2.25 0 1 1 4.5 0 2.25 2.25 0 0 1-4.5 0ZM9 15.75a2.25 2.25 0 1 0 0 4.5 2.25 2.25 0 0 0 0-4.5Z"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"viewBox","0 0 24 24"),m(e,"stroke","currentColor"),m(e,"fill","currentColor"),m(e,"class",l[0]),m(e,"stroke-width",l[1])},m(n,o){B(n,e,o),k(e,t)},p(n,[o]){o&1&&m(e,"class",n[0]),o&2&&m(e,"stroke-width",n[1])},i:we,o:we,d(n){n&&p(e)}}}function ud(l,e,t){let{className:n="w-4 h-4"}=e,{strokeWidth:o="1.5"}=e;return l.$$set=s=>{"className"in s&&t(0,n=s.className),"strokeWidth"in s&&t(1,o=s.strokeWidth)},[n,o]}class rs extends Ve{constructor(e){super(),Ne(this,e,ud,cd,Be,{className:0,strokeWidth:1})}}function fd(l){let e,t;return{c(){e=ze("svg"),t=ze("path"),this.h()},l(n){e=Pe(n,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var o=S(e);t=Pe(o,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),S(t).forEach(p),o.forEach(p),this.h()},h(){m(t,"stroke-linecap","round"),m(t,"stroke-linejoin","round"),m(t,"d","m21 7.5-9-5.25L3 7.5m18 0-9 5.25m9-5.25v9l-9 5.25M3 7.5l9 5.25M3 7.5v9l9 5.25m0-9v9"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"fill","none"),m(e,"viewBox","0 0 24 24"),m(e,"stroke-width",l[1]),m(e,"stroke","currentColor"),m(e,"class",l[0])},m(n,o){B(n,e,o),k(e,t)},p(n,[o]){o&2&&m(e,"stroke-width",n[1]),o&1&&m(e,"class",n[0])},i:we,o:we,d(n){n&&p(e)}}}function dd(l,e,t){let{className:n="size-4"}=e,{strokeWidth:o="2"}=e;return l.$$set=s=>{"className"in s&&t(0,n=s.className),"strokeWidth"in s&&t(1,o=s.strokeWidth)},[n,o]}class hd extends Ve{constructor(e){super(),Ne(this,e,dd,fd,Be,{className:0,strokeWidth:1})}}function md(l){let e;const t=l[13].default,n=xt(t,l,l[23],null);return{c(){n&&n.c()},l(o){n&&n.l(o)},m(o,s){n&&n.m(o,s),e=!0},p(o,s){n&&n.p&&(!e||s&8388608)&&$t(n,t,o,o[23],e?tn(t,o[23],s,null):en(o[23]),null)},i(o){e||(C(n,o),e=!0)},o(o){P(n,o),e=!1},d(o){n&&n.d(o)}}}function ur(l){let e,t;return e=new Sn({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",id:"chat-controls-button",$$slots:{default:[gd]},$$scope:{ctx:l}}}),e.$on("click",l[14]),{c(){te(e.$$.fragment)},l(n){oe(e.$$.fragment,n)},m(n,o){ne(e,n,o),t=!0},p(n,o){const s={};o&8388624&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){le(e,n)}}}function gd(l){let e,t,n,o=l[4].t("Controls")+"",s,r;return e=new rs({props:{className:" size-4",strokeWidth:"0.5"}}),{c(){te(e.$$.fragment),t=$(),n=V("div"),s=Ce(o),this.h()},l(i){oe(e.$$.fragment,i),t=ee(i),n=N(i,"DIV",{class:!0});var a=S(n);s=Me(a,o),a.forEach(p),this.h()},h(){m(n,"class","flex items-center")},m(i,a){ne(e,i,a),B(i,t,a),B(i,n,a),k(n,s),r=!0},p(i,a){(!r||a&16)&&o!==(o=i[4].t("Controls")+"")&&He(s,o)},i(i){r||(C(e.$$.fragment,i),r=!0)},o(i){P(e.$$.fragment,i),r=!1},d(i){i&&(p(t),p(n)),le(e,i)}}}function fr(l){let e,t;return e=new Sn({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",id:"chat-share-button",$$slots:{default:[_d]},$$scope:{ctx:l}}}),e.$on("click",l[15]),{c(){te(e.$$.fragment)},l(n){oe(e.$$.fragment,n)},m(n,o){ne(e,n,o),t=!0},p(n,o){const s={};o&8388624&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){le(e,n)}}}function _d(l){let e,t,n,o,s=l[4].t("Share")+"",r;return{c(){e=ze("svg"),t=ze("path"),n=$(),o=V("div"),r=Ce(s),this.h()},l(i){e=Pe(i,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var a=S(e);t=Pe(a,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),S(t).forEach(p),a.forEach(p),n=ee(i),o=N(i,"DIV",{class:!0});var c=S(o);r=Me(c,s),c.forEach(p),this.h()},h(){m(t,"fill-rule","evenodd"),m(t,"d","M15.75 4.5a3 3 0 1 1 .825 2.066l-8.421 4.679a3.002 3.002 0 0 1 0 1.51l8.421 4.679a3 3 0 1 1-.729 1.31l-8.421-4.678a3 3 0 1 1 0-4.132l8.421-4.679a3 3 0 0 1-.096-.755Z"),m(t,"clip-rule","evenodd"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"viewBox","0 0 24 24"),m(e,"fill","currentColor"),m(e,"class","size-4"),m(o,"class","flex items-center")},m(i,a){B(i,e,a),k(e,t),B(i,n,a),B(i,o,a),k(o,r)},p(i,a){a&16&&s!==(s=i[4].t("Share")+"")&&He(r,s)},d(i){i&&(p(e),p(n),p(o))}}}function pd(l){let e,t,n,o=l[4].t("Overview")+"",s,r;return e=new ad({props:{className:" size-4",strokeWidth:"1.5"}}),{c(){te(e.$$.fragment),t=$(),n=V("div"),s=Ce(o),this.h()},l(i){oe(e.$$.fragment,i),t=ee(i),n=N(i,"DIV",{class:!0});var a=S(n);s=Me(a,o),a.forEach(p),this.h()},h(){m(n,"class","flex items-center")},m(i,a){ne(e,i,a),B(i,t,a),B(i,n,a),k(n,s),r=!0},p(i,a){(!r||a&16)&&o!==(o=i[4].t("Overview")+"")&&He(s,o)},i(i){r||(C(e.$$.fragment,i),r=!0)},o(i){P(e.$$.fragment,i),r=!1},d(i){i&&(p(t),p(n)),le(e,i)}}}function bd(l){let e,t,n,o=l[4].t("Artifacts")+"",s,r;return e=new hd({props:{className:" size-4",strokeWidth:"1.5"}}),{c(){te(e.$$.fragment),t=$(),n=V("div"),s=Ce(o),this.h()},l(i){oe(e.$$.fragment,i),t=ee(i),n=N(i,"DIV",{class:!0});var a=S(n);s=Me(a,o),a.forEach(p),this.h()},h(){m(n,"class","flex items-center")},m(i,a){ne(e,i,a),B(i,t,a),B(i,n,a),k(n,s),r=!0},p(i,a){(!r||a&16)&&o!==(o=i[4].t("Artifacts")+"")&&He(s,o)},i(i){r||(C(e.$$.fragment,i),r=!0)},o(i){P(e.$$.fragment,i),r=!1},d(i){i&&(p(t),p(n)),le(e,i)}}}function vd(l){let e,t,n,o,s=l[4].t("Download")+"",r;return{c(){e=ze("svg"),t=ze("path"),n=$(),o=V("div"),r=Ce(s),this.h()},l(i){e=Pe(i,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var a=S(e);t=Pe(a,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),S(t).forEach(p),a.forEach(p),n=ee(i),o=N(i,"DIV",{class:!0});var c=S(o);r=Me(c,s),c.forEach(p),this.h()},h(){m(t,"stroke-linecap","round"),m(t,"stroke-linejoin","round"),m(t,"d","M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"fill","none"),m(e,"viewBox","0 0 24 24"),m(e,"stroke-width","1.5"),m(e,"stroke","currentColor"),m(e,"class","size-4"),m(o,"class","flex items-center")},m(i,a){B(i,e,a),k(e,t),B(i,n,a),B(i,o,a),k(o,r)},p(i,a){a&16&&s!==(s=i[4].t("Download")+"")&&He(r,s)},d(i){i&&(p(e),p(n),p(o))}}}function wd(l){let e,t=l[4].t("Export chat (.json)")+"",n;return{c(){e=V("div"),n=Ce(t),this.h()},l(o){e=N(o,"DIV",{class:!0});var s=S(e);n=Me(s,t),s.forEach(p),this.h()},h(){m(e,"class","flex items-center line-clamp-1")},m(o,s){B(o,e,s),k(e,n)},p(o,s){s&16&&t!==(t=o[4].t("Export chat (.json)")+"")&&He(n,t)},d(o){o&&p(e)}}}function yd(l){let e,t=l[4].t("Plain text (.txt)")+"",n;return{c(){e=V("div"),n=Ce(t),this.h()},l(o){e=N(o,"DIV",{class:!0});var s=S(e);n=Me(s,t),s.forEach(p),this.h()},h(){m(e,"class","flex items-center line-clamp-1")},m(o,s){B(o,e,s),k(e,n)},p(o,s){s&16&&t!==(t=o[4].t("Plain text (.txt)")+"")&&He(n,t)},d(o){o&&p(e)}}}function kd(l){let e,t=l[4].t("PDF document (.pdf)")+"",n;return{c(){e=V("div"),n=Ce(t),this.h()},l(o){e=N(o,"DIV",{class:!0});var s=S(e);n=Me(s,t),s.forEach(p),this.h()},h(){m(e,"class","flex items-center line-clamp-1")},m(o,s){B(o,e,s),k(e,n)},p(o,s){s&16&&t!==(t=o[4].t("PDF document (.pdf)")+"")&&He(n,t)},d(o){o&&p(e)}}}function Ed(l){let e,t,n,o,s,r;return e=new Sn({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",$$slots:{default:[wd]},$$scope:{ctx:l}}}),e.$on("click",l[18]),n=new Sn({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",$$slots:{default:[yd]},$$scope:{ctx:l}}}),n.$on("click",l[19]),s=new Sn({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",$$slots:{default:[kd]},$$scope:{ctx:l}}}),s.$on("click",l[20]),{c(){te(e.$$.fragment),t=$(),te(n.$$.fragment),o=$(),te(s.$$.fragment)},l(i){oe(e.$$.fragment,i),t=ee(i),oe(n.$$.fragment,i),o=ee(i),oe(s.$$.fragment,i)},m(i,a){ne(e,i,a),B(i,t,a),ne(n,i,a),B(i,o,a),ne(s,i,a),r=!0},p(i,a){const c={};a&8388624&&(c.$$scope={dirty:a,ctx:i}),e.$set(c);const u={};a&8388624&&(u.$$scope={dirty:a,ctx:i}),n.$set(u);const f={};a&8388624&&(f.$$scope={dirty:a,ctx:i}),s.$set(f)},i(i){r||(C(e.$$.fragment,i),C(n.$$.fragment,i),C(s.$$.fragment,i),r=!0)},o(i){P(e.$$.fragment,i),P(n.$$.fragment,i),P(s.$$.fragment,i),r=!1},d(i){i&&(p(t),p(o)),le(e,i),le(n,i),le(s,i)}}}function Id(l){let e,t,n,o;return e=new Mc({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",$$slots:{default:[vd]},$$scope:{ctx:l}}}),n=new Tc({props:{class:"w-full rounded-xl px-1 py-1.5 z-50 bg-white dark:bg-gray-850 dark:text-white shadow-lg",transition:Gl,sideOffset:8,$$slots:{default:[Ed]},$$scope:{ctx:l}}}),{c(){te(e.$$.fragment),t=$(),te(n.$$.fragment)},l(s){oe(e.$$.fragment,s),t=ee(s),oe(n.$$.fragment,s)},m(s,r){ne(e,s,r),B(s,t,r),ne(n,s,r),o=!0},p(s,r){const i={};r&8388624&&(i.$$scope={dirty:r,ctx:s}),e.$set(i);const a={};r&8388624&&(a.$$scope={dirty:r,ctx:s}),n.$set(a)},i(s){o||(C(e.$$.fragment,s),C(n.$$.fragment,s),o=!0)},o(s){P(e.$$.fragment,s),P(n.$$.fragment,s),o=!1},d(s){s&&p(t),le(e,s),le(n,s)}}}function Sd(l){let e,t,n,o=l[4].t("Copy")+"",s,r;return e=new Za({props:{className:" size-4",strokeWidth:"1.5"}}),{c(){te(e.$$.fragment),t=$(),n=V("div"),s=Ce(o),this.h()},l(i){oe(e.$$.fragment,i),t=ee(i),n=N(i,"DIV",{class:!0});var a=S(n);s=Me(a,o),a.forEach(p),this.h()},h(){m(n,"class","flex items-center")},m(i,a){ne(e,i,a),B(i,t,a),B(i,n,a),k(n,s),r=!0},p(i,a){(!r||a&16)&&o!==(o=i[4].t("Copy")+"")&&He(s,o)},i(i){r||(C(e.$$.fragment,i),r=!0)},o(i){P(e.$$.fragment,i),r=!1},d(i){i&&(p(t),p(n)),le(e,i)}}}function dr(l){let e,t,n,o,s;return o=new Vc({props:{chatId:l[0].id}}),{c(){e=V("hr"),t=$(),n=V("div"),te(o.$$.fragment),this.h()},l(r){e=N(r,"HR",{class:!0}),t=ee(r),n=N(r,"DIV",{class:!0});var i=S(n);oe(o.$$.fragment,i),i.forEach(p),this.h()},h(){m(e,"class","border-gray-50 dark:border-gray-850 my-0.5"),m(n,"class","flex p-1")},m(r,i){B(r,e,i),B(r,t,i),B(r,n,i),ne(o,n,null),s=!0},p(r,i){const a={};i&1&&(a.chatId=r[0].id),o.$set(a)},i(r){s||(C(o.$$.fragment,r),s=!0)},o(r){P(o.$$.fragment,r),s=!1},d(r){r&&(p(e),p(t),p(n)),le(o)}}}function Dd(l){let e,t,n,o,s,r,i,a,c,u,f,h,d=l[3]&&ur(l),_=!l[5]&&fr(l);n=new Sn({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",id:"chat-overview-button",$$slots:{default:[pd]},$$scope:{ctx:l}}}),n.$on("click",l[16]),s=new Sn({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",id:"chat-overview-button",$$slots:{default:[bd]},$$scope:{ctx:l}}}),s.$on("click",l[17]),i=new Cc({props:{$$slots:{default:[Id]},$$scope:{ctx:l}}}),c=new Sn({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",id:"chat-copy-button",$$slots:{default:[Sd]},$$scope:{ctx:l}}}),c.$on("click",l[21]);let b=!l[5]&&dr(l);return{c(){d&&d.c(),e=$(),_&&_.c(),t=$(),te(n.$$.fragment),o=$(),te(s.$$.fragment),r=$(),te(i.$$.fragment),a=$(),te(c.$$.fragment),u=$(),b&&b.c(),f=Oe()},l(v){d&&d.l(v),e=ee(v),_&&_.l(v),t=ee(v),oe(n.$$.fragment,v),o=ee(v),oe(s.$$.fragment,v),r=ee(v),oe(i.$$.fragment,v),a=ee(v),oe(c.$$.fragment,v),u=ee(v),b&&b.l(v),f=Oe()},m(v,g){d&&d.m(v,g),B(v,e,g),_&&_.m(v,g),B(v,t,g),ne(n,v,g),B(v,o,g),ne(s,v,g),B(v,r,g),ne(i,v,g),B(v,a,g),ne(c,v,g),B(v,u,g),b&&b.m(v,g),B(v,f,g),h=!0},p(v,g){v[3]?d?(d.p(v,g),g&8&&C(d,1)):(d=ur(v),d.c(),C(d,1),d.m(e.parentNode,e)):d&&(Ae(),P(d,1,1,()=>{d=null}),Le()),v[5]?_&&(Ae(),P(_,1,1,()=>{_=null}),Le()):_?(_.p(v,g),g&32&&C(_,1)):(_=fr(v),_.c(),C(_,1),_.m(t.parentNode,t));const w={};g&8388624&&(w.$$scope={dirty:g,ctx:v}),n.$set(w);const y={};g&8388624&&(y.$$scope={dirty:g,ctx:v}),s.$set(y);const E={};g&8388624&&(E.$$scope={dirty:g,ctx:v}),i.$set(E);const z={};g&8388624&&(z.$$scope={dirty:g,ctx:v}),c.$set(z),v[5]?b&&(Ae(),P(b,1,1,()=>{b=null}),Le()):b?(b.p(v,g),g&32&&C(b,1)):(b=dr(v),b.c(),C(b,1),b.m(f.parentNode,f))},i(v){h||(C(d),C(_),C(n.$$.fragment,v),C(s.$$.fragment,v),C(i.$$.fragment,v),C(c.$$.fragment,v),C(b),h=!0)},o(v){P(d),P(_),P(n.$$.fragment,v),P(s.$$.fragment,v),P(i.$$.fragment,v),P(c.$$.fragment,v),P(b),h=!1},d(v){v&&(p(e),p(t),p(o),p(r),p(a),p(u),p(f)),d&&d.d(v),_&&_.d(v),le(n,v),le(s,v),le(i,v),le(c,v),b&&b.d(v)}}}function Cd(l){let e,t,n;return t=new Vo({props:{class:"w-full max-w-[200px] rounded-xl px-1 py-1.5  z-50 bg-white dark:bg-gray-850 dark:text-white shadow-lg",sideOffset:8,side:"bottom",align:"end",transition:Gl,$$slots:{default:[Dd]},$$scope:{ctx:l}}}),{c(){e=V("div"),te(t.$$.fragment),this.h()},l(o){e=N(o,"DIV",{slot:!0});var s=S(e);oe(t.$$.fragment,s),s.forEach(p),this.h()},h(){m(e,"slot","content")},m(o,s){B(o,e,s),ne(t,e,null),n=!0},p(o,s){const r={};s&8388667&&(r.$$scope={dirty:s,ctx:o}),t.$set(r)},i(o){n||(C(t.$$.fragment,o),n=!0)},o(o){P(t.$$.fragment,o),n=!1},d(o){o&&p(e),le(t)}}}function Md(l){let e,t;return e=new To({props:{$$slots:{content:[Cd],default:[md]},$$scope:{ctx:l}}}),e.$on("change",l[22]),{c(){te(e.$$.fragment)},l(n){oe(e.$$.fragment,n)},m(n,o){ne(e,n,o),t=!0},p(n,[o]){const s={};o&8388667&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){le(e,n)}}}function Td(l,e,t){let n,o,s;ie(l,Co,j=>t(3,n=j)),ie(l,Mo,j=>t(5,s=j));let{$$slots:r={},$$scope:i}=e;const{saveAs:a}=eu,c=Ut("i18n");ie(l,c,j=>t(4,o=j));let{shareEnabled:u=!1}=e,{shareHandler:f}=e,{downloadHandler:h}=e,{chat:d}=e,{onClose:_=()=>{}}=e;const b=async()=>{const j=d.chat.history;return Jo(j,j.currentId).reduce((K,D,W,L)=>`${K}### ${D.role.toUpperCase()}
${D.content}

`,"").trim()},v=async()=>{const j=await b();let Y=new Blob([j],{type:"text/plain"});a(Y,`chat-${d.chat.title}.txt`)},g=async()=>{const j=d.chat.history,Y=Jo(j,j.currentId),M=await tu(d.chat.title,Y),K=window.URL.createObjectURL(M),D=document.createElement("a");D.href=K,D.download=`chat-${d.chat.title}.pdf`,document.body.appendChild(D),D.click(),document.body.removeChild(D),window.URL.revokeObjectURL(K)},w=async()=>{d.id&&t(0,d=await Qo(localStorage.token,d.id));let j=new Blob([JSON.stringify([d])],{type:"application/json"});a(j,`chat-export-${Date.now()}.json`)},y=async()=>{await Rt.set(!0),await Jn.set(!1),await Yn.set(!1)},E=()=>{f()},z=async()=>{await Rt.set(!0),await Jn.set(!0),await Yn.set(!1)},T=async()=>{await Rt.set(!0),await Yn.set(!0),await Jn.set(!1)},I=()=>{w()},H=()=>{v()},O=()=>{g()},A=async()=>{await _o(await b()).catch(Y=>{console.error(Y)})&&nt.success(o.t("Copied to clipboard"))},F=j=>{j.detail===!1&&_()};return l.$$set=j=>{"shareEnabled"in j&&t(11,u=j.shareEnabled),"shareHandler"in j&&t(1,f=j.shareHandler),"downloadHandler"in j&&t(12,h=j.downloadHandler),"chat"in j&&t(0,d=j.chat),"onClose"in j&&t(2,_=j.onClose),"$$scope"in j&&t(23,i=j.$$scope)},[d,f,_,n,o,s,c,b,v,g,w,u,h,r,y,E,z,T,I,H,O,A,F,i]}class Vd extends Ve{constructor(e){super(),Ne(this,e,Td,Md,Be,{shareEnabled:11,shareHandler:1,downloadHandler:12,chat:0,onClose:2})}}function Nd(l){let e,t;return{c(){e=ze("svg"),t=ze("path"),this.h()},l(n){e=Pe(n,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var o=S(e);t=Pe(o,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),S(t).forEach(p),o.forEach(p),this.h()},h(){m(t,"stroke-linecap","round"),m(t,"stroke-linejoin","round"),m(t,"d","m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"fill","none"),m(e,"viewBox","0 0 24 24"),m(e,"stroke-width",l[1]),m(e,"stroke","currentColor"),m(e,"class",l[0])},m(n,o){B(n,e,o),k(e,t)},p(n,[o]){o&2&&m(e,"stroke-width",n[1]),o&1&&m(e,"class",n[0])},i:we,o:we,d(n){n&&p(e)}}}function zd(l,e,t){let{className:n="size-4"}=e,{strokeWidth:o="1.5"}=e;return l.$$set=s=>{"className"in s&&t(0,n=s.className),"strokeWidth"in s&&t(1,o=s.strokeWidth)},[n,o]}class Pd extends Ve{constructor(e){super(),Ne(this,e,zd,Nd,Be,{className:0,strokeWidth:1})}}function hr(l){let e,t,n;function o(r){l[18](r)}let s={showSetDefault:!l[2]};return l[0]!==void 0&&(s.selectedModels=l[0]),e=new sd({props:s}),We.push(()=>$e(e,"selectedModels",o)),{c(){te(e.$$.fragment)},l(r){oe(e.$$.fragment,r)},m(r,i){ne(e,r,i),n=!0},p(r,i){const a={};i&4&&(a.showSetDefault=!r[2]),!t&&i&1&&(t=!0,a.selectedModels=r[0],xe(()=>t=!1)),e.$set(a)},i(r){n||(C(e.$$.fragment,r),n=!0)},o(r){P(e.$$.fragment,r),n=!1},d(r){le(e,r)}}}function Od(l){let e,t;return e=new Gt({props:{content:l[11].t("Controls"),$$slots:{default:[Bd]},$$scope:{ctx:l}}}),{c(){te(e.$$.fragment)},l(n){oe(e.$$.fragment,n)},m(n,o){ne(e,n,o),t=!0},p(n,o){const s={};o&2048&&(s.content=n[11].t("Controls")),o&67112960&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){le(e,n)}}}function Hd(l){let e,t;return e=new Vd({props:{chat:l[3],shareEnabled:l[2],shareHandler:l[19],downloadHandler:l[20],$$slots:{default:[Ad]},$$scope:{ctx:l}}}),{c(){te(e.$$.fragment)},l(n){oe(e.$$.fragment,n)},m(n,o){ne(e,n,o),t=!0},p(n,o){const s={};o&8&&(s.chat=n[3]),o&4&&(s.shareEnabled=n[2]),o&32&&(s.shareHandler=n[19]),o&64&&(s.downloadHandler=n[20]),o&67108864&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){le(e,n)}}}function Bd(l){let e,t,n,o,s,r;return n=new rs({props:{className:" size-5",strokeWidth:"0.5"}}),{c(){e=V("button"),t=V("div"),te(n.$$.fragment),this.h()},l(i){e=N(i,"BUTTON",{class:!0,"aria-label":!0});var a=S(e);t=N(a,"DIV",{class:!0});var c=S(t);oe(n.$$.fragment,c),c.forEach(p),a.forEach(p),this.h()},h(){m(t,"class","m-auto self-center"),m(e,"class","flex cursor-pointer px-2 py-2 rounded-xl hover:bg-gray-50 dark:hover:bg-gray-850 transition"),m(e,"aria-label","Controls")},m(i,a){B(i,e,a),k(e,t),ne(n,t,null),o=!0,s||(r=ke(e,"click",l[21]),s=!0)},p:we,i(i){o||(C(n.$$.fragment,i),o=!0)},o(i){P(n.$$.fragment,i),o=!1},d(i){i&&p(e),le(n),s=!1,r()}}}function Ad(l){let e,t='<div class="m-auto self-center"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5"><path stroke-linecap="round" stroke-linejoin="round" d="M6.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM12.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM18.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Z"></path></svg></div>';return{c(){e=V("button"),e.innerHTML=t,this.h()},l(n){e=N(n,"BUTTON",{class:!0,id:!0,"data-svelte-h":!0}),gt(e)!=="svelte-xd5mtd"&&(e.innerHTML=t),this.h()},h(){m(e,"class","flex cursor-pointer px-2 py-2 rounded-xl hover:bg-gray-50 dark:hover:bg-gray-850 transition"),m(e,"id","chat-context-menu-button")},m(n,o){B(n,e,o)},p:we,d(n){n&&p(e)}}}function mr(l){let e,t;return e=new Gt({props:{content:l[11].t("Controls"),$$slots:{default:[Ld]},$$scope:{ctx:l}}}),{c(){te(e.$$.fragment)},l(n){oe(e.$$.fragment,n)},m(n,o){ne(e,n,o),t=!0},p(n,o){const s={};o&2048&&(s.content=n[11].t("Controls")),o&67112960&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){le(e,n)}}}function Ld(l){let e,t,n,o,s,r;return n=new rs({props:{className:" size-5",strokeWidth:"0.5"}}),{c(){e=V("button"),t=V("div"),te(n.$$.fragment),this.h()},l(i){e=N(i,"BUTTON",{class:!0,"aria-label":!0});var a=S(e);t=N(a,"DIV",{class:!0});var c=S(t);oe(n.$$.fragment,c),c.forEach(p),a.forEach(p),this.h()},h(){m(t,"class","m-auto self-center"),m(e,"class","flex cursor-pointer px-2 py-2 rounded-xl hover:bg-gray-50 dark:hover:bg-gray-850 transition"),m(e,"aria-label","Controls")},m(i,a){B(i,e,a),k(e,t),ne(n,t,null),o=!0,s||(r=ke(e,"click",l[22]),s=!0)},p:we,i(i){o||(C(n.$$.fragment,i),o=!0)},o(i){P(n.$$.fragment,i),o=!1},d(i){i&&p(e),le(n),s=!1,r()}}}function Rd(l){let e,t,n,o,s,r,i;return n=new Pd({props:{className:" size-5",strokeWidth:"2"}}),{c(){e=V("button"),t=V("div"),te(n.$$.fragment),this.h()},l(a){e=N(a,"BUTTON",{id:!0,class:!0,"aria-label":!0});var c=S(e);t=N(c,"DIV",{class:!0});var u=S(t);oe(n.$$.fragment,u),u.forEach(p),c.forEach(p),this.h()},h(){m(t,"class","m-auto self-center"),m(e,"id","new-chat-button"),m(e,"class",o="flex "+(l[8]?"md:hidden":"")+" cursor-pointer px-2 py-2 rounded-xl text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-850 transition"),m(e,"aria-label","New Chat")},m(a,c){B(a,e,c),k(e,t),ne(n,t,null),s=!0,r||(i=ke(e,"click",l[23]),r=!0)},p(a,c){(!s||c&256&&o!==(o="flex "+(a[8]?"md:hidden":"")+" cursor-pointer px-2 py-2 rounded-xl text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-850 transition"))&&m(e,"class",o)},i(a){s||(C(n.$$.fragment,a),s=!0)},o(a){P(n.$$.fragment,a),s=!1},d(a){a&&p(e),le(n),r=!1,i()}}}function gr(l){let e,t;return e=new zc({props:{className:"max-w-[200px]",role:l[13].role,$$slots:{default:[Ud]},$$scope:{ctx:l}}}),e.$on("show",l[24]),{c(){te(e.$$.fragment)},l(n){oe(e.$$.fragment,n)},m(n,o){ne(e,n,o),t=!0},p(n,o){const s={};o&8192&&(s.role=n[13].role),o&67117056&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){le(e,n)}}}function Ud(l){let e,t,n,o;return{c(){e=V("button"),t=V("div"),n=V("img"),this.h()},l(s){e=N(s,"BUTTON",{class:!0,"aria-label":!0});var r=S(e);t=N(r,"DIV",{class:!0});var i=S(t);n=N(i,"IMG",{src:!0,class:!0,alt:!0,draggable:!0}),i.forEach(p),r.forEach(p),this.h()},h(){Hn(n.src,o=l[13].profile_image_url)||m(n,"src",o),m(n,"class","size-6 object-cover rounded-full"),m(n,"alt","User profile"),m(n,"draggable","false"),m(t,"class","self-center"),m(e,"class","select-none flex rounded-xl p-1.5 w-full hover:bg-gray-50 dark:hover:bg-gray-850 transition"),m(e,"aria-label","User Menu")},m(s,r){B(s,e,r),k(e,t),k(t,n)},p(s,r){r&8192&&!Hn(n.src,o=s[13].profile_image_url)&&m(n,"src",o)},d(s){s&&p(e)}}}function Wd(l){let e,t,n,o,s,r,i,a,c,u,f,h,d,_,b,v,g,w,y,E,z,T,I,H,O,A,F;function j(X){l[16](X)}let Y={chatId:l[7]};l[5]!==void 0&&(Y.show=l[5]),e=new Nc({props:Y}),We.push(()=>$e(e,"show",j)),h=new nu({});let M=l[4]&&hr(l);const K=[Hd,Od],D=[];function W(X,Q){return X[2]&&X[3]&&(X[3].id||X[9])?0:X[10]?1:-1}~(y=W(l))&&(E=D[y]=K[y](l));let L=!l[10]&&mr(l);I=new Gt({props:{content:l[11].t("New Chat"),$$slots:{default:[Rd]},$$scope:{ctx:l}}});let R=l[13]!==void 0&&gr(l);return{c(){te(e.$$.fragment),n=$(),o=V("div"),s=V("div"),r=$(),i=V("div"),a=V("div"),c=V("div"),u=V("button"),f=V("div"),te(h.$$.fragment),_=$(),b=V("div"),M&&M.c(),g=$(),w=V("div"),E&&E.c(),z=$(),L&&L.c(),T=$(),te(I.$$.fragment),H=$(),R&&R.c(),this.h()},l(X){oe(e.$$.fragment,X),n=ee(X),o=N(X,"DIV",{class:!0});var Q=S(o);s=N(Q,"DIV",{class:!0}),S(s).forEach(p),r=ee(Q),i=N(Q,"DIV",{class:!0});var G=S(i);a=N(G,"DIV",{class:!0});var ce=S(a);c=N(ce,"DIV",{class:!0});var se=S(c);u=N(se,"BUTTON",{id:!0,class:!0,"aria-label":!0});var ye=S(u);f=N(ye,"DIV",{class:!0});var Se=S(f);oe(h.$$.fragment,Se),Se.forEach(p),ye.forEach(p),se.forEach(p),_=ee(ce),b=N(ce,"DIV",{class:!0});var re=S(b);M&&M.l(re),re.forEach(p),g=ee(ce),w=N(ce,"DIV",{class:!0});var q=S(w);E&&E.l(q),z=ee(q),L&&L.l(q),T=ee(q),oe(I.$$.fragment,q),H=ee(q),R&&R.l(q),q.forEach(p),ce.forEach(p),G.forEach(p),Q.forEach(p),this.h()},h(){m(s,"class","bg-gradient-to-b via-50% from-white via-white to-transparent dark:from-gray-900 dark:via-gray-900 dark:to-transparent pointer-events-none absolute inset-0 -bottom-7 z-[-1] blur"),m(f,"class","m-auto self-center"),m(u,"id","sidebar-toggle-button"),m(u,"class","cursor-pointer px-2 py-2 flex rounded-xl hover:bg-gray-50 dark:hover:bg-gray-850 transition"),m(u,"aria-label","Toggle Sidebar"),m(c,"class",d=(l[8]?"md:hidden":"")+" mr-1 self-start flex flex-none items-center text-gray-600 dark:text-gray-400"),m(b,"class",v="flex-1 overflow-hidden max-w-full py-0.5 "+(l[8]?"ml-1":"")),m(w,"class","self-start flex flex-none items-center text-gray-600 dark:text-gray-400"),m(a,"class","flex items-center w-full max-w-full"),m(i,"class","flex max-w-full w-full mx-auto px-1 pt-0.5 bg-transparent"),m(o,"class","sticky top-0 z-30 w-full px-1.5 py-1.5 -mb-8 flex items-center")},m(X,Q){ne(e,X,Q),B(X,n,Q),B(X,o,Q),k(o,s),k(o,r),k(o,i),k(i,a),k(a,c),k(c,u),k(u,f),ne(h,f,null),k(a,_),k(a,b),M&&M.m(b,null),k(a,g),k(a,w),~y&&D[y].m(w,null),k(w,z),L&&L.m(w,null),k(w,T),ne(I,w,null),k(w,H),R&&R.m(w,null),O=!0,A||(F=ke(u,"click",l[17]),A=!0)},p(X,[Q]){const G={};Q&128&&(G.chatId=X[7]),!t&&Q&32&&(t=!0,G.show=X[5],xe(()=>t=!1)),e.$set(G),(!O||Q&256&&d!==(d=(X[8]?"md:hidden":"")+" mr-1 self-start flex flex-none items-center text-gray-600 dark:text-gray-400"))&&m(c,"class",d),X[4]?M?(M.p(X,Q),Q&16&&C(M,1)):(M=hr(X),M.c(),C(M,1),M.m(b,null)):M&&(Ae(),P(M,1,1,()=>{M=null}),Le()),(!O||Q&256&&v!==(v="flex-1 overflow-hidden max-w-full py-0.5 "+(X[8]?"ml-1":"")))&&m(b,"class",v);let ce=y;y=W(X),y===ce?~y&&D[y].p(X,Q):(E&&(Ae(),P(D[ce],1,1,()=>{D[ce]=null}),Le()),~y?(E=D[y],E?E.p(X,Q):(E=D[y]=K[y](X),E.c()),C(E,1),E.m(w,z)):E=null),X[10]?L&&(Ae(),P(L,1,1,()=>{L=null}),Le()):L?(L.p(X,Q),Q&1024&&C(L,1)):(L=mr(X),L.c(),C(L,1),L.m(w,T));const se={};Q&2048&&(se.content=X[11].t("New Chat")),Q&67109122&&(se.$$scope={dirty:Q,ctx:X}),I.$set(se),X[13]!==void 0?R?(R.p(X,Q),Q&8192&&C(R,1)):(R=gr(X),R.c(),C(R,1),R.m(w,null)):R&&(Ae(),P(R,1,1,()=>{R=null}),Le())},i(X){O||(C(e.$$.fragment,X),C(h.$$.fragment,X),C(M),C(E),C(L),C(I.$$.fragment,X),C(R),O=!0)},o(X){P(e.$$.fragment,X),P(h.$$.fragment,X),P(M),P(E),P(L),P(I.$$.fragment,X),P(R),O=!1},d(X){X&&(p(n),p(o)),le(e,X),le(h),M&&M.d(),~y&&D[y].d(),L&&L.d(),le(I),R&&R.d(),A=!1,F()}}}function jd(l,e,t){let n,o,s,r,i,a,c,u;ie(l,Zi,Y=>t(25,n=Y)),ie(l,pl,Y=>t(7,o=Y)),ie(l,go,Y=>t(8,s=Y)),ie(l,Mo,Y=>t(9,r=Y)),ie(l,Co,Y=>t(10,i=Y)),ie(l,Rt,Y=>t(12,c=Y)),ie(l,al,Y=>t(13,u=Y));const f=Ut("i18n");ie(l,f,Y=>t(11,a=Y));let{initNewChat:h}=e,{title:d=n}=e,{shareEnabled:_=!1}=e,{chat:b}=e,{selectedModels:v}=e,{showModelSelector:g=!0}=e,w=!1,y=!1;function E(Y){w=Y,t(5,w)}const z=()=>{go.set(!s)};function T(Y){v=Y,t(0,v)}const I=()=>{t(5,w=!w)},H=()=>{t(6,y=!y)},O=async()=>{await Rt.set(!c)},A=async()=>{await Rt.set(!c)},F=()=>{h()},j=Y=>{Y.detail==="archived-chat"&&rc.set(!0)};return l.$$set=Y=>{"initNewChat"in Y&&t(1,h=Y.initNewChat),"title"in Y&&t(15,d=Y.title),"shareEnabled"in Y&&t(2,_=Y.shareEnabled),"chat"in Y&&t(3,b=Y.chat),"selectedModels"in Y&&t(0,v=Y.selectedModels),"showModelSelector"in Y&&t(4,g=Y.showModelSelector)},[v,h,_,b,g,w,y,o,s,r,i,a,c,u,f,d,E,z,T,I,H,O,A,F,j]}class Fd extends Ve{constructor(e){super(),Ne(this,e,jd,Wd,Be,{initNewChat:1,title:15,shareEnabled:2,chat:3,selectedModels:0,showModelSelector:4})}}function Bt(l){if(typeof l=="string"||typeof l=="number")return""+l;let e="";if(Array.isArray(l))for(let t=0,n;t<l.length;t++)(n=Bt(l[t]))!==""&&(e+=(e&&" ")+n);else for(let t in l)l[t]&&(e+=(e&&" ")+t);return e}const Jl={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:l=>`Node type "${l}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:l=>`The old edge with id=${l} does not exist.`,error009:l=>`Marker type "${l}" doesn't exist.`,error008:(l,{id:e,sourceHandle:t,targetHandle:n})=>`Couldn't create edge for ${l} handle id: "${l==="source"?t:n}", edge id: ${e}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:l=>`Edge type "${l}" not found. Using fallback type "default".`,error012:l=>`Node with id "${l}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(l="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${l}/dist/style.css' or base.css to make sure everything is working properly.`},bo=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]];var wl;(function(l){l.Strict="strict",l.Loose="loose"})(wl||(wl={}));var Zn;(function(l){l.Free="free",l.Vertical="vertical",l.Horizontal="horizontal"})(Zn||(Zn={}));var vo;(function(l){l.Partial="partial",l.Full="full"})(vo||(vo={}));const $o={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null};var zl;(function(l){l.Bezier="default",l.Straight="straight",l.Step="step",l.SmoothStep="smoothstep",l.SimpleBezier="simplebezier"})(zl||(zl={}));var wo;(function(l){l.Arrow="arrow",l.ArrowClosed="arrowclosed"})(wo||(wo={}));var ot;(function(l){l.Left="left",l.Top="top",l.Right="right",l.Bottom="bottom"})(ot||(ot={}));const _r={[ot.Left]:ot.Right,[ot.Right]:ot.Left,[ot.Top]:ot.Bottom,[ot.Bottom]:ot.Top};function Yd(l,e){if(!l&&!e)return!0;if(!l||!e||l.size!==e.size)return!1;if(!l.size&&!e.size)return!0;for(const t of l.keys())if(!e.has(t))return!1;return!0}function pr(l,e,t){if(!t)return;const n=[];l.forEach((o,s)=>{e!=null&&e.has(s)||n.push(o)}),n.length&&t(n)}function br(l){return l===null?null:l?"valid":"invalid"}const Zd=l=>"id"in l&&"source"in l&&"target"in l,Xd=l=>"id"in l&&"position"in l&&!("source"in l)&&!("target"in l),is=l=>"id"in l&&"internals"in l&&!("source"in l)&&!("target"in l),zo=(l,e=[0,0])=>{const{width:t,height:n}=Ll(l),o=l.origin??e,s=t*o[0],r=n*o[1];return{x:l.position.x-s,y:l.position.y-r}},Kd=(l,e={nodeOrigin:[0,0],nodeLookup:void 0})=>{if(l.length===0)return{x:0,y:0,width:0,height:0};const t=l.reduce((n,o)=>{const s=typeof o=="string";let r=!e.nodeLookup&&!s?o:void 0;e.nodeLookup&&(r=s?e.nodeLookup.get(o):is(o)?o:e.nodeLookup.get(o.id));const i=r?yo(r,e.nodeOrigin):{x:0,y:0,x2:0,y2:0};return Oo(n,i)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return Ho(t)},Po=(l,e={})=>{if(l.size===0)return{x:0,y:0,width:0,height:0};let t={x:1/0,y:1/0,x2:-1/0,y2:-1/0};return l.forEach(n=>{if(e.filter===void 0||e.filter(n)){const o=yo(n);t=Oo(t,o)}}),Ho(t)},ta=(l,e,[t,n,o]=[0,0,1],s=!1,r=!1)=>{const i={...Ql(e,[t,n,o]),width:e.width/o,height:e.height/o},a=[];for(const c of l.values()){const{measured:u,selectable:f=!0,hidden:h=!1}=c;if(r&&!f||h)continue;const d=u.width??c.width??c.initialWidth??null,_=u.height??c.height??c.initialHeight??null,b=Zl(i,Bl(c)),v=(d??0)*(_??0),g=s&&b>0;(!c.internals.handleBounds||g||b>=v||c.dragging)&&a.push(c)}return a},es=(l,e)=>{const t=new Set;return l.forEach(n=>{t.add(n.id)}),e.filter(n=>t.has(n.source)||t.has(n.target))};function vr(l,e){const t=new Map,n=e!=null&&e.nodes?new Set(e.nodes.map(o=>o.id)):null;return l.forEach(o=>{o.measured.width&&o.measured.height&&((e==null?void 0:e.includeHiddenNodes)||!o.hidden)&&(!n||n.has(o.id))&&t.set(o.id,o)}),t}async function wr({nodes:l,width:e,height:t,panZoom:n,minZoom:o,maxZoom:s},r){if(l.size===0)return Promise.resolve(!1);const i=Po(l),a=cs(i,e,t,(r==null?void 0:r.minZoom)??o,(r==null?void 0:r.maxZoom)??s,(r==null?void 0:r.padding)??.1);return await n.setViewport(a,{duration:r==null?void 0:r.duration}),Promise.resolve(!0)}function qd({nodeId:l,nextPosition:e,nodeLookup:t,nodeOrigin:n=[0,0],nodeExtent:o,onError:s}){const r=t.get(l),i=r.parentId?t.get(r.parentId):void 0,{x:a,y:c}=i?i.internals.positionAbsolute:{x:0,y:0},u=r.origin??n;let f=o;if(r.extent==="parent"&&!r.expandParent)if(!i)s==null||s("005",Jl.error005());else{const d=i.measured.width,_=i.measured.height;d&&_&&(f=[[a,c],[a+d,c+_]])}else i&&Xl(r.extent)&&(f=[[r.extent[0][0]+a,r.extent[0][1]+c],[r.extent[1][0]+a,r.extent[1][1]+c]]);const h=Xl(f)?Hl(e,f,r.measured):e;return{position:{x:h.x-a+r.measured.width*u[0],y:h.y-c+r.measured.height*u[1]},positionAbsolute:h}}async function na({nodesToRemove:l=[],edgesToRemove:e=[],nodes:t,edges:n,onBeforeDelete:o}){const s=new Set(l.map(h=>h.id)),r=[];for(const h of t){if(h.deletable===!1)continue;const d=s.has(h.id),_=!d&&h.parentId&&r.find(b=>b.id===h.parentId);(d||_)&&r.push(h)}const i=new Set(e.map(h=>h.id)),a=n.filter(h=>h.deletable!==!1),u=es(r,a);for(const h of a)i.has(h.id)&&!u.find(_=>_.id===h.id)&&u.push(h);if(!o)return{edges:u,nodes:r};const f=await o({nodes:r,edges:u});return typeof f=="boolean"?f?{edges:u,nodes:r}:{edges:[],nodes:[]}:f}const Ol=(l,e=0,t=1)=>Math.min(Math.max(l,e),t),Hl=(l={x:0,y:0},e,t)=>({x:Ol(l.x,e[0][0],e[1][0]-((t==null?void 0:t.width)??0)),y:Ol(l.y,e[0][1],e[1][1]-((t==null?void 0:t.height)??0))});function la(l,e,t){const{width:n,height:o}=Ll(t),{x:s,y:r}=t.internals.positionAbsolute;return Hl(l,[[s,r],[s+n,r+o]],e)}const yr=(l,e,t)=>l<e?Ol(Math.abs(l-e),1,e)/e:l>t?-Ol(Math.abs(l-t),1,e)/e:0,oa=(l,e,t=15,n=40)=>{const o=yr(l.x,n,e.width-n)*t,s=yr(l.y,n,e.height-n)*t;return[o,s]},Oo=(l,e)=>({x:Math.min(l.x,e.x),y:Math.min(l.y,e.y),x2:Math.max(l.x2,e.x2),y2:Math.max(l.y2,e.y2)}),ts=({x:l,y:e,width:t,height:n})=>({x:l,y:e,x2:l+t,y2:e+n}),Ho=({x:l,y:e,x2:t,y2:n})=>({x:l,y:e,width:t-l,height:n-e}),Bl=(l,e=[0,0])=>{var o,s;const{x:t,y:n}=is(l)?l.internals.positionAbsolute:zo(l,e);return{x:t,y:n,width:((o=l.measured)==null?void 0:o.width)??l.width??l.initialWidth??0,height:((s=l.measured)==null?void 0:s.height)??l.height??l.initialHeight??0}},yo=(l,e=[0,0])=>{var o,s;const{x:t,y:n}=is(l)?l.internals.positionAbsolute:zo(l,e);return{x:t,y:n,x2:t+(((o=l.measured)==null?void 0:o.width)??l.width??l.initialWidth??0),y2:n+(((s=l.measured)==null?void 0:s.height)??l.height??l.initialHeight??0)}},Gd=(l,e)=>Ho(Oo(ts(l),ts(e))),Zl=(l,e)=>{const t=Math.max(0,Math.min(l.x+l.width,e.x+e.width)-Math.max(l.x,e.x)),n=Math.max(0,Math.min(l.y+l.height,e.y+e.height)-Math.max(l.y,e.y));return Math.ceil(t*n)},kr=l=>On(l.width)&&On(l.height)&&On(l.x)&&On(l.y),On=l=>!isNaN(l)&&isFinite(l),Jd=(l,e)=>{},as=(l,e=[1,1])=>({x:e[0]*Math.round(l.x/e[0]),y:e[1]*Math.round(l.y/e[1])}),Ql=({x:l,y:e},[t,n,o],s=!1,r=[1,1])=>{const i={x:(l-t)/o,y:(e-n)/o};return s?as(i,r):i},sa=({x:l,y:e},[t,n,o])=>({x:l*o+t,y:e*o+n}),cs=(l,e,t,n,o,s)=>{const r=e/(l.width*(1+s)),i=t/(l.height*(1+s)),a=Math.min(r,i),c=Ol(a,n,o),u=l.x+l.width/2,f=l.y+l.height/2,h=e/2-u*c,d=t/2-f*c;return{x:h,y:d,zoom:c}},ko=()=>{var l;return typeof navigator<"u"&&((l=navigator==null?void 0:navigator.userAgent)==null?void 0:l.indexOf("Mac"))>=0};function Xl(l){return l!==void 0&&l!=="parent"}function Ll(l){var e,t;return{width:((e=l.measured)==null?void 0:e.width)??l.width??l.initialWidth??0,height:((t=l.measured)==null?void 0:t.height)??l.height??l.initialHeight??0}}function Er(l){var e,t;return(((e=l.measured)==null?void 0:e.width)??l.width??l.initialWidth)!==void 0&&(((t=l.measured)==null?void 0:t.height)??l.height??l.initialHeight)!==void 0}function Qd(l,e={width:0,height:0},t,n,o){let s=t;const r={...l};for(;s;){const i=n.get(s);if(s=i==null?void 0:i.parentId,i){const a=i.origin||o;r.x+=i.internals.positionAbsolute.x-(e.width??0)*a[0],r.y+=i.internals.positionAbsolute.y-(e.height??0)*a[1]}}return r}function Zo(l,{snapGrid:e=[0,0],snapToGrid:t=!1,transform:n}){const{x:o,y:s}=Qn(l),r=Ql({x:o,y:s},n),{x:i,y:a}=t?as(r,e):r;return{xSnapped:i,ySnapped:a,...r}}const ra=l=>({width:l.offsetWidth,height:l.offsetHeight}),xd=l=>{var e;return((e=l.getRootNode)==null?void 0:e.call(l))||(window==null?void 0:window.document)},$d=["INPUT","SELECT","TEXTAREA"];function eh(l){var n,o;const e=((o=(n=l.composedPath)==null?void 0:n.call(l))==null?void 0:o[0])||l.target;return $d.includes(e==null?void 0:e.nodeName)||(e==null?void 0:e.hasAttribute("contenteditable"))||!!(e!=null&&e.closest(".nokey"))}const ia=l=>"clientX"in l,Qn=(l,e)=>{var s,r;const t=ia(l),n=t?l.clientX:(s=l.touches)==null?void 0:s[0].clientX,o=t?l.clientY:(r=l.touches)==null?void 0:r[0].clientY;return{x:n-((e==null?void 0:e.left)??0),y:o-((e==null?void 0:e.top)??0)}},Ir=(l,e,t,n,o)=>{const s=e.querySelectorAll(`.${l}`);return!s||!s.length?null:Array.from(s).map(r=>{const i=r.getBoundingClientRect();return{id:r.getAttribute("data-handleid"),type:l,nodeId:o,position:r.getAttribute("data-handlepos"),x:(i.left-t.left)/n,y:(i.top-t.top)/n,...ra(r)}})};function th({sourceX:l,sourceY:e,targetX:t,targetY:n,sourceControlX:o,sourceControlY:s,targetControlX:r,targetControlY:i}){const a=l*.125+o*.375+r*.375+t*.125,c=e*.125+s*.375+i*.375+n*.125,u=Math.abs(a-l),f=Math.abs(c-e);return[a,c,u,f]}function io(l,e){return l>=0?.5*l:e*25*Math.sqrt(-l)}function Sr({pos:l,x1:e,y1:t,x2:n,y2:o,c:s}){switch(l){case ot.Left:return[e-io(e-n,s),t];case ot.Right:return[e+io(n-e,s),t];case ot.Top:return[e,t-io(t-o,s)];case ot.Bottom:return[e,t+io(o-t,s)]}}function aa({sourceX:l,sourceY:e,sourcePosition:t=ot.Bottom,targetX:n,targetY:o,targetPosition:s=ot.Top,curvature:r=.25}){const[i,a]=Sr({pos:t,x1:l,y1:e,x2:n,y2:o,c:r}),[c,u]=Sr({pos:s,x1:n,y1:o,x2:l,y2:e,c:r}),[f,h,d,_]=th({sourceX:l,sourceY:e,targetX:n,targetY:o,sourceControlX:i,sourceControlY:a,targetControlX:c,targetControlY:u});return[`M${l},${e} C${i},${a} ${c},${u} ${n},${o}`,f,h,d,_]}function ca({sourceX:l,sourceY:e,targetX:t,targetY:n}){const o=Math.abs(t-l)/2,s=t<l?t+o:t-o,r=Math.abs(n-e)/2,i=n<e?n+r:n-r;return[s,i,o,r]}function nh({sourceNode:l,targetNode:e,selected:t=!1,zIndex:n=0,elevateOnSelect:o=!1}){if(!o)return n;const s=t||e.selected||l.selected,r=Math.max(l.internals.z||0,e.internals.z||0,1e3);return n+(s?r:0)}function lh({sourceNode:l,targetNode:e,width:t,height:n,transform:o}){const s=Oo(yo(l),yo(e));s.x===s.x2&&(s.x2+=1),s.y===s.y2&&(s.y2+=1);const r={x:-o[0]/o[2],y:-o[1]/o[2],width:t/o[2],height:n/o[2]};return Zl(r,Ho(s))>0}const oh=({source:l,sourceHandle:e,target:t,targetHandle:n})=>`xy-edge__${l}${e||""}-${t}${n||""}`,sh=(l,e)=>e.some(t=>t.source===l.source&&t.target===l.target&&(t.sourceHandle===l.sourceHandle||!t.sourceHandle&&!l.sourceHandle)&&(t.targetHandle===l.targetHandle||!t.targetHandle&&!l.targetHandle)),rh=(l,e)=>{if(!l.source||!l.target)return e;let t;return Zd(l)?t={...l}:t={...l,id:oh(l)},sh(t,e)?e:(t.sourceHandle===null&&delete t.sourceHandle,t.targetHandle===null&&delete t.targetHandle,e.concat(t))};function ua({sourceX:l,sourceY:e,targetX:t,targetY:n}){const[o,s,r,i]=ca({sourceX:l,sourceY:e,targetX:t,targetY:n});return[`M ${l},${e}L ${t},${n}`,o,s,r,i]}const Dr={[ot.Left]:{x:-1,y:0},[ot.Right]:{x:1,y:0},[ot.Top]:{x:0,y:-1},[ot.Bottom]:{x:0,y:1}},ih=({source:l,sourcePosition:e=ot.Bottom,target:t})=>e===ot.Left||e===ot.Right?l.x<t.x?{x:1,y:0}:{x:-1,y:0}:l.y<t.y?{x:0,y:1}:{x:0,y:-1},Cr=(l,e)=>Math.sqrt(Math.pow(e.x-l.x,2)+Math.pow(e.y-l.y,2));function ah({source:l,sourcePosition:e=ot.Bottom,target:t,targetPosition:n=ot.Top,center:o,offset:s}){const r=Dr[e],i=Dr[n],a={x:l.x+r.x*s,y:l.y+r.y*s},c={x:t.x+i.x*s,y:t.y+i.y*s},u=ih({source:a,sourcePosition:e,target:c}),f=u.x!==0?"x":"y",h=u[f];let d=[],_,b;const v={x:0,y:0},g={x:0,y:0},[w,y,E,z]=ca({sourceX:l.x,sourceY:l.y,targetX:t.x,targetY:t.y});if(r[f]*i[f]===-1){_=o.x??w,b=o.y??y;const I=[{x:_,y:a.y},{x:_,y:c.y}],H=[{x:a.x,y:b},{x:c.x,y:b}];r[f]===h?d=f==="x"?I:H:d=f==="x"?H:I}else{const I=[{x:a.x,y:c.y}],H=[{x:c.x,y:a.y}];if(f==="x"?d=r.x===h?H:I:d=r.y===h?I:H,e===n){const Y=Math.abs(l[f]-t[f]);if(Y<=s){const M=Math.min(s-1,s-Y);r[f]===h?v[f]=(a[f]>l[f]?-1:1)*M:g[f]=(c[f]>t[f]?-1:1)*M}}if(e!==n){const Y=f==="x"?"y":"x",M=r[f]===i[Y],K=a[Y]>c[Y],D=a[Y]<c[Y];(r[f]===1&&(!M&&K||M&&D)||r[f]!==1&&(!M&&D||M&&K))&&(d=f==="x"?I:H)}const O={x:a.x+v.x,y:a.y+v.y},A={x:c.x+g.x,y:c.y+g.y},F=Math.max(Math.abs(O.x-d[0].x),Math.abs(A.x-d[0].x)),j=Math.max(Math.abs(O.y-d[0].y),Math.abs(A.y-d[0].y));F>=j?(_=(O.x+A.x)/2,b=d[0].y):(_=d[0].x,b=(O.y+A.y)/2)}return[[l,{x:a.x+v.x,y:a.y+v.y},...d,{x:c.x+g.x,y:c.y+g.y},t],_,b,E,z]}function ch(l,e,t,n){const o=Math.min(Cr(l,e)/2,Cr(e,t)/2,n),{x:s,y:r}=e;if(l.x===s&&s===t.x||l.y===r&&r===t.y)return`L${s} ${r}`;if(l.y===r){const c=l.x<t.x?-1:1,u=l.y<t.y?1:-1;return`L ${s+o*c},${r}Q ${s},${r} ${s},${r+o*u}`}const i=l.x<t.x?1:-1,a=l.y<t.y?-1:1;return`L ${s},${r+o*a}Q ${s},${r} ${s+o*i},${r}`}function Eo({sourceX:l,sourceY:e,sourcePosition:t=ot.Bottom,targetX:n,targetY:o,targetPosition:s=ot.Top,borderRadius:r=5,centerX:i,centerY:a,offset:c=20}){const[u,f,h,d,_]=ah({source:{x:l,y:e},sourcePosition:t,target:{x:n,y:o},targetPosition:s,center:{x:i,y:a},offset:c});return[u.reduce((v,g,w)=>{let y="";return w>0&&w<u.length-1?y=ch(u[w-1],g,u[w+1],r):y=`${w===0?"M":"L"}${g.x} ${g.y}`,v+=y,v},""),f,h,d,_]}function Mr(l){var e;return l&&!!(l.internals.handleBounds||(e=l.handles)!=null&&e.length)&&!!(l.measured.width||l.width||l.initialWidth)}function uh(l){var f;const{sourceNode:e,targetNode:t}=l;if(!Mr(e)||!Mr(t))return null;const n=e.internals.handleBounds||Tr(e.handles),o=t.internals.handleBounds||Tr(t.handles),s=Vr((n==null?void 0:n.source)??[],l.sourceHandle),r=Vr(l.connectionMode===wl.Strict?(o==null?void 0:o.target)??[]:((o==null?void 0:o.target)??[]).concat((o==null?void 0:o.source)??[]),l.targetHandle);if(!s||!r)return(f=l.onError)==null||f.call(l,"008",Jl.error008(s?"target":"source",{id:l.id,sourceHandle:l.sourceHandle,targetHandle:l.targetHandle})),null;const i=(s==null?void 0:s.position)||ot.Bottom,a=(r==null?void 0:r.position)||ot.Top,c=Kl(e,s,i),u=Kl(t,r,a);return{sourceX:c.x,sourceY:c.y,targetX:u.x,targetY:u.y,sourcePosition:i,targetPosition:a}}function Tr(l){if(!l)return null;const e=[],t=[];for(const n of l)n.width=n.width??1,n.height=n.height??1,n.type==="source"?e.push(n):n.type==="target"&&t.push(n);return{source:e,target:t}}function Kl(l,e,t=ot.Left,n=!1){const o=((e==null?void 0:e.x)??0)+l.internals.positionAbsolute.x,s=((e==null?void 0:e.y)??0)+l.internals.positionAbsolute.y,{width:r,height:i}=e??Ll(l);if(n)return{x:o+r/2,y:s+i/2};switch((e==null?void 0:e.position)??t){case ot.Top:return{x:o+r/2,y:s};case ot.Right:return{x:o+r,y:s+i/2};case ot.Bottom:return{x:o+r/2,y:s+i};case ot.Left:return{x:o,y:s+i/2}}}function Vr(l,e){return l&&(e?l.find(t=>t.id===e):l[0])||null}function ns(l,e){return l?typeof l=="string"?l:`${e?`${e}__`:""}${Object.keys(l).sort().map(n=>`${n}=${l[n]}`).join("&")}`:""}function fh(l,{id:e,defaultColor:t,defaultMarkerStart:n,defaultMarkerEnd:o}){const s=new Set;return l.reduce((r,i)=>([i.markerStart||n,i.markerEnd||o].forEach(a=>{if(a&&typeof a=="object"){const c=ns(a,e);s.has(c)||(r.push({id:c,color:a.color||t,...a}),s.add(c))}}),r),[]).sort((r,i)=>r.id.localeCompare(i.id))}const fa={nodeOrigin:[0,0],nodeExtent:bo,elevateNodesOnSelect:!0,defaults:{}},dh={...fa,checkEquality:!0};function da(l,e){const t={...l};for(const n in e)e[n]!==void 0&&(t[n]=e[n]);return t}function ha(l,e,t,n){var i,a;const o=da(dh,n),s=new Map(e),r=o!=null&&o.elevateNodesOnSelect?1e3:0;e.clear(),t.clear();for(const c of l){let u=s.get(c.id);if(o.checkEquality&&c===(u==null?void 0:u.internals.userNode))e.set(c.id,u);else{const f=zo(c,o.nodeOrigin),h=Xl(c.extent)?c.extent:o.nodeExtent,d=Hl(f,h,Ll(c));u={...o.defaults,...c,measured:{width:(i=c.measured)==null?void 0:i.width,height:(a=c.measured)==null?void 0:a.height},internals:{positionAbsolute:d,handleBounds:c.measured?u==null?void 0:u.internals.handleBounds:void 0,z:ga(c,r),userNode:c}},e.set(c.id,u)}c.parentId&&ma(u,e,t,n)}}function hh(l,e){if(!l.parentId)return;const t=e.get(l.parentId);t?t.set(l.id,l):e.set(l.parentId,new Map([[l.id,l]]))}function ma(l,e,t,n){const{elevateNodesOnSelect:o,nodeOrigin:s,nodeExtent:r}=da(fa,n),i=l.parentId,a=e.get(i);if(!a){console.warn(`Parent node ${i} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}hh(l,t);const c=o?1e3:0,{x:u,y:f,z:h}=mh(l,a,s,r,c),{positionAbsolute:d}=l.internals,_=u!==d.x||f!==d.y;(_||h!==l.internals.z)&&(l.internals={...l.internals,positionAbsolute:_?{x:u,y:f}:d,z:h})}function ga(l,e){return(On(l.zIndex)?l.zIndex:0)+(l.selected?e:0)}function mh(l,e,t,n,o){const{x:s,y:r}=e.internals.positionAbsolute,i=Ll(l),a=zo(l,t),c=Xl(l.extent)?Hl(a,l.extent,i):a;let u=Hl({x:s+c.x,y:r+c.y},n,i);l.extent==="parent"&&(u=la(u,i,e));const f=ga(l,o),h=e.internals.z??0;return{x:u.x,y:u.y,z:h>f?h:f}}function gh(l,e,t,n=[0,0]){var r;const o=[],s=new Map;for(const i of l){const a=e.get(i.parentId);if(!a)continue;const c=((r=s.get(i.parentId))==null?void 0:r.expandedRect)??Bl(a),u=Gd(c,i.rect);s.set(i.parentId,{expandedRect:u,parent:a})}return s.size>0&&s.forEach(({expandedRect:i,parent:a},c)=>{var y;const u=a.internals.positionAbsolute,f=Ll(a),h=a.origin??n,d=i.x<u.x?Math.round(Math.abs(u.x-i.x)):0,_=i.y<u.y?Math.round(Math.abs(u.y-i.y)):0,b=Math.max(f.width,Math.round(i.width)),v=Math.max(f.height,Math.round(i.height)),g=(b-f.width)*h[0],w=(v-f.height)*h[1];(d>0||_>0||g||w)&&(o.push({id:c,type:"position",position:{x:a.position.x-d+g,y:a.position.y-_+w}}),(y=t.get(c))==null||y.forEach(E=>{l.some(z=>z.id===E.id)||o.push({id:E.id,type:"position",position:{x:E.position.x+d,y:E.position.y+_}})})),(f.width<i.width||f.height<i.height||d||_)&&o.push({id:c,type:"dimensions",setAttributes:!0,dimensions:{width:b+(d?h[0]*d-g:0),height:v+(_?h[1]*_-w:0)}})}),o}function _h(l,e,t,n,o,s){const r=n==null?void 0:n.querySelector(".xyflow__viewport");let i=!1;if(!r)return{changes:[],updatedInternals:i};const a=[],c=window.getComputedStyle(r),{m22:u}=new window.DOMMatrixReadOnly(c.transform),f=[];for(const h of l.values()){const d=e.get(h.id);if(d)if(d.hidden)d.internals={...d.internals,handleBounds:void 0},i=!0;else{const _=ra(h.nodeElement),b=d.measured.width!==_.width||d.measured.height!==_.height;if(!!(_.width&&_.height&&(b||!d.internals.handleBounds||h.force))){const g=h.nodeElement.getBoundingClientRect(),w=Xl(d.extent)?d.extent:s;let{positionAbsolute:y}=d.internals;d.parentId&&d.extent==="parent"?y=la(y,_,e.get(d.parentId)):w&&(y=Hl(y,w,_)),d.measured=_,d.internals={...d.internals,positionAbsolute:y,handleBounds:{source:Ir("source",h.nodeElement,g,u,d.id),target:Ir("target",h.nodeElement,g,u,d.id)}},d.parentId&&ma(d,e,t,{nodeOrigin:o}),i=!0,b&&(a.push({id:d.id,type:"dimensions",dimensions:_}),d.expandParent&&d.parentId&&f.push({id:d.id,parentId:d.parentId,rect:Bl(d,o)}))}}}if(f.length>0){const h=gh(f,e,t,o);a.push(...h)}return{changes:a,updatedInternals:i}}async function ph({delta:l,panZoom:e,transform:t,translateExtent:n,width:o,height:s}){if(!e||!l.x&&!l.y)return Promise.resolve(!1);const r=await e.setViewportConstrained({x:t[0]+l.x,y:t[1]+l.y,zoom:t[2]},[[0,0],[o,s]],n),i=!!r&&(r.x!==t[0]||r.y!==t[1]||r.k!==t[2]);return Promise.resolve(i)}function _a(l,e,t){l.clear(),e.clear();for(const n of t){const{source:o,target:s,sourceHandle:r=null,targetHandle:i=null}=n,a=`${o}-source-${r}`,c=`${s}-target-${i}`,u=l.get(a)||new Map,f=l.get(c)||new Map,h={edgeId:n.id,source:o,target:s,sourceHandle:r,targetHandle:i};e.set(n.id,n),l.set(a,u.set(`${s}-${i}`,h)),l.set(c,f.set(`${o}-${r}`,h))}}function pa(l,e){if(!l.parentId)return!1;const t=e.get(l.parentId);return t?t.selected?!0:pa(t,e):!1}function Nr(l,e,t){let n=l;do{if(n!=null&&n.matches(e))return!0;if(n===t)return!1;n=n.parentElement}while(n);return!1}function bh(l,e,t,n){const o=new Map;for(const[s,r]of l)if((r.selected||r.id===n)&&(!r.parentId||!pa(r,l))&&(r.draggable||e&&typeof r.draggable>"u")){const i=l.get(s);i&&o.set(s,{id:s,position:i.position||{x:0,y:0},distance:{x:t.x-i.internals.positionAbsolute.x,y:t.y-i.internals.positionAbsolute.y},extent:i.extent,parentId:i.parentId,origin:i.origin,expandParent:i.expandParent,internals:{positionAbsolute:i.internals.positionAbsolute||{x:0,y:0}},measured:{width:i.measured.width??0,height:i.measured.height??0}})}return o}function Xo({nodeId:l,dragItems:e,nodeLookup:t,dragging:n=!0}){var r,i;const o=[];for(const[a,c]of e){const u=(r=t.get(a))==null?void 0:r.internals.userNode;u&&o.push({...u,position:c.position,dragging:n})}if(!l)return[o[0],o];const s=t.get(l).internals.userNode;return[{...s,position:((i=e.get(l))==null?void 0:i.position)||s.position,dragging:n},o]}function vh({onNodeMouseDown:l,getStoreItems:e,onDragStart:t,onDrag:n,onDragStop:o}){let s={x:null,y:null},r=0,i=new Map,a=!1,c={x:0,y:0},u=null,f=!1,h=null,d=!1;function _({noDragClassName:v,handleSelector:g,domNode:w,isSelectable:y,nodeId:E,nodeClickDistance:z=0}){h=Pn(w);function T({x:A,y:F},j){const{nodeLookup:Y,nodeExtent:M,snapGrid:K,snapToGrid:D,nodeOrigin:W,onNodeDrag:L,onSelectionDrag:R,onError:X,updateNodePositions:Q}=e();s={x:A,y:F};let G=!1,ce={x:0,y:0,x2:0,y2:0};if(i.size>1&&M){const se=Po(i);ce=ts(se)}for(const[se,ye]of i){let Se={x:A-ye.distance.x,y:F-ye.distance.y};D&&(Se=as(Se,K));let re=[[M[0][0],M[0][1]],[M[1][0],M[1][1]]];if(i.size>1&&M&&!ye.extent){const{positionAbsolute:ae}=ye.internals,Ie=ae.x-ce.x+M[0][0],ge=ae.x+ye.measured.width-ce.x2+M[1][0],_t=ae.y-ce.y+M[0][1],me=ae.y+ye.measured.height-ce.y2+M[1][1];re=[[Ie,_t],[ge,me]]}const{position:q,positionAbsolute:Ee}=qd({nodeId:se,nextPosition:Se,nodeLookup:Y,nodeExtent:re,nodeOrigin:W,onError:X});G=G||ye.position.x!==q.x||ye.position.y!==q.y,ye.position=q,ye.internals.positionAbsolute=Ee}if(G&&(Q(i,!0),j&&(n||L||!E&&R))){const[se,ye]=Xo({nodeId:E,dragItems:i,nodeLookup:Y});n==null||n(j,i,se,ye),L==null||L(j,se,ye),E||R==null||R(j,ye)}}async function I(){if(!u)return;const{transform:A,panBy:F,autoPanSpeed:j}=e(),[Y,M]=oa(c,u,j);(Y!==0||M!==0)&&(s.x=(s.x??0)-Y/A[2],s.y=(s.y??0)-M/A[2],await F({x:Y,y:M})&&T(s,null)),r=requestAnimationFrame(I)}function H(A){var G;const{nodeLookup:F,multiSelectionActive:j,nodesDraggable:Y,transform:M,snapGrid:K,snapToGrid:D,selectNodesOnDrag:W,onNodeDragStart:L,onSelectionDragStart:R,unselectNodesAndEdges:X}=e();f=!0,(!W||!y)&&!j&&E&&((G=F.get(E))!=null&&G.selected||X()),y&&W&&E&&(l==null||l(E));const Q=Zo(A.sourceEvent,{transform:M,snapGrid:K,snapToGrid:D});if(s=Q,i=bh(F,Y,Q,E),i.size>0&&(t||L||!E&&R)){const[ce,se]=Xo({nodeId:E,dragItems:i,nodeLookup:F});t==null||t(A.sourceEvent,i,ce,se),L==null||L(A.sourceEvent,ce,se),E||R==null||R(A.sourceEvent,se)}}const O=bu().clickDistance(z).on("start",A=>{const{domNode:F,nodeDragThreshold:j,transform:Y,snapGrid:M,snapToGrid:K}=e();d=!1,j===0&&H(A),s=Zo(A.sourceEvent,{transform:Y,snapGrid:M,snapToGrid:K}),u=(F==null?void 0:F.getBoundingClientRect())||null,c=Qn(A.sourceEvent,u)}).on("drag",A=>{const{autoPanOnNodeDrag:F,transform:j,snapGrid:Y,snapToGrid:M,nodeDragThreshold:K}=e(),D=Zo(A.sourceEvent,{transform:j,snapGrid:Y,snapToGrid:M});if(A.sourceEvent.type==="touchmove"&&A.sourceEvent.touches.length>1&&(d=!0),!d){if(!a&&F&&f&&(a=!0,I()),!f){const W=D.xSnapped-(s.x??0),L=D.ySnapped-(s.y??0);Math.sqrt(W*W+L*L)>K&&H(A)}(s.x!==D.xSnapped||s.y!==D.ySnapped)&&i&&f&&(c=Qn(A.sourceEvent,u),T(D,A.sourceEvent))}}).on("end",A=>{if(!(!f||d)&&(a=!1,f=!1,cancelAnimationFrame(r),i.size>0)){const{nodeLookup:F,updateNodePositions:j,onNodeDragStop:Y,onSelectionDragStop:M}=e();if(j(i,!1),o||Y||!E&&M){const[K,D]=Xo({nodeId:E,dragItems:i,nodeLookup:F,dragging:!1});o==null||o(A.sourceEvent,i,K,D),Y==null||Y(A.sourceEvent,K,D),E||M==null||M(A.sourceEvent,D)}}}).filter(A=>{const F=A.target;return!A.button&&(!v||!Nr(F,`.${v}`,w))&&(!g||Nr(F,g,w))});h.call(O)}function b(){h==null||h.on(".drag",null)}return{update:_,destroy:b}}function wh(l,e,t){const n=[],o={x:l.x-t,y:l.y-t,width:t*2,height:t*2};for(const s of e.values())Zl(o,Bl(s))>0&&n.push(s);return n}const yh=250;function kh(l,e,t,n){var i,a;let o=[],s=1/0;const r=wh(l,t,e+yh);for(const c of r){const u=[...((i=c.internals.handleBounds)==null?void 0:i.source)??[],...((a=c.internals.handleBounds)==null?void 0:a.target)??[]];for(const f of u){if(n.nodeId===f.nodeId&&n.type===f.type&&n.id===f.id)continue;const{x:h,y:d}=Kl(c,f,f.position,!0),_=Math.sqrt(Math.pow(h-l.x,2)+Math.pow(d-l.y,2));_>e||(_<s?(o=[{...f,x:h,y:d}],s=_):_===s&&o.push({...f,x:h,y:d}))}}if(!o.length)return null;if(o.length>1){const c=n.type==="source"?"target":"source";return o.find(u=>u.type===c)??o[0]}return o[0]}function ba(l,e,t,n,o,s=!1){var c,u,f;const r=n.get(l);if(!r)return null;const i=o==="strict"?(c=r.internals.handleBounds)==null?void 0:c[e]:[...((u=r.internals.handleBounds)==null?void 0:u.source)??[],...((f=r.internals.handleBounds)==null?void 0:f.target)??[]],a=(t?i==null?void 0:i.find(h=>h.id===t):i==null?void 0:i[0])??null;return a&&s?{...a,...Kl(r,a,a.position,!0)}:a}function va(l,e){return l||(e!=null&&e.classList.contains("target")?"target":e!=null&&e.classList.contains("source")?"source":null)}function Eh(l,e){let t=null;return e?t=!0:l&&!e&&(t=!1),t}const wa=()=>!0;function Ih(l,{connectionMode:e,connectionRadius:t,handleId:n,nodeId:o,edgeUpdaterType:s,isTarget:r,domNode:i,nodeLookup:a,lib:c,autoPanOnConnect:u,flowId:f,panBy:h,cancelConnection:d,onConnectStart:_,onConnect:b,onConnectEnd:v,isValidConnection:g=wa,onReconnectEnd:w,updateConnection:y,getTransform:E,getFromHandle:z,autoPanSpeed:T}){const I=xd(l.target);let H=0,O;const{x:A,y:F}=Qn(l),j=I==null?void 0:I.elementFromPoint(A,F),Y=va(s,j),M=i==null?void 0:i.getBoundingClientRect();if(!M||!Y)return;const K=ba(o,Y,n,a,e);if(!K)return;let D=Qn(l,M),W=!1,L=null,R=!1,X=null;function Q(){if(!u||!M)return;const[Ee,ae]=oa(D,M,T);h({x:Ee,y:ae}),H=requestAnimationFrame(Q)}const G={...K,nodeId:o,type:Y,position:K.position},ce=a.get(o),ye={inProgress:!0,isValid:null,from:Kl(ce,G,ot.Left,!0),fromHandle:G,fromPosition:G.position,fromNode:ce,to:D,toHandle:null,toPosition:_r[G.position],toNode:null};y(ye);let Se=ye;_==null||_(l,{nodeId:o,handleId:n,handleType:Y});function re(Ee){if(!z()||!G){q(Ee);return}const ae=E();D=Qn(Ee,M),O=kh(Ql(D,ae,!1,[1,1]),t,a,G),W||(Q(),W=!0);const Ie=ya(Ee,{handle:O,connectionMode:e,fromNodeId:o,fromHandleId:n,fromType:r?"target":"source",isValidConnection:g,doc:I,lib:c,flowId:f,nodeLookup:a});X=Ie.handleDomNode,L=Ie.connection,R=Eh(!!O,Ie.isValid);const ge={...Se,isValid:R,to:O&&R?sa({x:O.x,y:O.y},ae):D,toHandle:Ie.toHandle,toPosition:R&&Ie.toHandle?Ie.toHandle.position:_r[G.position],toNode:Ie.toHandle?a.get(Ie.toHandle.nodeId):null};R&&O&&Se.toHandle&&ge.toHandle&&Se.toHandle.type===ge.toHandle.type&&Se.toHandle.nodeId===ge.toHandle.nodeId&&Se.toHandle.id===ge.toHandle.id&&Se.to.x===ge.to.x&&Se.to.y===ge.to.y||(y(ge),Se=ge)}function q(Ee){(O||X)&&L&&R&&(b==null||b(L));const{inProgress:ae,...Ie}=Se,ge={...Ie,toPosition:Se.toHandle?Se.toPosition:null};v==null||v(Ee,ge),s&&(w==null||w(Ee,ge)),d(),cancelAnimationFrame(H),W=!1,R=!1,L=null,X=null,I.removeEventListener("mousemove",re),I.removeEventListener("mouseup",q),I.removeEventListener("touchmove",re),I.removeEventListener("touchend",q)}I.addEventListener("mousemove",re),I.addEventListener("mouseup",q),I.addEventListener("touchmove",re),I.addEventListener("touchend",q)}function ya(l,{handle:e,connectionMode:t,fromNodeId:n,fromHandleId:o,fromType:s,doc:r,lib:i,flowId:a,isValidConnection:c=wa,nodeLookup:u}){const f=s==="target",h=e?r.querySelector(`.${i}-flow__handle[data-id="${a}-${e==null?void 0:e.nodeId}-${e==null?void 0:e.id}-${e==null?void 0:e.type}"]`):null,{x:d,y:_}=Qn(l),b=r.elementFromPoint(d,_),v=b!=null&&b.classList.contains(`${i}-flow__handle`)?b:h,g={handleDomNode:v,isValid:!1,connection:null,toHandle:null};if(v){const w=va(void 0,v),y=v.getAttribute("data-nodeid"),E=v.getAttribute("data-handleid"),z=v.classList.contains("connectable"),T=v.classList.contains("connectableend");if(!y||!w)return g;const I={source:f?y:n,sourceHandle:f?E:o,target:f?n:y,targetHandle:f?o:E};g.connection=I;const O=z&&T&&(t===wl.Strict?f&&w==="source"||!f&&w==="target":y!==n||E!==o);g.isValid=O&&c(I),g.toHandle=ba(y,w,E,u,t,!1)}return g}const Sh={onPointerDown:Ih,isValid:ya},Dh=(l,e)=>l.x!==e.x||l.y!==e.y||l.zoom!==e.k,Bo=l=>({x:l.x,y:l.y,zoom:l.k}),Ko=({x:l,y:e,zoom:t})=>ls.translate(l,e).scale(t),Tl=(l,e)=>l.target.closest(`.${e}`),ka=(l,e)=>e===2&&Array.isArray(l)&&l.includes(2),qo=(l,e=0,t=()=>{})=>{const n=typeof e=="number"&&e>0;return n||t(),n?l.transition().duration(e).on("end",t):l},Ea=l=>{const e=l.ctrlKey&&ko()?10:1;return-l.deltaY*(l.deltaMode===1?.05:l.deltaMode?1:.002)*e};function Ch({zoomPanValues:l,noWheelClassName:e,d3Selection:t,d3Zoom:n,panOnScrollMode:o,panOnScrollSpeed:s,zoomOnPinch:r,onPanZoomStart:i,onPanZoom:a,onPanZoomEnd:c}){return u=>{if(Tl(u,e))return!1;u.preventDefault(),u.stopImmediatePropagation();const f=t.property("__zoom").k||1;if(u.ctrlKey&&r){const v=Fn(u),g=Ea(u),w=f*Math.pow(2,g);n.scaleTo(t,w,v,u);return}const h=u.deltaMode===1?20:1;let d=o===Zn.Vertical?0:u.deltaX*h,_=o===Zn.Horizontal?0:u.deltaY*h;!ko()&&u.shiftKey&&o!==Zn.Vertical&&(d=u.deltaY*h,_=0),n.translateBy(t,-(d/f)*s,-(_/f)*s,{internal:!0});const b=Bo(t.property("__zoom"));clearTimeout(l.panScrollTimeout),l.isPanScrolling||(l.isPanScrolling=!0,i==null||i(u,b)),l.isPanScrolling&&(a==null||a(u,b),l.panScrollTimeout=setTimeout(()=>{c==null||c(u,b),l.isPanScrolling=!1},150))}}function Mh({noWheelClassName:l,preventScrolling:e,d3ZoomHandler:t}){return function(n,o){if(!e&&n.type==="wheel"&&!n.ctrlKey||Tl(n,l))return null;n.preventDefault(),t.call(this,n,o)}}function Th({zoomPanValues:l,onDraggingChange:e,onPanZoomStart:t}){return n=>{var s,r,i;if((s=n.sourceEvent)!=null&&s.internal)return;const o=Bo(n.transform);l.mouseButton=((r=n.sourceEvent)==null?void 0:r.button)||0,l.isZoomingOrPanning=!0,l.prevViewport=o,((i=n.sourceEvent)==null?void 0:i.type)==="mousedown"&&e(!0),t&&(t==null||t(n.sourceEvent,o))}}function Vh({zoomPanValues:l,panOnDrag:e,onPaneContextMenu:t,onTransformChange:n,onPanZoom:o}){return s=>{var r,i;l.usedRightMouseButton=!!(t&&ka(e,l.mouseButton??0)),(r=s.sourceEvent)!=null&&r.sync||n([s.transform.x,s.transform.y,s.transform.k]),o&&!((i=s.sourceEvent)!=null&&i.internal)&&(o==null||o(s.sourceEvent,Bo(s.transform)))}}function Nh({zoomPanValues:l,panOnDrag:e,panOnScroll:t,onDraggingChange:n,onPanZoomEnd:o,onPaneContextMenu:s}){return r=>{var i;if(!((i=r.sourceEvent)!=null&&i.internal)&&(l.isZoomingOrPanning=!1,s&&ka(e,l.mouseButton??0)&&!l.usedRightMouseButton&&r.sourceEvent&&s(r.sourceEvent),l.usedRightMouseButton=!1,n(!1),o&&Dh(l.prevViewport,r.transform))){const a=Bo(r.transform);l.prevViewport=a,clearTimeout(l.timerId),l.timerId=setTimeout(()=>{o==null||o(r.sourceEvent,a)},t?150:0)}}}function zh({zoomActivationKeyPressed:l,zoomOnScroll:e,zoomOnPinch:t,panOnDrag:n,panOnScroll:o,zoomOnDoubleClick:s,userSelectionActive:r,noWheelClassName:i,noPanClassName:a,lib:c}){return u=>{var _;const f=l||e,h=t&&u.ctrlKey;if(u.button===1&&u.type==="mousedown"&&(Tl(u,`${c}-flow__node`)||Tl(u,`${c}-flow__edge`)))return!0;if(!n&&!f&&!o&&!s&&!t||r||Tl(u,i)&&u.type==="wheel"||Tl(u,a)&&(u.type!=="wheel"||o&&u.type==="wheel"&&!l)||!t&&u.ctrlKey&&u.type==="wheel")return!1;if(!t&&u.type==="touchstart"&&((_=u.touches)==null?void 0:_.length)>1)return u.preventDefault(),!1;if(!f&&!o&&!h&&u.type==="wheel"||!n&&(u.type==="mousedown"||u.type==="touchstart")||Array.isArray(n)&&!n.includes(u.button)&&u.type==="mousedown")return!1;const d=Array.isArray(n)&&n.includes(u.button)||!u.button||u.button<=1;return(!u.ctrlKey||u.type==="wheel")&&d}}function Ph({domNode:l,minZoom:e,maxZoom:t,paneClickDistance:n,translateExtent:o,viewport:s,onPanZoom:r,onPanZoomStart:i,onPanZoomEnd:a,onDraggingChange:c}){const u={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{x:0,y:0,zoom:0},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},f=l.getBoundingClientRect(),h=Tu().clickDistance(!On(n)||n<0?0:n).scaleExtent([e,t]).translateExtent(o),d=Pn(l).call(h);y({x:s.x,y:s.y,zoom:Ol(s.zoom,e,t)},[[0,0],[f.width,f.height]],o);const _=d.on("wheel.zoom"),b=d.on("dblclick.zoom");h.wheelDelta(Ea);function v(j,Y){return d?new Promise(M=>{h==null||h.transform(qo(d,Y==null?void 0:Y.duration,()=>M(!0)),j)}):Promise.resolve(!1)}function g({noWheelClassName:j,noPanClassName:Y,onPaneContextMenu:M,userSelectionActive:K,panOnScroll:D,panOnDrag:W,panOnScrollMode:L,panOnScrollSpeed:R,preventScrolling:X,zoomOnPinch:Q,zoomOnScroll:G,zoomOnDoubleClick:ce,zoomActivationKeyPressed:se,lib:ye,onTransformChange:Se}){K&&!u.isZoomingOrPanning&&w();const q=D&&!se&&!K?Ch({zoomPanValues:u,noWheelClassName:j,d3Selection:d,d3Zoom:h,panOnScrollMode:L,panOnScrollSpeed:R,zoomOnPinch:Q,onPanZoomStart:i,onPanZoom:r,onPanZoomEnd:a}):Mh({noWheelClassName:j,preventScrolling:X,d3ZoomHandler:_});if(d.on("wheel.zoom",q,{passive:!1}),!K){const ae=Th({zoomPanValues:u,onDraggingChange:c,onPanZoomStart:i});h.on("start",ae);const Ie=Vh({zoomPanValues:u,panOnDrag:W,onPaneContextMenu:!!M,onPanZoom:r,onTransformChange:Se});h.on("zoom",Ie);const ge=Nh({zoomPanValues:u,panOnDrag:W,panOnScroll:D,onPaneContextMenu:M,onPanZoomEnd:a,onDraggingChange:c});h.on("end",ge)}const Ee=zh({zoomActivationKeyPressed:se,panOnDrag:W,zoomOnScroll:G,panOnScroll:D,zoomOnDoubleClick:ce,zoomOnPinch:Q,userSelectionActive:K,noPanClassName:Y,noWheelClassName:j,lib:ye});h.filter(Ee),ce?d.on("dblclick.zoom",b):d.on("dblclick.zoom",null)}function w(){h.on("zoom",null)}async function y(j,Y,M){const K=Ko(j),D=h==null?void 0:h.constrain()(K,Y,M);return D&&await v(D),new Promise(W=>W(D))}async function E(j,Y){const M=Ko(j);return await v(M,Y),new Promise(K=>K(M))}function z(j){if(d){const Y=Ko(j),M=d.property("__zoom");(M.k!==j.zoom||M.x!==j.x||M.y!==j.y)&&(h==null||h.transform(d,Y,null,{sync:!0}))}}function T(){const j=d?Xa(d.node()):{x:0,y:0,k:1};return{x:j.x,y:j.y,zoom:j.k}}function I(j,Y){return d?new Promise(M=>{h==null||h.scaleTo(qo(d,Y==null?void 0:Y.duration,()=>M(!0)),j)}):Promise.resolve(!1)}function H(j,Y){return d?new Promise(M=>{h==null||h.scaleBy(qo(d,Y==null?void 0:Y.duration,()=>M(!0)),j)}):Promise.resolve(!1)}function O(j){h==null||h.scaleExtent(j)}function A(j){h==null||h.translateExtent(j)}function F(j){const Y=!On(j)||j<0?0:j;h==null||h.clickDistance(Y)}return{update:g,destroy:w,setViewport:E,setViewportConstrained:y,getViewport:T,scaleTo:I,scaleBy:H,setScaleExtent:O,setTranslateExtent:A,syncViewport:z,setClickDistance:F}}var zr;(function(l){l.Line="line",l.Handle="handle"})(zr||(zr={}));function Oh(l){let e,t,n,o,s,r;const i=l[45].default,a=xt(i,l,l[44],null);return{c(){e=V("div"),a&&a.c(),this.h()},l(c){e=N(c,"DIV",{"data-handleid":!0,"data-nodeid":!0,"data-handlepos":!0,"data-id":!0,class:!0,style:!0,role:!0,tabindex:!0});var u=S(e);a&&a.l(u),u.forEach(p),this.h()},h(){m(e,"data-handleid",l[6]),m(e,"data-nodeid",l[14]),m(e,"data-handlepos",l[2]),m(e,"data-id",t=l[13]+"-"+l[14]+"-"+(l[0]||null)+"-"+l[1]),m(e,"class",n=Bt(["svelte-flow__handle",`svelte-flow__handle-${l[2]}`,"nodrag","nopan",l[2],l[4]])),m(e,"style",l[3]),m(e,"role","button"),m(e,"tabindex","-1"),lt(e,"valid",l[7]),lt(e,"connectingto",l[5]),lt(e,"connectingfrom",l[9]),lt(e,"source",!l[11]),lt(e,"target",l[11]),lt(e,"connectablestart",l[12]),lt(e,"connectableend",l[12]),lt(e,"connectable",l[12]),lt(e,"connectionindicator",l[12]&&(!l[10]||l[8]))},m(c,u){B(c,e,u),a&&a.m(e,null),o=!0,s||(r=[ke(e,"mousedown",l[32]),ke(e,"touchstart",l[32])],s=!0)},p(c,u){a&&a.p&&(!o||u[1]&8192)&&$t(a,i,c,c[44],o?tn(i,c[44],u,null):en(c[44]),null),(!o||u[0]&64)&&m(e,"data-handleid",c[6]),(!o||u[0]&4)&&m(e,"data-handlepos",c[2]),(!o||u[0]&8195&&t!==(t=c[13]+"-"+c[14]+"-"+(c[0]||null)+"-"+c[1]))&&m(e,"data-id",t),(!o||u[0]&20&&n!==(n=Bt(["svelte-flow__handle",`svelte-flow__handle-${c[2]}`,"nodrag","nopan",c[2],c[4]])))&&m(e,"class",n),(!o||u[0]&8)&&m(e,"style",c[3]),(!o||u[0]&148)&&lt(e,"valid",c[7]),(!o||u[0]&52)&&lt(e,"connectingto",c[5]),(!o||u[0]&532)&&lt(e,"connectingfrom",c[9]),(!o||u[0]&2068)&&lt(e,"source",!c[11]),(!o||u[0]&2068)&&lt(e,"target",c[11]),(!o||u[0]&4116)&&lt(e,"connectablestart",c[12]),(!o||u[0]&4116)&&lt(e,"connectableend",c[12]),(!o||u[0]&4116)&&lt(e,"connectable",c[12]),(!o||u[0]&5396)&&lt(e,"connectionindicator",c[12]&&(!c[10]||c[8]))},i(c){o||(C(a,c),o=!0)},o(c){P(a,c),o=!1},d(c){c&&p(e),a&&a.d(c),s=!1,ln(r)}}}function Hh(l,e,t){let n,o,s,r,i,a,c,u,f,h,d,_,b,v,g,w,y,E,z,T,I,H,O,A,F,{$$slots:j={},$$scope:Y}=e,{id:M=void 0}=e,{type:K="source"}=e,{position:D=ot.Top}=e,{style:W=void 0}=e,{isValidConnection:L=void 0}=e,{onconnect:R=void 0}=e,{ondisconnect:X=void 0}=e,{isConnectable:Q=void 0}=e,{class:G=void 0}=e;const ce=Ut("svelteflow__node_id"),se=Ut("svelteflow__node_connectable");ie(l,se,be=>t(43,F=be));const ye=Zt(),{connectionMode:Se,domNode:re,nodeLookup:q,connectionRadius:Ee,viewport:ae,isValidConnection:Ie,lib:ge,addEdge:_t,onedgecreate:me,panBy:ct,cancelConnection:ut,updateConnection:Wt,autoPanOnConnect:ve,edges:Ue,connectionLookup:st,onconnect:yt,onconnectstart:ft,onconnectend:rt,flowId:At,connection:_e}=ye;ie(l,Se,be=>t(40,h=be)),ie(l,re,be=>t(55,O=be)),ie(l,q,be=>t(54,H=be)),ie(l,Ee,be=>t(56,A=be)),ie(l,ae,be=>t(46,b=be)),ie(l,Ie,be=>t(51,E=be)),ie(l,ge,be=>t(53,I=be)),ie(l,me,be=>t(50,y=be)),ie(l,ve,be=>t(52,T=be)),ie(l,Ue,be=>t(42,_=be)),ie(l,st,be=>t(41,d=be)),ie(l,yt,be=>t(49,w=be)),ie(l,ft,be=>t(48,g=be)),ie(l,rt,be=>t(47,v=be)),ie(l,At,be=>t(13,z=be)),ie(l,_e,be=>t(39,f=be));function St(be){const Vt=ia(be);(Vt&&be.button===0||!Vt)&&Sh.onPointerDown(be,{handleId:s,nodeId:ce,isTarget:n,connectionRadius:A,domNode:O,nodeLookup:H,connectionMode:h,lib:I,autoPanOnConnect:T,flowId:z,isValidConnection:L??E,updateConnection:Wt,cancelConnection:ut,panBy:ct,onConnect:ue=>{const Re=y?y(ue):ue;Re&&(_t(Re),w==null||w(ue))},onConnectStart:(ue,Re)=>{g==null||g(ue,{nodeId:Re.nodeId,handleId:Re.handleId,handleType:Re.handleType})},onConnectEnd:(ue,Re)=>{v==null||v(ue,Re)},getTransform:()=>[b.x,b.y,b.zoom],getFromHandle:()=>f.fromHandle})}let pt=null,ht;return l.$$set=be=>{"id"in be&&t(0,M=be.id),"type"in be&&t(1,K=be.type),"position"in be&&t(2,D=be.position),"style"in be&&t(3,W=be.style),"isValidConnection"in be&&t(33,L=be.isValidConnection),"onconnect"in be&&t(34,R=be.onconnect),"ondisconnect"in be&&t(35,X=be.ondisconnect),"isConnectable"in be&&t(36,Q=be.isConnectable),"class"in be&&t(4,G=be.class),"$$scope"in be&&t(44,Y=be.$$scope)},l.$$.update=()=>{var be,Vt,ue,Re,je,Ge,kt,Dt,Ct;if(l.$$.dirty[0]&2&&t(11,n=K==="target"),l.$$.dirty[1]&4128&&t(12,o=Q!==void 0?Q:F),l.$$.dirty[0]&1&&t(6,s=M||null),l.$$.dirty[0]&3|l.$$.dirty[1]&3096&&(R||X)&&t(38,ht=d.get(`${ce}-${K}-${M||null}`)),l.$$.dirty[1]&216){if(pt&&!Yd(ht,pt)){const Nt=ht??new Map;pr(pt,Nt,X),pr(Nt,pt,R)}t(37,pt=ht??new Map)}l.$$.dirty[1]&256&&t(10,r=!!f.fromHandle),l.$$.dirty[0]&66|l.$$.dirty[1]&256&&t(9,i=((be=f.fromHandle)==null?void 0:be.nodeId)===ce&&((Vt=f.fromHandle)==null?void 0:Vt.type)===K&&((ue=f.fromHandle)==null?void 0:ue.id)===s),l.$$.dirty[0]&66|l.$$.dirty[1]&256&&t(5,a=((Re=f.toHandle)==null?void 0:Re.nodeId)===ce&&((je=f.toHandle)==null?void 0:je.type)===K&&((Ge=f.toHandle)==null?void 0:Ge.id)===s),l.$$.dirty[0]&66|l.$$.dirty[1]&768&&t(8,c=h===wl.Strict?((kt=f.fromHandle)==null?void 0:kt.type)!==K:ce!==((Dt=f.fromHandle)==null?void 0:Dt.nodeId)||s!==((Ct=f.fromHandle)==null?void 0:Ct.id)),l.$$.dirty[0]&32|l.$$.dirty[1]&256&&t(7,u=a&&f.isValid)},[M,K,D,W,G,a,s,u,c,i,r,n,o,z,ce,se,Se,re,q,Ee,ae,Ie,ge,me,ve,Ue,st,yt,ft,rt,At,_e,St,L,R,X,Q,pt,ht,f,h,d,_,F,Y,j]}class Al extends Ve{constructor(e){super(),Ne(this,e,Hh,Oh,Be,{id:0,type:1,position:2,style:3,isValidConnection:33,onconnect:34,ondisconnect:35,isConnectable:36,class:4},null,[-1,-1])}}function Bh(l){var a;let e,t,n=((a=l[0])==null?void 0:a.label)+"",o,s,r,i;return e=new Al({props:{type:"target",position:l[1]??ot.Top}}),r=new Al({props:{type:"source",position:l[2]??ot.Bottom}}),{c(){te(e.$$.fragment),t=$(),o=Ce(n),s=$(),te(r.$$.fragment)},l(c){oe(e.$$.fragment,c),t=ee(c),o=Me(c,n),s=ee(c),oe(r.$$.fragment,c)},m(c,u){ne(e,c,u),B(c,t,u),B(c,o,u),B(c,s,u),ne(r,c,u),i=!0},p(c,[u]){var d;const f={};u&2&&(f.position=c[1]??ot.Top),e.$set(f),(!i||u&1)&&n!==(n=((d=c[0])==null?void 0:d.label)+"")&&He(o,n);const h={};u&4&&(h.position=c[2]??ot.Bottom),r.$set(h)},i(c){i||(C(e.$$.fragment,c),C(r.$$.fragment,c),i=!0)},o(c){P(e.$$.fragment,c),P(r.$$.fragment,c),i=!1},d(c){c&&(p(t),p(o),p(s)),le(e,c),le(r,c)}}}function Ah(l,e,t){const n=["data","targetPosition","sourcePosition"];Yt(e,n);let{data:o={label:"Node"}}=e,{targetPosition:s=void 0}=e,{sourcePosition:r=void 0}=e;return l.$$set=i=>{e=It(It({},e),Bn(i)),t(3,Yt(e,n)),"data"in i&&t(0,o=i.data),"targetPosition"in i&&t(1,s=i.targetPosition),"sourcePosition"in i&&t(2,r=i.sourcePosition)},[o,s,r]}class Ia extends Ve{constructor(e){super(),Ne(this,e,Ah,Bh,Be,{data:0,targetPosition:1,sourcePosition:2})}}function Lh(l){var r;let e=((r=l[0])==null?void 0:r.label)+"",t,n,o,s;return o=new Al({props:{type:"source",position:l[1]??ot.Bottom}}),{c(){t=Ce(e),n=$(),te(o.$$.fragment)},l(i){t=Me(i,e),n=ee(i),oe(o.$$.fragment,i)},m(i,a){B(i,t,a),B(i,n,a),ne(o,i,a),s=!0},p(i,[a]){var u;(!s||a&1)&&e!==(e=((u=i[0])==null?void 0:u.label)+"")&&He(t,e);const c={};a&2&&(c.position=i[1]??ot.Bottom),o.$set(c)},i(i){s||(C(o.$$.fragment,i),s=!0)},o(i){P(o.$$.fragment,i),s=!1},d(i){i&&(p(t),p(n)),le(o,i)}}}function Rh(l,e,t){const n=["data","sourcePosition"];Yt(e,n);let{data:o={label:"Node"}}=e,{sourcePosition:s=void 0}=e;return l.$$set=r=>{e=It(It({},e),Bn(r)),t(2,Yt(e,n)),"data"in r&&t(0,o=r.data),"sourcePosition"in r&&t(1,s=r.sourcePosition)},[o,s]}class Uh extends Ve{constructor(e){super(),Ne(this,e,Rh,Lh,Be,{data:0,sourcePosition:1})}}function Wh(l){var r;let e=((r=l[0])==null?void 0:r.label)+"",t,n,o,s;return o=new Al({props:{type:"target",position:l[1]??ot.Top}}),{c(){t=Ce(e),n=$(),te(o.$$.fragment)},l(i){t=Me(i,e),n=ee(i),oe(o.$$.fragment,i)},m(i,a){B(i,t,a),B(i,n,a),ne(o,i,a),s=!0},p(i,[a]){var u;(!s||a&1)&&e!==(e=((u=i[0])==null?void 0:u.label)+"")&&He(t,e);const c={};a&2&&(c.position=i[1]??ot.Top),o.$set(c)},i(i){s||(C(o.$$.fragment,i),s=!0)},o(i){P(o.$$.fragment,i),s=!1},d(i){i&&(p(t),p(n)),le(o,i)}}}function jh(l,e,t){const n=["data","targetPosition"];Yt(e,n);let{data:o={label:"Node"}}=e,{targetPosition:s=void 0}=e;return l.$$set=r=>{e=It(It({},e),Bn(r)),t(2,Yt(e,n)),"data"in r&&t(0,o=r.data),"targetPosition"in r&&t(1,s=r.targetPosition)},[o,s]}class Fh extends Ve{constructor(e){super(),Ne(this,e,jh,Wh,Be,{data:0,targetPosition:1})}}function Yh(l,e,t){const n=[];return Yt(e,n),l.$$set=o=>{e=It(It({},e),Bn(o)),t(0,Yt(e,n))},[]}class Zh extends Ve{constructor(e){super(),Ne(this,e,Yh,null,Be,{})}}function Pr(l,e,t){if(!e)return;const n=t?e.querySelector(t):e;n&&n.appendChild(l)}function Xh(l,{target:e,domNode:t}){return Pr(l,t,e),{async update({target:n,domNode:o}){Pr(l,o,n)},destroy(){l.parentNode&&l.parentNode.removeChild(l)}}}function Kh(l){let e,t,n,o,s;const r=l[3].default,i=xt(r,l,l[2],null);return{c(){e=V("div"),i&&i.c()},l(a){e=N(a,"DIV",{});var c=S(e);i&&i.l(c),c.forEach(p)},m(a,c){B(a,e,c),i&&i.m(e,null),n=!0,o||(s=dn(t=Xh.call(null,e,{target:".svelte-flow__edgelabel-renderer",domNode:l[0]})),o=!0)},p(a,[c]){i&&i.p&&(!n||c&4)&&$t(i,r,a,a[2],n?tn(r,a[2],c,null):en(a[2]),null),t&&nn(t.update)&&c&1&&t.update.call(null,{target:".svelte-flow__edgelabel-renderer",domNode:a[0]})},i(a){n||(C(i,a),n=!0)},o(a){P(i,a),n=!1},d(a){a&&p(e),i&&i.d(a),o=!1,s()}}}function qh(l,e,t){let n,{$$slots:o={},$$scope:s}=e;const{domNode:r}=Zt();return ie(l,r,i=>t(0,n=i)),l.$$set=i=>{"$$scope"in i&&t(2,s=i.$$scope)},[n,r,s,o]}class Gh extends Ve{constructor(e){super(),Ne(this,e,qh,Kh,Be,{})}}function Sa(){const{edgeLookup:l,selectionRect:e,selectionRectMode:t,multiselectionKeyPressed:n,addSelectedEdges:o,unselectNodesAndEdges:s,elementsSelectable:r}=Zt();return i=>{const a=he(l).get(i);if(!a){console.warn("012",Jl.error012(i));return}(a.selectable||he(r)&&typeof a.selectable>"u")&&(e.set(null),t.set(null),a.selected?a.selected&&he(n)&&s({nodes:[],edges:[a]}):o([i]))}}function Jh(l){let e,t,n=`translate(-50%, -50%) translate(${l[1]}px,${l[2]}px)`,o,s,r;const i=l[5].default,a=xt(i,l,l[7],null);return{c(){e=V("div"),a&&a.c(),this.h()},l(c){e=N(c,"DIV",{class:!0,style:!0,role:!0,tabindex:!0});var u=S(e);a&&a.l(u),u.forEach(p),this.h()},h(){m(e,"class","svelte-flow__edge-label"),m(e,"style",t="pointer-events: all;"+l[0]),m(e,"role","button"),m(e,"tabindex","-1"),tt(e,"transform",n)},m(c,u){B(c,e,u),a&&a.m(e,null),o=!0,s||(r=[ke(e,"keyup",xh),ke(e,"click",l[6])],s=!0)},p(c,u){a&&a.p&&(!o||u&128)&&$t(a,i,c,c[7],o?tn(i,c[7],u,null):en(c[7]),null),(!o||u&1&&t!==(t="pointer-events: all;"+c[0]))&&m(e,"style",t);const f=u&1;(u&7&&n!==(n=`translate(-50%, -50%) translate(${c[1]}px,${c[2]}px)`)||f)&&tt(e,"transform",n)},i(c){o||(C(a,c),o=!0)},o(c){P(a,c),o=!1},d(c){c&&p(e),a&&a.d(c),s=!1,ln(r)}}}function Qh(l){let e,t;return e=new Gh({props:{$$slots:{default:[Jh]},$$scope:{ctx:l}}}),{c(){te(e.$$.fragment)},l(n){oe(e.$$.fragment,n)},m(n,o){ne(e,n,o),t=!0},p(n,[o]){const s={};o&135&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){le(e,n)}}}const xh=()=>{};function $h(l,e,t){let{$$slots:n={},$$scope:o}=e,{style:s=void 0}=e,{x:r=void 0}=e,{y:i=void 0}=e;const a=Sa(),c=Ut("svelteflow__edge_id"),u=()=>{c&&a(c)};return l.$$set=f=>{"style"in f&&t(0,s=f.style),"x"in f&&t(1,r=f.x),"y"in f&&t(2,i=f.y),"$$scope"in f&&t(7,o=f.$$scope)},[s,r,i,a,c,n,u,o]}class em extends Ve{constructor(e){super(),Ne(this,e,$h,Qh,Be,{style:0,x:1,y:2})}}function tm(l){let e;return{c(){e=ze("path"),this.h()},l(t){e=Pe(t,"path",{d:!0,"stroke-opacity":!0,"stroke-width":!0,fill:!0,class:!0}),S(e).forEach(p),this.h()},h(){m(e,"d",l[1]),m(e,"stroke-opacity",0),m(e,"stroke-width",l[10]),m(e,"fill","none"),m(e,"class","svelte-flow__edge-interaction")},m(t,n){B(t,e,n)},p(t,n){n&2&&m(e,"d",t[1])},d(t){t&&p(e)}}}function Or(l){let e,t;return e=new em({props:{x:l[3],y:l[4],style:l[5],$$slots:{default:[nm]},$$scope:{ctx:l}}}),{c(){te(e.$$.fragment)},l(n){oe(e.$$.fragment,n)},m(n,o){ne(e,n,o),t=!0},p(n,o){const s={};o&8&&(s.x=n[3]),o&16&&(s.y=n[4]),o&32&&(s.style=n[5]),o&4100&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){le(e,n)}}}function nm(l){let e;return{c(){e=Ce(l[2])},l(t){e=Me(t,l[2])},m(t,n){B(t,e,n)},p(t,n){n&4&&He(e,t[2])},d(t){t&&p(e)}}}function lm(l){let e,t,n,o,s,r,i=l[10]&&tm(l),a=l[2]&&Or(l);return{c(){e=ze("path"),n=$(),i&&i.c(),o=$(),a&&a.c(),s=Oe(),this.h()},l(c){e=Pe(c,"path",{id:!0,d:!0,class:!0,"marker-start":!0,"marker-end":!0,fill:!0,style:!0}),S(e).forEach(p),n=ee(c),i&&i.l(c),o=ee(c),a&&a.l(c),s=Oe(),this.h()},h(){m(e,"id",l[0]),m(e,"d",l[1]),m(e,"class",t=Bt(["svelte-flow__edge-path",l[9]])),m(e,"marker-start",l[6]),m(e,"marker-end",l[7]),m(e,"fill","none"),m(e,"style",l[8])},m(c,u){B(c,e,u),B(c,n,u),i&&i.m(c,u),B(c,o,u),a&&a.m(c,u),B(c,s,u),r=!0},p(c,[u]){(!r||u&1)&&m(e,"id",c[0]),(!r||u&2)&&m(e,"d",c[1]),(!r||u&512&&t!==(t=Bt(["svelte-flow__edge-path",c[9]])))&&m(e,"class",t),(!r||u&64)&&m(e,"marker-start",c[6]),(!r||u&128)&&m(e,"marker-end",c[7]),(!r||u&256)&&m(e,"style",c[8]),c[10]&&i.p(c,u),c[2]?a?(a.p(c,u),u&4&&C(a,1)):(a=Or(c),a.c(),C(a,1),a.m(s.parentNode,s)):a&&(Ae(),P(a,1,1,()=>{a=null}),Le())},i(c){r||(C(a),r=!0)},o(c){P(a),r=!1},d(c){c&&(p(e),p(n),p(o),p(s)),i&&i.d(c),a&&a.d(c)}}}function om(l,e,t){let{id:n=void 0}=e,{path:o}=e,{label:s=void 0}=e,{labelX:r=void 0}=e,{labelY:i=void 0}=e,{labelStyle:a=void 0}=e,{markerStart:c=void 0}=e,{markerEnd:u=void 0}=e,{style:f=void 0}=e,{interactionWidth:h=20}=e,{class:d=void 0}=e,_=h===void 0?20:h;return l.$$set=b=>{"id"in b&&t(0,n=b.id),"path"in b&&t(1,o=b.path),"label"in b&&t(2,s=b.label),"labelX"in b&&t(3,r=b.labelX),"labelY"in b&&t(4,i=b.labelY),"labelStyle"in b&&t(5,a=b.labelStyle),"markerStart"in b&&t(6,c=b.markerStart),"markerEnd"in b&&t(7,u=b.markerEnd),"style"in b&&t(8,f=b.style),"interactionWidth"in b&&t(11,h=b.interactionWidth),"class"in b&&t(9,d=b.class)},[n,o,s,r,i,a,c,u,f,d,_,h]}class Ao extends Ve{constructor(e){super(),Ne(this,e,om,lm,Be,{id:0,path:1,label:2,labelX:3,labelY:4,labelStyle:5,markerStart:6,markerEnd:7,style:8,interactionWidth:11,class:9})}}function sm(l){let e,t;return e=new Ao({props:{path:l[8],labelX:l[7],labelY:l[6],label:l[0],labelStyle:l[1],markerStart:l[3],markerEnd:l[4],interactionWidth:l[5],style:l[2]}}),{c(){te(e.$$.fragment)},l(n){oe(e.$$.fragment,n)},m(n,o){ne(e,n,o),t=!0},p(n,[o]){const s={};o&256&&(s.path=n[8]),o&128&&(s.labelX=n[7]),o&64&&(s.labelY=n[6]),o&1&&(s.label=n[0]),o&2&&(s.labelStyle=n[1]),o&8&&(s.markerStart=n[3]),o&16&&(s.markerEnd=n[4]),o&32&&(s.interactionWidth=n[5]),o&4&&(s.style=n[2]),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){le(e,n)}}}function rm(l,e,t){let n,o,s;const r=["label","labelStyle","style","markerStart","markerEnd","interactionWidth","sourceX","sourceY","sourcePosition","targetX","targetY","targetPosition"];Yt(e,r);let{label:i=void 0}=e,{labelStyle:a=void 0}=e,{style:c=void 0}=e,{markerStart:u=void 0}=e,{markerEnd:f=void 0}=e,{interactionWidth:h=void 0}=e,{sourceX:d}=e,{sourceY:_}=e,{sourcePosition:b}=e,{targetX:v}=e,{targetY:g}=e,{targetPosition:w}=e;return l.$$set=y=>{e=It(It({},e),Bn(y)),t(15,Yt(e,r)),"label"in y&&t(0,i=y.label),"labelStyle"in y&&t(1,a=y.labelStyle),"style"in y&&t(2,c=y.style),"markerStart"in y&&t(3,u=y.markerStart),"markerEnd"in y&&t(4,f=y.markerEnd),"interactionWidth"in y&&t(5,h=y.interactionWidth),"sourceX"in y&&t(9,d=y.sourceX),"sourceY"in y&&t(10,_=y.sourceY),"sourcePosition"in y&&t(11,b=y.sourcePosition),"targetX"in y&&t(12,v=y.targetX),"targetY"in y&&t(13,g=y.targetY),"targetPosition"in y&&t(14,w=y.targetPosition)},l.$$.update=()=>{l.$$.dirty&32256&&t(8,[n,o,s]=aa({sourceX:d,sourceY:_,targetX:v,targetY:g,sourcePosition:b,targetPosition:w}),n,(t(7,o),t(9,d),t(10,_),t(12,v),t(13,g),t(11,b),t(14,w)),(t(6,s),t(9,d),t(10,_),t(12,v),t(13,g),t(11,b),t(14,w)))},[i,a,c,u,f,h,s,o,n,d,_,b,v,g,w]}class Da extends Ve{constructor(e){super(),Ne(this,e,rm,sm,Be,{label:0,labelStyle:1,style:2,markerStart:3,markerEnd:4,interactionWidth:5,sourceX:9,sourceY:10,sourcePosition:11,targetX:12,targetY:13,targetPosition:14})}}function im(l){let e,t;return e=new Ao({props:{path:l[8],labelX:l[7],labelY:l[6],label:l[0],labelStyle:l[1],markerStart:l[3],markerEnd:l[4],interactionWidth:l[5],style:l[2]}}),{c(){te(e.$$.fragment)},l(n){oe(e.$$.fragment,n)},m(n,o){ne(e,n,o),t=!0},p(n,[o]){const s={};o&256&&(s.path=n[8]),o&128&&(s.labelX=n[7]),o&64&&(s.labelY=n[6]),o&1&&(s.label=n[0]),o&2&&(s.labelStyle=n[1]),o&8&&(s.markerStart=n[3]),o&16&&(s.markerEnd=n[4]),o&32&&(s.interactionWidth=n[5]),o&4&&(s.style=n[2]),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){le(e,n)}}}function am(l,e,t){let n,o,s;const r=["label","labelStyle","style","markerStart","markerEnd","interactionWidth","sourceX","sourceY","sourcePosition","targetX","targetY","targetPosition"];Yt(e,r);let{label:i=void 0}=e,{labelStyle:a=void 0}=e,{style:c=void 0}=e,{markerStart:u=void 0}=e,{markerEnd:f=void 0}=e,{interactionWidth:h=void 0}=e,{sourceX:d}=e,{sourceY:_}=e,{sourcePosition:b}=e,{targetX:v}=e,{targetY:g}=e,{targetPosition:w}=e;return l.$$set=y=>{e=It(It({},e),Bn(y)),t(15,Yt(e,r)),"label"in y&&t(0,i=y.label),"labelStyle"in y&&t(1,a=y.labelStyle),"style"in y&&t(2,c=y.style),"markerStart"in y&&t(3,u=y.markerStart),"markerEnd"in y&&t(4,f=y.markerEnd),"interactionWidth"in y&&t(5,h=y.interactionWidth),"sourceX"in y&&t(9,d=y.sourceX),"sourceY"in y&&t(10,_=y.sourceY),"sourcePosition"in y&&t(11,b=y.sourcePosition),"targetX"in y&&t(12,v=y.targetX),"targetY"in y&&t(13,g=y.targetY),"targetPosition"in y&&t(14,w=y.targetPosition)},l.$$.update=()=>{l.$$.dirty&32256&&t(8,[n,o,s]=Eo({sourceX:d,sourceY:_,targetX:v,targetY:g,sourcePosition:b,targetPosition:w}),n,(t(7,o),t(9,d),t(10,_),t(12,v),t(13,g),t(11,b),t(14,w)),(t(6,s),t(9,d),t(10,_),t(12,v),t(13,g),t(11,b),t(14,w)))},[i,a,c,u,f,h,s,o,n,d,_,b,v,g,w]}class cm extends Ve{constructor(e){super(),Ne(this,e,am,im,Be,{label:0,labelStyle:1,style:2,markerStart:3,markerEnd:4,interactionWidth:5,sourceX:9,sourceY:10,sourcePosition:11,targetX:12,targetY:13,targetPosition:14})}}function um(l){let e,t;return e=new Ao({props:{path:l[8],labelX:l[7],labelY:l[6],label:l[0],labelStyle:l[1],markerStart:l[3],markerEnd:l[4],interactionWidth:l[5],style:l[2]}}),{c(){te(e.$$.fragment)},l(n){oe(e.$$.fragment,n)},m(n,o){ne(e,n,o),t=!0},p(n,[o]){const s={};o&256&&(s.path=n[8]),o&128&&(s.labelX=n[7]),o&64&&(s.labelY=n[6]),o&1&&(s.label=n[0]),o&2&&(s.labelStyle=n[1]),o&8&&(s.markerStart=n[3]),o&16&&(s.markerEnd=n[4]),o&32&&(s.interactionWidth=n[5]),o&4&&(s.style=n[2]),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){le(e,n)}}}function fm(l,e,t){let n,o,s;const r=["label","labelStyle","style","markerStart","markerEnd","interactionWidth","sourceX","sourceY","targetX","targetY"];Yt(e,r);let{label:i=void 0}=e,{labelStyle:a=void 0}=e,{style:c=void 0}=e,{markerStart:u=void 0}=e,{markerEnd:f=void 0}=e,{interactionWidth:h=void 0}=e,{sourceX:d}=e,{sourceY:_}=e,{targetX:b}=e,{targetY:v}=e;return l.$$set=g=>{e=It(It({},e),Bn(g)),t(13,Yt(e,r)),"label"in g&&t(0,i=g.label),"labelStyle"in g&&t(1,a=g.labelStyle),"style"in g&&t(2,c=g.style),"markerStart"in g&&t(3,u=g.markerStart),"markerEnd"in g&&t(4,f=g.markerEnd),"interactionWidth"in g&&t(5,h=g.interactionWidth),"sourceX"in g&&t(9,d=g.sourceX),"sourceY"in g&&t(10,_=g.sourceY),"targetX"in g&&t(11,b=g.targetX),"targetY"in g&&t(12,v=g.targetY)},l.$$.update=()=>{l.$$.dirty&7680&&t(8,[n,o,s]=ua({sourceX:d,sourceY:_,targetX:b,targetY:v}),n,(t(7,o),t(9,d),t(10,_),t(11,b),t(12,v)),(t(6,s),t(9,d),t(10,_),t(11,b),t(12,v)))},[i,a,c,u,f,h,s,o,n,d,_,b,v]}class dm extends Ve{constructor(e){super(),Ne(this,e,fm,um,Be,{label:0,labelStyle:1,style:2,markerStart:3,markerEnd:4,interactionWidth:5,sourceX:9,sourceY:10,targetX:11,targetY:12})}}function hm(l){let e,t;return e=new Ao({props:{path:l[8],labelX:l[7],labelY:l[6],label:l[0],labelStyle:l[1],markerStart:l[3],markerEnd:l[4],interactionWidth:l[5],style:l[2]}}),{c(){te(e.$$.fragment)},l(n){oe(e.$$.fragment,n)},m(n,o){ne(e,n,o),t=!0},p(n,[o]){const s={};o&256&&(s.path=n[8]),o&128&&(s.labelX=n[7]),o&64&&(s.labelY=n[6]),o&1&&(s.label=n[0]),o&2&&(s.labelStyle=n[1]),o&8&&(s.markerStart=n[3]),o&16&&(s.markerEnd=n[4]),o&32&&(s.interactionWidth=n[5]),o&4&&(s.style=n[2]),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){le(e,n)}}}function mm(l,e,t){let n,o,s;const r=["label","labelStyle","style","markerStart","markerEnd","interactionWidth","sourceX","sourceY","sourcePosition","targetX","targetY","targetPosition"];Yt(e,r);let{label:i=void 0}=e,{labelStyle:a=void 0}=e,{style:c=void 0}=e,{markerStart:u=void 0}=e,{markerEnd:f=void 0}=e,{interactionWidth:h=void 0}=e,{sourceX:d}=e,{sourceY:_}=e,{sourcePosition:b}=e,{targetX:v}=e,{targetY:g}=e,{targetPosition:w}=e;return l.$$set=y=>{e=It(It({},e),Bn(y)),t(15,Yt(e,r)),"label"in y&&t(0,i=y.label),"labelStyle"in y&&t(1,a=y.labelStyle),"style"in y&&t(2,c=y.style),"markerStart"in y&&t(3,u=y.markerStart),"markerEnd"in y&&t(4,f=y.markerEnd),"interactionWidth"in y&&t(5,h=y.interactionWidth),"sourceX"in y&&t(9,d=y.sourceX),"sourceY"in y&&t(10,_=y.sourceY),"sourcePosition"in y&&t(11,b=y.sourcePosition),"targetX"in y&&t(12,v=y.targetX),"targetY"in y&&t(13,g=y.targetY),"targetPosition"in y&&t(14,w=y.targetPosition)},l.$$.update=()=>{l.$$.dirty&32256&&t(8,[n,o,s]=Eo({sourceX:d,sourceY:_,targetX:v,targetY:g,sourcePosition:b,targetPosition:w,borderRadius:0}),n,(t(7,o),t(9,d),t(10,_),t(12,v),t(13,g),t(11,b),t(14,w)),(t(6,s),t(9,d),t(10,_),t(12,v),t(13,g),t(11,b),t(14,w)))},[i,a,c,u,f,h,s,o,n,d,_,b,v,g,w]}class gm extends Ve{constructor(e){super(),Ne(this,e,mm,hm,Be,{label:0,labelStyle:1,style:2,markerStart:3,markerEnd:4,interactionWidth:5,sourceX:9,sourceY:10,sourcePosition:11,targetX:12,targetY:13,targetPosition:14})}}function _m(l,e){const t=l.set,n=e.set,o=he(l),s=he(e);let i=o.length===0&&s.length>0?s:o;l.set(i);const a=c=>{const u=t(c);return i=u,n(i),u};l.set=e.set=a,l.update=e.update=c=>a(c(i))}function pm(l,e){const t=l.set,n=e.set;let o=he(e);l.set(o);const s=r=>{t(r),n(r),o=r};l.set=e.set=s,l.update=e.update=r=>s(r(o))}const bm=(l,e,t)=>{if(!t)return;const n=he(l),o=e.set,s=t.set;let r=t?he(t):{x:0,y:0,zoom:1};e.set(r),e.set=i=>(o(i),s(i),r=i,i),t.set=i=>(n==null||n.syncViewport(i),o(i),s(i),r=i,i),e.update=i=>{e.set(i(r))},t.update=i=>{t.set(i(r))}},vm=(l,e,t,n=[0,0],o=bo)=>{const{subscribe:s,set:r,update:i}=Je([]);let a=l,c={},u=!0;const f=b=>(ha(b,e,t,{elevateNodesOnSelect:u,nodeOrigin:n,nodeExtent:o,defaults:c,checkEquality:!1}),a=b,r(a),a),h=b=>f(b(a)),d=b=>{c=b},_=b=>{u=b.elevateNodesOnSelect??u};return f(a),{subscribe:s,set:f,update:h,setDefaultOptions:d,setOptions:_}},wm=(l,e,t,n)=>{const{subscribe:o,set:s,update:r}=Je([]);let i=l,a={};const c=h=>{const d=a?h.map(_=>({...a,..._})):h;_a(e,t,d),i=d,s(i)},u=h=>c(h(i)),f=h=>{a=h};return c(i),{subscribe:o,set:c,update:u,setDefaultOptions:f}},Ca={input:Uh,output:Fh,default:Ia,group:Zh},Ma={straight:dm,smoothstep:cm,default:Da,step:gm},ym=({nodes:l=[],edges:e=[],width:t,height:n,fitView:o,nodeOrigin:s,nodeExtent:r})=>{const i=new Map,a=new Map,c=new Map,u=new Map,f=s??[0,0],h=r??bo;ha(l,i,a,{nodeExtent:h,nodeOrigin:f,elevateNodesOnSelect:!1,checkEquality:!1}),_a(c,u,e);let d={x:0,y:0,zoom:1};if(o&&t&&n){const _=Po(i,{filter:b=>!!((b.width||b.initialWidth)&&(b.height||b.initialHeight))});d=cs(_,t,n,.5,2,.1)}return{flowId:Je(null),nodes:vm(l,i,a,f,h),nodeLookup:zn(i),parentLookup:zn(a),edgeLookup:zn(u),visibleNodes:zn([]),edges:wm(e,c,u),visibleEdges:zn([]),connectionLookup:zn(c),height:Je(500),width:Je(500),minZoom:Je(.5),maxZoom:Je(2),nodeOrigin:Je(f),nodeDragThreshold:Je(1),nodeExtent:Je(h),translateExtent:Je(bo),autoPanOnNodeDrag:Je(!0),autoPanOnConnect:Je(!0),fitViewOnInit:Je(!1),fitViewOnInitDone:Je(!1),fitViewOptions:Je(void 0),panZoom:Je(null),snapGrid:Je(null),dragging:Je(!1),selectionRect:Je(null),selectionKeyPressed:Je(!1),multiselectionKeyPressed:Je(!1),deleteKeyPressed:Je(!1),panActivationKeyPressed:Je(!1),zoomActivationKeyPressed:Je(!1),selectionRectMode:Je(null),selectionMode:Je(vo.Partial),nodeTypes:Je(Ca),edgeTypes:Je(Ma),viewport:Je(d),connectionMode:Je(wl.Strict),domNode:Je(null),connection:zn($o),connectionLineType:Je(zl.Bezier),connectionRadius:Je(20),isValidConnection:Je(()=>!0),nodesDraggable:Je(!0),nodesConnectable:Je(!0),elementsSelectable:Je(!0),selectNodesOnDrag:Je(!0),markers:zn([]),defaultMarkerColor:Je("#b1b1b7"),lib:zn("svelte"),onlyRenderVisibleElements:Je(!1),onerror:Je(Jd),ondelete:Je(void 0),onedgecreate:Je(void 0),onconnect:Je(void 0),onconnectstart:Je(void 0),onconnectend:Je(void 0),onbeforedelete:Je(void 0),nodesInitialized:Je(!1),edgesInitialized:Je(!1),viewportInitialized:Je(!1),initialized:zn(!1)}};function km(l){const e=Vl([l.edges,l.nodes,l.nodeLookup,l.onlyRenderVisibleElements,l.viewport,l.width,l.height],([t,,n,o,s,r,i])=>o&&r&&i?t.filter(c=>{const u=n.get(c.source),f=n.get(c.target);return u&&f&&lh({sourceNode:u,targetNode:f,width:r,height:i,transform:[s.x,s.y,s.zoom]})}):t);return Vl([e,l.nodes,l.nodeLookup,l.connectionMode,l.onerror],([t,,n,o,s])=>t.reduce((i,a)=>{const c=n.get(a.source),u=n.get(a.target);if(!c||!u)return i;const f=uh({id:a.id,sourceNode:c,targetNode:u,sourceHandle:a.sourceHandle||null,targetHandle:a.targetHandle||null,connectionMode:o,onError:s});return f&&i.push({...a,zIndex:nh({selected:a.selected,zIndex:a.zIndex,sourceNode:c,targetNode:u,elevateOnSelect:!1}),...f}),i},[]))}function Em(l){return Vl([l.nodeLookup,l.onlyRenderVisibleElements,l.width,l.height,l.viewport,l.nodes],([e,t,n,o,s])=>{const r=[s.x,s.y,s.zoom];return t?ta(e,{x:0,y:0,width:n,height:o},r,!0):Array.from(e.values())})}const Lo=Symbol();function Ta({nodes:l,edges:e,width:t,height:n,fitView:o,nodeOrigin:s,nodeExtent:r}){const i=ym({nodes:l,edges:e,width:t,height:n,fitView:o,nodeOrigin:s,nodeExtent:r});function a(D){i.nodeTypes.set({...Ca,...D})}function c(D){i.edgeTypes.set({...Ma,...D})}function u(D){const W=he(i.edges);i.edges.set(rh(D,W))}const f=(D,W=!1)=>{var R;const L=he(i.nodeLookup);for(const[X,Q]of D){const G=(R=L.get(X))==null?void 0:R.internals.userNode;G&&(G.position=Q.position,G.dragging=W)}i.nodes.update(X=>X)};function h(D){var X,Q,G;const W=he(i.nodeLookup),{changes:L,updatedInternals:R}=_h(D,W,he(i.parentLookup),he(i.domNode),he(i.nodeOrigin));if(R){if(!he(i.fitViewOnInitDone)&&he(i.fitViewOnInit)){const ce=he(i.fitViewOptions),se=_({...ce,nodes:ce==null?void 0:ce.nodes});i.fitViewOnInitDone.set(se)}for(const ce of L){const se=(X=W.get(ce.id))==null?void 0:X.internals.userNode;if(se)switch(ce.type){case"dimensions":{const ye={...se.measured,...ce.dimensions};ce.setAttributes&&(se.width=((Q=ce.dimensions)==null?void 0:Q.width)??se.width,se.height=((G=ce.dimensions)==null?void 0:G.height)??se.height),se.measured=ye;break}case"position":se.position=ce.position??se.position;break}}i.nodes.update(ce=>ce),he(i.nodesInitialized)||i.nodesInitialized.set(!0)}}function d(D){const W=he(i.panZoom);if(!W)return Promise.resolve(!1);const L=vr(he(i.nodeLookup),D);return wr({nodes:L,width:he(i.width),height:he(i.height),minZoom:he(i.minZoom),maxZoom:he(i.maxZoom),panZoom:W},D)}function _(D){const W=he(i.panZoom);if(!W)return!1;const L=vr(he(i.nodeLookup),D);return wr({nodes:L,width:he(i.width),height:he(i.height),minZoom:he(i.minZoom),maxZoom:he(i.maxZoom),panZoom:W},D),L.size>0}function b(D,W){const L=he(i.panZoom);return L?L.scaleBy(D,W):Promise.resolve(!1)}function v(D){return b(1.2,D)}function g(D){return b(1/1.2,D)}function w(D){const W=he(i.panZoom);W&&(W.setScaleExtent([D,he(i.maxZoom)]),i.minZoom.set(D))}function y(D){const W=he(i.panZoom);W&&(W.setScaleExtent([he(i.minZoom),D]),i.maxZoom.set(D))}function E(D){const W=he(i.panZoom);W&&(W.setTranslateExtent(D),i.translateExtent.set(D))}function z(D){let W=!1;return D.forEach(L=>{L.selected&&(L.selected=!1,W=!0)}),W}function T(D){var W;(W=he(i.panZoom))==null||W.setClickDistance(D)}function I(D){z((D==null?void 0:D.nodes)||he(i.nodes))&&i.nodes.set(he(i.nodes)),z((D==null?void 0:D.edges)||he(i.edges))&&i.edges.set(he(i.edges))}i.deleteKeyPressed.subscribe(async D=>{var W;if(D){const L=he(i.nodes),R=he(i.edges),X=L.filter(se=>se.selected),Q=R.filter(se=>se.selected),{nodes:G,edges:ce}=await na({nodesToRemove:X,edgesToRemove:Q,nodes:L,edges:R,onBeforeDelete:he(i.onbeforedelete)});(G.length||ce.length)&&(i.nodes.update(se=>se.filter(ye=>!G.some(Se=>Se.id===ye.id))),i.edges.update(se=>se.filter(ye=>!ce.some(Se=>Se.id===ye.id))),(W=he(i.ondelete))==null||W({nodes:G,edges:ce}))}});function H(D){const W=he(i.multiselectionKeyPressed);i.nodes.update(L=>L.map(R=>{const X=D.includes(R.id),Q=W&&R.selected||X;return R.selected=Q,R})),W||i.edges.update(L=>L.map(R=>(R.selected=!1,R)))}function O(D){const W=he(i.multiselectionKeyPressed);i.edges.update(L=>L.map(R=>{const X=D.includes(R.id),Q=W&&R.selected||X;return R.selected=Q,R})),W||i.nodes.update(L=>L.map(R=>(R.selected=!1,R)))}function A(D){var L;const W=(L=he(i.nodes))==null?void 0:L.find(R=>R.id===D);if(!W){console.warn("012",Jl.error012(D));return}i.selectionRect.set(null),i.selectionRectMode.set(null),W.selected?W.selected&&he(i.multiselectionKeyPressed)&&I({nodes:[W],edges:[]}):H([D])}function F(D){const W=he(i.viewport);return ph({delta:D,panZoom:he(i.panZoom),transform:[W.x,W.y,W.zoom],translateExtent:he(i.translateExtent),width:he(i.width),height:he(i.height)})}const j=Je($o),Y=D=>{j.set({...D})};function M(){j.set($o)}function K(){i.fitViewOnInitDone.set(!1),i.selectionRect.set(null),i.selectionRectMode.set(null),i.snapGrid.set(null),i.isValidConnection.set(()=>!0),I(),M()}return{...i,visibleEdges:km(i),visibleNodes:Em(i),connection:Vl([j,i.viewport],([D,W])=>D.inProgress?{...D,to:Ql(D.to,[W.x,W.y,W.zoom])}:{...D}),markers:Vl([i.edges,i.defaultMarkerColor,i.flowId],([D,W,L])=>fh(D,{defaultColor:W,id:L})),initialized:(()=>{let D=!1;const W=he(i.nodes).length,L=he(i.edges).length;return Vl([i.nodesInitialized,i.edgesInitialized,i.viewportInitialized],([R,X,Q])=>D||(W===0?D=Q:L===0?D=Q&&R:D=Q&&R&&X,D))})(),syncNodeStores:D=>_m(i.nodes,D),syncEdgeStores:D=>pm(i.edges,D),syncViewport:D=>bm(i.panZoom,i.viewport,D),setNodeTypes:a,setEdgeTypes:c,addEdge:u,updateNodePositions:f,updateNodeInternals:h,zoomIn:v,zoomOut:g,fitView:D=>d(D),setMinZoom:w,setMaxZoom:y,setTranslateExtent:E,setPaneClickDistance:T,unselectNodesAndEdges:I,addSelectedNodes:H,addSelectedEdges:O,handleNodeSelection:A,panBy:F,updateConnection:Y,cancelConnection:M,reset:K}}function Zt(){const l=Ut(Lo);if(!l)throw new Error("In order to use useStore you need to wrap your component in a <SvelteFlowProvider />");return l.getStore()}function Im({nodes:l,edges:e,width:t,height:n,fitView:o,nodeOrigin:s,nodeExtent:r}){const i=Ta({nodes:l,edges:e,width:t,height:n,fitView:o,nodeOrigin:s,nodeExtent:r});return jl(Lo,{getStore:()=>i}),i}function Sm(l,e){const{panZoom:t,minZoom:n,maxZoom:o,initialViewport:s,viewport:r,dragging:i,translateExtent:a,paneClickDistance:c}=e,u=Ph({domNode:l,minZoom:n,maxZoom:o,translateExtent:a,viewport:s,paneClickDistance:c,onDraggingChange:i.set}),f=u.getViewport();return r.set(f),t.set(u),u.update(e),{update(h){u.update(h)}}}function Dm(l){let e,t,n,o,s;const r=l[35].default,i=xt(r,l,l[34],null);return{c(){e=V("div"),i&&i.c(),this.h()},l(a){e=N(a,"DIV",{class:!0});var c=S(e);i&&i.l(c),c.forEach(p),this.h()},h(){m(e,"class","svelte-flow__zoom svelte-4xkw84")},m(a,c){B(a,e,c),i&&i.m(e,null),n=!0,o||(s=dn(t=Sm.call(null,e,{viewport:l[18],minZoom:l[12],maxZoom:l[13],initialViewport:l[11],dragging:l[23],panZoom:l[19],onPanZoomStart:l[0],onPanZoom:l[1],onPanZoomEnd:l[2],zoomOnScroll:l[5],zoomOnDoubleClick:l[6],zoomOnPinch:l[7],panOnScroll:l[9],panOnDrag:l[10],panOnScrollSpeed:.5,panOnScrollMode:l[3]||Zn.Free,zoomActivationKeyPressed:l[14],preventScrolling:typeof l[4]=="boolean"?l[4]:!0,noPanClassName:"nopan",noWheelClassName:"nowheel",userSelectionActive:!!l[15],translateExtent:l[16],lib:l[17],paneClickDistance:l[8],onTransformChange:l[29]})),o=!0)},p(a,c){i&&i.p&&(!n||c[1]&8)&&$t(i,r,a,a[34],n?tn(r,a[34],c,null):en(a[34]),null),t&&nn(t.update)&&c[0]&262143&&t.update.call(null,{viewport:a[18],minZoom:a[12],maxZoom:a[13],initialViewport:a[11],dragging:a[23],panZoom:a[19],onPanZoomStart:a[0],onPanZoom:a[1],onPanZoomEnd:a[2],zoomOnScroll:a[5],zoomOnDoubleClick:a[6],zoomOnPinch:a[7],panOnScroll:a[9],panOnDrag:a[10],panOnScrollSpeed:.5,panOnScrollMode:a[3]||Zn.Free,zoomActivationKeyPressed:a[14],preventScrolling:typeof a[4]=="boolean"?a[4]:!0,noPanClassName:"nopan",noWheelClassName:"nowheel",userSelectionActive:!!a[15],translateExtent:a[16],lib:a[17],paneClickDistance:a[8],onTransformChange:a[29]})},i(a){n||(C(i,a),n=!0)},o(a){P(i,a),n=!1},d(a){a&&p(e),i&&i.d(a),o=!1,s()}}}function Cm(l,e,t){let n,o,s,r,i,a,c,u,f,h,d,{$$slots:_={},$$scope:b}=e,{initialViewport:v=void 0}=e,{onMoveStart:g=void 0}=e,{onMove:w=void 0}=e,{onMoveEnd:y=void 0}=e,{panOnScrollMode:E}=e,{preventScrolling:z}=e,{zoomOnScroll:T}=e,{zoomOnDoubleClick:I}=e,{zoomOnPinch:H}=e,{panOnDrag:O}=e,{panOnScroll:A}=e,{paneClickDistance:F}=e;const{viewport:j,panZoom:Y,selectionRect:M,minZoom:K,maxZoom:D,dragging:W,translateExtent:L,lib:R,panActivationKeyPressed:X,zoomActivationKeyPressed:Q,viewportInitialized:G}=Zt();ie(l,M,se=>t(15,f=se)),ie(l,K,se=>t(12,a=se)),ie(l,D,se=>t(13,c=se)),ie(l,L,se=>t(16,h=se)),ie(l,R,se=>t(17,d=se)),ie(l,X,se=>t(33,i=se)),ie(l,Q,se=>t(14,u=se)),ie(l,G,se=>t(36,r=se));const ce=se=>j.set({x:se[0],y:se[1],zoom:se[2]});return hn(()=>{fo(G,r=!0,r)}),l.$$set=se=>{"initialViewport"in se&&t(30,v=se.initialViewport),"onMoveStart"in se&&t(0,g=se.onMoveStart),"onMove"in se&&t(1,w=se.onMove),"onMoveEnd"in se&&t(2,y=se.onMoveEnd),"panOnScrollMode"in se&&t(3,E=se.panOnScrollMode),"preventScrolling"in se&&t(4,z=se.preventScrolling),"zoomOnScroll"in se&&t(5,T=se.zoomOnScroll),"zoomOnDoubleClick"in se&&t(6,I=se.zoomOnDoubleClick),"zoomOnPinch"in se&&t(7,H=se.zoomOnPinch),"panOnDrag"in se&&t(31,O=se.panOnDrag),"panOnScroll"in se&&t(32,A=se.panOnScroll),"paneClickDistance"in se&&t(8,F=se.paneClickDistance),"$$scope"in se&&t(34,b=se.$$scope)},l.$$.update=()=>{l.$$.dirty[0]&1073741824&&t(11,n=v||{x:0,y:0,zoom:1}),l.$$.dirty[1]&5&&t(10,o=i||O),l.$$.dirty[1]&6&&t(9,s=i||A)},[g,w,y,E,z,T,I,H,F,s,o,n,a,c,u,f,h,d,j,Y,M,K,D,W,L,R,X,Q,G,ce,v,O,A,i,b,_]}class Mm extends Ve{constructor(e){super(),Ne(this,e,Cm,Dm,Be,{initialViewport:30,onMoveStart:0,onMove:1,onMoveEnd:2,panOnScrollMode:3,preventScrolling:4,zoomOnScroll:5,zoomOnDoubleClick:6,zoomOnPinch:7,panOnDrag:31,panOnScroll:32,paneClickDistance:8},null,[-1,-1])}}function Tm(l){let e,t,n,o;const s=l[28].default,r=xt(s,l,l[27],null);return{c(){e=V("div"),r&&r.c(),this.h()},l(i){e=N(i,"DIV",{class:!0});var a=S(e);r&&r.l(a),a.forEach(p),this.h()},h(){m(e,"class","svelte-flow__pane svelte-1esy7hx"),lt(e,"draggable",l[0]===!0||Array.isArray(l[0])&&l[0].includes(0)),lt(e,"dragging",l[4]),lt(e,"selection",l[1])},m(i,a){B(i,e,a),r&&r.m(e,null),l[29](e),t=!0,n||(o=[ke(e,"click",function(){nn(l[3]?void 0:ao(l[15],l[2]))&&(l[3]?void 0:ao(l[15],l[2])).apply(this,arguments)}),ke(e,"pointerdown",function(){nn(l[3]?l[16]:void 0)&&(l[3]?l[16]:void 0).apply(this,arguments)}),ke(e,"pointermove",function(){nn(l[3]?l[17]:void 0)&&(l[3]?l[17]:void 0).apply(this,arguments)}),ke(e,"pointerup",function(){nn(l[3]?l[18]:void 0)&&(l[3]?l[18]:void 0).apply(this,arguments)}),ke(e,"contextmenu",function(){nn(ao(l[19],l[2]))&&ao(l[19],l[2]).apply(this,arguments)})],n=!0)},p(i,a){l=i,r&&r.p&&(!t||a[0]&134217728)&&$t(r,s,l,l[27],t?tn(s,l[27],a,null):en(l[27]),null),(!t||a[0]&1)&&lt(e,"draggable",l[0]===!0||Array.isArray(l[0])&&l[0].includes(0)),(!t||a[0]&16)&&lt(e,"dragging",l[4]),(!t||a[0]&2)&&lt(e,"selection",l[1])},i(i){t||(C(r,i),t=!0)},o(i){P(r,i),t=!1},d(i){i&&p(e),r&&r.d(i),l[29](null),n=!1,ln(o)}}}function ao(l,e){return t=>{t.target===e&&(l==null||l(t))}}function Hr(l){return e=>{const t=l.includes(e.id);return e.selected!==t&&(e.selected=t),e}}function Vm(l,e,t){let n,o,s,r,i,a,c,u,f,h,d,_,b,{$$slots:v={},$$scope:g}=e,{panOnDrag:w=void 0}=e,{selectionOnDrag:y=void 0}=e;const E=on(),{nodes:z,nodeLookup:T,edges:I,viewport:H,dragging:O,elementsSelectable:A,selectionRect:F,selectionRectMode:j,selectionKeyPressed:Y,selectionMode:M,panActivationKeyPressed:K,unselectNodesAndEdges:D}=Zt();ie(l,T,re=>t(36,f=re)),ie(l,I,re=>t(33,a=re)),ie(l,H,re=>t(35,u=re)),ie(l,O,re=>t(4,b=re)),ie(l,A,re=>t(25,d=re)),ie(l,F,re=>t(24,h=re)),ie(l,j,re=>t(23,i=re)),ie(l,Y,re=>t(22,r=re)),ie(l,M,re=>t(34,c=re)),ie(l,K,re=>t(26,_=re));let W,L=null,R=[],X=!1;function Q(re){if(X){X=!1;return}E("paneclick",{event:re}),D(),j.set(null)}function G(re){var ae,Ie;if(L=W.getBoundingClientRect(),!A||!o||re.button!==0||re.target!==W||!L)return;(Ie=(ae=re.target)==null?void 0:ae.setPointerCapture)==null||Ie.call(ae,re.pointerId);const{x:q,y:Ee}=Qn(re,L);D(),F.set({width:0,height:0,startX:q,startY:Ee,x:q,y:Ee})}function ce(re){if(!o||!L||!h)return;X=!0;const q=Qn(re,L),Ee=h.startX??0,ae=h.startY??0,Ie={...h,x:q.x<Ee?q.x:Ee,y:q.y<ae?q.y:ae,width:Math.abs(q.x-Ee),height:Math.abs(q.y-ae)},ge=R.map(ut=>ut.id),_t=es(R,a).map(ut=>ut.id);R=ta(f,Ie,[u.x,u.y,u.zoom],c===vo.Partial,!0);const me=es(R,a).map(ut=>ut.id),ct=R.map(ut=>ut.id);(ge.length!==ct.length||ct.some(ut=>!ge.includes(ut)))&&z.update(ut=>ut.map(Hr(ct))),(_t.length!==me.length||me.some(ut=>!_t.includes(ut)))&&I.update(ut=>ut.map(Hr(me))),j.set("user"),F.set(Ie)}function se(re){var q,Ee;re.button===0&&((Ee=(q=re.target)==null?void 0:q.releasePointerCapture)==null||Ee.call(q,re.pointerId),!o&&i==="user"&&re.target===W&&(Q==null||Q(re)),F.set(null),R.length>0&&fo(j,i="nodes",i),r&&(X=!1))}const ye=re=>{if(Array.isArray(n)&&(n!=null&&n.includes(2))){re.preventDefault();return}E("panecontextmenu",{event:re})};function Se(re){We[re?"unshift":"push"](()=>{W=re,t(2,W)})}return l.$$set=re=>{"panOnDrag"in re&&t(0,w=re.panOnDrag),"selectionOnDrag"in re&&t(20,y=re.selectionOnDrag),"$$scope"in re&&t(27,g=re.$$scope)},l.$$.update=()=>{l.$$.dirty[0]&67108865&&t(21,n=_||w),l.$$.dirty[0]&24117248&&t(1,o=r||h||y&&n!==!0),l.$$.dirty[0]&41943042&&t(3,s=d&&(o||i==="user"))},[w,o,W,s,b,T,I,H,O,A,F,j,Y,M,K,Q,G,ce,se,ye,y,n,r,i,h,d,_,g,v,Se]}class Nm extends Ve{constructor(e){super(),Ne(this,e,Vm,Tm,Be,{panOnDrag:0,selectionOnDrag:20},null,[-1,-1])}}function zm(l){let e,t;const n=l[3].default,o=xt(n,l,l[2],null);return{c(){e=V("div"),o&&o.c(),this.h()},l(s){e=N(s,"DIV",{class:!0,style:!0});var r=S(e);o&&o.l(r),r.forEach(p),this.h()},h(){m(e,"class","svelte-flow__viewport xyflow__viewport svelte-1floaup"),tt(e,"transform","translate("+l[0].x+"px, "+l[0].y+"px) scale("+l[0].zoom+")")},m(s,r){B(s,e,r),o&&o.m(e,null),t=!0},p(s,[r]){o&&o.p&&(!t||r&4)&&$t(o,n,s,s[2],t?tn(n,s[2],r,null):en(s[2]),null),(!t||r&1)&&tt(e,"transform","translate("+s[0].x+"px, "+s[0].y+"px) scale("+s[0].zoom+")")},i(s){t||(C(o,s),t=!0)},o(s){P(o,s),t=!1},d(s){s&&p(e),o&&o.d(s)}}}function Pm(l,e,t){let n,{$$slots:o={},$$scope:s}=e;const{viewport:r}=Zt();return ie(l,r,i=>t(0,n=i)),l.$$set=i=>{"$$scope"in i&&t(2,s=i.$$scope)},[n,r,s,o]}class Om extends Ve{constructor(e){super(),Ne(this,e,Pm,zm,Be,{})}}function Va(l,e){const{store:t,onDrag:n,onDragStart:o,onDragStop:s,onNodeMouseDown:r}=e,i=vh({onDrag:n,onDragStart:o,onDragStop:s,onNodeMouseDown:r,getStoreItems:()=>{const c=he(t.snapGrid),u=he(t.viewport);return{nodes:he(t.nodes),nodeLookup:he(t.nodeLookup),edges:he(t.edges),nodeExtent:he(t.nodeExtent),snapGrid:c||[0,0],snapToGrid:!!c,nodeOrigin:he(t.nodeOrigin),multiSelectionActive:he(t.multiselectionKeyPressed),domNode:he(t.domNode),transform:[u.x,u.y,u.zoom],autoPanOnNodeDrag:he(t.autoPanOnNodeDrag),nodesDraggable:he(t.nodesDraggable),selectNodesOnDrag:he(t.selectNodesOnDrag),nodeDragThreshold:he(t.nodeDragThreshold),unselectNodesAndEdges:t.unselectNodesAndEdges,updateNodePositions:t.updateNodePositions,panBy:t.panBy}}});function a(c,u){if(u.disabled){i.destroy();return}i.update({domNode:c,noDragClassName:u.noDragClass,handleSelector:u.handleSelector,nodeId:u.nodeId,isSelectable:u.isSelectable,nodeClickDistance:u.nodeClickDistance})}return a(l,e),{update(c){a(l,c)},destroy(){i.destroy()}}}function Hm({width:l,height:e,initialWidth:t,initialHeight:n,measuredWidth:o,measuredHeight:s}){if(o===void 0&&s===void 0){const r=l??t,i=e??n;return{width:r?`width:${r}px;`:"",height:i?`height:${i}px;`:""}}return{width:l?`width:${l}px;`:"",height:e?`height:${e}px;`:""}}function Br(l){let e,t,n,o,s,r=`translate(${l[12]}px, ${l[13]}px)`,i,a,c;var u=l[27];function f(h,d){return{props:{data:h[2],id:h[1],selected:h[3],selectable:h[5],deletable:h[7],sourcePosition:h[14],targetPosition:h[15],zIndex:h[16],dragging:h[9],draggable:h[4],dragHandle:h[19],parentId:h[21],type:h[25],isConnectable:h[28],positionAbsoluteX:h[12],positionAbsoluteY:h[13],width:h[17],height:h[18]}}}return u&&(t=ho(u,f(l))),{c(){e=V("div"),t&&te(t.$$.fragment),this.h()},l(h){e=N(h,"DIV",{"data-id":!0,class:!0,style:!0});var d=S(e);t&&oe(t.$$.fragment,d),d.forEach(p),this.h()},h(){m(e,"data-id",l[1]),m(e,"class",n=Bt(["svelte-flow__node",`svelte-flow__node-${l[25]}`,l[23]])),m(e,"style",o=(l[10]??"")+";"+l[26].width+l[26].height),lt(e,"dragging",l[9]),lt(e,"selected",l[3]),lt(e,"draggable",l[4]),lt(e,"connectable",l[6]),lt(e,"selectable",l[5]),lt(e,"nopan",l[4]),lt(e,"parent",l[11]),tt(e,"z-index",l[16]),tt(e,"transform",r),tt(e,"visibility",l[20]?"visible":"hidden")},m(h,d){B(h,e,d),t&&ne(t,e,null),l[50](e),i=!0,a||(c=[dn(s=Va.call(null,e,{nodeId:l[1],isSelectable:l[5],disabled:!1,handleSelector:l[19],noDragClass:"nodrag",nodeClickDistance:l[22],onNodeMouseDown:l[31],onDrag:l[47],onDragStart:l[48],onDragStop:l[49],store:l[29]})),ke(e,"click",l[34]),ke(e,"mouseenter",l[51]),ke(e,"mouseleave",l[52]),ke(e,"mousemove",l[53]),ke(e,"contextmenu",l[54])],a=!0)},p(h,d){if(d[0]&134217728&&u!==(u=h[27])){if(t){Ae();const b=t;P(b.$$.fragment,1,0,()=>{le(b,1)}),Le()}u?(t=ho(u,f(h)),te(t.$$.fragment),C(t.$$.fragment,1),ne(t,e,null)):t=null}else if(u){const b={};d[0]&4&&(b.data=h[2]),d[0]&2&&(b.id=h[1]),d[0]&8&&(b.selected=h[3]),d[0]&32&&(b.selectable=h[5]),d[0]&128&&(b.deletable=h[7]),d[0]&16384&&(b.sourcePosition=h[14]),d[0]&32768&&(b.targetPosition=h[15]),d[0]&65536&&(b.zIndex=h[16]),d[0]&512&&(b.dragging=h[9]),d[0]&16&&(b.draggable=h[4]),d[0]&524288&&(b.dragHandle=h[19]),d[0]&2097152&&(b.parentId=h[21]),d[0]&33554432&&(b.type=h[25]),d[0]&268435456&&(b.isConnectable=h[28]),d[0]&4096&&(b.positionAbsoluteX=h[12]),d[0]&8192&&(b.positionAbsoluteY=h[13]),d[0]&131072&&(b.width=h[17]),d[0]&262144&&(b.height=h[18]),t.$set(b)}(!i||d[0]&2)&&m(e,"data-id",h[1]),(!i||d[0]&41943040&&n!==(n=Bt(["svelte-flow__node",`svelte-flow__node-${h[25]}`,h[23]])))&&m(e,"class",n),(!i||d[0]&67109888&&o!==(o=(h[10]??"")+";"+h[26].width+h[26].height))&&m(e,"style",o),s&&nn(s.update)&&d[0]&4718626&&s.update.call(null,{nodeId:h[1],isSelectable:h[5],disabled:!1,handleSelector:h[19],noDragClass:"nodrag",nodeClickDistance:h[22],onNodeMouseDown:h[31],onDrag:h[47],onDragStart:h[48],onDragStop:h[49],store:h[29]}),(!i||d[0]&41943552)&&lt(e,"dragging",h[9]),(!i||d[0]&41943048)&&lt(e,"selected",h[3]),(!i||d[0]&41943056)&&lt(e,"draggable",h[4]),(!i||d[0]&41943104)&&lt(e,"connectable",h[6]),(!i||d[0]&41943072)&&lt(e,"selectable",h[5]),(!i||d[0]&41943056)&&lt(e,"nopan",h[4]),(!i||d[0]&41945088)&&lt(e,"parent",h[11]);const _=d[0]&67109888;(d[0]&67175424||_)&&tt(e,"z-index",h[16]),(d[0]&67122176&&r!==(r=`translate(${h[12]}px, ${h[13]}px)`)||_)&&tt(e,"transform",r),(d[0]&68158464||_)&&tt(e,"visibility",h[20]?"visible":"hidden")},i(h){i||(t&&C(t.$$.fragment,h),i=!0)},o(h){t&&P(t.$$.fragment,h),i=!1},d(h){h&&p(e),t&&le(t),l[50](null),a=!1,ln(c)}}}function Bm(l){let e,t,n=!l[8]&&Br(l);return{c(){n&&n.c(),e=Oe()},l(o){n&&n.l(o),e=Oe()},m(o,s){n&&n.m(o,s),B(o,e,s),t=!0},p(o,s){o[8]?n&&(Ae(),P(n,1,1,()=>{n=null}),Le()):n?(n.p(o,s),s[0]&256&&C(n,1)):(n=Br(o),n.c(),C(n,1),n.m(e.parentNode,e))},i(o){t||(C(n),t=!0)},o(o){P(n),t=!1},d(o){o&&p(e),n&&n.d(o)}}}function Am(l,e,t){let n,o,s,r,i,a,{node:c}=e,{id:u}=e,{data:f={}}=e,{selected:h=!1}=e,{draggable:d=void 0}=e,{selectable:_=void 0}=e,{connectable:b=!0}=e,{deletable:v=!0}=e,{hidden:g=!1}=e,{dragging:w=!1}=e,{resizeObserver:y=null}=e,{style:E=void 0}=e,{type:z="default"}=e,{isParent:T=!1}=e,{positionX:I}=e,{positionY:H}=e,{sourcePosition:O=void 0}=e,{targetPosition:A=void 0}=e,{zIndex:F}=e,{measuredWidth:j=void 0}=e,{measuredHeight:Y=void 0}=e,{initialWidth:M=void 0}=e,{initialHeight:K=void 0}=e,{width:D=void 0}=e,{height:W=void 0}=e,{dragHandle:L=void 0}=e,{initialized:R=!1}=e,{parentId:X=void 0}=e,{nodeClickDistance:Q=void 0}=e,{class:G=""}=e;const ce=Zt(),{nodeTypes:se,nodeDragThreshold:ye,selectNodesOnDrag:Se,handleNodeSelection:re,updateNodeInternals:q}=ce;ie(l,se,_e=>t(46,i=_e));let Ee,ae=null;const Ie=on(),ge=Je(b);ie(l,ge,_e=>t(28,a=_e));let _t,me,ct;jl("svelteflow__node_id",u),jl("svelteflow__node_connectable",ge),il(()=>{ae&&(y==null||y.unobserve(ae))});function ut(_e){_&&(!he(Se)||!d||he(ye)>0)&&re(u),Ie("nodeclick",{node:c.internals.userNode,event:_e})}const Wt=(_e,St,pt,ht)=>{Ie("nodedrag",{event:_e,targetNode:pt,nodes:ht})},ve=(_e,St,pt,ht)=>{Ie("nodedragstart",{event:_e,targetNode:pt,nodes:ht})},Ue=(_e,St,pt,ht)=>{Ie("nodedragstop",{event:_e,targetNode:pt,nodes:ht})};function st(_e){We[_e?"unshift":"push"](()=>{Ee=_e,t(24,Ee)})}const yt=_e=>Ie("nodemouseenter",{node:c,event:_e}),ft=_e=>Ie("nodemouseleave",{node:c,event:_e}),rt=_e=>Ie("nodemousemove",{node:c,event:_e}),At=_e=>Ie("nodecontextmenu",{node:c,event:_e});return l.$$set=_e=>{"node"in _e&&t(0,c=_e.node),"id"in _e&&t(1,u=_e.id),"data"in _e&&t(2,f=_e.data),"selected"in _e&&t(3,h=_e.selected),"draggable"in _e&&t(4,d=_e.draggable),"selectable"in _e&&t(5,_=_e.selectable),"connectable"in _e&&t(6,b=_e.connectable),"deletable"in _e&&t(7,v=_e.deletable),"hidden"in _e&&t(8,g=_e.hidden),"dragging"in _e&&t(9,w=_e.dragging),"resizeObserver"in _e&&t(35,y=_e.resizeObserver),"style"in _e&&t(10,E=_e.style),"type"in _e&&t(36,z=_e.type),"isParent"in _e&&t(11,T=_e.isParent),"positionX"in _e&&t(12,I=_e.positionX),"positionY"in _e&&t(13,H=_e.positionY),"sourcePosition"in _e&&t(14,O=_e.sourcePosition),"targetPosition"in _e&&t(15,A=_e.targetPosition),"zIndex"in _e&&t(16,F=_e.zIndex),"measuredWidth"in _e&&t(37,j=_e.measuredWidth),"measuredHeight"in _e&&t(38,Y=_e.measuredHeight),"initialWidth"in _e&&t(39,M=_e.initialWidth),"initialHeight"in _e&&t(40,K=_e.initialHeight),"width"in _e&&t(17,D=_e.width),"height"in _e&&t(18,W=_e.height),"dragHandle"in _e&&t(19,L=_e.dragHandle),"initialized"in _e&&t(20,R=_e.initialized),"parentId"in _e&&t(21,X=_e.parentId),"nodeClickDistance"in _e&&t(22,Q=_e.nodeClickDistance),"class"in _e&&t(23,G=_e.class)},l.$$.update=()=>{l.$$.dirty[1]&32&&t(25,n=z||"default"),l.$$.dirty[0]&33554432|l.$$.dirty[1]&32768&&t(45,o=!!i[n]),l.$$.dirty[0]&33554432|l.$$.dirty[1]&32768&&t(27,s=i[n]||Ia),l.$$.dirty[1]&16416&&(o||console.warn("003",Jl.error003(z))),l.$$.dirty[0]&393216|l.$$.dirty[1]&960&&t(26,r=Hm({width:D,height:W,initialWidth:M,initialHeight:K,measuredWidth:j,measuredHeight:Y})),l.$$.dirty[0]&64&&ge.set(!!b),l.$$.dirty[0]&50380802|l.$$.dirty[1]&14336&&((_t&&n!==_t||me&&O!==me||ct&&A!==ct)&&requestAnimationFrame(()=>q(new Map([[u,{id:u,nodeElement:Ee,force:!0}]]))),t(42,_t=n),t(43,me=O),t(44,ct=A)),l.$$.dirty[0]&17825792|l.$$.dirty[1]&1040&&y&&(Ee!==ae||!R)&&(ae&&y.unobserve(ae),Ee&&y.observe(Ee),t(41,ae=Ee))},[c,u,f,h,d,_,b,v,g,w,E,T,I,H,O,A,F,D,W,L,R,X,Q,G,Ee,n,r,s,a,ce,se,re,Ie,ge,ut,y,z,j,Y,M,K,ae,_t,me,ct,o,i,Wt,ve,Ue,st,yt,ft,rt,At]}class Lm extends Ve{constructor(e){super(),Ne(this,e,Am,Bm,Li,{node:0,id:1,data:2,selected:3,draggable:4,selectable:5,connectable:6,deletable:7,hidden:8,dragging:9,resizeObserver:35,style:10,type:36,isParent:11,positionX:12,positionY:13,sourcePosition:14,targetPosition:15,zIndex:16,measuredWidth:37,measuredHeight:38,initialWidth:39,initialHeight:40,width:17,height:18,dragHandle:19,initialized:20,parentId:21,nodeClickDistance:22,class:23},null,[-1,-1])}}const{Map:Rm}=Ri;function Ar(l,e,t){const n=l.slice();return n[21]=e[t],n}function Lr(l,e){let t,n,o;return n=new Lm({props:{node:e[21],id:e[21].id,data:e[21].data,selected:!!e[21].selected,hidden:!!e[21].hidden,draggable:!!(e[21].draggable||e[2]&&typeof e[21].draggable>"u"),selectable:!!(e[21].selectable||e[3]&&typeof e[21].selectable>"u"),connectable:!!(e[21].connectable||e[4]&&typeof e[21].connectable>"u"),deletable:e[21].deletable??!0,positionX:e[21].internals.positionAbsolute.x,positionY:e[21].internals.positionAbsolute.y,isParent:e[5].has(e[21].id),style:e[21].style,class:e[21].class,type:e[21].type??"default",sourcePosition:e[21].sourcePosition,targetPosition:e[21].targetPosition,dragging:e[21].dragging,zIndex:e[21].internals.z??0,dragHandle:e[21].dragHandle,initialized:Er(e[21]),width:e[21].width,height:e[21].height,initialWidth:e[21].initialWidth,initialHeight:e[21].initialHeight,measuredWidth:e[21].measured.width,measuredHeight:e[21].measured.height,parentId:e[21].parentId,resizeObserver:e[11],nodeClickDistance:e[0]}}),n.$on("nodeclick",e[12]),n.$on("nodemouseenter",e[13]),n.$on("nodemousemove",e[14]),n.$on("nodemouseleave",e[15]),n.$on("nodedrag",e[16]),n.$on("nodedragstart",e[17]),n.$on("nodedragstop",e[18]),n.$on("nodecontextmenu",e[19]),{key:l,first:null,c(){t=Oe(),te(n.$$.fragment),this.h()},l(s){t=Oe(),oe(n.$$.fragment,s),this.h()},h(){this.first=t},m(s,r){B(s,t,r),ne(n,s,r),o=!0},p(s,r){e=s;const i={};r&2&&(i.node=e[21]),r&2&&(i.id=e[21].id),r&2&&(i.data=e[21].data),r&2&&(i.selected=!!e[21].selected),r&2&&(i.hidden=!!e[21].hidden),r&6&&(i.draggable=!!(e[21].draggable||e[2]&&typeof e[21].draggable>"u")),r&10&&(i.selectable=!!(e[21].selectable||e[3]&&typeof e[21].selectable>"u")),r&18&&(i.connectable=!!(e[21].connectable||e[4]&&typeof e[21].connectable>"u")),r&2&&(i.deletable=e[21].deletable??!0),r&2&&(i.positionX=e[21].internals.positionAbsolute.x),r&2&&(i.positionY=e[21].internals.positionAbsolute.y),r&34&&(i.isParent=e[5].has(e[21].id)),r&2&&(i.style=e[21].style),r&2&&(i.class=e[21].class),r&2&&(i.type=e[21].type??"default"),r&2&&(i.sourcePosition=e[21].sourcePosition),r&2&&(i.targetPosition=e[21].targetPosition),r&2&&(i.dragging=e[21].dragging),r&2&&(i.zIndex=e[21].internals.z??0),r&2&&(i.dragHandle=e[21].dragHandle),r&2&&(i.initialized=Er(e[21])),r&2&&(i.width=e[21].width),r&2&&(i.height=e[21].height),r&2&&(i.initialWidth=e[21].initialWidth),r&2&&(i.initialHeight=e[21].initialHeight),r&2&&(i.measuredWidth=e[21].measured.width),r&2&&(i.measuredHeight=e[21].measured.height),r&2&&(i.parentId=e[21].parentId),r&1&&(i.nodeClickDistance=e[0]),n.$set(i)},i(s){o||(C(n.$$.fragment,s),o=!0)},o(s){P(n.$$.fragment,s),o=!1},d(s){s&&p(t),le(n,s)}}}function Um(l){let e,t=[],n=new Rm,o,s=wt(l[1]);const r=i=>i[21].id;for(let i=0;i<s.length;i+=1){let a=Ar(l,s,i),c=r(a);n.set(c,t[i]=Lr(c,a))}return{c(){e=V("div");for(let i=0;i<t.length;i+=1)t[i].c();this.h()},l(i){e=N(i,"DIV",{class:!0});var a=S(e);for(let c=0;c<t.length;c+=1)t[c].l(a);a.forEach(p),this.h()},h(){m(e,"class","svelte-flow__nodes svelte-tf4uy4")},m(i,a){B(i,e,a);for(let c=0;c<t.length;c+=1)t[c]&&t[c].m(e,null);o=!0},p(i,[a]){a&2111&&(s=wt(i[1]),Ae(),t=So(t,a,r,1,i,s,n,e,Do,Lr,null,Ar),Le())},i(i){if(!o){for(let a=0;a<s.length;a+=1)C(t[a]);o=!0}},o(i){for(let a=0;a<t.length;a+=1)P(t[a]);o=!1},d(i){i&&p(e);for(let a=0;a<t.length;a+=1)t[a].d()}}}function Wm(l,e,t){let n,o,s,r,i,{nodeClickDistance:a=0}=e;const{visibleNodes:c,nodesDraggable:u,nodesConnectable:f,elementsSelectable:h,updateNodeInternals:d,parentLookup:_}=Zt();ie(l,c,H=>t(1,n=H)),ie(l,u,H=>t(2,o=H)),ie(l,f,H=>t(4,r=H)),ie(l,h,H=>t(3,s=H)),ie(l,_,H=>t(5,i=H));const b=typeof ResizeObserver>"u"?null:new ResizeObserver(H=>{const O=new Map;H.forEach(A=>{const F=A.target.getAttribute("data-id");O.set(F,{id:F,nodeElement:A.target,force:!0})}),d(O)});il(()=>{b==null||b.disconnect()});function v(H){bt.call(this,l,H)}function g(H){bt.call(this,l,H)}function w(H){bt.call(this,l,H)}function y(H){bt.call(this,l,H)}function E(H){bt.call(this,l,H)}function z(H){bt.call(this,l,H)}function T(H){bt.call(this,l,H)}function I(H){bt.call(this,l,H)}return l.$$set=H=>{"nodeClickDistance"in H&&t(0,a=H.nodeClickDistance)},[a,n,o,s,r,i,c,u,f,h,_,b,v,g,w,y,E,z,T,I]}class jm extends Ve{constructor(e){super(),Ne(this,e,Wm,Um,Be,{nodeClickDistance:0})}}function Rr(l){let e,t,n,o,s,r,i,a;var c=l[27];function u(f,h){return{props:{id:f[0],source:f[1],target:f[2],sourceX:f[14],sourceY:f[15],targetX:f[16],targetY:f[17],sourcePosition:f[18],targetPosition:f[19],animated:f[6],selected:f[7],label:f[10],labelStyle:f[11],data:f[3],style:f[4],interactionWidth:f[21],selectable:f[24],deletable:f[8]??!0,type:f[23],sourceHandleId:f[12],targetHandleId:f[13],markerStart:f[26],markerEnd:f[25]}}}return c&&(n=ho(c,u(l))),{c(){e=ze("svg"),t=ze("g"),n&&te(n.$$.fragment),this.h()},l(f){e=Pe(f,"svg",{});var h=S(e);t=Pe(h,"g",{class:!0,"data-id":!0,"aria-label":!0,role:!0});var d=S(t);n&&oe(n.$$.fragment,d),d.forEach(p),h.forEach(p),this.h()},h(){m(t,"class",o=Bt(["svelte-flow__edge",l[22]])),m(t,"data-id",l[0]),m(t,"aria-label",s=l[20]===null?void 0:l[20]?l[20]:`Edge from ${l[1]} to ${l[2]}`),m(t,"role","img"),lt(t,"animated",l[6]),lt(t,"selected",l[7]),lt(t,"selectable",l[24]),tt(e,"z-index",l[5])},m(f,h){B(f,e,h),k(e,t),n&&ne(n,t,null),r=!0,i||(a=[ke(t,"click",l[32]),ke(t,"contextmenu",l[41]),ke(t,"mouseenter",l[42]),ke(t,"mouseleave",l[43])],i=!0)},p(f,h){if(h[0]&134217728&&c!==(c=f[27])){if(n){Ae();const d=n;P(d.$$.fragment,1,0,()=>{le(d,1)}),Le()}c?(n=ho(c,u(f)),te(n.$$.fragment),C(n.$$.fragment,1),ne(n,t,null)):n=null}else if(c){const d={};h[0]&1&&(d.id=f[0]),h[0]&2&&(d.source=f[1]),h[0]&4&&(d.target=f[2]),h[0]&16384&&(d.sourceX=f[14]),h[0]&32768&&(d.sourceY=f[15]),h[0]&65536&&(d.targetX=f[16]),h[0]&131072&&(d.targetY=f[17]),h[0]&262144&&(d.sourcePosition=f[18]),h[0]&524288&&(d.targetPosition=f[19]),h[0]&64&&(d.animated=f[6]),h[0]&128&&(d.selected=f[7]),h[0]&1024&&(d.label=f[10]),h[0]&2048&&(d.labelStyle=f[11]),h[0]&8&&(d.data=f[3]),h[0]&16&&(d.style=f[4]),h[0]&2097152&&(d.interactionWidth=f[21]),h[0]&16777216&&(d.selectable=f[24]),h[0]&256&&(d.deletable=f[8]??!0),h[0]&8388608&&(d.type=f[23]),h[0]&4096&&(d.sourceHandleId=f[12]),h[0]&8192&&(d.targetHandleId=f[13]),h[0]&67108864&&(d.markerStart=f[26]),h[0]&33554432&&(d.markerEnd=f[25]),n.$set(d)}(!r||h[0]&4194304&&o!==(o=Bt(["svelte-flow__edge",f[22]])))&&m(t,"class",o),(!r||h[0]&1)&&m(t,"data-id",f[0]),(!r||h[0]&1048582&&s!==(s=f[20]===null?void 0:f[20]?f[20]:`Edge from ${f[1]} to ${f[2]}`))&&m(t,"aria-label",s),(!r||h[0]&4194368)&&lt(t,"animated",f[6]),(!r||h[0]&4194432)&&lt(t,"selected",f[7]),(!r||h[0]&20971520)&&lt(t,"selectable",f[24]),h[0]&32&&tt(e,"z-index",f[5])},i(f){r||(n&&C(n.$$.fragment,f),r=!0)},o(f){n&&P(n.$$.fragment,f),r=!1},d(f){f&&p(e),n&&le(n),i=!1,ln(a)}}}function Fm(l){let e,t,n=!l[9]&&Rr(l);return{c(){n&&n.c(),e=Oe()},l(o){n&&n.l(o),e=Oe()},m(o,s){n&&n.m(o,s),B(o,e,s),t=!0},p(o,s){o[9]?n&&(Ae(),P(n,1,1,()=>{n=null}),Le()):n?(n.p(o,s),s[0]&512&&C(n,1)):(n=Rr(o),n.c(),C(n,1),n.m(e.parentNode,e))},i(o){t||(C(n),t=!0)},o(o){P(n),t=!1},d(o){o&&p(e),n&&n.d(o)}}}function Ym(l,e,t){let n,o,s,r,i,a,c,u,f,{id:h}=e,{type:d="default"}=e,{source:_=""}=e,{target:b=""}=e,{data:v={}}=e,{style:g=void 0}=e,{zIndex:w=void 0}=e,{animated:y=!1}=e,{selected:E=!1}=e,{selectable:z=void 0}=e,{deletable:T=void 0}=e,{hidden:I=!1}=e,{label:H=void 0}=e,{labelStyle:O=void 0}=e,{markerStart:A=void 0}=e,{markerEnd:F=void 0}=e,{sourceHandle:j=void 0}=e,{targetHandle:Y=void 0}=e,{sourceX:M}=e,{sourceY:K}=e,{targetX:D}=e,{targetY:W}=e,{sourcePosition:L}=e,{targetPosition:R}=e,{ariaLabel:X=void 0}=e,{interactionWidth:Q=void 0}=e,{class:G=""}=e;jl("svelteflow__edge_id",h);const{edgeLookup:ce,edgeTypes:se,flowId:ye,elementsSelectable:Se}=Zt();ie(l,ce,me=>t(44,a=me)),ie(l,se,me=>t(40,f=me)),ie(l,ye,me=>t(39,u=me)),ie(l,Se,me=>t(38,c=me));const re=on(),q=Sa();function Ee(me){const ct=a.get(h);ct&&(q(h),re("edgeclick",{event:me,edge:ct}))}function ae(me,ct){const ut=a.get(h);ut&&re(ct,{event:me,edge:ut})}const Ie=me=>{ae(me,"edgecontextmenu")},ge=me=>{ae(me,"edgemouseenter")},_t=me=>{ae(me,"edgemouseleave")};return l.$$set=me=>{"id"in me&&t(0,h=me.id),"type"in me&&t(34,d=me.type),"source"in me&&t(1,_=me.source),"target"in me&&t(2,b=me.target),"data"in me&&t(3,v=me.data),"style"in me&&t(4,g=me.style),"zIndex"in me&&t(5,w=me.zIndex),"animated"in me&&t(6,y=me.animated),"selected"in me&&t(7,E=me.selected),"selectable"in me&&t(35,z=me.selectable),"deletable"in me&&t(8,T=me.deletable),"hidden"in me&&t(9,I=me.hidden),"label"in me&&t(10,H=me.label),"labelStyle"in me&&t(11,O=me.labelStyle),"markerStart"in me&&t(36,A=me.markerStart),"markerEnd"in me&&t(37,F=me.markerEnd),"sourceHandle"in me&&t(12,j=me.sourceHandle),"targetHandle"in me&&t(13,Y=me.targetHandle),"sourceX"in me&&t(14,M=me.sourceX),"sourceY"in me&&t(15,K=me.sourceY),"targetX"in me&&t(16,D=me.targetX),"targetY"in me&&t(17,W=me.targetY),"sourcePosition"in me&&t(18,L=me.sourcePosition),"targetPosition"in me&&t(19,R=me.targetPosition),"ariaLabel"in me&&t(20,X=me.ariaLabel),"interactionWidth"in me&&t(21,Q=me.interactionWidth),"class"in me&&t(22,G=me.class)},l.$$.update=()=>{l.$$.dirty[1]&8&&t(23,n=d||"default"),l.$$.dirty[0]&8388608|l.$$.dirty[1]&512&&t(27,o=f[n]||Da),l.$$.dirty[1]&288&&t(26,s=A?`url('#${ns(A,u)}')`:void 0),l.$$.dirty[1]&320&&t(25,r=F?`url('#${ns(F,u)}')`:void 0),l.$$.dirty[1]&144&&t(24,i=z??c)},[h,_,b,v,g,w,y,E,T,I,H,O,j,Y,M,K,D,W,L,R,X,Q,G,n,i,r,s,o,ce,se,ye,Se,Ee,ae,d,z,A,F,c,u,f,Ie,ge,_t]}class Zm extends Ve{constructor(e){super(),Ne(this,e,Ym,Fm,Li,{id:0,type:34,source:1,target:2,data:3,style:4,zIndex:5,animated:6,selected:7,selectable:35,deletable:8,hidden:9,label:10,labelStyle:11,markerStart:36,markerEnd:37,sourceHandle:12,targetHandle:13,sourceX:14,sourceY:15,targetX:16,targetY:17,sourcePosition:18,targetPosition:19,ariaLabel:20,interactionWidth:21,class:22},null,[-1,-1])}}function Xm(l,e,t){let{onMount:n=void 0}=e,{onDestroy:o=void 0}=e;return hn(()=>(n==null||n(),o)),l.$$set=s=>{"onMount"in s&&t(0,n=s.onMount),"onDestroy"in s&&t(1,o=s.onDestroy)},[n,o]}class Km extends Ve{constructor(e){super(),Ne(this,e,Xm,null,Be,{onMount:0,onDestroy:1})}}function Ur(l,e,t){const n=l.slice();return n[2]=e[t],n}function Wr(l,e){let t,n,o;const s=[e[2]];let r={};for(let i=0;i<s.length;i+=1)r=It(r,s[i]);return n=new t1({props:r}),{key:l,first:null,c(){t=Oe(),te(n.$$.fragment),this.h()},l(i){t=Oe(),oe(n.$$.fragment,i),this.h()},h(){this.first=t},m(i,a){B(i,t,a),ne(n,i,a),o=!0},p(i,a){e=i;const c=a&1?rl(s,[Fl(e[2])]):{};n.$set(c)},i(i){o||(C(n.$$.fragment,i),o=!0)},o(i){P(n.$$.fragment,i),o=!1},d(i){i&&p(t),le(n,i)}}}function qm(l){let e,t=[],n=new Map,o,s=wt(l[0]);const r=i=>i[2].id;for(let i=0;i<s.length;i+=1){let a=Ur(l,s,i),c=r(a);n.set(c,t[i]=Wr(c,a))}return{c(){e=ze("defs");for(let i=0;i<t.length;i+=1)t[i].c()},l(i){e=Pe(i,"defs",{});var a=S(e);for(let c=0;c<t.length;c+=1)t[c].l(a);a.forEach(p)},m(i,a){B(i,e,a);for(let c=0;c<t.length;c+=1)t[c]&&t[c].m(e,null);o=!0},p(i,[a]){a&1&&(s=wt(i[0]),Ae(),t=So(t,a,r,1,i,s,n,e,Do,Wr,null,Ur),Le())},i(i){if(!o){for(let a=0;a<s.length;a+=1)C(t[a]);o=!0}},o(i){for(let a=0;a<t.length;a+=1)P(t[a]);o=!1},d(i){i&&p(e);for(let a=0;a<t.length;a+=1)t[a].d()}}}function Gm(l,e,t){let n;const{markers:o}=Zt();return ie(l,o,s=>t(0,n=s)),[n,o]}class Jm extends Ve{constructor(e){super(),Ne(this,e,Gm,qm,Be,{})}}function Qm(l){let e;return{c(){e=ze("polyline"),this.h()},l(t){e=Pe(t,"polyline",{stroke:!0,"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,fill:!0,points:!0}),S(e).forEach(p),this.h()},h(){m(e,"stroke",l[6]),m(e,"stroke-linecap","round"),m(e,"stroke-linejoin","round"),m(e,"stroke-width",l[7]),m(e,"fill",l[6]),m(e,"points","-5,-4 0,0 -5,4 -5,-4")},m(t,n){B(t,e,n)},p(t,n){n&64&&m(e,"stroke",t[6]),n&128&&m(e,"stroke-width",t[7]),n&64&&m(e,"fill",t[6])},d(t){t&&p(e)}}}function xm(l){let e;return{c(){e=ze("polyline"),this.h()},l(t){e=Pe(t,"polyline",{stroke:!0,"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,fill:!0,points:!0}),S(e).forEach(p),this.h()},h(){m(e,"stroke",l[6]),m(e,"stroke-linecap","round"),m(e,"stroke-linejoin","round"),m(e,"stroke-width",l[7]),m(e,"fill","none"),m(e,"points","-5,-4 0,0 -5,4")},m(t,n){B(t,e,n)},p(t,n){n&64&&m(e,"stroke",t[6]),n&128&&m(e,"stroke-width",t[7])},d(t){t&&p(e)}}}function $m(l){let e,t,n;function o(i,a){if(i[1]===wo.Arrow)return xm;if(i[1]===wo.ArrowClosed)return Qm}let s=o(l),r=s&&s(l);return{c(){e=ze("marker"),r&&r.c(),this.h()},l(i){e=Pe(i,"marker",{class:!0,id:!0,markerWidth:!0,markerHeight:!0,viewBox:!0,markerUnits:!0,orient:!0,refX:!0,refY:!0});var a=S(e);r&&r.l(a),a.forEach(p),this.h()},h(){m(e,"class","svelte-flow__arrowhead"),m(e,"id",l[0]),m(e,"markerWidth",t=`${l[2]}`),m(e,"markerHeight",n=`${l[3]}`),m(e,"viewBox","-10 -10 20 20"),m(e,"markerUnits",l[4]),m(e,"orient",l[5]),m(e,"refX","0"),m(e,"refY","0")},m(i,a){B(i,e,a),r&&r.m(e,null)},p(i,[a]){s===(s=o(i))&&r?r.p(i,a):(r&&r.d(1),r=s&&s(i),r&&(r.c(),r.m(e,null))),a&1&&m(e,"id",i[0]),a&4&&t!==(t=`${i[2]}`)&&m(e,"markerWidth",t),a&8&&n!==(n=`${i[3]}`)&&m(e,"markerHeight",n),a&16&&m(e,"markerUnits",i[4]),a&32&&m(e,"orient",i[5])},i:we,o:we,d(i){i&&p(e),r&&r.d()}}}function e1(l,e,t){let{id:n}=e,{type:o}=e,{width:s=12.5}=e,{height:r=12.5}=e,{markerUnits:i="strokeWidth"}=e,{orient:a="auto-start-reverse"}=e,{color:c=void 0}=e,{strokeWidth:u=void 0}=e;return l.$$set=f=>{"id"in f&&t(0,n=f.id),"type"in f&&t(1,o=f.type),"width"in f&&t(2,s=f.width),"height"in f&&t(3,r=f.height),"markerUnits"in f&&t(4,i=f.markerUnits),"orient"in f&&t(5,a=f.orient),"color"in f&&t(6,c=f.color),"strokeWidth"in f&&t(7,u=f.strokeWidth)},[n,o,s,r,i,a,c,u]}class t1 extends Ve{constructor(e){super(),Ne(this,e,e1,$m,Be,{id:0,type:1,width:2,height:3,markerUnits:4,orient:5,color:6,strokeWidth:7})}}function jr(l,e,t){const n=l.slice();return n[14]=e[t],n}function Fr(l,e){let t,n,o;return n=new Zm({props:{id:e[14].id,source:e[14].source,target:e[14].target,data:e[14].data,style:e[14].style,animated:e[14].animated,selected:e[14].selected,selectable:e[14].selectable??e[1],deletable:e[14].deletable,hidden:e[14].hidden,label:e[14].label,labelStyle:e[14].labelStyle,markerStart:e[14].markerStart,markerEnd:e[14].markerEnd,sourceHandle:e[14].sourceHandle,targetHandle:e[14].targetHandle,sourceX:e[14].sourceX,sourceY:e[14].sourceY,targetX:e[14].targetX,targetY:e[14].targetY,sourcePosition:e[14].sourcePosition,targetPosition:e[14].targetPosition,ariaLabel:e[14].ariaLabel,interactionWidth:e[14].interactionWidth,class:e[14].class,type:e[14].type||"default",zIndex:e[14].zIndex}}),n.$on("edgeclick",e[7]),n.$on("edgecontextmenu",e[8]),n.$on("edgemouseenter",e[9]),n.$on("edgemouseleave",e[10]),{key:l,first:null,c(){t=Oe(),te(n.$$.fragment),this.h()},l(s){t=Oe(),oe(n.$$.fragment,s),this.h()},h(){this.first=t},m(s,r){B(s,t,r),ne(n,s,r),o=!0},p(s,r){e=s;const i={};r&1&&(i.id=e[14].id),r&1&&(i.source=e[14].source),r&1&&(i.target=e[14].target),r&1&&(i.data=e[14].data),r&1&&(i.style=e[14].style),r&1&&(i.animated=e[14].animated),r&1&&(i.selected=e[14].selected),r&3&&(i.selectable=e[14].selectable??e[1]),r&1&&(i.deletable=e[14].deletable),r&1&&(i.hidden=e[14].hidden),r&1&&(i.label=e[14].label),r&1&&(i.labelStyle=e[14].labelStyle),r&1&&(i.markerStart=e[14].markerStart),r&1&&(i.markerEnd=e[14].markerEnd),r&1&&(i.sourceHandle=e[14].sourceHandle),r&1&&(i.targetHandle=e[14].targetHandle),r&1&&(i.sourceX=e[14].sourceX),r&1&&(i.sourceY=e[14].sourceY),r&1&&(i.targetX=e[14].targetX),r&1&&(i.targetY=e[14].targetY),r&1&&(i.sourcePosition=e[14].sourcePosition),r&1&&(i.targetPosition=e[14].targetPosition),r&1&&(i.ariaLabel=e[14].ariaLabel),r&1&&(i.interactionWidth=e[14].interactionWidth),r&1&&(i.class=e[14].class),r&1&&(i.type=e[14].type||"default"),r&1&&(i.zIndex=e[14].zIndex),n.$set(i)},i(s){o||(C(n.$$.fragment,s),o=!0)},o(s){P(n.$$.fragment,s),o=!1},d(s){s&&p(t),le(n,s)}}}function Yr(l){let e,t;return e=new Km({props:{onMount:l[11],onDestroy:l[12]}}),{c(){te(e.$$.fragment)},l(n){oe(e.$$.fragment,n)},m(n,o){ne(e,n,o),t=!0},p(n,o){const s={};o&4&&(s.onMount=n[11]),o&4&&(s.onDestroy=n[12]),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){le(e,n)}}}function n1(l){let e,t,n,o,s=[],r=new Map,i,a;n=new Jm({});let c=wt(l[0]);const u=h=>h[14].id;for(let h=0;h<c.length;h+=1){let d=jr(l,c,h),_=u(d);r.set(_,s[h]=Fr(_,d))}let f=l[0].length>0&&Yr(l);return{c(){e=V("div"),t=ze("svg"),te(n.$$.fragment),o=$();for(let h=0;h<s.length;h+=1)s[h].c();i=$(),f&&f.c(),this.h()},l(h){e=N(h,"DIV",{class:!0});var d=S(e);t=Pe(d,"svg",{class:!0});var _=S(t);oe(n.$$.fragment,_),_.forEach(p),o=ee(d);for(let b=0;b<s.length;b+=1)s[b].l(d);i=ee(d),f&&f.l(d),d.forEach(p),this.h()},h(){m(t,"class","svelte-flow__marker"),m(e,"class","svelte-flow__edges")},m(h,d){B(h,e,d),k(e,t),ne(n,t,null),k(e,o);for(let _=0;_<s.length;_+=1)s[_]&&s[_].m(e,null);k(e,i),f&&f.m(e,null),a=!0},p(h,[d]){d&3&&(c=wt(h[0]),Ae(),s=So(s,d,u,1,h,c,r,e,Do,Fr,i,jr),Le()),h[0].length>0?f?(f.p(h,d),d&1&&C(f,1)):(f=Yr(h),f.c(),C(f,1),f.m(e,null)):f&&(Ae(),P(f,1,1,()=>{f=null}),Le())},i(h){if(!a){C(n.$$.fragment,h);for(let d=0;d<c.length;d+=1)C(s[d]);C(f),a=!0}},o(h){P(n.$$.fragment,h);for(let d=0;d<s.length;d+=1)P(s[d]);P(f),a=!1},d(h){h&&p(e),le(n);for(let d=0;d<s.length;d+=1)s[d].d();f&&f.d()}}}function l1(l,e,t){let n,o,s,{defaultEdgeOptions:r}=e;const{visibleEdges:i,edgesInitialized:a,edges:{setDefaultOptions:c},elementsSelectable:u}=Zt();ie(l,i,g=>t(0,n=g)),ie(l,a,g=>t(2,s=g)),ie(l,u,g=>t(1,o=g)),hn(()=>{r&&c(r)});function f(g){bt.call(this,l,g)}function h(g){bt.call(this,l,g)}function d(g){bt.call(this,l,g)}function _(g){bt.call(this,l,g)}const b=()=>{fo(a,s=!0,s)},v=()=>{fo(a,s=!1,s)};return l.$$set=g=>{"defaultEdgeOptions"in g&&t(6,r=g.defaultEdgeOptions)},[n,o,s,i,a,u,r,f,h,d,_,b,v]}class o1 extends Ve{constructor(e){super(),Ne(this,e,l1,n1,Be,{defaultEdgeOptions:6})}}function Zr(l){let e;return{c(){e=V("div"),this.h()},l(t){e=N(t,"DIV",{class:!0}),S(e).forEach(p),this.h()},h(){m(e,"class","svelte-flow__selection svelte-1iugwpu"),tt(e,"width",typeof l[2]=="string"?l[2]:`${l[2]}px`),tt(e,"height",typeof l[3]=="string"?l[3]:`${l[3]}px`),tt(e,"transform",`translate(${l[0]}px, ${l[1]}px)`)},m(t,n){B(t,e,n)},p(t,n){n&4&&tt(e,"width",typeof t[2]=="string"?t[2]:`${t[2]}px`),n&8&&tt(e,"height",typeof t[3]=="string"?t[3]:`${t[3]}px`),n&3&&tt(e,"transform",`translate(${t[0]}px, ${t[1]}px)`)},d(t){t&&p(e)}}}function s1(l){let e,t=l[4]&&Zr(l);return{c(){t&&t.c(),e=Oe()},l(n){t&&t.l(n),e=Oe()},m(n,o){t&&t.m(n,o),B(n,e,o)},p(n,[o]){n[4]?t?t.p(n,o):(t=Zr(n),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:we,o:we,d(n){n&&p(e),t&&t.d(n)}}}function r1(l,e,t){let{x:n=0}=e,{y:o=0}=e,{width:s=0}=e,{height:r=0}=e,{isVisible:i=!0}=e;return l.$$set=a=>{"x"in a&&t(0,n=a.x),"y"in a&&t(1,o=a.y),"width"in a&&t(2,s=a.width),"height"in a&&t(3,r=a.height),"isVisible"in a&&t(4,i=a.isVisible)},[n,o,s,r,i]}class Na extends Ve{constructor(e){super(),Ne(this,e,r1,s1,Be,{x:0,y:1,width:2,height:3,isVisible:4})}}function i1(l){var n,o,s,r;let e,t;return e=new Na({props:{isVisible:!!(l[0]&&l[1]==="user"),width:(n=l[0])==null?void 0:n.width,height:(o=l[0])==null?void 0:o.height,x:(s=l[0])==null?void 0:s.x,y:(r=l[0])==null?void 0:r.y}}),{c(){te(e.$$.fragment)},l(i){oe(e.$$.fragment,i)},m(i,a){ne(e,i,a),t=!0},p(i,[a]){var u,f,h,d;const c={};a&3&&(c.isVisible=!!(i[0]&&i[1]==="user")),a&1&&(c.width=(u=i[0])==null?void 0:u.width),a&1&&(c.height=(f=i[0])==null?void 0:f.height),a&1&&(c.x=(h=i[0])==null?void 0:h.x),a&1&&(c.y=(d=i[0])==null?void 0:d.y),e.$set(c)},i(i){t||(C(e.$$.fragment,i),t=!0)},o(i){P(e.$$.fragment,i),t=!1},d(i){le(e,i)}}}function a1(l,e,t){let n,o;const{selectionRect:s,selectionRectMode:r}=Zt();return ie(l,s,i=>t(0,n=i)),ie(l,r,i=>t(1,o=i)),[n,o,s,r]}class c1 extends Ve{constructor(e){super(),Ne(this,e,a1,i1,Be,{})}}function Xr(l){let e,t,n,o,s;return t=new Na({props:{width:"100%",height:"100%",x:0,y:0}}),{c(){e=V("div"),te(t.$$.fragment),this.h()},l(r){e=N(r,"DIV",{class:!0,style:!0,role:!0,tabindex:!0});var i=S(e);oe(t.$$.fragment,i),i.forEach(p),this.h()},h(){m(e,"class","selection-wrapper nopan svelte-5pxri"),tt(e,"width",l[1].width+"px"),tt(e,"height",l[1].height+"px"),tt(e,"transform","translate("+l[1].x+"px, "+l[1].y+"px)"),m(e,"role","button"),m(e,"tabindex","-1")},m(r,i){B(r,e,i),ne(t,e,null),n=!0,o||(s=[dn(Va.call(null,e,{disabled:!1,store:l[2],onDrag:l[11],onDragStart:l[12],onDragStop:l[13]})),ke(e,"contextmenu",l[7]),ke(e,"click",l[8]),ke(e,"keyup",f1)],o=!0)},p(r,i){(!n||i&2)&&tt(e,"width",r[1].width+"px"),(!n||i&2)&&tt(e,"height",r[1].height+"px"),(!n||i&2)&&tt(e,"transform","translate("+r[1].x+"px, "+r[1].y+"px)")},i(r){n||(C(t.$$.fragment,r),n=!0)},o(r){P(t.$$.fragment,r),n=!1},d(r){r&&p(e),le(t),o=!1,ln(s)}}}function u1(l){let e=l[0]==="nodes"&&l[1]&&On(l[1].x)&&On(l[1].y),t,n,o=e&&Xr(l);return{c(){o&&o.c(),t=Oe()},l(s){o&&o.l(s),t=Oe()},m(s,r){o&&o.m(s,r),B(s,t,r),n=!0},p(s,[r]){r&3&&(e=s[0]==="nodes"&&s[1]&&On(s[1].x)&&On(s[1].y)),e?o?(o.p(s,r),r&3&&C(o,1)):(o=Xr(s),o.c(),C(o,1),o.m(t.parentNode,t)):o&&(Ae(),P(o,1,1,()=>{o=null}),Le())},i(s){n||(C(o),n=!0)},o(s){P(o),n=!1},d(s){s&&p(t),o&&o.d(s)}}}const f1=()=>{};function d1(l,e,t){let n,o,s;const r=Zt(),{selectionRectMode:i,nodes:a,nodeLookup:c}=r;ie(l,i,g=>t(0,s=g)),ie(l,a,g=>t(9,n=g)),ie(l,c,g=>t(10,o=g));const u=on();let f=null;function h(g){const w=n.filter(y=>y.selected);u("selectioncontextmenu",{nodes:w,event:g})}function d(g){const w=n.filter(y=>y.selected);u("selectionclick",{nodes:w,event:g})}const _=(g,w,y,E)=>{u("nodedrag",{event:g,targetNode:null,nodes:E})},b=(g,w,y,E)=>{u("nodedragstart",{event:g,targetNode:null,nodes:E})},v=(g,w,y,E)=>{u("nodedragstop",{event:g,targetNode:null,nodes:E})};return l.$$.update=()=>{l.$$.dirty&1537&&s==="nodes"&&t(1,f=Po(o,{filter:g=>!!g.selected}))},[s,f,r,i,a,c,u,h,d,n,o,_,b,v]}class h1 extends Ve{constructor(e){super(),Ne(this,e,d1,u1,Be,{})}}function jn(l,e){let{enabled:t=!0,trigger:n,type:o="keydown"}=e;function s(r){const i=Array.isArray(n)?n:[n],a={alt:r.altKey,ctrl:r.ctrlKey,shift:r.shiftKey,meta:r.metaKey};for(const c of i){const u={modifier:[],preventDefault:!1,enabled:!0,...c},{modifier:f,key:h,callback:d,preventDefault:_,enabled:b}=u;if(b){if(f.length&&!(Array.isArray(f)?f:[f]).map(w=>typeof w=="string"?[w]:w).some(w=>w.every(y=>a[y])))continue;if(r.key===h){_&&r.preventDefault();const v={node:l,trigger:u,originalEvent:r};l.dispatchEvent(new CustomEvent("shortcut",{detail:v})),d==null||d(v)}}}}return t&&l.addEventListener(o,s),{update:r=>{const{enabled:i=!0,type:a="keydown"}=r;t&&(!i||o!==a)?l.removeEventListener(o,s):!t&&i&&l.addEventListener(a,s),t=i,o=a,n=r.trigger},destroy:()=>{l.removeEventListener(o,s)}}}function m1(l){let e,t,n,o,s,r,i,a,c,u,f,h;return{c:we,l:we,m(d,_){f||(h=[dn(e=jn.call(null,window,{trigger:qt(l[0],l[11]),type:"keydown"})),dn(t=jn.call(null,window,{trigger:qt(l[0],l[12]),type:"keyup"})),dn(n=jn.call(null,window,{trigger:qt(l[1],l[13]),type:"keydown"})),dn(o=jn.call(null,window,{trigger:qt(l[1],l[14]),type:"keyup"})),dn(s=jn.call(null,window,{trigger:qt(l[2],l[15]),type:"keydown"})),dn(r=jn.call(null,window,{trigger:qt(l[2],l[16]),type:"keyup"})),dn(i=jn.call(null,window,{trigger:qt(l[3],l[17]),type:"keydown"})),dn(a=jn.call(null,window,{trigger:qt(l[3],l[18]),type:"keyup"})),dn(c=jn.call(null,window,{trigger:qt(l[4],l[19]),type:"keydown"})),dn(u=jn.call(null,window,{trigger:qt(l[4],l[20]),type:"keyup"})),ke(window,"blur",l[10]),ke(window,"contextmenu",l[10])],f=!0)},p(d,[_]){e&&nn(e.update)&&_&1&&e.update.call(null,{trigger:qt(d[0],d[11]),type:"keydown"}),t&&nn(t.update)&&_&1&&t.update.call(null,{trigger:qt(d[0],d[12]),type:"keyup"}),n&&nn(n.update)&&_&2&&n.update.call(null,{trigger:qt(d[1],d[13]),type:"keydown"}),o&&nn(o.update)&&_&2&&o.update.call(null,{trigger:qt(d[1],d[14]),type:"keyup"}),s&&nn(s.update)&&_&4&&s.update.call(null,{trigger:qt(d[2],d[15]),type:"keydown"}),r&&nn(r.update)&&_&4&&r.update.call(null,{trigger:qt(d[2],d[16]),type:"keyup"}),i&&nn(i.update)&&_&8&&i.update.call(null,{trigger:qt(d[3],d[17]),type:"keydown"}),a&&nn(a.update)&&_&8&&a.update.call(null,{trigger:qt(d[3],d[18]),type:"keyup"}),c&&nn(c.update)&&_&16&&c.update.call(null,{trigger:qt(d[4],d[19]),type:"keydown"}),u&&nn(u.update)&&_&16&&u.update.call(null,{trigger:qt(d[4],d[20]),type:"keyup"})},i:we,o:we,d(d){f=!1,ln(h)}}}function za(l){return l!==null&&typeof l=="object"}function g1(l){return za(l)?l.modifier||[]:[]}function _1(l){return l==null?"":za(l)?l.key:l}function qt(l,e){return(Array.isArray(l)?l:[l]).map(n=>{const o=_1(n);return{key:o,modifier:g1(n),enabled:o!==null,callback:e}})}function p1(l,e,t){let{selectionKey:n="Shift"}=e,{multiSelectionKey:o=ko()?"Meta":"Control"}=e,{deleteKey:s="Backspace"}=e,{panActivationKey:r=" "}=e,{zoomActivationKey:i=ko()?"Meta":"Control"}=e;const{selectionKeyPressed:a,multiselectionKeyPressed:c,deleteKeyPressed:u,panActivationKeyPressed:f,zoomActivationKeyPressed:h,selectionRect:d}=Zt();function _(){d.set(null),a.set(!1),c.set(!1),u.set(!1),f.set(!1),h.set(!1)}const b=()=>a.set(!0),v=()=>a.set(!1),g=()=>c.set(!0),w=()=>c.set(!1),y=O=>{!(O.originalEvent.ctrlKey||O.originalEvent.metaKey||O.originalEvent.shiftKey)&&!eh(O.originalEvent)&&u.set(!0)},E=()=>u.set(!1),z=()=>f.set(!0),T=()=>f.set(!1),I=()=>h.set(!0),H=()=>h.set(!1);return l.$$set=O=>{"selectionKey"in O&&t(0,n=O.selectionKey),"multiSelectionKey"in O&&t(1,o=O.multiSelectionKey),"deleteKey"in O&&t(2,s=O.deleteKey),"panActivationKey"in O&&t(3,r=O.panActivationKey),"zoomActivationKey"in O&&t(4,i=O.zoomActivationKey)},[n,o,s,r,i,a,c,u,f,h,_,b,v,g,w,y,E,z,T,I,H]}class b1 extends Ve{constructor(e){super(),Ne(this,e,p1,m1,Be,{selectionKey:0,multiSelectionKey:1,deleteKey:2,panActivationKey:3,zoomActivationKey:4})}}const v1=l=>({}),Kr=l=>({});function qr(l){let e,t,n,o;const s=l[13].connectionLine,r=xt(s,l,l[12],Kr);let i=!l[2]&&Gr(l);return{c(){e=ze("svg"),t=ze("g"),r&&r.c(),i&&i.c(),this.h()},l(a){e=Pe(a,"svg",{width:!0,height:!0,class:!0,style:!0});var c=S(e);t=Pe(c,"g",{class:!0});var u=S(t);r&&r.l(u),i&&i.l(u),u.forEach(p),c.forEach(p),this.h()},h(){m(t,"class",n=Bt(["svelte-flow__connection",br(l[3].isValid)])),m(e,"width",l[5]),m(e,"height",l[6]),m(e,"class","svelte-flow__connectionline"),m(e,"style",l[0])},m(a,c){B(a,e,c),k(e,t),r&&r.m(t,null),i&&i.m(t,null),o=!0},p(a,c){r&&r.p&&(!o||c&4096)&&$t(r,s,a,a[12],o?tn(s,a[12],c,v1):en(a[12]),Kr),a[2]?i&&(i.d(1),i=null):i?i.p(a,c):(i=Gr(a),i.c(),i.m(t,null)),(!o||c&8&&n!==(n=Bt(["svelte-flow__connection",br(a[3].isValid)])))&&m(t,"class",n),(!o||c&32)&&m(e,"width",a[5]),(!o||c&64)&&m(e,"height",a[6]),(!o||c&1)&&m(e,"style",a[0])},i(a){o||(C(r,a),o=!0)},o(a){P(r,a),o=!1},d(a){a&&p(e),r&&r.d(a),i&&i.d()}}}function Gr(l){let e;return{c(){e=ze("path"),this.h()},l(t){e=Pe(t,"path",{d:!0,style:!0,fill:!0,class:!0}),S(e).forEach(p),this.h()},h(){m(e,"d",l[4]),m(e,"style",l[1]),m(e,"fill","none"),m(e,"class","svelte-flow__connection-path")},m(t,n){B(t,e,n)},p(t,n){n&16&&m(e,"d",t[4]),n&2&&m(e,"style",t[1])},d(t){t&&p(e)}}}function w1(l){let e,t,n=l[3].inProgress&&qr(l);return{c(){n&&n.c(),e=Oe()},l(o){n&&n.l(o),e=Oe()},m(o,s){n&&n.m(o,s),B(o,e,s),t=!0},p(o,[s]){o[3].inProgress?n?(n.p(o,s),s&8&&C(n,1)):(n=qr(o),n.c(),C(n,1),n.m(e.parentNode,e)):n&&(Ae(),P(n,1,1,()=>{n=null}),Le())},i(o){t||(C(n),t=!0)},o(o){P(n),t=!1},d(o){o&&p(e),n&&n.d(o)}}}function y1(l,e,t){let n,o,s,r,{$$slots:i={},$$scope:a}=e,{containerStyle:c=""}=e,{style:u=""}=e,{isCustomComponent:f=!1}=e;const{width:h,height:d,connection:_,connectionLineType:b}=Zt();ie(l,h,g=>t(5,s=g)),ie(l,d,g=>t(6,r=g)),ie(l,_,g=>t(3,o=g)),ie(l,b,g=>t(11,n=g));let v=null;return l.$$set=g=>{"containerStyle"in g&&t(0,c=g.containerStyle),"style"in g&&t(1,u=g.style),"isCustomComponent"in g&&t(2,f=g.isCustomComponent),"$$scope"in g&&t(12,a=g.$$scope)},l.$$.update=()=>{if(l.$$.dirty&2060&&o.inProgress&&!f){const{from:g,to:w,fromPosition:y,toPosition:E}=o,z={sourceX:g.x,sourceY:g.y,sourcePosition:y,targetX:w.x,targetY:w.y,targetPosition:E};switch(n){case zl.Bezier:t(4,[v]=aa(z),v);break;case zl.Step:t(4,[v]=Eo({...z,borderRadius:0}),v);break;case zl.SmoothStep:t(4,[v]=Eo(z),v);break;default:t(4,[v]=ua(z),v)}}},[c,u,f,o,v,s,r,h,d,_,b,n,a,i]}class k1 extends Ve{constructor(e){super(),Ne(this,e,y1,w1,Be,{containerStyle:0,style:1,isCustomComponent:2})}}function E1(l){let e,t,n;const o=l[8].default,s=xt(o,l,l[7],null);let r=[{class:t=Bt(["svelte-flow__panel",l[1],...l[2]])},{style:l[0]},l[5]],i={};for(let a=0;a<r.length;a+=1)i=It(i,r[a]);return{c(){e=V("div"),s&&s.c(),this.h()},l(a){e=N(a,"DIV",{class:!0,style:!0});var c=S(e);s&&s.l(c),c.forEach(p),this.h()},h(){Pl(e,i),tt(e,"pointer-events",l[3]?"none":"")},m(a,c){B(a,e,c),s&&s.m(e,null),n=!0},p(a,[c]){s&&s.p&&(!n||c&128)&&$t(s,o,a,a[7],n?tn(o,a[7],c,null):en(a[7]),null),Pl(e,i=rl(r,[(!n||c&6&&t!==(t=Bt(["svelte-flow__panel",a[1],...a[2]])))&&{class:t},(!n||c&1)&&{style:a[0]},c&32&&a[5]])),tt(e,"pointer-events",a[3]?"none":"")},i(a){n||(C(s,a),n=!0)},o(a){P(s,a),n=!1},d(a){a&&p(e),s&&s.d(a)}}}function I1(l,e,t){let n;const o=["position","style","class"];let s=Yt(e,o),r,{$$slots:i={},$$scope:a}=e,{position:c="top-right"}=e,{style:u=void 0}=e,{class:f=void 0}=e;const{selectionRectMode:h}=Zt();return ie(l,h,d=>t(3,r=d)),l.$$set=d=>{e=It(It({},e),Bn(d)),t(5,s=Yt(e,o)),"position"in d&&t(6,c=d.position),"style"in d&&t(0,u=d.style),"class"in d&&t(1,f=d.class),"$$scope"in d&&t(7,a=d.$$scope)},l.$$.update=()=>{l.$$.dirty&64&&t(2,n=`${c}`.split("-"))},[u,f,n,r,h,s,c,a,i]}class Pa extends Ve{constructor(e){super(),Ne(this,e,I1,E1,Be,{position:6,style:0,class:1})}}function Jr(l){let e,t;return e=new Pa({props:{position:l[1],class:"svelte-flow__attribution","data-message":"Feel free to remove the attribution or check out how you could support us: https://svelteflow.dev/support-us",$$slots:{default:[S1]},$$scope:{ctx:l}}}),{c(){te(e.$$.fragment)},l(n){oe(e.$$.fragment,n)},m(n,o){ne(e,n,o),t=!0},p(n,o){const s={};o&2&&(s.position=n[1]),o&4&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){le(e,n)}}}function S1(l){let e,t="Svelte Flow";return{c(){e=V("a"),e.textContent=t,this.h()},l(n){e=N(n,"A",{href:!0,target:!0,rel:!0,"aria-label":!0,"data-svelte-h":!0}),gt(e)!=="svelte-2vm8e4"&&(e.textContent=t),this.h()},h(){m(e,"href","https://svelteflow.dev"),m(e,"target","_blank"),m(e,"rel","noopener noreferrer"),m(e,"aria-label","Svelte Flow attribution")},m(n,o){B(n,e,o)},p:we,d(n){n&&p(e)}}}function D1(l){var o;let e,t,n=!((o=l[0])!=null&&o.hideAttribution)&&Jr(l);return{c(){n&&n.c(),e=Oe()},l(s){n&&n.l(s),e=Oe()},m(s,r){n&&n.m(s,r),B(s,e,r),t=!0},p(s,[r]){var i;(i=s[0])!=null&&i.hideAttribution?n&&(Ae(),P(n,1,1,()=>{n=null}),Le()):n?(n.p(s,r),r&1&&C(n,1)):(n=Jr(s),n.c(),C(n,1),n.m(e.parentNode,e))},i(s){t||(C(n),t=!0)},o(s){P(n),t=!1},d(s){s&&p(e),n&&n.d(s)}}}function C1(l,e,t){let{proOptions:n=void 0}=e,{position:o="bottom-right"}=e;return l.$$set=s=>{"proOptions"in s&&t(0,n=s.proOptions),"position"in s&&t(1,o=s.position)},[n,o]}class M1 extends Ve{constructor(e){super(),Ne(this,e,C1,D1,Be,{proOptions:0,position:1})}}function Qr(l,{nodeTypes:e,edgeTypes:t,minZoom:n,maxZoom:o,translateExtent:s,paneClickDistance:r}){e!==void 0&&l.setNodeTypes(e),t!==void 0&&l.setEdgeTypes(t),n!==void 0&&l.setMinZoom(n),o!==void 0&&l.setMaxZoom(o),s!==void 0&&l.setTranslateExtent(s),r!==void 0&&l.setPaneClickDistance(r)}const T1=l=>Object.keys(l);function V1(l,e){T1(e).forEach(t=>{const n=e[t];n!==void 0&&l[t].set(n)})}function N1(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function z1(l="light"){return zn("light",t=>{if(l!=="system"){t(l);return}const n=N1(),o=()=>t(n!=null&&n.matches?"dark":"light");return t(n!=null&&n.matches?"dark":"light"),n==null||n.addEventListener("change",o),()=>{n==null||n.removeEventListener("change",o)}})}const P1=l=>({}),xr=l=>({slot:"connectionLine"});function O1(l){let e;const t=l[75].connectionLine,n=xt(t,l,l[99],xr);return{c(){n&&n.c()},l(o){n&&n.l(o)},m(o,s){n&&n.m(o,s),e=!0},p(o,s){n&&n.p&&(!e||s[3]&64)&&$t(n,t,o,o[99],e?tn(t,o[99],s,P1):en(o[99]),xr)},i(o){e||(C(n,o),e=!0)},o(o){P(n,o),e=!1},d(o){n&&n.d(o)}}}function H1(l){let e,t,n,o,s,r,i,a,c,u,f,h;return e=new o1({props:{defaultEdgeOptions:l[21]}}),e.$on("edgeclick",l[78]),e.$on("edgecontextmenu",l[79]),e.$on("edgemouseenter",l[80]),e.$on("edgemouseleave",l[81]),n=new k1({props:{containerStyle:l[7],style:l[6],isCustomComponent:l[34].connectionLine,$$slots:{connectionLine:[O1]},$$scope:{ctx:l}}}),c=new jm({props:{nodeClickDistance:l[23]}}),c.$on("nodeclick",l[82]),c.$on("nodemouseenter",l[83]),c.$on("nodemousemove",l[84]),c.$on("nodemouseleave",l[85]),c.$on("nodedragstart",l[86]),c.$on("nodedrag",l[87]),c.$on("nodedragstop",l[88]),c.$on("nodecontextmenu",l[89]),f=new h1({}),f.$on("selectionclick",l[90]),f.$on("selectioncontextmenu",l[91]),f.$on("nodedragstart",l[92]),f.$on("nodedrag",l[93]),f.$on("nodedragstop",l[94]),{c(){te(e.$$.fragment),t=$(),te(n.$$.fragment),o=$(),s=V("div"),r=$(),i=V("div"),a=$(),te(c.$$.fragment),u=$(),te(f.$$.fragment),this.h()},l(d){oe(e.$$.fragment,d),t=ee(d),oe(n.$$.fragment,d),o=ee(d),s=N(d,"DIV",{class:!0}),S(s).forEach(p),r=ee(d),i=N(d,"DIV",{class:!0}),S(i).forEach(p),a=ee(d),oe(c.$$.fragment,d),u=ee(d),oe(f.$$.fragment,d),this.h()},h(){m(s,"class","svelte-flow__edgelabel-renderer"),m(i,"class","svelte-flow__viewport-portal")},m(d,_){ne(e,d,_),B(d,t,_),ne(n,d,_),B(d,o,_),B(d,s,_),B(d,r,_),B(d,i,_),B(d,a,_),ne(c,d,_),B(d,u,_),ne(f,d,_),h=!0},p(d,_){const b={};_[0]&2097152&&(b.defaultEdgeOptions=d[21]),e.$set(b);const v={};_[0]&128&&(v.containerStyle=d[7]),_[0]&64&&(v.style=d[6]),_[1]&8&&(v.isCustomComponent=d[34].connectionLine),_[3]&64&&(v.$$scope={dirty:_,ctx:d}),n.$set(v);const g={};_[0]&8388608&&(g.nodeClickDistance=d[23]),c.$set(g)},i(d){h||(C(e.$$.fragment,d),C(n.$$.fragment,d),C(c.$$.fragment,d),C(f.$$.fragment,d),h=!0)},o(d){P(e.$$.fragment,d),P(n.$$.fragment,d),P(c.$$.fragment,d),P(f.$$.fragment,d),h=!1},d(d){d&&(p(t),p(o),p(s),p(r),p(i),p(a),p(u)),le(e,d),le(n,d),le(c,d),le(f,d)}}}function B1(l){let e,t,n,o;return e=new Om({props:{$$slots:{default:[H1]},$$scope:{ctx:l}}}),n=new c1({}),{c(){te(e.$$.fragment),t=$(),te(n.$$.fragment)},l(s){oe(e.$$.fragment,s),t=ee(s),oe(n.$$.fragment,s)},m(s,r){ne(e,s,r),B(s,t,r),ne(n,s,r),o=!0},p(s,r){const i={};r[0]&10485952|r[1]&8|r[3]&64&&(i.$$scope={dirty:r,ctx:s}),e.$set(i)},i(s){o||(C(e.$$.fragment,s),C(n.$$.fragment,s),o=!0)},o(s){P(e.$$.fragment,s),P(n.$$.fragment,s),o=!1},d(s){s&&p(t),le(e,s),le(n,s)}}}function A1(l){let e,t;return e=new Nm({props:{panOnDrag:l[17]===void 0?!0:l[17],selectionOnDrag:l[18],$$slots:{default:[B1]},$$scope:{ctx:l}}}),e.$on("paneclick",l[95]),e.$on("panecontextmenu",l[96]),{c(){te(e.$$.fragment)},l(n){oe(e.$$.fragment,n)},m(n,o){ne(e,n,o),t=!0},p(n,o){const s={};o[0]&131072&&(s.panOnDrag=n[17]===void 0?!0:n[17]),o[0]&262144&&(s.selectionOnDrag=n[18]),o[0]&10485952|o[1]&8|o[3]&64&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){le(e,n)}}}function L1(l){let e,t,n,o,s,r,i,a,c,u,f,h;t=new b1({props:{selectionKey:l[1],deleteKey:l[5],panActivationKey:l[2],multiSelectionKey:l[3],zoomActivationKey:l[4]}}),o=new Mm({props:{initialViewport:l[31],onMoveStart:l[8],onMove:l[9],onMoveEnd:l[10],panOnScrollMode:l[11]===void 0?Zn.Free:l[11],preventScrolling:l[12]===void 0?!0:l[12],zoomOnScroll:l[13]===void 0?!0:l[13],zoomOnDoubleClick:l[14]===void 0?!0:l[14],zoomOnPinch:l[15]===void 0?!0:l[15],panOnScroll:l[16]===void 0?!1:l[16],panOnDrag:l[17]===void 0?!0:l[17],paneClickDistance:l[22]===void 0?0:l[22],$$slots:{default:[A1]},$$scope:{ctx:l}}}),r=new M1({props:{proOptions:l[20],position:l[19]}});const d=l[75].default,_=xt(d,l,l[99],null);let b=[{style:l[24]},{class:a=Bt(["svelte-flow",l[25],l[30]])},{"data-testid":"svelte-flow__wrapper"},l[33],{role:"application"}],v={};for(let g=0;g<b.length;g+=1)v=It(v,b[g]);return{c(){e=V("div"),te(t.$$.fragment),n=$(),te(o.$$.fragment),s=$(),te(r.$$.fragment),i=$(),_&&_.c(),this.h()},l(g){e=N(g,"DIV",{style:!0,class:!0,"data-testid":!0,role:!0});var w=S(e);oe(t.$$.fragment,w),n=ee(w),oe(o.$$.fragment,w),s=ee(w),oe(r.$$.fragment,w),i=ee(w),_&&_.l(w),w.forEach(p),this.h()},h(){Pl(e,v),sl(()=>l[98].call(e)),lt(e,"svelte-12wlba6",!0)},m(g,w){B(g,e,w),ne(t,e,null),k(e,n),ne(o,e,null),k(e,s),ne(r,e,null),k(e,i),_&&_.m(e,null),l[97](e),c=Ra(e,l[98].bind(e)),u=!0,f||(h=[ke(e,"dragover",l[76]),ke(e,"drop",l[77])],f=!0)},p(g,w){const y={};w[0]&2&&(y.selectionKey=g[1]),w[0]&32&&(y.deleteKey=g[5]),w[0]&4&&(y.panActivationKey=g[2]),w[0]&8&&(y.multiSelectionKey=g[3]),w[0]&16&&(y.zoomActivationKey=g[4]),t.$set(y);const E={};w[0]&256&&(E.onMoveStart=g[8]),w[0]&512&&(E.onMove=g[9]),w[0]&1024&&(E.onMoveEnd=g[10]),w[0]&2048&&(E.panOnScrollMode=g[11]===void 0?Zn.Free:g[11]),w[0]&4096&&(E.preventScrolling=g[12]===void 0?!0:g[12]),w[0]&8192&&(E.zoomOnScroll=g[13]===void 0?!0:g[13]),w[0]&16384&&(E.zoomOnDoubleClick=g[14]===void 0?!0:g[14]),w[0]&32768&&(E.zoomOnPinch=g[15]===void 0?!0:g[15]),w[0]&65536&&(E.panOnScroll=g[16]===void 0?!1:g[16]),w[0]&131072&&(E.panOnDrag=g[17]===void 0?!0:g[17]),w[0]&4194304&&(E.paneClickDistance=g[22]===void 0?0:g[22]),w[0]&10879168|w[1]&8|w[3]&64&&(E.$$scope={dirty:w,ctx:g}),o.$set(E);const z={};w[0]&1048576&&(z.proOptions=g[20]),w[0]&524288&&(z.position=g[19]),r.$set(z),_&&_.p&&(!u||w[3]&64)&&$t(_,d,g,g[99],u?tn(d,g[99],w,null):en(g[99]),null),Pl(e,v=rl(b,[(!u||w[0]&16777216)&&{style:g[24]},(!u||w[0]&1107296256&&a!==(a=Bt(["svelte-flow",g[25],g[30]])))&&{class:a},{"data-testid":"svelte-flow__wrapper"},w[1]&4&&g[33],{role:"application"}])),lt(e,"svelte-12wlba6",!0)},i(g){u||(C(t.$$.fragment,g),C(o.$$.fragment,g),C(r.$$.fragment,g),C(_,g),u=!0)},o(g){P(t.$$.fragment,g),P(o.$$.fragment,g),P(r.$$.fragment,g),P(_,g),u=!1},d(g){g&&p(e),le(t),le(o),le(r),_&&_.d(g),l[97](null),c(),f=!1,ln(h)}}}function R1(l,e,t){let n;const o=["id","nodes","edges","fitView","fitViewOptions","minZoom","maxZoom","initialViewport","viewport","nodeTypes","edgeTypes","selectionKey","selectionMode","panActivationKey","multiSelectionKey","zoomActivationKey","nodesDraggable","nodesConnectable","nodeDragThreshold","elementsSelectable","snapGrid","deleteKey","connectionRadius","connectionLineType","connectionMode","connectionLineStyle","connectionLineContainerStyle","onMoveStart","onMove","onMoveEnd","isValidConnection","translateExtent","nodeExtent","onlyRenderVisibleElements","panOnScrollMode","preventScrolling","zoomOnScroll","zoomOnDoubleClick","zoomOnPinch","panOnScroll","panOnDrag","selectionOnDrag","autoPanOnConnect","autoPanOnNodeDrag","onerror","ondelete","onedgecreate","attributionPosition","proOptions","defaultEdgeOptions","width","height","colorMode","onconnect","onconnectstart","onconnectend","onbeforedelete","oninit","nodeOrigin","paneClickDistance","nodeClickDistance","defaultMarkerColor","style","class"];let s=Yt(e,o),r,i,a=we,c=()=>(a(),a=us(H,J=>t(100,i=J)),H),u,f=we,h=()=>(f(),f=us(n,J=>t(30,u=J)),n);l.$$.on_destroy.push(()=>a()),l.$$.on_destroy.push(()=>f());let{$$slots:d={},$$scope:_}=e;const b=Ua(d);let{id:v="1"}=e,{nodes:g}=e,{edges:w}=e,{fitView:y=void 0}=e,{fitViewOptions:E=void 0}=e,{minZoom:z=void 0}=e,{maxZoom:T=void 0}=e,{initialViewport:I=void 0}=e,{viewport:H=void 0}=e;c();let{nodeTypes:O=void 0}=e,{edgeTypes:A=void 0}=e,{selectionKey:F=void 0}=e,{selectionMode:j=void 0}=e,{panActivationKey:Y=void 0}=e,{multiSelectionKey:M=void 0}=e,{zoomActivationKey:K=void 0}=e,{nodesDraggable:D=void 0}=e,{nodesConnectable:W=void 0}=e,{nodeDragThreshold:L=void 0}=e,{elementsSelectable:R=void 0}=e,{snapGrid:X=void 0}=e,{deleteKey:Q=void 0}=e,{connectionRadius:G=void 0}=e,{connectionLineType:ce=void 0}=e,{connectionMode:se=wl.Strict}=e,{connectionLineStyle:ye=""}=e,{connectionLineContainerStyle:Se=""}=e,{onMoveStart:re=void 0}=e,{onMove:q=void 0}=e,{onMoveEnd:Ee=void 0}=e,{isValidConnection:ae=void 0}=e,{translateExtent:Ie=void 0}=e,{nodeExtent:ge=void 0}=e,{onlyRenderVisibleElements:_t=void 0}=e,{panOnScrollMode:me=Zn.Free}=e,{preventScrolling:ct=!0}=e,{zoomOnScroll:ut=!0}=e,{zoomOnDoubleClick:Wt=!0}=e,{zoomOnPinch:ve=!0}=e,{panOnScroll:Ue=!1}=e,{panOnDrag:st=!0}=e,{selectionOnDrag:yt=void 0}=e,{autoPanOnConnect:ft=!0}=e,{autoPanOnNodeDrag:rt=!0}=e,{onerror:At=void 0}=e,{ondelete:_e=void 0}=e,{onedgecreate:St=void 0}=e,{attributionPosition:pt=void 0}=e,{proOptions:ht=void 0}=e,{defaultEdgeOptions:be=void 0}=e,{width:Vt=void 0}=e,{height:ue=void 0}=e,{colorMode:Re="light"}=e,{onconnect:je=void 0}=e,{onconnectstart:Ge=void 0}=e,{onconnectend:kt=void 0}=e,{onbeforedelete:Dt=void 0}=e,{oninit:Ct=void 0}=e,{nodeOrigin:Nt=void 0}=e,{paneClickDistance:Ht=0}=e,{nodeClickDistance:zt=0}=e,{defaultMarkerColor:Jt="#b1b1b7"}=e,{style:Xt=void 0}=e,{class:Z=void 0}=e,Fe,Ke,Ze;const Qe=i||I,et=Wa(Lo)?Zt():Im({nodes:he(g),edges:he(w),width:Vt,height:ue,fitView:y,nodeOrigin:Nt,nodeExtent:ge});hn(()=>(et.width.set(Ke),et.height.set(Ze),et.domNode.set(Fe),et.syncNodeStores(g),et.syncEdgeStores(w),et.syncViewport(H),y!==void 0&&et.fitViewOnInit.set(y),E&&et.fitViewOptions.set(E),Qr(et,{nodeTypes:O,edgeTypes:A,minZoom:z,maxZoom:T,translateExtent:Ie,paneClickDistance:Ht}),()=>{et.reset()}));const{initialized:jt}=et;ie(l,jt,J=>t(74,r=J));let Et=!1;function Ft(J){bt.call(this,l,J)}function Xn(J){bt.call(this,l,J)}function $n(J){bt.call(this,l,J)}function cl(J){bt.call(this,l,J)}function Mn(J){bt.call(this,l,J)}function kl(J){bt.call(this,l,J)}function ul(J){bt.call(this,l,J)}function wn(J){bt.call(this,l,J)}function An(J){bt.call(this,l,J)}function Kn(J){bt.call(this,l,J)}function el(J){bt.call(this,l,J)}function fl(J){bt.call(this,l,J)}function Tn(J){bt.call(this,l,J)}function El(J){bt.call(this,l,J)}function dl(J){bt.call(this,l,J)}function yn(J){bt.call(this,l,J)}function Ln(J){bt.call(this,l,J)}function qn(J){bt.call(this,l,J)}function tl(J){bt.call(this,l,J)}function hl(J){bt.call(this,l,J)}function Vn(J){bt.call(this,l,J)}function Il(J){We[J?"unshift":"push"](()=>{Fe=J,t(28,Fe)})}function ml(){Ke=this.clientWidth,Ze=this.clientHeight,t(26,Ke),t(27,Ze)}return l.$$set=J=>{e=It(It({},e),Bn(J)),t(33,s=Yt(e,o)),"id"in J&&t(35,v=J.id),"nodes"in J&&t(36,g=J.nodes),"edges"in J&&t(37,w=J.edges),"fitView"in J&&t(38,y=J.fitView),"fitViewOptions"in J&&t(39,E=J.fitViewOptions),"minZoom"in J&&t(40,z=J.minZoom),"maxZoom"in J&&t(41,T=J.maxZoom),"initialViewport"in J&&t(42,I=J.initialViewport),"viewport"in J&&c(t(0,H=J.viewport)),"nodeTypes"in J&&t(43,O=J.nodeTypes),"edgeTypes"in J&&t(44,A=J.edgeTypes),"selectionKey"in J&&t(1,F=J.selectionKey),"selectionMode"in J&&t(45,j=J.selectionMode),"panActivationKey"in J&&t(2,Y=J.panActivationKey),"multiSelectionKey"in J&&t(3,M=J.multiSelectionKey),"zoomActivationKey"in J&&t(4,K=J.zoomActivationKey),"nodesDraggable"in J&&t(46,D=J.nodesDraggable),"nodesConnectable"in J&&t(47,W=J.nodesConnectable),"nodeDragThreshold"in J&&t(48,L=J.nodeDragThreshold),"elementsSelectable"in J&&t(49,R=J.elementsSelectable),"snapGrid"in J&&t(50,X=J.snapGrid),"deleteKey"in J&&t(5,Q=J.deleteKey),"connectionRadius"in J&&t(51,G=J.connectionRadius),"connectionLineType"in J&&t(52,ce=J.connectionLineType),"connectionMode"in J&&t(53,se=J.connectionMode),"connectionLineStyle"in J&&t(6,ye=J.connectionLineStyle),"connectionLineContainerStyle"in J&&t(7,Se=J.connectionLineContainerStyle),"onMoveStart"in J&&t(8,re=J.onMoveStart),"onMove"in J&&t(9,q=J.onMove),"onMoveEnd"in J&&t(10,Ee=J.onMoveEnd),"isValidConnection"in J&&t(54,ae=J.isValidConnection),"translateExtent"in J&&t(55,Ie=J.translateExtent),"nodeExtent"in J&&t(56,ge=J.nodeExtent),"onlyRenderVisibleElements"in J&&t(57,_t=J.onlyRenderVisibleElements),"panOnScrollMode"in J&&t(11,me=J.panOnScrollMode),"preventScrolling"in J&&t(12,ct=J.preventScrolling),"zoomOnScroll"in J&&t(13,ut=J.zoomOnScroll),"zoomOnDoubleClick"in J&&t(14,Wt=J.zoomOnDoubleClick),"zoomOnPinch"in J&&t(15,ve=J.zoomOnPinch),"panOnScroll"in J&&t(16,Ue=J.panOnScroll),"panOnDrag"in J&&t(17,st=J.panOnDrag),"selectionOnDrag"in J&&t(18,yt=J.selectionOnDrag),"autoPanOnConnect"in J&&t(58,ft=J.autoPanOnConnect),"autoPanOnNodeDrag"in J&&t(59,rt=J.autoPanOnNodeDrag),"onerror"in J&&t(60,At=J.onerror),"ondelete"in J&&t(61,_e=J.ondelete),"onedgecreate"in J&&t(62,St=J.onedgecreate),"attributionPosition"in J&&t(19,pt=J.attributionPosition),"proOptions"in J&&t(20,ht=J.proOptions),"defaultEdgeOptions"in J&&t(21,be=J.defaultEdgeOptions),"width"in J&&t(63,Vt=J.width),"height"in J&&t(64,ue=J.height),"colorMode"in J&&t(65,Re=J.colorMode),"onconnect"in J&&t(66,je=J.onconnect),"onconnectstart"in J&&t(67,Ge=J.onconnectstart),"onconnectend"in J&&t(68,kt=J.onconnectend),"onbeforedelete"in J&&t(69,Dt=J.onbeforedelete),"oninit"in J&&t(70,Ct=J.oninit),"nodeOrigin"in J&&t(71,Nt=J.nodeOrigin),"paneClickDistance"in J&&t(22,Ht=J.paneClickDistance),"nodeClickDistance"in J&&t(23,zt=J.nodeClickDistance),"defaultMarkerColor"in J&&t(72,Jt=J.defaultMarkerColor),"style"in J&&t(24,Xt=J.style),"class"in J&&t(25,Z=J.class),"$$scope"in J&&t(99,_=J.$$scope)},l.$$.update=()=>{l.$$.dirty[0]&201326592&&Ke!==void 0&&Ze!==void 0&&(et.width.set(Ke),et.height.set(Ze)),l.$$.dirty[2]&6400&&!Et&&r&&(Ct==null||Ct(),t(73,Et=!0)),l.$$.dirty[1]&2097135632|l.$$.dirty[2]&1777&&V1(et,{flowId:v,connectionLineType:ce,connectionRadius:G,selectionMode:j,snapGrid:X,defaultMarkerColor:Jt,nodesDraggable:D,nodesConnectable:W,elementsSelectable:R,onlyRenderVisibleElements:_t,isValidConnection:ae,autoPanOnConnect:ft,autoPanOnNodeDrag:rt,onerror:At,ondelete:_e,onedgecreate:St,connectionMode:se,nodeDragThreshold:L,onconnect:je,onconnectstart:Ge,onconnectend:kt,onbeforedelete:Dt,nodeOrigin:Nt}),l.$$.dirty[0]&4194304|l.$$.dirty[1]&16791040&&Qr(et,{nodeTypes:O,edgeTypes:A,minZoom:z,maxZoom:T,translateExtent:Ie,paneClickDistance:Ht}),l.$$.dirty[2]&8&&h(t(29,n=z1(Re)))},[H,F,Y,M,K,Q,ye,Se,re,q,Ee,me,ct,ut,Wt,ve,Ue,st,yt,pt,ht,be,Ht,zt,Xt,Z,Ke,Ze,Fe,n,u,Qe,jt,s,b,v,g,w,y,E,z,T,I,O,A,j,D,W,L,R,X,G,ce,se,ae,Ie,ge,_t,ft,rt,At,_e,St,Vt,ue,Re,je,Ge,kt,Dt,Ct,Nt,Jt,Et,r,d,Ft,Xn,$n,cl,Mn,kl,ul,wn,An,Kn,el,fl,Tn,El,dl,yn,Ln,qn,tl,hl,Vn,Il,ml,_]}class U1 extends Ve{constructor(e){super(),Ne(this,e,R1,L1,Be,{id:35,nodes:36,edges:37,fitView:38,fitViewOptions:39,minZoom:40,maxZoom:41,initialViewport:42,viewport:0,nodeTypes:43,edgeTypes:44,selectionKey:1,selectionMode:45,panActivationKey:2,multiSelectionKey:3,zoomActivationKey:4,nodesDraggable:46,nodesConnectable:47,nodeDragThreshold:48,elementsSelectable:49,snapGrid:50,deleteKey:5,connectionRadius:51,connectionLineType:52,connectionMode:53,connectionLineStyle:6,connectionLineContainerStyle:7,onMoveStart:8,onMove:9,onMoveEnd:10,isValidConnection:54,translateExtent:55,nodeExtent:56,onlyRenderVisibleElements:57,panOnScrollMode:11,preventScrolling:12,zoomOnScroll:13,zoomOnDoubleClick:14,zoomOnPinch:15,panOnScroll:16,panOnDrag:17,selectionOnDrag:18,autoPanOnConnect:58,autoPanOnNodeDrag:59,onerror:60,ondelete:61,onedgecreate:62,attributionPosition:19,proOptions:20,defaultEdgeOptions:21,width:63,height:64,colorMode:65,onconnect:66,onconnectstart:67,onconnectend:68,onbeforedelete:69,oninit:70,nodeOrigin:71,paneClickDistance:22,nodeClickDistance:23,defaultMarkerColor:72,style:24,class:25},null,[-1,-1,-1,-1])}}function W1(l){let e;const t=l[7].default,n=xt(t,l,l[6],null);return{c(){n&&n.c()},l(o){n&&n.l(o)},m(o,s){n&&n.m(o,s),e=!0},p(o,[s]){n&&n.p&&(!e||s&64)&&$t(n,t,o,o[6],e?tn(t,o[6],s,null):en(o[6]),null)},i(o){e||(C(n,o),e=!0)},o(o){P(n,o),e=!1},d(o){n&&n.d(o)}}}function j1(l,e,t){let{$$slots:n={},$$scope:o}=e,{initialNodes:s=void 0}=e,{initialEdges:r=void 0}=e,{initialWidth:i=void 0}=e,{initialHeight:a=void 0}=e,{fitView:c=void 0}=e,{nodeOrigin:u=void 0}=e;const f=Ta({nodes:s,edges:r,width:i,height:a,nodeOrigin:u,fitView:c});return jl(Lo,{getStore:()=>f}),il(()=>{f.reset()}),l.$$set=h=>{"initialNodes"in h&&t(0,s=h.initialNodes),"initialEdges"in h&&t(1,r=h.initialEdges),"initialWidth"in h&&t(2,i=h.initialWidth),"initialHeight"in h&&t(3,a=h.initialHeight),"fitView"in h&&t(4,c=h.fitView),"nodeOrigin"in h&&t(5,u=h.nodeOrigin),"$$scope"in h&&t(6,o=h.$$scope)},[s,r,i,a,c,u,o,n]}class F1 extends Ve{constructor(e){super(),Ne(this,e,j1,W1,Be,{initialNodes:0,initialEdges:1,initialWidth:2,initialHeight:3,fitView:4,nodeOrigin:5})}}const Y1=l=>({}),$r=l=>({class:"button-svg"});function Z1(l){let e,t,n,o,s;const r=l[8].default,i=xt(r,l,l[7],$r);let a=[{type:"button"},{class:t=Bt(["svelte-flow__controls-button",l[0]])},l[6]],c={};for(let u=0;u<a.length;u+=1)c=It(c,a[u]);return{c(){e=V("button"),i&&i.c(),this.h()},l(u){e=N(u,"BUTTON",{type:!0,class:!0});var f=S(e);i&&i.l(f),f.forEach(p),this.h()},h(){Pl(e,c),tt(e,"--xy-controls-button-background-color-props",l[1]),tt(e,"--xy-controls-button-background-color-hover-props",l[2]),tt(e,"--xy-controls-button-color-props",l[3]),tt(e,"--xy-controls-button-color-hover-props",l[4]),tt(e,"--xy-controls-button-border-color-props",l[5])},m(u,f){B(u,e,f),i&&i.m(e,null),e.autofocus&&e.focus(),n=!0,o||(s=ke(e,"click",l[9]),o=!0)},p(u,[f]){i&&i.p&&(!n||f&128)&&$t(i,r,u,u[7],n?tn(r,u[7],f,Y1):en(u[7]),$r),Pl(e,c=rl(a,[{type:"button"},(!n||f&1&&t!==(t=Bt(["svelte-flow__controls-button",u[0]])))&&{class:t},f&64&&u[6]])),tt(e,"--xy-controls-button-background-color-props",u[1]),tt(e,"--xy-controls-button-background-color-hover-props",u[2]),tt(e,"--xy-controls-button-color-props",u[3]),tt(e,"--xy-controls-button-color-hover-props",u[4]),tt(e,"--xy-controls-button-border-color-props",u[5])},i(u){n||(C(i,u),n=!0)},o(u){P(i,u),n=!1},d(u){u&&p(e),i&&i.d(u),o=!1,s()}}}function X1(l,e,t){const n=["class"];let o=Yt(e,n),{$$slots:s={},$$scope:r}=e,{class:i=void 0}=e,a,c,u,f,h;function d(_){bt.call(this,l,_)}return l.$$set=_=>{e=It(It({},e),Bn(_)),t(6,o=Yt(e,n)),"class"in _&&t(0,i=_.class),"$$scope"in _&&t(7,r=_.$$scope)},[i,a,c,u,f,h,o,r,s,d]}class Io extends Ve{constructor(e){super(),Ne(this,e,X1,Z1,Be,{class:0})}}function K1(l){let e,t;return{c(){e=ze("svg"),t=ze("path"),this.h()},l(n){e=Pe(n,"svg",{xmlns:!0,viewBox:!0});var o=S(e);t=Pe(o,"path",{d:!0}),S(t).forEach(p),o.forEach(p),this.h()},h(){m(t,"d","M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"viewBox","0 0 32 32")},m(n,o){B(n,e,o),k(e,t)},p:we,i:we,o:we,d(n){n&&p(e)}}}class q1 extends Ve{constructor(e){super(),Ne(this,e,null,K1,Be,{})}}function G1(l){let e,t;return{c(){e=ze("svg"),t=ze("path"),this.h()},l(n){e=Pe(n,"svg",{xmlns:!0,viewBox:!0});var o=S(e);t=Pe(o,"path",{d:!0}),S(t).forEach(p),o.forEach(p),this.h()},h(){m(t,"d","M0 0h32v4.2H0z"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"viewBox","0 0 32 5")},m(n,o){B(n,e,o),k(e,t)},p:we,i:we,o:we,d(n){n&&p(e)}}}class J1 extends Ve{constructor(e){super(),Ne(this,e,null,G1,Be,{})}}function Q1(l){let e,t;return{c(){e=ze("svg"),t=ze("path"),this.h()},l(n){e=Pe(n,"svg",{xmlns:!0,viewBox:!0});var o=S(e);t=Pe(o,"path",{d:!0}),S(t).forEach(p),o.forEach(p),this.h()},h(){m(t,"d","M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"viewBox","0 0 32 30")},m(n,o){B(n,e,o),k(e,t)},p:we,i:we,o:we,d(n){n&&p(e)}}}class x1 extends Ve{constructor(e){super(),Ne(this,e,null,Q1,Be,{})}}function $1(l){let e,t;return{c(){e=ze("svg"),t=ze("path"),this.h()},l(n){e=Pe(n,"svg",{xmlns:!0,viewBox:!0});var o=S(e);t=Pe(o,"path",{d:!0}),S(t).forEach(p),o.forEach(p),this.h()},h(){m(t,"d","M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"viewBox","0 0 25 32")},m(n,o){B(n,e,o),k(e,t)},p:we,i:we,o:we,d(n){n&&p(e)}}}class eg extends Ve{constructor(e){super(),Ne(this,e,null,$1,Be,{})}}function tg(l){let e,t;return{c(){e=ze("svg"),t=ze("path"),this.h()},l(n){e=Pe(n,"svg",{xmlns:!0,viewBox:!0});var o=S(e);t=Pe(o,"path",{d:!0}),S(t).forEach(p),o.forEach(p),this.h()},h(){m(t,"d","M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"viewBox","0 0 25 32")},m(n,o){B(n,e,o),k(e,t)},p:we,i:we,o:we,d(n){n&&p(e)}}}class ng extends Ve{constructor(e){super(),Ne(this,e,null,tg,Be,{})}}const lg=l=>({}),ei=l=>({}),og=l=>({}),ti=l=>({});function ni(l){let e,t,n,o;const s=[{class:"svelte-flow__controls-zoomin"},{title:"zoom in"},{"aria-label":"zoom in"},{disabled:l[9]},l[17]];let r={$$slots:{default:[sg]},$$scope:{ctx:l}};for(let c=0;c<s.length;c+=1)r=It(r,s[c]);e=new Io({props:r}),e.$on("click",l[18]);const i=[{class:"svelte-flow__controls-zoomout"},{title:"zoom out"},{"aria-label":"zoom out"},{disabled:l[10]},l[17]];let a={$$slots:{default:[rg]},$$scope:{ctx:l}};for(let c=0;c<i.length;c+=1)a=It(a,i[c]);return n=new Io({props:a}),n.$on("click",l[19]),{c(){te(e.$$.fragment),t=$(),te(n.$$.fragment)},l(c){oe(e.$$.fragment,c),t=ee(c),oe(n.$$.fragment,c)},m(c,u){ne(e,c,u),B(c,t,u),ne(n,c,u),o=!0},p(c,u){const f=u[0]&131584?rl(s,[s[0],s[1],s[2],u[0]&512&&{disabled:c[9]},u[0]&131072&&Fl(c[17])]):{};u[1]&32&&(f.$$scope={dirty:u,ctx:c}),e.$set(f);const h=u[0]&132096?rl(i,[i[0],i[1],i[2],u[0]&1024&&{disabled:c[10]},u[0]&131072&&Fl(c[17])]):{};u[1]&32&&(h.$$scope={dirty:u,ctx:c}),n.$set(h)},i(c){o||(C(e.$$.fragment,c),C(n.$$.fragment,c),o=!0)},o(c){P(e.$$.fragment,c),P(n.$$.fragment,c),o=!1},d(c){c&&p(t),le(e,c),le(n,c)}}}function sg(l){let e,t;return e=new q1({}),{c(){te(e.$$.fragment)},l(n){oe(e.$$.fragment,n)},m(n,o){ne(e,n,o),t=!0},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){le(e,n)}}}function rg(l){let e,t;return e=new J1({}),{c(){te(e.$$.fragment)},l(n){oe(e.$$.fragment,n)},m(n,o){ne(e,n,o),t=!0},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){le(e,n)}}}function li(l){let e,t;const n=[{class:"svelte-flow__controls-fitview"},{title:"fit view"},{"aria-label":"fit view"},l[17]];let o={$$slots:{default:[ig]},$$scope:{ctx:l}};for(let s=0;s<n.length;s+=1)o=It(o,n[s]);return e=new Io({props:o}),e.$on("click",l[20]),{c(){te(e.$$.fragment)},l(s){oe(e.$$.fragment,s)},m(s,r){ne(e,s,r),t=!0},p(s,r){const i=r[0]&131072?rl(n,[n[0],n[1],n[2],Fl(s[17])]):{};r[1]&32&&(i.$$scope={dirty:r,ctx:s}),e.$set(i)},i(s){t||(C(e.$$.fragment,s),t=!0)},o(s){P(e.$$.fragment,s),t=!1},d(s){le(e,s)}}}function ig(l){let e,t;return e=new x1({}),{c(){te(e.$$.fragment)},l(n){oe(e.$$.fragment,n)},m(n,o){ne(e,n,o),t=!0},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){le(e,n)}}}function oi(l){let e,t;const n=[{class:"svelte-flow__controls-interactive"},{title:"toggle interactivity"},{"aria-label":"toggle interactivity"},l[17]];let o={$$slots:{default:[ug]},$$scope:{ctx:l}};for(let s=0;s<n.length;s+=1)o=It(o,n[s]);return e=new Io({props:o}),e.$on("click",l[21]),{c(){te(e.$$.fragment)},l(s){oe(e.$$.fragment,s)},m(s,r){ne(e,s,r),t=!0},p(s,r){const i=r[0]&131072?rl(n,[n[0],n[1],n[2],Fl(s[17])]):{};r[0]&256|r[1]&32&&(i.$$scope={dirty:r,ctx:s}),e.$set(i)},i(s){t||(C(e.$$.fragment,s),t=!0)},o(s){P(e.$$.fragment,s),t=!1},d(s){le(e,s)}}}function ag(l){let e,t;return e=new eg({}),{c(){te(e.$$.fragment)},l(n){oe(e.$$.fragment,n)},m(n,o){ne(e,n,o),t=!0},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){le(e,n)}}}function cg(l){let e,t;return e=new ng({}),{c(){te(e.$$.fragment)},l(n){oe(e.$$.fragment,n)},m(n,o){ne(e,n,o),t=!0},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){le(e,n)}}}function ug(l){let e,t,n,o;const s=[cg,ag],r=[];function i(a,c){return a[8]?0:1}return e=i(l),t=r[e]=s[e](l),{c(){t.c(),n=Oe()},l(a){t.l(a),n=Oe()},m(a,c){r[e].m(a,c),B(a,n,c),o=!0},p(a,c){let u=e;e=i(a),e!==u&&(Ae(),P(r[u],1,1,()=>{r[u]=null}),Le(),t=r[e],t||(t=r[e]=s[e](a),t.c()),C(t,1),t.m(n.parentNode,n))},i(a){o||(C(t),o=!0)},o(a){P(t),o=!1},d(a){a&&p(n),r[e].d(a)}}}function fg(l){let e,t,n,o,s,r;const i=l[35].before,a=xt(i,l,l[36],ti);let c=l[1]&&ni(l),u=l[2]&&li(l),f=l[3]&&oi(l);const h=l[35].default,d=xt(h,l,l[36],null),_=l[35].after,b=xt(_,l,l[36],ei);return{c(){a&&a.c(),e=$(),c&&c.c(),t=$(),u&&u.c(),n=$(),f&&f.c(),o=$(),d&&d.c(),s=$(),b&&b.c()},l(v){a&&a.l(v),e=ee(v),c&&c.l(v),t=ee(v),u&&u.l(v),n=ee(v),f&&f.l(v),o=ee(v),d&&d.l(v),s=ee(v),b&&b.l(v)},m(v,g){a&&a.m(v,g),B(v,e,g),c&&c.m(v,g),B(v,t,g),u&&u.m(v,g),B(v,n,g),f&&f.m(v,g),B(v,o,g),d&&d.m(v,g),B(v,s,g),b&&b.m(v,g),r=!0},p(v,g){a&&a.p&&(!r||g[1]&32)&&$t(a,i,v,v[36],r?tn(i,v[36],g,og):en(v[36]),ti),v[1]?c?(c.p(v,g),g[0]&2&&C(c,1)):(c=ni(v),c.c(),C(c,1),c.m(t.parentNode,t)):c&&(Ae(),P(c,1,1,()=>{c=null}),Le()),v[2]?u?(u.p(v,g),g[0]&4&&C(u,1)):(u=li(v),u.c(),C(u,1),u.m(n.parentNode,n)):u&&(Ae(),P(u,1,1,()=>{u=null}),Le()),v[3]?f?(f.p(v,g),g[0]&8&&C(f,1)):(f=oi(v),f.c(),C(f,1),f.m(o.parentNode,o)):f&&(Ae(),P(f,1,1,()=>{f=null}),Le()),d&&d.p&&(!r||g[1]&32)&&$t(d,h,v,v[36],r?tn(h,v[36],g,null):en(v[36]),null),b&&b.p&&(!r||g[1]&32)&&$t(b,_,v,v[36],r?tn(_,v[36],g,lg):en(v[36]),ei)},i(v){r||(C(a,v),C(c),C(u),C(f),C(d,v),C(b,v),r=!0)},o(v){P(a,v),P(c),P(u),P(f),P(d,v),P(b,v),r=!1},d(v){v&&(p(e),p(t),p(n),p(o),p(s)),a&&a.d(v),c&&c.d(v),u&&u.d(v),f&&f.d(v),d&&d.d(v),b&&b.d(v)}}}function dg(l){let e,t;return e=new Pa({props:{class:Bt(["svelte-flow__controls",l[7],l[6]]),position:l[0],"data-testid":"svelte-flow__controls","aria-label":l[4]??"Svelte Flow controls",style:l[5],$$slots:{default:[fg]},$$scope:{ctx:l}}}),{c(){te(e.$$.fragment)},l(n){oe(e.$$.fragment,n)},m(n,o){ne(e,n,o),t=!0},p(n,o){const s={};o[0]&192&&(s.class=Bt(["svelte-flow__controls",n[7],n[6]])),o[0]&1&&(s.position=n[0]),o[0]&16&&(s["aria-label"]=n[4]??"Svelte Flow controls"),o[0]&32&&(s.style=n[5]),o[0]&1806|o[1]&32&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){le(e,n)}}}function hg(l,e,t){let n,o,s,r,i,a,c,u,f,h,{$$slots:d={},$$scope:_}=e,{position:b="bottom-left"}=e,{showZoom:v=!0}=e,{showFitView:g=!0}=e,{showLock:w=!0}=e,{buttonBgColor:y=void 0}=e,{buttonBgColorHover:E=void 0}=e,{buttonColor:z=void 0}=e,{buttonColorHover:T=void 0}=e,{buttonBorderColor:I=void 0}=e,{ariaLabel:H=void 0}=e,{style:O=void 0}=e,{orientation:A="vertical"}=e,{fitViewOptions:F=void 0}=e,{class:j=""}=e;const{zoomIn:Y,zoomOut:M,fitView:K,viewport:D,minZoom:W,maxZoom:L,nodesDraggable:R,nodesConnectable:X,elementsSelectable:Q}=Zt();ie(l,D,re=>t(30,a=re)),ie(l,W,re=>t(31,c=re)),ie(l,L,re=>t(29,i=re)),ie(l,R,re=>t(34,h=re)),ie(l,X,re=>t(33,f=re)),ie(l,Q,re=>t(32,u=re));const G={bgColor:y,bgColorHover:E,color:z,colorHover:T,borderColor:I},ce=()=>{Y()},se=()=>{M()},ye=()=>{K(F)},Se=()=>{t(8,n=!n),R.set(n),X.set(n),Q.set(n)};return l.$$set=re=>{"position"in re&&t(0,b=re.position),"showZoom"in re&&t(1,v=re.showZoom),"showFitView"in re&&t(2,g=re.showFitView),"showLock"in re&&t(3,w=re.showLock),"buttonBgColor"in re&&t(22,y=re.buttonBgColor),"buttonBgColorHover"in re&&t(23,E=re.buttonBgColorHover),"buttonColor"in re&&t(24,z=re.buttonColor),"buttonColorHover"in re&&t(25,T=re.buttonColorHover),"buttonBorderColor"in re&&t(26,I=re.buttonBorderColor),"ariaLabel"in re&&t(4,H=re.ariaLabel),"style"in re&&t(5,O=re.style),"orientation"in re&&t(27,A=re.orientation),"fitViewOptions"in re&&t(28,F=re.fitViewOptions),"class"in re&&t(6,j=re.class),"$$scope"in re&&t(36,_=re.$$scope)},l.$$.update=()=>{l.$$.dirty[1]&14&&t(8,n=h||f||u),l.$$.dirty[0]&1073741824|l.$$.dirty[1]&1&&t(10,o=a.zoom<=c),l.$$.dirty[0]&1610612736&&t(9,s=a.zoom>=i),l.$$.dirty[0]&134217728&&t(7,r=A==="horizontal"?"horizontal":"vertical")},[b,v,g,w,H,O,j,r,n,s,o,D,W,L,R,X,Q,G,ce,se,ye,Se,y,E,z,T,I,A,F,i,a,c,u,f,h,d,_]}let mg=class extends Ve{constructor(e){super(),Ne(this,e,hg,dg,Be,{position:0,showZoom:1,showFitView:2,showLock:3,buttonBgColor:22,buttonBgColorHover:23,buttonColor:24,buttonColorHover:25,buttonBorderColor:26,ariaLabel:4,style:5,orientation:27,fitViewOptions:28,class:6},null,[-1,-1])}};var xn;(function(l){l.Lines="lines",l.Dots="dots",l.Cross="cross"})(xn||(xn={}));function gg(l){let e,t;return{c(){e=ze("circle"),this.h()},l(n){e=Pe(n,"circle",{cx:!0,cy:!0,r:!0,class:!0}),S(e).forEach(p),this.h()},h(){m(e,"cx",l[0]),m(e,"cy",l[0]),m(e,"r",l[0]),m(e,"class",t=Bt(["svelte-flow__background-pattern","dots",l[1]]))},m(n,o){B(n,e,o)},p(n,[o]){o&1&&m(e,"cx",n[0]),o&1&&m(e,"cy",n[0]),o&1&&m(e,"r",n[0]),o&2&&t!==(t=Bt(["svelte-flow__background-pattern","dots",n[1]]))&&m(e,"class",t)},i:we,o:we,d(n){n&&p(e)}}}function _g(l,e,t){let{radius:n=5}=e,{class:o=""}=e;return l.$$set=s=>{"radius"in s&&t(0,n=s.radius),"class"in s&&t(1,o=s.class)},[n,o]}class pg extends Ve{constructor(e){super(),Ne(this,e,_g,gg,Be,{radius:0,class:1})}}function bg(l){let e,t,n;return{c(){e=ze("path"),this.h()},l(o){e=Pe(o,"path",{"stroke-width":!0,d:!0,class:!0}),S(e).forEach(p),this.h()},h(){m(e,"stroke-width",l[0]),m(e,"d",t=`M${l[1][0]/2} 0 V${l[1][1]} M0 ${l[1][1]/2} H${l[1][0]}`),m(e,"class",n=Bt(["svelte-flow__background-pattern",l[2],l[3]]))},m(o,s){B(o,e,s)},p(o,[s]){s&1&&m(e,"stroke-width",o[0]),s&2&&t!==(t=`M${o[1][0]/2} 0 V${o[1][1]} M0 ${o[1][1]/2} H${o[1][0]}`)&&m(e,"d",t),s&12&&n!==(n=Bt(["svelte-flow__background-pattern",o[2],o[3]]))&&m(e,"class",n)},i:we,o:we,d(o){o&&p(e)}}}function vg(l,e,t){let{lineWidth:n=1}=e,{dimensions:o}=e,{variant:s=void 0}=e,{class:r=""}=e;return l.$$set=i=>{"lineWidth"in i&&t(0,n=i.lineWidth),"dimensions"in i&&t(1,o=i.dimensions),"variant"in i&&t(2,s=i.variant),"class"in i&&t(3,r=i.class)},[n,o,s,r]}class wg extends Ve{constructor(e){super(),Ne(this,e,vg,bg,Be,{lineWidth:0,dimensions:1,variant:2,class:3})}}function yg(l){let e,t;return e=new wg({props:{dimensions:l[6],variant:l[0],lineWidth:l[1],class:l[4]}}),{c(){te(e.$$.fragment)},l(n){oe(e.$$.fragment,n)},m(n,o){ne(e,n,o),t=!0},p(n,o){const s={};o&64&&(s.dimensions=n[6]),o&1&&(s.variant=n[0]),o&2&&(s.lineWidth=n[1]),o&16&&(s.class=n[4]),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){le(e,n)}}}function kg(l){let e,t;return e=new pg({props:{radius:l[7]/2,class:l[4]}}),{c(){te(e.$$.fragment)},l(n){oe(e.$$.fragment,n)},m(n,o){ne(e,n,o),t=!0},p(n,o){const s={};o&128&&(s.radius=n[7]/2),o&16&&(s.class=n[4]),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){le(e,n)}}}function Eg(l){let e,t,n,o,s,r,i,a,c,u,f,h,d;const _=[kg,yg],b=[];function v(g,w){return g[14]?0:1}return n=v(l),o=b[n]=_[n](l),{c(){e=ze("svg"),t=ze("pattern"),o.c(),u=ze("rect"),this.h()},l(g){e=Pe(g,"svg",{class:!0,"data-testid":!0});var w=S(e);t=Pe(w,"pattern",{id:!0,x:!0,y:!0,width:!0,height:!0,patternUnits:!0,patternTransform:!0});var y=S(t);o.l(y),y.forEach(p),u=Pe(w,"rect",{x:!0,y:!0,width:!0,height:!0,fill:!0}),S(u).forEach(p),w.forEach(p),this.h()},h(){m(t,"id",l[11]),m(t,"x",s=l[9].x%l[8][0]),m(t,"y",r=l[9].y%l[8][1]),m(t,"width",i=l[8][0]),m(t,"height",a=l[8][1]),m(t,"patternUnits","userSpaceOnUse"),m(t,"patternTransform",c=`translate(-${l[10][0]},-${l[10][1]})`),m(u,"x","0"),m(u,"y","0"),m(u,"width","100%"),m(u,"height","100%"),m(u,"fill",f=`url(#${l[11]})`),m(e,"class",h=fs(Bt(["svelte-flow__background",l[5]]))+" svelte-1r7pe8d"),m(e,"data-testid","svelte-flow__background"),tt(e,"--xy-background-color-props",l[2]),tt(e,"--xy-background-pattern-color-props",l[3])},m(g,w){B(g,e,w),k(e,t),b[n].m(t,null),k(e,u),d=!0},p(g,[w]){o.p(g,w),(!d||w&2048)&&m(t,"id",g[11]),(!d||w&768&&s!==(s=g[9].x%g[8][0]))&&m(t,"x",s),(!d||w&768&&r!==(r=g[9].y%g[8][1]))&&m(t,"y",r),(!d||w&256&&i!==(i=g[8][0]))&&m(t,"width",i),(!d||w&256&&a!==(a=g[8][1]))&&m(t,"height",a),(!d||w&1024&&c!==(c=`translate(-${g[10][0]},-${g[10][1]})`))&&m(t,"patternTransform",c),(!d||w&2048&&f!==(f=`url(#${g[11]})`))&&m(u,"fill",f),(!d||w&32&&h!==(h=fs(Bt(["svelte-flow__background",g[5]]))+" svelte-1r7pe8d"))&&m(e,"class",h),w&4&&tt(e,"--xy-background-color-props",g[2]),w&8&&tt(e,"--xy-background-pattern-color-props",g[3])},i(g){d||(C(o),d=!0)},o(g){P(o),d=!1},d(g){g&&p(e),b[n].d()}}}const Ig={[xn.Dots]:1,[xn.Lines]:1,[xn.Cross]:6};function Sg(l,e,t){let n,o,s,r,i,a,c,{id:u=void 0}=e,{variant:f=xn.Dots}=e,{gap:h=20}=e,{size:d=1}=e,{lineWidth:_=1}=e,{bgColor:b=void 0}=e,{patternColor:v=void 0}=e,{patternClass:g=void 0}=e,{class:w=""}=e;const{viewport:y,flowId:E}=Zt();ie(l,y,O=>t(9,a=O)),ie(l,E,O=>t(18,c=O));const z=d||Ig[f],T=f===xn.Dots,I=f===xn.Cross,H=Array.isArray(h)?h:[h,h];return l.$$set=O=>{"id"in O&&t(15,u=O.id),"variant"in O&&t(0,f=O.variant),"gap"in O&&t(16,h=O.gap),"size"in O&&t(17,d=O.size),"lineWidth"in O&&t(1,_=O.lineWidth),"bgColor"in O&&t(2,b=O.bgColor),"patternColor"in O&&t(3,v=O.patternColor),"patternClass"in O&&t(4,g=O.patternClass),"class"in O&&t(5,w=O.class)},l.$$.update=()=>{l.$$.dirty&294912&&t(11,n=`background-pattern-${c}-${u||""}`),l.$$.dirty&512&&t(8,o=[H[0]*a.zoom||1,H[1]*a.zoom||1]),l.$$.dirty&512&&t(7,s=z*a.zoom),l.$$.dirty&384&&t(6,r=I?[s,s]:o),l.$$.dirty&192&&t(10,i=T?[s/2,s/2]:[r[0]/2,r[1]/2])},[f,_,b,v,g,w,r,s,o,a,i,n,y,E,T,u,h,d,c]}class Dg extends Ve{constructor(e){super(),Ne(this,e,Sg,Eg,Be,{id:15,variant:0,gap:16,size:17,lineWidth:1,bgColor:2,patternColor:3,patternClass:4,class:5})}}const si=l=>Xd(l);function Cg(){const{zoomIn:l,zoomOut:e,fitView:t,onbeforedelete:n,snapGrid:o,viewport:s,width:r,height:i,minZoom:a,maxZoom:c,panZoom:u,nodes:f,edges:h,domNode:d,nodeLookup:_,nodeOrigin:b,edgeLookup:v,connectionLookup:g}=Zt(),w=z=>{var A,F;const T=he(_),I=si(z)?z:T.get(z.id),H=I.parentId?Qd(I.position,I.measured,I.parentId,T,he(b)):I.position,O={id:I.id,position:H,width:((A=I.measured)==null?void 0:A.width)??I.width,height:((F=I.measured)==null?void 0:F.height)??I.height,data:I.data};return Bl(O)},y=(z,T,I={replace:!1})=>{var A;const H=(A=he(_).get(z))==null?void 0:A.internals.userNode;if(!H)return;const O=typeof T=="function"?T(H):T;I.replace?f.update(F=>F.map(j=>j.id===z?si(O)?O:{...j,...O}:j)):(Object.assign(H,O),f.update(F=>F))},E=z=>he(_).get(z);return{zoomIn:l,zoomOut:e,getInternalNode:E,getNode:z=>{var T;return(T=E(z))==null?void 0:T.internals.userNode},getNodes:z=>z===void 0?he(f):ri(he(_),z),getEdge:z=>he(v).get(z),getEdges:z=>z===void 0?he(h):ri(he(v),z),setZoom:(z,T)=>{const I=he(u);return I?I.scaleTo(z,{duration:T==null?void 0:T.duration}):Promise.resolve(!1)},getZoom:()=>he(s).zoom,setViewport:async(z,T)=>{const I=he(s),H=he(u);return H?(await H.setViewport({x:z.x??I.x,y:z.y??I.y,zoom:z.zoom??I.zoom},{duration:T==null?void 0:T.duration}),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>he(s),setCenter:async(z,T,I)=>{const H=typeof(I==null?void 0:I.zoom)<"u"?I.zoom:he(c),O=he(u);return O?(await O.setViewport({x:he(r)/2-z*H,y:he(i)/2-T*H,zoom:H},{duration:I==null?void 0:I.duration}),Promise.resolve(!0)):Promise.resolve(!1)},fitView:t,fitBounds:async(z,T)=>{const I=he(u);if(!I)return Promise.resolve(!1);const H=cs(z,he(r),he(i),he(a),he(c),(T==null?void 0:T.padding)??.1);return await I.setViewport(H,{duration:T==null?void 0:T.duration}),Promise.resolve(!0)},getIntersectingNodes:(z,T=!0,I)=>{const H=kr(z),O=H?z:w(z);return O?(I||he(f)).filter(A=>{const F=he(_).get(A.id);if(!F||!H&&A.id===z.id)return!1;const j=Bl(F),Y=Zl(j,O);return T&&Y>0||Y>=O.width*O.height}):[]},isNodeIntersecting:(z,T,I=!0)=>{const O=kr(z)?z:w(z);if(!O)return!1;const A=Zl(O,T);return I&&A>0||A>=O.width*O.height},deleteElements:async({nodes:z=[],edges:T=[]})=>{const{nodes:I,edges:H}=await na({nodesToRemove:z,edgesToRemove:T,nodes:he(f),edges:he(h),onBeforeDelete:he(n)});return I&&f.update(O=>O.filter(A=>!I.some(({id:F})=>F===A.id))),H&&h.update(O=>O.filter(A=>!H.some(({id:F})=>F===A.id))),{deletedNodes:I,deletedEdges:H}},screenToFlowPosition:(z,T={snapToGrid:!0})=>{const I=he(d);if(!I)return z;const H=T.snapToGrid?he(o):!1,{x:O,y:A,zoom:F}=he(s),{x:j,y:Y}=I.getBoundingClientRect(),M={x:z.x-j,y:z.y-Y};return Ql(M,[O,A,F],H!==null,H||[1,1])},flowToScreenPosition:z=>{const T=he(d);if(!T)return z;const{x:I,y:H,zoom:O}=he(s),{x:A,y:F}=T.getBoundingClientRect(),j=sa(z,[I,H,O]);return{x:j.x+A,y:j.y+F}},toObject:()=>({nodes:he(f).map(z=>({...z,position:{...z.position},data:{...z.data}})),edges:he(h).map(z=>({...z})),viewport:{...he(s)}}),updateNode:y,updateNodeData:(z,T,I)=>{var A;const H=(A=he(_).get(z))==null?void 0:A.internals.userNode;if(!H)return;const O=typeof T=="function"?T(H):T;H.data=I!=null&&I.replace?O:{...H.data,...O},f.update(F=>F)},getNodesBounds:z=>{const T=he(_),I=he(b);return Kd(z,{nodeLookup:T,nodeOrigin:I})},getHandleConnections:({type:z,id:T,nodeId:I})=>{var H;return Array.from(((H=he(g).get(`${I}-${z}-${T??null}`))==null?void 0:H.values())??[])},viewport:s}}function ri(l,e){var n;const t=[];for(const o of e){const s=l.get(o);if(s){const r="internals"in s?(n=s.internals)==null?void 0:n.userNode:s;t.push(r)}}return t}function Mg(){const{nodesInitialized:l}=Zt();return{subscribe:l.subscribe}}function ii(l,e,t){const n=l.slice();return n[25]=e[t],n[27]=t,n}function ai(l,e,t){const n=l.slice();return n[22]=e[t],n[24]=t,n}function Tg(l){let e,t;return e=new ss({props:{className:"size-4"}}),{c(){te(e.$$.fragment)},l(n){oe(e.$$.fragment,n)},m(n,o){ne(e,n,o),t=!0},p:we,i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){le(e,n)}}}function Vg(l){let e,t,n,o,s,r,i,a=l[8].t("Tools")+"",c,u,f=l[8].t("Functions")+"",h,d,_,b,v,g,w,y;function E(H,O){if(H[1]==="tools")return zg;if(H[1]==="functions")return Ng}let z=E(l),T=z&&z(l),I=l[2]&&fi(l);return{c(){e=V("form"),t=V("div"),n=V("div"),o=V("div"),s=V("div"),r=V("select"),i=V("option"),c=Ce(a),u=V("option"),h=Ce(f),d=$(),_=V("div"),b=V("select"),T&&T.c(),v=$(),I&&I.c(),this.h()},l(H){e=N(H,"FORM",{class:!0});var O=S(e);t=N(O,"DIV",{class:!0});var A=S(t);n=N(A,"DIV",{class:!0});var F=S(n);o=N(F,"DIV",{class:!0});var j=S(o);s=N(j,"DIV",{class:!0});var Y=S(s);r=N(Y,"SELECT",{class:!0,placeholder:!0});var M=S(r);i=N(M,"OPTION",{class:!0});var K=S(i);c=Me(K,a),K.forEach(p),u=N(M,"OPTION",{class:!0});var D=S(u);h=Me(D,f),D.forEach(p),M.forEach(p),Y.forEach(p),d=ee(j),_=N(j,"DIV",{class:!0});var W=S(_);b=N(W,"SELECT",{class:!0});var L=S(b);T&&T.l(L),L.forEach(p),W.forEach(p),j.forEach(p),F.forEach(p),v=ee(A),I&&I.l(A),A.forEach(p),O.forEach(p),this.h()},h(){i.__value="tools",Dn(i,i.__value),m(i,"class","bg-gray-100 dark:bg-gray-800"),u.__value="functions",Dn(u,u.__value),m(u,"class","bg-gray-100 dark:bg-gray-800"),m(r,"class","w-full rounded text-xs py-2 px-1 bg-transparent outline-none"),m(r,"placeholder","Select"),l[1]===void 0&&sl(()=>l[13].call(r)),m(s,"class","flex-1"),m(b,"class","w-full rounded py-2 px-1 text-xs bg-transparent outline-none"),l[2]===void 0&&sl(()=>l[14].call(b)),m(_,"class","flex-1"),m(o,"class","flex gap-2"),m(n,"class","space-y-1"),m(t,"class","flex flex-col"),m(e,"class","flex flex-col h-full justify-between space-y-3 text-sm")},m(H,O){B(H,e,O),k(e,t),k(t,n),k(n,o),k(o,s),k(s,r),k(r,i),k(i,c),k(r,u),k(u,h),eo(r,l[1],!0),k(o,d),k(o,_),k(_,b),T&&T.m(b,null),eo(b,l[2],!0),k(t,v),I&&I.m(t,null),g=!0,w||(y=[ke(r,"change",l[13]),ke(b,"change",l[14]),ke(b,"change",l[15]),ke(e,"submit",Ai(l[18]))],w=!0)},p(H,O){(!g||O&256)&&a!==(a=H[8].t("Tools")+"")&&He(c,a),(!g||O&256)&&f!==(f=H[8].t("Functions")+"")&&He(h,f),O&2&&eo(r,H[1]),z===(z=E(H))&&T?T.p(H,O):(T&&T.d(1),T=z&&z(H),T&&(T.c(),T.m(b,null))),O&196&&eo(b,H[2]),H[2]?I?(I.p(H,O),O&4&&C(I,1)):(I=fi(H),I.c(),C(I,1),I.m(t,null)):I&&(Ae(),P(I,1,1,()=>{I=null}),Le())},i(H){g||(C(I),g=!0)},o(H){P(I),g=!1},d(H){H&&p(e),T&&T.d(),I&&I.d(),w=!1,ln(y)}}}function Ng(l){let e,t=l[8].t("Select a function")+"",n,o,s=wt(l[7]),r=[];for(let i=0;i<s.length;i+=1)r[i]=ci(ii(l,s,i));return{c(){e=V("option"),n=Ce(t);for(let i=0;i<r.length;i+=1)r[i].c();o=Oe(),this.h()},l(i){e=N(i,"OPTION",{class:!0});var a=S(e);n=Me(a,t),a.forEach(p);for(let c=0;c<r.length;c+=1)r[c].l(i);o=Oe(),this.h()},h(){e.__value="",Dn(e,e.__value),e.selected=!0,e.disabled=!0,m(e,"class","bg-gray-100 dark:bg-gray-800")},m(i,a){B(i,e,a),k(e,n);for(let c=0;c<r.length;c+=1)r[c]&&r[c].m(i,a);B(i,o,a)},p(i,a){if(a&256&&t!==(t=i[8].t("Select a function")+"")&&He(n,t),a&128){s=wt(i[7]);let c;for(c=0;c<s.length;c+=1){const u=ii(i,s,c);r[c]?r[c].p(u,a):(r[c]=ci(u),r[c].c(),r[c].m(o.parentNode,o))}for(;c<r.length;c+=1)r[c].d(1);r.length=s.length}},d(i){i&&(p(e),p(o)),Cn(r,i)}}}function zg(l){let e,t=l[8].t("Select a tool")+"",n,o,s=wt(l[6]),r=[];for(let i=0;i<s.length;i+=1)r[i]=ui(ai(l,s,i));return{c(){e=V("option"),n=Ce(t);for(let i=0;i<r.length;i+=1)r[i].c();o=Oe(),this.h()},l(i){e=N(i,"OPTION",{class:!0});var a=S(e);n=Me(a,t),a.forEach(p);for(let c=0;c<r.length;c+=1)r[c].l(i);o=Oe(),this.h()},h(){e.__value="",Dn(e,e.__value),e.selected=!0,e.disabled=!0,m(e,"class","bg-gray-100 dark:bg-gray-800")},m(i,a){B(i,e,a),k(e,n);for(let c=0;c<r.length;c+=1)r[c]&&r[c].m(i,a);B(i,o,a)},p(i,a){if(a&256&&t!==(t=i[8].t("Select a tool")+"")&&He(n,t),a&64){s=wt(i[6]);let c;for(c=0;c<s.length;c+=1){const u=ai(i,s,c);r[c]?r[c].p(u,a):(r[c]=ui(u),r[c].c(),r[c].m(o.parentNode,o))}for(;c<r.length;c+=1)r[c].d(1);r.length=s.length}},d(i){i&&(p(e),p(o)),Cn(r,i)}}}function ci(l){let e,t=l[25].name+"",n,o;return{c(){e=V("option"),n=Ce(t),this.h()},l(s){e=N(s,"OPTION",{class:!0});var r=S(e);n=Me(r,t),r.forEach(p),this.h()},h(){e.__value=o=l[25].id,Dn(e,e.__value),m(e,"class","bg-gray-100 dark:bg-gray-800")},m(s,r){B(s,e,r),k(e,n)},p(s,r){r&128&&t!==(t=s[25].name+"")&&He(n,t),r&128&&o!==(o=s[25].id)&&(e.__value=o,Dn(e,e.__value))},d(s){s&&p(e)}}}function ui(l){let e,t=l[22].name+"",n,o;return{c(){e=V("option"),n=Ce(t),this.h()},l(s){e=N(s,"OPTION",{class:!0});var r=S(e);n=Me(r,t),r.forEach(p),this.h()},h(){e.__value=o=l[22].id,Dn(e,e.__value),m(e,"class","bg-gray-100 dark:bg-gray-800")},m(s,r){B(s,e,r),k(e,n)},p(s,r){r&64&&t!==(t=s[22].name+"")&&He(n,t),r&64&&o!==(o=s[22].id)&&(e.__value=o,Dn(e,e.__value))},d(s){s&&p(e)}}}function fi(l){let e,t,n,o,s,r;const i=[Og,Pg],a=[];function c(u,f){return u[3]?1:0}return o=c(l),s=a[o]=i[o](l),{c(){e=V("hr"),t=$(),n=V("div"),s.c(),this.h()},l(u){e=N(u,"HR",{class:!0}),t=ee(u),n=N(u,"DIV",{class:!0});var f=S(n);s.l(f),f.forEach(p),this.h()},h(){m(e,"class","dark:border-gray-800 my-1 w-full"),m(n,"class","my-2 text-xs")},m(u,f){B(u,e,f),B(u,t,f),B(u,n,f),a[o].m(n,null),r=!0},p(u,f){let h=o;o=c(u),o===h?a[o].p(u,f):(Ae(),P(a[h],1,1,()=>{a[h]=null}),Le(),s=a[o],s?s.p(u,f):(s=a[o]=i[o](u),s.c()),C(s,1),s.m(n,null))},i(u){r||(C(s),r=!0)},o(u){P(s),r=!1},d(u){u&&(p(e),p(t),p(n)),a[o].d()}}}function Pg(l){let e,t;return e=new ss({props:{className:"size-5"}}),{c(){te(e.$$.fragment)},l(n){oe(e.$$.fragment,n)},m(n,o){ne(e,n,o),t=!0},p:we,i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){le(e,n)}}}function Og(l){let e,t,n;function o(r){l[16](r)}let s={valvesSpec:l[4]};return l[5]!==void 0&&(s.valves=l[5]),e=new cu({props:s}),We.push(()=>$e(e,"valves",o)),e.$on("change",l[17]),{c(){te(e.$$.fragment)},l(r){oe(e.$$.fragment,r)},m(r,i){ne(e,r,i),n=!0},p(r,i){const a={};i&16&&(a.valvesSpec=r[4]),!t&&i&32&&(t=!0,a.valves=r[5],xe(()=>t=!1)),e.$set(a)},i(r){n||(C(e.$$.fragment,r),n=!0)},o(r){P(e.$$.fragment,r),n=!1},d(r){le(e,r)}}}function Hg(l){let e,t,n,o;const s=[Vg,Tg],r=[];function i(a,c){return a[0]&&!a[3]?0:1}return e=i(l),t=r[e]=s[e](l),{c(){t.c(),n=Oe()},l(a){t.l(a),n=Oe()},m(a,c){r[e].m(a,c),B(a,n,c),o=!0},p(a,[c]){let u=e;e=i(a),e===u?r[e].p(a,c):(Ae(),P(r[u],1,1,()=>{r[u]=null}),Le(),t=r[e],t?t.p(a,c):(t=r[e]=s[e](a),t.c()),C(t,1),t.m(n.parentNode,n))},i(a){o||(C(t),o=!0)},o(a){P(t),o=!1},d(a){a&&p(n),r[e].d(a)}}}function Bg(l,e,t){let n,o,s;ie(l,vl,O=>t(6,n=O)),ie(l,gs,O=>t(7,o=O));const r=on(),i=Ut("i18n");ie(l,i,O=>t(8,s=O));let{show:a=!1}=e,c="tools",u="",f=!1,h=null,d={},_;const b=async()=>{_&&clearTimeout(_),_=setTimeout(()=>{g()},500)},v=async()=>{var O;if(t(3,f=!0),c==="tools"?(t(5,d=await Yc(localStorage.token,u)),t(4,h=await Zc(localStorage.token,u))):c==="functions"&&(t(5,d=await ru(localStorage.token,u)),t(4,h=await iu(localStorage.token,u))),h)for(const A in h.properties)((O=h.properties[A])==null?void 0:O.type)==="array"&&t(5,d[A]=(d[A]??[]).join(","),d);t(3,f=!1)},g=async()=>{var O;if(h){for(const A in h.properties)((O=h.properties[A])==null?void 0:O.type)==="array"&&t(5,d[A]=(d[A]??"").split(",").map(F=>F.trim()),d);if(c==="tools"){const A=await Xc(localStorage.token,u,d).catch(F=>(nt.error(F),null));A&&(nt.success(s.t("Valves updated")),t(5,d=A))}else if(c==="functions"){const A=await au(localStorage.token,u,d).catch(F=>(nt.error(F),null));A&&(nt.success(s.t("Valves updated")),t(5,d=A))}}},w=async()=>{t(3,f=!0),o===null&&gs.set(await su(localStorage.token)),n===null&&vl.set(await os(localStorage.token)),t(3,f=!1)};function y(){c=ds(this),t(1,c)}function E(){u=ds(this),t(2,u),t(1,c)}const z=async()=>{await qe()};function T(O){d=O,t(5,d)}const I=()=>{b()},H=()=>{g(),r("save")};return l.$$set=O=>{"show"in O&&t(0,a=O.show)},l.$$.update=()=>{l.$$.dirty&2&&c&&t(2,u=""),l.$$.dirty&4&&u&&v(),l.$$.dirty&1&&a&&w()},[a,c,u,f,h,d,n,o,s,r,i,b,g,y,E,z,T,I,H]}class Ag extends Ve{constructor(e){super(),Ne(this,e,Bg,Hg,Be,{show:0})}}function di(l,e,t){const n=l.slice();return n[14]=e[t],n[16]=t,n}function hi(l){let e,t,n,o;return e=new uo({props:{title:l[3].t("Files"),open:!0,buttonClassName:"w-full",$$slots:{content:[Lg]},$$scope:{ctx:l}}}),{c(){te(e.$$.fragment),t=$(),n=V("hr"),this.h()},l(s){oe(e.$$.fragment,s),t=ee(s),n=N(s,"HR",{class:!0}),this.h()},h(){m(n,"class","my-2 border-gray-50 dark:border-gray-700/10")},m(s,r){ne(e,s,r),B(s,t,r),B(s,n,r),o=!0},p(s,r){const i={};r&8&&(i.title=s[3].t("Files")),r&131073&&(i.$$scope={dirty:r,ctx:s}),e.$set(i)},i(s){o||(C(e.$$.fragment,s),o=!0)},o(s){P(e.$$.fragment,s),o=!1},d(s){s&&(p(t),p(n)),le(e,s)}}}function mi(l){var s,r;let e,t;function n(){return l[9](l[16])}function o(){return l[10](l[14])}return e=new Gi({props:{className:"w-full",item:l[14],edit:!0,url:(s=l[14])!=null&&s.url?l[14].url:null,name:l[14].name,type:l[14].type,size:(r=l[14])==null?void 0:r.size,dismissible:!0}}),e.$on("dismiss",n),e.$on("click",o),{c(){te(e.$$.fragment)},l(i){oe(e.$$.fragment,i)},m(i,a){ne(e,i,a),t=!0},p(i,a){var u,f;l=i;const c={};a&1&&(c.item=l[14]),a&1&&(c.url=(u=l[14])!=null&&u.url?l[14].url:null),a&1&&(c.name=l[14].name),a&1&&(c.type=l[14].type),a&1&&(c.size=(f=l[14])==null?void 0:f.size),e.$set(c)},i(i){t||(C(e.$$.fragment,i),t=!0)},o(i){P(e.$$.fragment,i),t=!1},d(i){le(e,i)}}}function Lg(l){let e,t,n=wt(l[0]),o=[];for(let r=0;r<n.length;r+=1)o[r]=mi(di(l,n,r));const s=r=>P(o[r],1,1,()=>{o[r]=null});return{c(){e=V("div");for(let r=0;r<o.length;r+=1)o[r].c();this.h()},l(r){e=N(r,"DIV",{class:!0,slot:!0});var i=S(e);for(let a=0;a<o.length;a+=1)o[a].l(i);i.forEach(p),this.h()},h(){m(e,"class","flex flex-col gap-1 mt-1.5"),m(e,"slot","content")},m(r,i){B(r,e,i);for(let a=0;a<o.length;a+=1)o[a]&&o[a].m(e,null);t=!0},p(r,i){if(i&1){n=wt(r[0]);let a;for(a=0;a<n.length;a+=1){const c=di(r,n,a);o[a]?(o[a].p(c,i),C(o[a],1)):(o[a]=mi(c),o[a].c(),C(o[a],1),o[a].m(e,null))}for(Ae(),a=n.length;a<o.length;a+=1)s(a);Le()}},i(r){if(!t){for(let i=0;i<n.length;i+=1)C(o[i]);t=!0}},o(r){o=o.filter(Boolean);for(let i=0;i<o.length;i+=1)P(o[i]);t=!1},d(r){r&&p(e),Cn(o,r)}}}function Rg(l){let e,t,n;return t=new Ag({props:{show:l[2]}}),{c(){e=V("div"),te(t.$$.fragment),this.h()},l(o){e=N(o,"DIV",{class:!0,slot:!0});var s=S(e);oe(t.$$.fragment,s),s.forEach(p),this.h()},h(){m(e,"class","text-sm"),m(e,"slot","content")},m(o,s){B(o,e,s),ne(t,e,null),n=!0},p(o,s){const r={};s&4&&(r.show=o[2]),t.$set(r)},i(o){n||(C(t.$$.fragment,o),n=!0)},o(o){P(t.$$.fragment,o),n=!1},d(o){o&&p(e),le(t)}}}function Ug(l){let e,t,n,o,s;return{c(){e=V("div"),t=V("textarea"),this.h()},l(r){e=N(r,"DIV",{class:!0,slot:!0});var i=S(e);t=N(i,"TEXTAREA",{class:!0,rows:!0,placeholder:!0}),S(t).forEach(p),i.forEach(p),this.h()},h(){m(t,"class","w-full text-xs py-1.5 bg-transparent outline-none resize-none"),m(t,"rows","4"),m(t,"placeholder",n=l[3].t("Enter system prompt")),m(e,"class",""),m(e,"slot","content")},m(r,i){B(r,e,i),k(e,t),Dn(t,l[1].system),o||(s=ke(t,"input",l[12]),o=!0)},p(r,i){i&8&&n!==(n=r[3].t("Enter system prompt"))&&m(t,"placeholder",n),i&2&&Dn(t,r[1].system)},d(r){r&&p(e),o=!1,s()}}}function Wg(l){var a;let e,t,n,o,s;function r(c){l[13](c)}let i={admin:((a=l[4])==null?void 0:a.role)==="admin"};return l[1]!==void 0&&(i.params=l[1]),n=new ou({props:i}),We.push(()=>$e(n,"params",r)),{c(){e=V("div"),t=V("div"),te(n.$$.fragment),this.h()},l(c){e=N(c,"DIV",{class:!0,slot:!0});var u=S(e);t=N(u,"DIV",{});var f=S(t);oe(n.$$.fragment,f),f.forEach(p),u.forEach(p),this.h()},h(){m(e,"class","text-sm mt-1.5"),m(e,"slot","content")},m(c,u){B(c,e,u),k(e,t),ne(n,t,null),s=!0},p(c,u){var h;const f={};u&16&&(f.admin=((h=c[4])==null?void 0:h.role)==="admin"),!o&&u&2&&(o=!0,f.params=c[1],xe(()=>o=!1)),n.$set(f)},i(c){s||(C(n.$$.fragment,c),s=!0)},o(c){P(n.$$.fragment,c),s=!1},d(c){c&&p(e),le(n)}}}function jg(l){let e,t,n,o=l[3].t("Chat Controls")+"",s,r,i,a,c,u,f,h,d,_,b,v,g,w,y,E,z,T,I,H;a=new No({props:{className:"size-3.5"}});let O=l[0].length>0&&hi(l);function A(j){l[11](j)}let F={title:l[3].t("Valves"),buttonClassName:"w-full",$$slots:{content:[Rg]},$$scope:{ctx:l}};return l[2]!==void 0&&(F.open=l[2]),h=new uo({props:F}),We.push(()=>$e(h,"open",A)),g=new uo({props:{title:l[3].t("System Prompt"),open:!0,buttonClassName:"w-full",$$slots:{content:[Ug]},$$scope:{ctx:l}}}),z=new uo({props:{title:l[3].t("Advanced Params"),open:!0,buttonClassName:"w-full",$$slots:{content:[Wg]},$$scope:{ctx:l}}}),{c(){e=V("div"),t=V("div"),n=V("div"),s=Ce(o),r=$(),i=V("button"),te(a.$$.fragment),c=$(),u=V("div"),O&&O.c(),f=$(),te(h.$$.fragment),_=$(),b=V("hr"),v=$(),te(g.$$.fragment),w=$(),y=V("hr"),E=$(),te(z.$$.fragment),this.h()},l(j){e=N(j,"DIV",{class:!0});var Y=S(e);t=N(Y,"DIV",{class:!0});var M=S(t);n=N(M,"DIV",{class:!0});var K=S(n);s=Me(K,o),K.forEach(p),r=ee(M),i=N(M,"BUTTON",{class:!0});var D=S(i);oe(a.$$.fragment,D),D.forEach(p),M.forEach(p),c=ee(Y),u=N(Y,"DIV",{class:!0});var W=S(u);O&&O.l(W),f=ee(W),oe(h.$$.fragment,W),_=ee(W),b=N(W,"HR",{class:!0}),v=ee(W),oe(g.$$.fragment,W),w=ee(W),y=N(W,"HR",{class:!0}),E=ee(W),oe(z.$$.fragment,W),W.forEach(p),Y.forEach(p),this.h()},h(){m(n,"class","text-lg font-medium self-center font-primary"),m(i,"class","self-center"),m(t,"class","flex items-center justify-between dark:text-gray-100 mb-2"),m(b,"class","my-2 border-gray-50 dark:border-gray-700/10"),m(y,"class","my-2 border-gray-50 dark:border-gray-700/10"),m(u,"class","dark:text-gray-200 text-sm font-primary py-0.5 px-0.5"),m(e,"class","dark:text-white")},m(j,Y){B(j,e,Y),k(e,t),k(t,n),k(n,s),k(t,r),k(t,i),ne(a,i,null),k(e,c),k(e,u),O&&O.m(u,null),k(u,f),ne(h,u,null),k(u,_),k(u,b),k(u,v),ne(g,u,null),k(u,w),k(u,y),k(u,E),ne(z,u,null),T=!0,I||(H=ke(i,"click",l[8]),I=!0)},p(j,[Y]){(!T||Y&8)&&o!==(o=j[3].t("Chat Controls")+"")&&He(s,o),j[0].length>0?O?(O.p(j,Y),Y&1&&C(O,1)):(O=hi(j),O.c(),C(O,1),O.m(u,f)):O&&(Ae(),P(O,1,1,()=>{O=null}),Le());const M={};Y&8&&(M.title=j[3].t("Valves")),Y&131076&&(M.$$scope={dirty:Y,ctx:j}),!d&&Y&4&&(d=!0,M.open=j[2],xe(()=>d=!1)),h.$set(M);const K={};Y&8&&(K.title=j[3].t("System Prompt")),Y&131082&&(K.$$scope={dirty:Y,ctx:j}),g.$set(K);const D={};Y&8&&(D.title=j[3].t("Advanced Params")),Y&131090&&(D.$$scope={dirty:Y,ctx:j}),z.$set(D)},i(j){T||(C(a.$$.fragment,j),C(O),C(h.$$.fragment,j),C(g.$$.fragment,j),C(z.$$.fragment,j),T=!0)},o(j){P(a.$$.fragment,j),P(O),P(h.$$.fragment,j),P(g.$$.fragment,j),P(z.$$.fragment,j),T=!1},d(j){j&&p(e),le(a),O&&O.d(),le(h),le(g),le(z),I=!1,H()}}}function Fg(l,e,t){let n,o;ie(l,al,g=>t(4,o=g));const s=on(),r=Ut("i18n");ie(l,r,g=>t(3,n=g));let{models:i=[]}=e,{chatFiles:a=[]}=e,{params:c={}}=e,u=!1;const f=()=>{s("close")},h=g=>{a.splice(g,1),t(0,a)},d=g=>{console.log(g)};function _(g){u=g,t(2,u)}function b(){c.system=this.value,t(1,c)}function v(g){c=g,t(1,c)}return l.$$set=g=>{"models"in g&&t(7,i=g.models),"chatFiles"in g&&t(0,a=g.chatFiles),"params"in g&&t(1,c=g.params)},[a,c,u,n,o,s,r,i,f,h,d,_,b,v]}class Oa extends Ve{constructor(e){super(),Ne(this,e,Fg,jg,Be,{models:7,chatFiles:0,params:1})}}function gi(l,e,t){const n=l.slice();return n[10]=e[t],n}function Yg(l){let e;const t=l[4].default,n=xt(t,l,l[8],null);return{c(){n&&n.c()},l(o){n&&n.l(o)},m(o,s){n&&n.m(o,s),e=!0},p(o,s){n&&n.p&&(!e||s&256)&&$t(n,t,o,o[8],e?tn(t,o[8],s,null):en(o[8]),null)},i(o){e||(C(n,o),e=!0)},o(o){P(n,o),e=!1},d(o){n&&n.d(o)}}}function Zg(l){var r;let e,t,n=(((r=l[10])==null?void 0:r.label)??"Camera")+"",o,s;return{c(){e=V("div"),t=V("div"),o=Ce(n),s=$(),this.h()},l(i){e=N(i,"DIV",{class:!0});var a=S(e);t=N(a,"DIV",{class:!0});var c=S(t);o=Me(c,n),c.forEach(p),a.forEach(p),s=ee(i),this.h()},h(){m(t,"class","line-clamp-1"),m(e,"class","flex items-center")},m(i,a){B(i,e,a),k(e,t),k(t,o),B(i,s,a)},p(i,a){var c;a&2&&n!==(n=(((c=i[10])==null?void 0:c.label)??"Camera")+"")&&He(o,n)},d(i){i&&(p(e),p(s))}}}function _i(l){let e,t;function n(){return l[5](l[10])}return e=new Sn({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",$$slots:{default:[Zg]},$$scope:{ctx:l}}}),e.$on("click",n),{c(){te(e.$$.fragment)},l(o){oe(e.$$.fragment,o)},m(o,s){ne(e,o,s),t=!0},p(o,s){l=o;const r={};s&258&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(o){t||(C(e.$$.fragment,o),t=!0)},o(o){P(e.$$.fragment,o),t=!1},d(o){le(e,o)}}}function Xg(l){let e,t,n=wt(l[1]),o=[];for(let r=0;r<n.length;r+=1)o[r]=_i(gi(l,n,r));const s=r=>P(o[r],1,1,()=>{o[r]=null});return{c(){for(let r=0;r<o.length;r+=1)o[r].c();e=Oe()},l(r){for(let i=0;i<o.length;i+=1)o[i].l(r);e=Oe()},m(r,i){for(let a=0;a<o.length;a+=1)o[a]&&o[a].m(r,i);B(r,e,i),t=!0},p(r,i){if(i&10){n=wt(r[1]);let a;for(a=0;a<n.length;a+=1){const c=gi(r,n,a);o[a]?(o[a].p(c,i),C(o[a],1)):(o[a]=_i(c),o[a].c(),C(o[a],1),o[a].m(e.parentNode,e))}for(Ae(),a=n.length;a<o.length;a+=1)s(a);Le()}},i(r){if(!t){for(let i=0;i<n.length;i+=1)C(o[i]);t=!0}},o(r){o=o.filter(Boolean);for(let i=0;i<o.length;i+=1)P(o[i]);t=!1},d(r){r&&p(e),Cn(o,r)}}}function Kg(l){let e,t,n;return t=new Vo({props:{class:"w-full max-w-[180px] rounded-lg px-1 py-1.5 border border-gray-300/30 dark:border-gray-700/50 z-[9999] bg-white dark:bg-gray-900 dark:text-white shadow-sm",sideOffset:6,side:"top",align:"start",transition:Gl,$$slots:{default:[Xg]},$$scope:{ctx:l}}}),{c(){e=V("div"),te(t.$$.fragment),this.h()},l(o){e=N(o,"DIV",{slot:!0});var s=S(e);oe(t.$$.fragment,s),s.forEach(p),this.h()},h(){m(e,"slot","content")},m(o,s){B(o,e,s),ne(t,e,null),n=!0},p(o,s){const r={};s&258&&(r.$$scope={dirty:s,ctx:o}),t.$set(r)},i(o){n||(C(t.$$.fragment,o),n=!0)},o(o){P(t.$$.fragment,o),n=!1},d(o){o&&p(e),le(t)}}}function qg(l){let e,t,n;function o(r){l[6](r)}let s={$$slots:{content:[Kg],default:[Yg]},$$scope:{ctx:l}};return l[2]!==void 0&&(s.show=l[2]),e=new To({props:s}),We.push(()=>$e(e,"show",o)),e.$on("change",l[7]),{c(){te(e.$$.fragment)},l(r){oe(e.$$.fragment,r)},m(r,i){ne(e,r,i),n=!0},p(r,[i]){const a={};i&258&&(a.$$scope={dirty:i,ctx:r}),!t&&i&4&&(t=!0,a.show=r[2],xe(()=>t=!1)),e.$set(a)},i(r){n||(C(e.$$.fragment,r),n=!0)},o(r){P(e.$$.fragment,r),n=!1},d(r){le(e,r)}}}function Gg(l,e,t){let{$$slots:n={},$$scope:o}=e;Ut("i18n");const s=on();let{onClose:r=()=>{}}=e,{devices:i}=e,a=!1;const c=h=>{s("change",h.deviceId)};function u(h){a=h,t(2,a)}const f=h=>{h.detail===!1&&r()};return l.$$set=h=>{"onClose"in h&&t(0,r=h.onClose),"devices"in h&&t(1,i=h.devices),"$$scope"in h&&t(8,o=h.$$scope)},[r,i,a,s,n,c,u,f,o]}class Jg extends Ve{constructor(e){super(),Ne(this,e,Gg,qg,Be,{onClose:0,devices:1})}}function pi(l){let e,t,n,o,s,r,i,a,c,u,f,h,d,_,b,v='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="size-5"><path d="M6.28 5.22a.75.75 0 0 0-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 1 0 1.06 1.06L10 11.06l3.72 3.72a.75.75 0 1 0 1.06-1.06L11.06 10l3.72-3.72a.75.75 0 0 0-1.06-1.06L10 8.94 6.28 5.22Z"></path></svg>',g,w,y,E=l[4]&&bi(l);function z(M,K){return M[4]?e0:t0}let T=z(l),I=T(l);const H=[r0,s0],O=[];function A(M,K){return M[4]?0:1}i=A(l),a=O[i]=H[i](l);function F(M,K){return M[1]?f0:M[2]?u0:c0}let j=F(l),Y=j(l);return{c(){e=V("div"),E&&E.c(),t=$(),n=V("div"),I.c(),o=$(),s=V("div"),r=V("div"),a.c(),c=$(),u=V("div"),f=V("button"),h=V("div"),Y.c(),d=$(),_=V("div"),b=V("button"),b.innerHTML=v,this.h()},l(M){e=N(M,"DIV",{class:!0});var K=S(e);E&&E.l(K),t=ee(K),n=N(K,"DIV",{class:!0});var D=S(n);I.l(D),D.forEach(p),o=ee(K),s=N(K,"DIV",{class:!0});var W=S(s);r=N(W,"DIV",{});var L=S(r);a.l(L),L.forEach(p),c=ee(W),u=N(W,"DIV",{});var R=S(u);f=N(R,"BUTTON",{type:!0});var X=S(f);h=N(X,"DIV",{class:!0});var Q=S(h);Y.l(Q),Q.forEach(p),X.forEach(p),R.forEach(p),d=ee(W),_=N(W,"DIV",{});var G=S(_);b=N(G,"BUTTON",{class:!0,type:!0,"data-svelte-h":!0}),gt(b)!=="svelte-1k5eavb"&&(b.innerHTML=v),G.forEach(p),W.forEach(p),K.forEach(p),this.h()},h(){m(n,"class","flex justify-center items-center flex-1 h-full w-full max-h-full"),m(h,"class","line-clamp-1 text-sm font-medium"),m(f,"type","button"),m(b,"class","p-3 rounded-full bg-gray-50 dark:bg-gray-900"),m(b,"type","button"),m(s,"class","flex justify-between items-center pb-2 w-full"),m(e,"class","max-w-lg w-full h-full max-h-[100dvh] flex flex-col justify-between p-3 md:p-6")},m(M,K){B(M,e,K),E&&E.m(e,null),k(e,t),k(e,n),I.m(n,null),k(e,o),k(e,s),k(s,r),O[i].m(r,null),k(s,c),k(s,u),k(u,f),k(f,h),Y.m(h,null),k(s,d),k(s,_),k(_,b),g=!0,w||(y=[ke(f,"click",l[31]),ke(b,"click",l[32])],w=!0)},p(M,K){M[4]?E?E.p(M,K):(E=bi(M),E.c(),E.m(e,t)):E&&(E.d(1),E=null),T===(T=z(M))&&I?I.p(M,K):(I.d(1),I=T(M),I&&(I.c(),I.m(n,null)));let D=i;i=A(M),i===D?O[i].p(M,K):(Ae(),P(O[D],1,1,()=>{O[D]=null}),Le(),a=O[i],a?a.p(M,K):(a=O[i]=H[i](M),a.c()),C(a,1),a.m(r,null)),j===(j=F(M))&&Y?Y.p(M,K):(Y.d(1),Y=j(M),Y&&(Y.c(),Y.m(h,null)))},i(M){g||(C(a),g=!0)},o(M){P(a),g=!1},d(M){M&&p(e),E&&E.d(),I.d(),O[i].d(),Y.d(),w=!1,ln(y)}}}function bi(l){let e,t,n;function o(i,a){return i[3]?$g:i[1]||i[2]?xg:Qg}let s=o(l),r=s(l);return{c(){e=V("button"),r.c(),this.h()},l(i){e=N(i,"BUTTON",{type:!0,class:!0});var a=S(e);r.l(a),a.forEach(p),this.h()},h(){m(e,"type","button"),m(e,"class","flex justify-center items-center w-full h-20 min-h-20")},m(i,a){B(i,e,a),r.m(e,null),t||(n=ke(e,"click",l[26]),t=!0)},p(i,a){s===(s=o(i))&&r?r.p(i,a):(r.d(1),r=s(i),r&&(r.c(),r.m(e,null)))},d(i){i&&p(e),r.d(),t=!1,n()}}}function Qg(l){let e,t,n;return{c(){e=V("div"),this.h()},l(o){e=N(o,"DIV",{class:!0,style:!0}),S(e).forEach(p),this.h()},h(){var o,s,r,i,a,c,u,f,h;m(e,"class",t=(l[6]*100>4?" size-[4.5rem]":l[6]*100>2?" size-16":l[6]*100>1?"size-14":"size-12")+" transition-all rounded-full "+((((r=(s=(o=l[0])==null?void 0:o.info)==null?void 0:s.meta)==null?void 0:r.profile_image_url)??"/static/favicon.png")!=="/static/favicon.png"?" bg-cover bg-center bg-no-repeat":"bg-black dark:bg-white")+" bg-black dark:bg-white"),m(e,"style",n=(((c=(a=(i=l[0])==null?void 0:i.info)==null?void 0:a.meta)==null?void 0:c.profile_image_url)??"/static/favicon.png")!=="/static/favicon.png"?`background-image: url('${(h=(f=(u=l[0])==null?void 0:u.info)==null?void 0:f.meta)==null?void 0:h.profile_image_url}');`:"")},m(o,s){B(o,e,s)},p(o,s){var r,i,a,c,u,f,h,d,_;s[0]&65&&t!==(t=(o[6]*100>4?" size-[4.5rem]":o[6]*100>2?" size-16":o[6]*100>1?"size-14":"size-12")+" transition-all rounded-full "+((((a=(i=(r=o[0])==null?void 0:r.info)==null?void 0:i.meta)==null?void 0:a.profile_image_url)??"/static/favicon.png")!=="/static/favicon.png"?" bg-cover bg-center bg-no-repeat":"bg-black dark:bg-white")+" bg-black dark:bg-white")&&m(e,"class",t),s[0]&1&&n!==(n=(((f=(u=(c=o[0])==null?void 0:c.info)==null?void 0:u.meta)==null?void 0:f.profile_image_url)??"/static/favicon.png")!=="/static/favicon.png"?`background-image: url('${(_=(d=(h=o[0])==null?void 0:h.info)==null?void 0:d.meta)==null?void 0:_.profile_image_url}');`:"")&&m(e,"style",n)},d(o){o&&p(e)}}}function xg(l){let e,t,n,o,s,r;return{c(){e=ze("svg"),t=ze("style"),n=Ce(`.spinner_qM83 {
								animation: spinner_8HQG 1.05s infinite;
							}
							.spinner_oXPr {
								animation-delay: 0.1s;
							}
							.spinner_ZTLf {
								animation-delay: 0.2s;
							}
							@keyframes spinner_8HQG {
								0%,
								57.14% {
									animation-timing-function: cubic-bezier(0.33, 0.66, 0.66, 1);
									transform: translate(0);
								}
								28.57% {
									animation-timing-function: cubic-bezier(0.33, 0, 0.66, 0.33);
									transform: translateY(-6px);
								}
								100% {
									transform: translate(0);
								}
							}
						`),o=ze("circle"),s=ze("circle"),r=ze("circle"),this.h()},l(i){e=Pe(i,"svg",{class:!0,viewBox:!0,fill:!0,xmlns:!0});var a=S(e);t=Pe(a,"style",{});var c=S(t);n=Me(c,`.spinner_qM83 {
								animation: spinner_8HQG 1.05s infinite;
							}
							.spinner_oXPr {
								animation-delay: 0.1s;
							}
							.spinner_ZTLf {
								animation-delay: 0.2s;
							}
							@keyframes spinner_8HQG {
								0%,
								57.14% {
									animation-timing-function: cubic-bezier(0.33, 0.66, 0.66, 1);
									transform: translate(0);
								}
								28.57% {
									animation-timing-function: cubic-bezier(0.33, 0, 0.66, 0.33);
									transform: translateY(-6px);
								}
								100% {
									transform: translate(0);
								}
							}
						`),c.forEach(p),o=Pe(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),S(o).forEach(p),s=Pe(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),S(s).forEach(p),r=Pe(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),S(r).forEach(p),a.forEach(p),this.h()},h(){m(o,"class","spinner_qM83"),m(o,"cx","4"),m(o,"cy","12"),m(o,"r","3"),m(s,"class","spinner_qM83 spinner_oXPr"),m(s,"cx","12"),m(s,"cy","12"),m(s,"r","3"),m(r,"class","spinner_qM83 spinner_ZTLf"),m(r,"cx","20"),m(r,"cy","12"),m(r,"r","3"),m(e,"class","size-12 text-gray-900 dark:text-gray-400"),m(e,"viewBox","0 0 24 24"),m(e,"fill","currentColor"),m(e,"xmlns","http://www.w3.org/2000/svg")},m(i,a){B(i,e,a),k(e,t),k(t,n),k(e,o),k(e,s),k(e,r)},p:we,d(i){i&&p(e)}}}function $g(l){let e,t;return{c(){e=V("div"),t=Ce(l[3]),this.h()},l(n){e=N(n,"DIV",{class:!0,style:!0});var o=S(e);t=Me(o,l[3]),o.forEach(p),this.h()},h(){m(e,"class","transition-all rounded-full"),tt(e,"font-size",(l[6]*100>4?"4.5":l[6]*100>2?"4.25":l[6]*100>1?"3.75":"3.5")+"rem"),tt(e,"width","100%"),tt(e,"text-align","center")},m(n,o){B(n,e,o),k(e,t)},p(n,o){o[0]&8&&He(t,n[3]),o[0]&64&&tt(e,"font-size",(n[6]*100>4?"4.5":n[6]*100>2?"4.25":n[6]*100>1?"3.75":"3.5")+"rem")},d(n){n&&p(e)}}}function e0(l){let e,t,n,o,s,r,i,a='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-6"><path d="M5.28 4.22a.75.75 0 0 0-1.06 1.06L6.94 8l-2.72 2.72a.75.75 0 1 0 1.06 1.06L8 9.06l2.72 2.72a.75.75 0 1 0 1.06-1.06L9.06 8l2.72-2.72a.75.75 0 0 0-1.06-1.06L8 6.94 5.28 4.22Z"></path></svg>',c,u;return{c(){e=V("div"),t=V("video"),n=$(),o=V("canvas"),s=$(),r=V("div"),i=V("button"),i.innerHTML=a,this.h()},l(f){e=N(f,"DIV",{class:!0});var h=S(e);t=N(h,"VIDEO",{id:!0,class:!0}),S(t).forEach(p),n=ee(h),o=N(h,"CANVAS",{id:!0,style:!0}),S(o).forEach(p),s=ee(h),r=N(h,"DIV",{class:!0});var d=S(r);i=N(d,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),gt(i)!=="svelte-16ul42n"&&(i.innerHTML=a),d.forEach(p),h.forEach(p),this.h()},h(){m(t,"id","camera-feed"),t.autoplay=!0,m(t,"class","rounded-2xl h-full min-w-full object-cover object-center"),t.playsInline=!0,m(o,"id","camera-canvas"),tt(o,"display","none"),m(i,"type","button"),m(i,"class","p-1.5 text-white cursor-pointer backdrop-blur-xl bg-black/10 rounded-full"),m(r,"class","absolute top-4 md:top-8 left-4"),m(e,"class","relative flex video-container w-full max-h-full pt-2 pb-4 md:py-6 px-2 h-full")},m(f,h){B(f,e,h),k(e,t),k(e,n),k(e,o),k(e,s),k(e,r),k(r,i),c||(u=ke(i,"click",l[28]),c=!0)},p:we,d(f){f&&p(e),c=!1,u()}}}function t0(l){let e,t,n;function o(i,a){return i[3]?o0:i[1]||i[2]?l0:n0}let s=o(l),r=s(l);return{c(){e=V("button"),r.c(),this.h()},l(i){e=N(i,"BUTTON",{type:!0});var a=S(e);r.l(a),a.forEach(p),this.h()},h(){m(e,"type","button")},m(i,a){B(i,e,a),r.m(e,null),t||(n=ke(e,"click",l[27]),t=!0)},p(i,a){s===(s=o(i))&&r?r.p(i,a):(r.d(1),r=s(i),r&&(r.c(),r.m(e,null)))},d(i){i&&p(e),r.d(),t=!1,n()}}}function n0(l){let e,t,n;return{c(){e=V("div"),this.h()},l(o){e=N(o,"DIV",{class:!0,style:!0}),S(e).forEach(p),this.h()},h(){var o,s,r,i,a,c,u,f,h;m(e,"class",t=(l[6]*100>4?" size-52":l[6]*100>2?"size-48":l[6]*100>1?"size-44":"size-40")+" transition-all rounded-full "+((((r=(s=(o=l[0])==null?void 0:o.info)==null?void 0:s.meta)==null?void 0:r.profile_image_url)??"/static/favicon.png")!=="/static/favicon.png"?" bg-cover bg-center bg-no-repeat":"bg-black dark:bg-white")),m(e,"style",n=(((c=(a=(i=l[0])==null?void 0:i.info)==null?void 0:a.meta)==null?void 0:c.profile_image_url)??"/static/favicon.png")!=="/static/favicon.png"?`background-image: url('${(h=(f=(u=l[0])==null?void 0:u.info)==null?void 0:f.meta)==null?void 0:h.profile_image_url}');`:"")},m(o,s){B(o,e,s)},p(o,s){var r,i,a,c,u,f,h,d,_;s[0]&65&&t!==(t=(o[6]*100>4?" size-52":o[6]*100>2?"size-48":o[6]*100>1?"size-44":"size-40")+" transition-all rounded-full "+((((a=(i=(r=o[0])==null?void 0:r.info)==null?void 0:i.meta)==null?void 0:a.profile_image_url)??"/static/favicon.png")!=="/static/favicon.png"?" bg-cover bg-center bg-no-repeat":"bg-black dark:bg-white"))&&m(e,"class",t),s[0]&1&&n!==(n=(((f=(u=(c=o[0])==null?void 0:c.info)==null?void 0:u.meta)==null?void 0:f.profile_image_url)??"/static/favicon.png")!=="/static/favicon.png"?`background-image: url('${(_=(d=(h=o[0])==null?void 0:h.info)==null?void 0:d.meta)==null?void 0:_.profile_image_url}');`:"")&&m(e,"style",n)},d(o){o&&p(e)}}}function l0(l){let e,t,n,o,s,r;return{c(){e=ze("svg"),t=ze("style"),n=Ce(`.spinner_qM83 {
									animation: spinner_8HQG 1.05s infinite;
								}
								.spinner_oXPr {
									animation-delay: 0.1s;
								}
								.spinner_ZTLf {
									animation-delay: 0.2s;
								}
								@keyframes spinner_8HQG {
									0%,
									57.14% {
										animation-timing-function: cubic-bezier(0.33, 0.66, 0.66, 1);
										transform: translate(0);
									}
									28.57% {
										animation-timing-function: cubic-bezier(0.33, 0, 0.66, 0.33);
										transform: translateY(-6px);
									}
									100% {
										transform: translate(0);
									}
								}
							`),o=ze("circle"),s=ze("circle"),r=ze("circle"),this.h()},l(i){e=Pe(i,"svg",{class:!0,viewBox:!0,fill:!0,xmlns:!0});var a=S(e);t=Pe(a,"style",{});var c=S(t);n=Me(c,`.spinner_qM83 {
									animation: spinner_8HQG 1.05s infinite;
								}
								.spinner_oXPr {
									animation-delay: 0.1s;
								}
								.spinner_ZTLf {
									animation-delay: 0.2s;
								}
								@keyframes spinner_8HQG {
									0%,
									57.14% {
										animation-timing-function: cubic-bezier(0.33, 0.66, 0.66, 1);
										transform: translate(0);
									}
									28.57% {
										animation-timing-function: cubic-bezier(0.33, 0, 0.66, 0.33);
										transform: translateY(-6px);
									}
									100% {
										transform: translate(0);
									}
								}
							`),c.forEach(p),o=Pe(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),S(o).forEach(p),s=Pe(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),S(s).forEach(p),r=Pe(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),S(r).forEach(p),a.forEach(p),this.h()},h(){m(o,"class","spinner_qM83"),m(o,"cx","4"),m(o,"cy","12"),m(o,"r","3"),m(s,"class","spinner_qM83 spinner_oXPr"),m(s,"cx","12"),m(s,"cy","12"),m(s,"r","3"),m(r,"class","spinner_qM83 spinner_ZTLf"),m(r,"cx","20"),m(r,"cy","12"),m(r,"r","3"),m(e,"class","size-44 text-gray-900 dark:text-gray-400"),m(e,"viewBox","0 0 24 24"),m(e,"fill","currentColor"),m(e,"xmlns","http://www.w3.org/2000/svg")},m(i,a){B(i,e,a),k(e,t),k(t,n),k(e,o),k(e,s),k(e,r)},p:we,d(i){i&&p(e)}}}function o0(l){let e,t;return{c(){e=V("div"),t=Ce(l[3]),this.h()},l(n){e=N(n,"DIV",{class:!0,style:!0});var o=S(e);t=Me(o,l[3]),o.forEach(p),this.h()},h(){m(e,"class","transition-all rounded-full"),tt(e,"font-size",(l[6]*100>4?"13":l[6]*100>2?"12":l[6]*100>1?"11.5":"11")+"rem"),tt(e,"width","100%"),tt(e,"text-align","center")},m(n,o){B(n,e,o),k(e,t)},p(n,o){o[0]&8&&He(t,n[3]),o[0]&64&&tt(e,"font-size",(n[6]*100>4?"13":n[6]*100>2?"12":n[6]*100>1?"11.5":"11")+"rem")},d(n){n&&p(e)}}}function s0(l){let e,t;return e=new Gt({props:{content:l[11].t("Camera"),$$slots:{default:[i0]},$$scope:{ctx:l}}}),{c(){te(e.$$.fragment)},l(n){oe(e.$$.fragment,n)},m(n,o){ne(e,n,o),t=!0},p(n,o){const s={};o[0]&2048&&(s.content=n[11].t("Camera")),o[2]&8&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){le(e,n)}}}function r0(l){let e,t;return e=new Jg({props:{devices:l[8],$$slots:{default:[a0]},$$scope:{ctx:l}}}),e.$on("change",l[29]),{c(){te(e.$$.fragment)},l(n){oe(e.$$.fragment,n)},m(n,o){ne(e,n,o),t=!0},p(n,o){const s={};o[0]&256&&(s.devices=n[8]),o[2]&8&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){le(e,n)}}}function i0(l){let e,t='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5"><path stroke-linecap="round" stroke-linejoin="round" d="M6.827 6.175A2.31 2.31 0 0 1 5.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 0 0-1.134-.175 2.31 2.31 0 0 1-1.64-1.055l-.822-1.316a2.192 2.192 0 0 0-1.736-1.039 48.774 48.774 0 0 0-5.232 0 2.192 2.192 0 0 0-1.736 1.039l-.821 1.316Z"></path><path stroke-linecap="round" stroke-linejoin="round" d="M16.5 12.75a4.5 4.5 0 1 1-9 0 4.5 4.5 0 0 1 9 0ZM18.75 10.5h.008v.008h-.008V10.5Z"></path></svg>',n,o;return{c(){e=V("button"),e.innerHTML=t,this.h()},l(s){e=N(s,"BUTTON",{class:!0,type:!0,"data-svelte-h":!0}),gt(e)!=="svelte-1n1gs9g"&&(e.innerHTML=t),this.h()},h(){m(e,"class","p-3 rounded-full bg-gray-50 dark:bg-gray-900"),m(e,"type","button")},m(s,r){B(s,e,r),n||(o=ke(e,"click",l[30]),n=!0)},p:we,d(s){s&&p(e),n=!1,o()}}}function a0(l){let e,t='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="size-5"><path fill-rule="evenodd" d="M15.312 11.424a5.5 5.5 0 0 1-9.201 2.466l-.312-.311h2.433a.75.75 0 0 0 0-1.5H3.989a.75.75 0 0 0-.75.75v4.242a.75.75 0 0 0 1.5 0v-2.43l.31.31a7 7 0 0 0 11.712-3.138.75.75 0 0 0-1.449-.39Zm1.23-3.723a.75.75 0 0 0 .219-.53V2.929a.75.75 0 0 0-1.5 0V5.36l-.31-.31A7 7 0 0 0 3.239 8.188a.75.75 0 1 0 1.448.389A5.5 5.5 0 0 1 13.89 6.11l.311.31h-2.432a.75.75 0 0 0 0 1.5h4.243a.75.75 0 0 0 .53-.219Z" clip-rule="evenodd"></path></svg>';return{c(){e=V("button"),e.innerHTML=t,this.h()},l(n){e=N(n,"BUTTON",{class:!0,type:!0,"data-svelte-h":!0}),gt(e)!=="svelte-5e0pue"&&(e.innerHTML=t),this.h()},h(){m(e,"class","p-3 rounded-full bg-gray-50 dark:bg-gray-900"),m(e,"type","button")},m(n,o){B(n,e,o)},p:we,d(n){n&&p(e)}}}function c0(l){let e=l[11].t("Listening...")+"",t;return{c(){t=Ce(e)},l(n){t=Me(n,e)},m(n,o){B(n,t,o)},p(n,o){o[0]&2048&&e!==(e=n[11].t("Listening...")+"")&&He(t,e)},d(n){n&&p(t)}}}function u0(l){let e=l[11].t("Tap to interrupt")+"",t;return{c(){t=Ce(e)},l(n){t=Me(n,e)},m(n,o){B(n,t,o)},p(n,o){o[0]&2048&&e!==(e=n[11].t("Tap to interrupt")+"")&&He(t,e)},d(n){n&&p(t)}}}function f0(l){let e=l[11].t("Thinking...")+"",t;return{c(){t=Ce(e)},l(n){t=Me(n,e)},m(n,o){B(n,t,o)},p(n,o){o[0]&2048&&e!==(e=n[11].t("Thinking...")+"")&&He(t,e)},d(n){n&&p(t)}}}function d0(l){let e,t,n=l[10]&&pi(l);return{c(){n&&n.c(),e=Oe()},l(o){n&&n.l(o),e=Oe()},m(o,s){n&&n.m(o,s),B(o,e,s),t=!0},p(o,s){o[10]?n?(n.p(o,s),s[0]&1024&&C(n,1)):(n=pi(o),n.c(),C(n,1),n.m(e.parentNode,e)):n&&(Ae(),P(n,1,1,()=>{n=null}),Le())},i(o){t||(C(n),t=!0)},o(o){P(n),t=!1},d(o){o&&p(e),n&&n.d(o)}}}function h0(l,e,t){let n,o,s,r,i;ie(l,yl,ue=>t(45,n=ue)),ie(l,ql,ue=>t(46,o=ue)),ie(l,Gn,ue=>t(47,s=ue)),ie(l,vn,ue=>t(10,r=ue));const a=on(),c=Ut("i18n");ie(l,c,ue=>t(11,i=ue));let{eventTarget:u}=e,{submitPrompt:f}=e,{stopResponse:h}=e,{files:d}=e,{chatId:_}=e,{modelId:b}=e,v=null,g=null,w=!1,y=!1,E=!1,z=null,T=!1,I=null,H=!1,O=0,A=!1,F,j=null,Y=[],M=[],K=null;const D=async()=>{const ue=await navigator.mediaDevices.enumerateDevices();t(8,M=ue.filter(Re=>Re.kind==="videoinput")),navigator.mediaDevices.getDisplayMedia&&t(8,M=[...M,{deviceId:"screen",label:"Screen Share"}]),console.log(M),K===null&&M.length>0&&t(9,K=M[0].deviceId)},W=async()=>{if(await D(),I===null){t(4,T=!0),await qe();try{await L()}catch(ue){console.error("Error accessing webcam: ",ue)}}},L=async()=>{const ue=document.getElementById("camera-feed");ue&&(K==="screen"?t(5,I=await navigator.mediaDevices.getDisplayMedia({video:{cursor:"always"},audio:!1})):t(5,I=await navigator.mediaDevices.getUserMedia({video:{deviceId:K?{exact:K}:void 0}})),I&&(await D(),ue.srcObject=I,await ue.play()))},R=async()=>{I&&I.getTracks().forEach(Re=>Re.stop()),t(5,I=null)},X=()=>{const ue=document.getElementById("camera-feed"),Re=document.getElementById("camera-canvas");if(!Re)return;const je=Re.getContext("2d");Re.width=ue.videoWidth,Re.height=ue.videoHeight,je.drawImage(ue,0,0,ue.videoWidth,ue.videoHeight);const Ge=Re.toDataURL("image/png");return console.log(Ge),Ge},Q=async()=>{await R(),t(4,T=!1)},G=-55,ce=async ue=>{await qe();const Re=Xi(ue,"recording.wav"),je=await Ki(localStorage.token,Re).catch(Ge=>(nt.error(Ge),null));if(je&&(console.log(je.text),je.text!=="")){const Ge=await f(je.text,{_raw:!0});console.log(Ge)}},se=async(ue=!0)=>{if(r){console.log("%c%s","color: red; font-size: 20px;","ðŸš¨ stopRecordingCallback ðŸš¨");const Re=Y.slice(0);if(Y=[],F=!1,ue&&ye(),y){if(t(1,w=!0),t(3,z=null),I){const Ge=X();t(20,d=[{type:"image",url:Ge}])}const je=new Blob(Re,{type:"audio/wav"});await ce(je),y=!1,t(1,w=!1)}}else Y=[],F=!1,j&&j.getTracks().forEach(je=>je.stop()),t(7,j=null)},ye=async()=>{r&&(j||t(7,j=await navigator.mediaDevices.getUserMedia({audio:!0})),F=new MediaRecorder(j),F.onstart=()=>{console.log("Recording started"),Y=[],q(j)},F.ondataavailable=ue=>{A&&Y.push(ue.data)},F.onstop=ue=>{console.log("Recording stopped",j,ue),se()},F.start())},Se=async()=>{try{F&&F.stop()}catch(ue){console.log("Error stopping audio stream:",ue)}j&&(j.getAudioTracks().forEach(function(ue){ue.stop()}),t(7,j=null))},re=ue=>{let Re=0;for(let je=0;je<ue.length;je++){const Ge=(ue[je]-128)/128;Re+=Ge*Ge}return Math.sqrt(Re/ue.length)},q=ue=>{const Re=new AudioContext,je=Re.createMediaStreamSource(ue),Ge=Re.createAnalyser();Ge.minDecibels=G,je.connect(Ge);const kt=Ge.frequencyBinCount,Dt=new Uint8Array(kt),Ct=new Uint8Array(Ge.fftSize);let Nt=Date.now();A=!1,console.log("ðŸ”Š Sound detection started",Nt,A),(()=>{const zt=()=>{if(!F||!r)return;if(E&&!((s==null?void 0:s.voiceInterruption)??!1)?(Ge.maxDecibels=0,Ge.minDecibels=-1):(Ge.minDecibels=G,Ge.maxDecibels=-30),Ge.getByteTimeDomainData(Ct),Ge.getByteFrequencyData(Dt),t(6,O=re(Ct)),Dt.some(Xt=>Xt>0)&&(console.log("%c%s","color: red; font-size: 20px;","ðŸ”Š Sound detected"),A||(A=!0,me()),Nt=Date.now()),A&&Date.now()-Nt>2e3&&(y=!0,F)){console.log("%c%s","color: red; font-size: 20px;","ðŸ”‡ Silence detected"),F.stop();return}window.requestAnimationFrame(zt)};window.requestAnimationFrame(zt)})()};let Ee={},ae=null,Ie=null;const ge=ue=>r?new Promise(Re=>{let je=[];const Ge=setInterval(async()=>{var kt,Dt,Ct;if(je=await speechSynthesis.getVoices(),je.length>0){clearInterval(Ge);const Nt=((kt=je==null?void 0:je.filter(Ht=>{var zt,Jt,Xt,Z;return Ht.voiceURI===(((Jt=(zt=s==null?void 0:s.audio)==null?void 0:zt.tts)==null?void 0:Jt.voice)??((Z=(Xt=o==null?void 0:o.audio)==null?void 0:Xt.tts)==null?void 0:Z.voice))}))==null?void 0:kt.at(0))??void 0;Ie=new SpeechSynthesisUtterance(ue),Ie.rate=((Ct=(Dt=s.audio)==null?void 0:Dt.tts)==null?void 0:Ct.playbackRate)??1,Nt&&(Ie.voice=Nt),speechSynthesis.speak(Ie),Ie.onend=async Ht=>{await new Promise(zt=>setTimeout(zt,200)),Re(Ht)}}},100)}):Promise.resolve(),_t=ue=>r?new Promise(Re=>{var Ge,kt;const je=document.getElementById("audioElement");je&&(je.src=ue.src,je.muted=!0,je.playbackRate=((kt=(Ge=s.audio)==null?void 0:Ge.tts)==null?void 0:kt.playbackRate)??1,je.play().then(()=>{je.muted=!1}).catch(Dt=>{console.error(Dt)}),je.onended=async Dt=>{await new Promise(Ct=>setTimeout(Ct,100)),Re(Dt)})}):Promise.resolve(),me=async()=>{t(2,E=!1),H&&h(),Ie&&(speechSynthesis.cancel(),Ie=null);const ue=document.getElementById("audioElement");ue&&(ue.muted=!0,ue.pause(),ue.currentTime=0)};let ct=new AbortController;const ut=new Map,Wt=new Map,ve=async ue=>{var Re,je,Ge,kt,Dt,Ct,Nt,Ht;if(!ut.has(ue))try{if((s==null?void 0:s.showEmojiInCall)??!1){const zt=await Hc(localStorage.token,b,ue,_);zt&&Wt.set(ue,zt)}if(o.audio.tts.engine!==""){const zt=await jc(localStorage.token,((je=(Re=s==null?void 0:s.audio)==null?void 0:Re.tts)==null?void 0:je.defaultVoice)===o.audio.tts.voice?((kt=(Ge=s==null?void 0:s.audio)==null?void 0:Ge.tts)==null?void 0:kt.voice)??((Ct=(Dt=o==null?void 0:o.audio)==null?void 0:Dt.tts)==null?void 0:Ct.voice):(Ht=(Nt=o==null?void 0:o.audio)==null?void 0:Nt.tts)==null?void 0:Ht.voice,ue).catch(Jt=>(console.error(Jt),null));if(zt){const Jt=await zt.blob(),Xt=URL.createObjectURL(Jt);ut.set(ue,new Audio(Xt))}}else ut.set(ue,!0)}catch(zt){console.error("Error synthesizing speech:",zt)}return ut.get(ue)};let Ue={};const st=async(ue,Re)=>{for(;!Re.aborted;)if(Ue[ue]&&Ue[ue].length>0){const je=Ue[ue].shift();if(ut.has(je))if(((s==null?void 0:s.showEmojiInCall)??!1)&&Wt.has(je)?t(3,z=Wt.get(je)):t(3,z=null),o.audio.tts.engine!=="")try{console.log("%c%s","color: red; font-size: 20px;",`Playing audio for content: ${je}`);const Ge=ut.get(je);await _t(Ge),console.log(`Played audio for content: ${je}`),await new Promise(kt=>setTimeout(kt,200))}catch(Ge){console.error("Error playing audio:",Ge)}else await ge(je);else Ue[ue].unshift(je),console.log(`Audio for "${je}" not yet available in the cache, re-queued...`),await new Promise(Ge=>setTimeout(Ge,200))}else if(Ee[ue]&&Ue[ue]&&Ue[ue].length===0){t(2,E=!1);break}else await new Promise(je=>setTimeout(je,200));console.log(`Audio monitoring and playing stopped for message ID ${ue}`)},yt=async ue=>{const{id:Re}=ue.detail;H=!0,ae!==Re&&(console.log(`Received chat start event for message ID ${Re}`),ae=Re,ct&&ct.abort(),ct=new AbortController,t(2,E=!0),st(Re,ct.signal))},ft=async ue=>{const{id:Re,content:je}=ue.detail;if(ae===Re){console.log(`Received chat event for message ID ${Re}: ${je}`);try{Ue[Re]===void 0?Ue[Re]=[je]:Ue[Re].push(je),console.log(je),ve(je)}catch(Ge){console.error("Failed to fetch or play audio:",Ge)}}},rt=async ue=>{const{id:Re,content:je}=ue.detail;Ee[Re]=!0,H=!1};hn(async()=>{const ue=async()=>{try{v=await navigator.wakeLock.request("screen")}catch(Re){console.log(Re)}v&&v.addEventListener("release",()=>{console.log("Wake Lock released")})};return"wakeLock"in navigator&&(await ue(),document.addEventListener("visibilitychange",async()=>{v!==null&&document.visibilityState==="visible"&&await ue()})),t(0,g=n.find(Re=>Re.id===b)),ye(),u.addEventListener("chat:start",yt),u.addEventListener("chat",ft),u.addEventListener("chat:finish",rt),async()=>{await me(),Se(),u.removeEventListener("chat:start",yt),u.removeEventListener("chat",ft),u.removeEventListener("chat:finish",rt),ct.abort(),await qe(),await me(),await se(!1),await Q()}}),il(async()=>{await me(),await se(!1),await Q(),await Se(),u.removeEventListener("chat:start",yt),u.removeEventListener("chat",ft),u.removeEventListener("chat:finish",rt),ct.abort(),await qe(),await me()});const At=()=>{E&&me()},_e=()=>{E&&me()},St=()=>{Q()},pt=async ue=>{console.log(ue.detail),t(9,K=ue.detail),await R(),await L()},ht=async()=>{await navigator.mediaDevices.getUserMedia({video:!0}),W()},be=()=>{E&&me()},Vt=async()=>{await Se(),await R(),console.log(j),console.log(I),vn.set(!1),a("close")};return l.$$set=ue=>{"eventTarget"in ue&&t(21,u=ue.eventTarget),"submitPrompt"in ue&&t(22,f=ue.submitPrompt),"stopResponse"in ue&&t(23,h=ue.stopResponse),"files"in ue&&t(20,d=ue.files),"chatId"in ue&&t(24,_=ue.chatId),"modelId"in ue&&t(25,b=ue.modelId)},[g,w,E,z,T,I,O,j,M,K,r,i,a,c,W,L,R,Q,Se,me,d,u,f,h,_,b,At,_e,St,pt,ht,be,Vt]}class Ha extends Ve{constructor(e){super(),Ne(this,e,h0,d0,Be,{eventTarget:21,submitPrompt:22,stopResponse:23,files:20,chatId:24,modelId:25},null,[-1,-1,-1])}}function m0(l){var E,z,T,I,H,O,A,F,j,Y;let e,t,n,o,s,r,i=(((z=(E=l[0])==null?void 0:E.model)==null?void 0:z.name)??((I=(T=l[0])==null?void 0:T.message)==null?void 0:I.model)??"Assistant")+"",a,c,u,f,h,d,_,b,v;t=new Wi({props:{src:((F=(A=(O=(H=l[0])==null?void 0:H.model)==null?void 0:O.info)==null?void 0:A.meta)==null?void 0:F.profile_image_url)??"",className:"size-5 -translate-y-[1px]"}}),f=new uu({props:{className:"size-3 "+((Y=(j=l[0])==null?void 0:j.message)!=null&&Y.favorite?"fill-red-500 stroke-red-500":"hover:fill-red-500 hover:stroke-red-500")+" ",strokeWidth:"2.5"}});function g(M,K){var D,W;return(W=(D=M[0])==null?void 0:D.message)!=null&&W.error?p0:_0}let w=g(l),y=w(l);return{c(){e=V("div"),te(t.$$.fragment),n=$(),o=V("div"),s=V("div"),r=V("div"),a=Ce(i),c=$(),u=V("button"),te(f.$$.fragment),d=$(),y.c(),this.h()},l(M){e=N(M,"DIV",{class:!0});var K=S(e);oe(t.$$.fragment,K),n=ee(K),o=N(K,"DIV",{class:!0});var D=S(o);s=N(D,"DIV",{class:!0});var W=S(s);r=N(W,"DIV",{class:!0});var L=S(r);a=Me(L,i),L.forEach(p),c=ee(W),u=N(W,"BUTTON",{class:!0});var R=S(u);oe(f.$$.fragment,R),R.forEach(p),W.forEach(p),d=ee(D),y.l(D),D.forEach(p),K.forEach(p),this.h()},h(){var M,K;m(r,"class","text-xs text-black dark:text-white font-medium line-clamp-1"),m(u,"class",h=(K=(M=l[0])==null?void 0:M.message)!=null&&K.favorite?"":"invisible group-hover:visible"),m(s,"class","flex justify-between items-center"),m(o,"class","ml-2"),m(e,"class","flex w-full")},m(M,K){B(M,e,K),ne(t,e,null),k(e,n),k(e,o),k(o,s),k(s,r),k(r,a),k(s,c),k(s,u),ne(f,u,null),k(o,d),y.m(o,null),_=!0,b||(v=ke(u,"click",l[1]),b=!0)},p(M,K){var L,R,X,Q,G,ce,se,ye,Se,re,q,Ee;const D={};K&1&&(D.src=((Q=(X=(R=(L=M[0])==null?void 0:L.model)==null?void 0:R.info)==null?void 0:X.meta)==null?void 0:Q.profile_image_url)??""),t.$set(D),(!_||K&1)&&i!==(i=(((ce=(G=M[0])==null?void 0:G.model)==null?void 0:ce.name)??((ye=(se=M[0])==null?void 0:se.message)==null?void 0:ye.model)??"Assistant")+"")&&He(a,i);const W={};K&1&&(W.className="size-3 "+((re=(Se=M[0])==null?void 0:Se.message)!=null&&re.favorite?"fill-red-500 stroke-red-500":"hover:fill-red-500 hover:stroke-red-500")+" "),f.$set(W),(!_||K&1&&h!==(h=(Ee=(q=M[0])==null?void 0:q.message)!=null&&Ee.favorite?"":"invisible group-hover:visible"))&&m(u,"class",h),w===(w=g(M))&&y?y.p(M,K):(y.d(1),y=w(M),y&&(y.c(),y.m(o,null)))},i(M){_||(C(t.$$.fragment,M),C(f.$$.fragment,M),_=!0)},o(M){P(t.$$.fragment,M),P(f.$$.fragment,M),_=!1},d(M){M&&p(e),le(t),le(f),y.d(),b=!1,v()}}}function g0(l){var _,b,v;let e,t,n,o,s,r,i=(((b=(_=l[0])==null?void 0:_.user)==null?void 0:b.name)??"User")+"",a,c,u;t=new Wi({props:{src:((v=l[0].user)==null?void 0:v.profile_image_url)??"/user.png",className:"size-5 -translate-y-[1px]"}});function f(g,w){var y,E;return(E=(y=g[0])==null?void 0:y.message)!=null&&E.error?v0:b0}let h=f(l),d=h(l);return{c(){e=V("div"),te(t.$$.fragment),n=$(),o=V("div"),s=V("div"),r=V("div"),a=Ce(i),c=$(),d.c(),this.h()},l(g){e=N(g,"DIV",{class:!0});var w=S(e);oe(t.$$.fragment,w),n=ee(w),o=N(w,"DIV",{class:!0});var y=S(o);s=N(y,"DIV",{class:!0});var E=S(s);r=N(E,"DIV",{class:!0});var z=S(r);a=Me(z,i),z.forEach(p),E.forEach(p),c=ee(y),d.l(y),y.forEach(p),w.forEach(p),this.h()},h(){m(r,"class","text-xs text-black dark:text-white font-medium line-clamp-1"),m(s,"class","flex justify-between items-center"),m(o,"class","ml-2"),m(e,"class","flex w-full")},m(g,w){B(g,e,w),ne(t,e,null),k(e,n),k(e,o),k(o,s),k(s,r),k(r,a),k(o,c),d.m(o,null),u=!0},p(g,w){var E,z,T;const y={};w&1&&(y.src=((E=g[0].user)==null?void 0:E.profile_image_url)??"/user.png"),t.$set(y),(!u||w&1)&&i!==(i=(((T=(z=g[0])==null?void 0:z.user)==null?void 0:T.name)??"User")+"")&&He(a,i),h===(h=f(g))&&d?d.p(g,w):(d.d(1),d=h(g),d&&(d.c(),d.m(o,null)))},i(g){u||(C(t.$$.fragment,g),u=!0)},o(g){P(t.$$.fragment,g),u=!1},d(g){g&&p(e),le(t),d.d()}}}function _0(l){let e,t=l[0].message.content+"",n;return{c(){e=V("div"),n=Ce(t),this.h()},l(o){e=N(o,"DIV",{class:!0});var s=S(e);n=Me(s,t),s.forEach(p),this.h()},h(){m(e,"class","text-gray-500 line-clamp-2 text-xs mt-0.5")},m(o,s){B(o,e,s),k(e,n)},p(o,s){s&1&&t!==(t=o[0].message.content+"")&&He(n,t)},d(o){o&&p(e)}}}function p0(l){let e,t=l[0].message.error.content+"",n;return{c(){e=V("div"),n=Ce(t),this.h()},l(o){e=N(o,"DIV",{class:!0});var s=S(e);n=Me(s,t),s.forEach(p),this.h()},h(){m(e,"class","text-red-500 line-clamp-2 text-xs mt-0.5")},m(o,s){B(o,e,s),k(e,n)},p(o,s){s&1&&t!==(t=o[0].message.error.content+"")&&He(n,t)},d(o){o&&p(e)}}}function b0(l){let e,t=l[0].message.content+"",n;return{c(){e=V("div"),n=Ce(t),this.h()},l(o){e=N(o,"DIV",{class:!0});var s=S(e);n=Me(s,t),s.forEach(p),this.h()},h(){m(e,"class","text-gray-500 line-clamp-2 text-xs mt-0.5")},m(o,s){B(o,e,s),k(e,n)},p(o,s){s&1&&t!==(t=o[0].message.content+"")&&He(n,t)},d(o){o&&p(e)}}}function v0(l){let e,t=l[0].message.error.content+"",n;return{c(){e=V("div"),n=Ce(t),this.h()},l(o){e=N(o,"DIV",{class:!0});var s=S(e);n=Me(s,t),s.forEach(p),this.h()},h(){m(e,"class","text-red-500 line-clamp-2 text-xs mt-0.5")},m(o,s){B(o,e,s),k(e,n)},p(o,s){s&1&&t!==(t=o[0].message.error.content+"")&&He(n,t)},d(o){o&&p(e)}}}function w0(l){let e,t,n,o;const s=[g0,m0],r=[];function i(a,c){return a[0].message.role==="user"?0:1}return e=i(l),t=r[e]=s[e](l),{c(){t.c(),n=Oe()},l(a){t.l(a),n=Oe()},m(a,c){r[e].m(a,c),B(a,n,c),o=!0},p(a,c){let u=e;e=i(a),e===u?r[e].p(a,c):(Ae(),P(r[u],1,1,()=>{r[u]=null}),Le(),t=r[e],t?t.p(a,c):(t=r[e]=s[e](a),t.c()),C(t,1),t.m(n.parentNode,n))},i(a){o||(C(t),o=!0)},o(a){P(t),o=!1},d(a){a&&p(n),r[e].d(a)}}}function y0(l){var a,c;let e,t,n,o,s,r,i;return t=new Gt({props:{content:(c=(a=l[0])==null?void 0:a.message)!=null&&c.error?l[0].message.error.content:l[0].message.content,class:"w-full",allowHTML:!1,$$slots:{default:[w0]},$$scope:{ctx:l}}}),o=new Al({props:{type:"target",position:ot.Top,class:"w-2 rounded-full dark:bg-gray-900"}}),r=new Al({props:{type:"source",position:ot.Bottom,class:"w-2 rounded-full dark:bg-gray-900"}}),{c(){e=V("div"),te(t.$$.fragment),n=$(),te(o.$$.fragment),s=$(),te(r.$$.fragment),this.h()},l(u){e=N(u,"DIV",{class:!0});var f=S(e);oe(t.$$.fragment,f),n=ee(f),oe(o.$$.fragment,f),s=ee(f),oe(r.$$.fragment,f),f.forEach(p),this.h()},h(){m(e,"class","px-4 py-3 shadow-md rounded-xl dark:bg-black bg-white border dark:border-gray-900 w-60 h-20 group")},m(u,f){B(u,e,f),ne(t,e,null),k(e,n),ne(o,e,null),k(e,s),ne(r,e,null),i=!0},p(u,[f]){var d,_;const h={};f&1&&(h.content=(_=(d=u[0])==null?void 0:d.message)!=null&&_.error?u[0].message.error.content:u[0].message.content),f&5&&(h.$$scope={dirty:f,ctx:u}),t.$set(h)},i(u){i||(C(t.$$.fragment,u),C(o.$$.fragment,u),C(r.$$.fragment,u),i=!0)},o(u){P(t.$$.fragment,u),P(o.$$.fragment,u),P(r.$$.fragment,u),i=!1},d(u){u&&p(e),le(t),le(o),le(r)}}}function k0(l,e,t){let{data:n}=e;const o=()=>{var s;t(0,n.message.favorite=!(((s=n==null?void 0:n.message)==null?void 0:s.favorite)??!1),n)};return l.$$set=s=>{"data"in s&&t(0,n=s.data)},[n,o]}class E0 extends Ve{constructor(e){super(),Ne(this,e,k0,y0,Be,{data:0})}}function I0(l){let e,t,n,o;return e=new mg({props:{showLock:!1}}),n=new Dg({props:{variant:xn.Dots}}),{c(){te(e.$$.fragment),t=$(),te(n.$$.fragment)},l(s){oe(e.$$.fragment,s),t=ee(s),oe(n.$$.fragment,s)},m(s,r){ne(e,s,r),B(s,t,r),ne(n,s,r),o=!0},p:we,i(s){o||(C(e.$$.fragment,s),C(n.$$.fragment,s),o=!0)},o(s){P(e.$$.fragment,s),P(n.$$.fragment,s),o=!1},d(s){s&&p(t),le(e,s),le(n,s)}}}function S0(l){let e,t;return e=new U1({props:{nodes:l[0],nodeTypes:l[1],edges:l[2],fitView:!0,minZoom:.001,colorMode:l[3].includes("dark")||l[3]==="system"&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",nodesConnectable:!1,nodesDraggable:!1,oninit:l[5],$$slots:{default:[I0]},$$scope:{ctx:l}}}),e.$on("nodeclick",l[6]),{c(){te(e.$$.fragment)},l(n){oe(e.$$.fragment,n)},m(n,o){ne(e,n,o),t=!0},p(n,[o]){const s={};o&1&&(s.nodes=n[0]),o&2&&(s.nodeTypes=n[1]),o&4&&(s.edges=n[2]),o&8&&(s.colorMode=n[3].includes("dark")||n[3]==="system"&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),o&128&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){le(e,n)}}}function D0(l,e,t){let n;ie(l,ic,u=>t(3,n=u));const o=on();let{nodes:s}=e,{nodeTypes:r}=e,{edges:i}=e;const a=()=>{console.log("Flow initialized")},c=u=>o("nodeclick",u.detail);return l.$$set=u=>{"nodes"in u&&t(0,s=u.nodes),"nodeTypes"in u&&t(1,r=u.nodeTypes),"edges"in u&&t(2,i=u.edges)},[s,r,i,n,o,a,c]}class C0 extends Ve{constructor(e){super(),Ne(this,e,D0,S0,Be,{nodes:0,nodeTypes:1,edges:2})}}function M0(l){let e,t;return{c(){e=ze("svg"),t=ze("path"),this.h()},l(n){e=Pe(n,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var o=S(e);t=Pe(o,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),S(t).forEach(p),o.forEach(p),this.h()},h(){m(t,"stroke-linecap","round"),m(t,"stroke-linejoin","round"),m(t,"d","M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"fill","none"),m(e,"viewBox","0 0 24 24"),m(e,"stroke-width",l[1]),m(e,"stroke","currentColor"),m(e,"class",l[0])},m(n,o){B(n,e,o),k(e,t)},p(n,[o]){o&2&&m(e,"stroke-width",n[1]),o&1&&m(e,"class",n[0])},i:we,o:we,d(n){n&&p(e)}}}function T0(l,e,t){let{className:n="size-4"}=e,{strokeWidth:o="1.5"}=e;return l.$$set=s=>{"className"in s&&t(0,n=s.className),"strokeWidth"in s&&t(1,o=s.strokeWidth)},[n,o]}class Ba extends Ve{constructor(e){super(),Ne(this,e,T0,M0,Be,{className:0,strokeWidth:1})}}function vi(l){let e,t;return e=new C0({props:{nodes:l[6],nodeTypes:l[8],edges:l[7]}}),e.$on("nodeclick",l[12]),{c(){te(e.$$.fragment)},l(n){oe(e.$$.fragment,n)},m(n,o){ne(e,n,o),t=!0},p:we,i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){le(e,n)}}}function V0(l){let e,t,n,o,s,r,i,a=l[1].t("Chat Overview")+"",c,u,f,h,d,_,b,v;s=new Ba({props:{className:"size-3.5"}}),h=new No({props:{className:"size-3.5"}});let g=l[2].length>0&&vi(l);return{c(){e=V("div"),t=V("div"),n=V("div"),o=V("button"),te(s.$$.fragment),r=$(),i=V("div"),c=Ce(a),u=$(),f=V("button"),te(h.$$.fragment),d=$(),g&&g.c(),this.h()},l(w){e=N(w,"DIV",{class:!0});var y=S(e);t=N(y,"DIV",{class:!0});var E=S(t);n=N(E,"DIV",{class:!0});var z=S(n);o=N(z,"BUTTON",{class:!0});var T=S(o);oe(s.$$.fragment,T),T.forEach(p),r=ee(z),i=N(z,"DIV",{class:!0});var I=S(i);c=Me(I,a),I.forEach(p),z.forEach(p),u=ee(E),f=N(E,"BUTTON",{class:!0});var H=S(f);oe(h.$$.fragment,H),H.forEach(p),E.forEach(p),d=ee(y),g&&g.l(y),y.forEach(p),this.h()},h(){m(o,"class","self-center p-0.5"),m(i,"class","text-lg font-medium self-center font-primary"),m(n,"class","flex items-center gap-2.5"),m(f,"class","self-center p-0.5"),m(t,"class","absolute z-50 w-full flex justify-between dark:text-gray-100 px-4 py-3.5"),m(e,"class","w-full h-full relative")},m(w,y){B(w,e,y),k(e,t),k(t,n),k(n,o),ne(s,o,null),k(n,r),k(n,i),k(i,c),k(t,u),k(t,f),ne(h,f,null),k(e,d),g&&g.m(e,null),_=!0,b||(v=[ke(o,"click",l[10]),ke(f,"click",l[11])],b=!0)},p(w,[y]){(!_||y&2)&&a!==(a=w[1].t("Chat Overview")+"")&&He(c,a),w[2].length>0?g?(g.p(w,y),y&4&&C(g,1)):(g=vi(w),g.c(),C(g,1),g.m(e,null)):g&&(Ae(),P(g,1,1,()=>{g=null}),Le())},i(w){_||(C(s.$$.fragment,w),C(h.$$.fragment,w),C(g),_=!0)},o(w){P(s.$$.fragment,w),P(h.$$.fragment,w),P(g),_=!1},d(w){w&&p(e),le(s),le(h),g&&g.d(),b=!1,ln(v)}}}function N0(l,e,t){let n,o,s,r;ie(l,yl,O=>t(13,n=O)),ie(l,al,O=>t(14,o=O));const i=on(),a=Ut("i18n");ie(l,a,O=>t(1,s=O));const{width:c,height:u}=Zt(),{fitView:f,getViewport:h}=Cg(),d=Mg();let{history:_}=e,b=null;const v=Je([]);ie(l,v,O=>t(2,r=O));const g=Je([]),w={custom:E0},y=async()=>{b===null?await f({nodes:[{id:_.currentId}]}):await f({nodes:[{id:b}]}),t(0,b=null)},E=async()=>{const O=[],A=[];let Y=new Map,M={};Object.keys(_.messages).forEach(K=>{var L;const D=_.messages[K],W=D.parentId?(((L=Y.get(D.parentId))==null?void 0:L.level)??-1)+1:0;M[W]||(M[W]=0),Y.set(K,{id:D.id,level:W,position:M[W]++})}),Object.keys(_.messages).forEach(K=>{const D=Y.get(K),W=D.position*250,L=D.level*150,R=W;O.push({id:D.id,type:"custom",data:{user:o,message:_.messages[K],model:n.find(Q=>Q.id===_.messages[K].model)},position:{x:R,y:L}});const X=_.messages[K].parentId;X&&A.push({id:X+"-"+D.id,source:X,target:D.id,selectable:!1,class:" dark:fill-gray-300 fill-gray-300",type:"smoothstep",animated:_.currentId===K||z(K,_.currentId)})}),await g.set([...A]),await v.set([...O])},z=(O,A)=>{const F=_.messages[O];return F.childrenIds&&F.childrenIds.some(j=>j===A||z(j,A))};hn(()=>{E(),d.subscribe(async O=>{O&&(await qe(),await f({nodes:[{id:_.currentId}]}))}),c.subscribe(O=>{O&&f({nodes:[{id:_.currentId}]})}),u.subscribe(O=>{O&&f({nodes:[{id:_.currentId}]})})}),il(()=>{console.log("Overview destroyed"),v.set([]),g.set([])});const T=()=>{Jn.set(!1)},I=()=>{i("close"),Jn.set(!1)},H=O=>{console.log(O.detail.node.data),i("nodeclick",O.detail),t(0,b=O.detail.node.data.message.id),f({nodes:[{id:b}]})};return l.$$set=O=>{"history"in O&&t(9,_=O.history)},l.$$.update=()=>{l.$$.dirty&512&&_&&E(),l.$$.dirty&512&&_&&_.currentId&&y()},[b,s,r,i,a,f,v,g,w,_,T,I,H]}class Aa extends Ve{constructor(e){super(),Ne(this,e,N0,V0,Be,{history:9})}}function z0(l){let e,t;return{c(){e=ze("svg"),t=ze("path"),this.h()},l(n){e=Pe(n,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var o=S(e);t=Pe(o,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),S(t).forEach(p),o.forEach(p),this.h()},h(){m(t,"stroke-linecap","round"),m(t,"stroke-linejoin","round"),m(t,"d","M3.75 3.75v4.5m0-4.5h4.5m-4.5 0L9 9M3.75 20.25v-4.5m0 4.5h4.5m-4.5 0L9 15M20.25 3.75h-4.5m4.5 0v4.5m0-4.5L15 9m5.25 11.25h-4.5m4.5 0v-4.5m0 4.5L15 15"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"fill","none"),m(e,"viewBox","0 0 24 24"),m(e,"stroke-width",l[1]),m(e,"stroke","currentColor"),m(e,"class",l[0])},m(n,o){B(n,e,o),k(e,t)},p(n,[o]){o&2&&m(e,"stroke-width",n[1]),o&1&&m(e,"class",n[0])},i:we,o:we,d(n){n&&p(e)}}}function P0(l,e,t){let{className:n="size-4"}=e,{strokeWidth:o="1.5"}=e;return l.$$set=s=>{"className"in s&&t(0,n=s.className),"strokeWidth"in s&&t(1,o=s.strokeWidth)},[n,o]}class O0 extends Ve{constructor(e){super(),Ne(this,e,P0,z0,Be,{className:0,strokeWidth:1})}}function wi(l){let e;return{c(){e=V("div"),this.h()},l(t){e=N(t,"DIV",{class:!0}),S(e).forEach(p),this.h()},h(){m(e,"class","absolute top-0 left-0 right-0 bottom-0 z-10")},m(t,n){B(t,e,n)},d(t){t&&p(e)}}}function H0(l){let e,t=l[5].t("No HTML, CSS, or JavaScript content found.")+"",n;return{c(){e=V("div"),n=Ce(t),this.h()},l(o){e=N(o,"DIV",{class:!0});var s=S(e);n=Me(s,t),s.forEach(p),this.h()},h(){m(e,"class","m-auto font-medium text-xs text-gray-900 dark:text-white")},m(o,s){B(o,e,s),k(e,n)},p(o,s){s&32&&t!==(t=o[5].t("No HTML, CSS, or JavaScript content found.")+"")&&He(n,t)},i:we,o:we,d(o){o&&p(e)}}}function B0(l){let e,t,n,o;const s=[L0,A0],r=[];function i(a,c){return a[1][a[2]].type==="iframe"?0:a[1][a[2]].type==="svg"?1:-1}return~(t=i(l))&&(n=r[t]=s[t](l)),{c(){e=V("div"),n&&n.c(),this.h()},l(a){e=N(a,"DIV",{class:!0});var c=S(e);n&&n.l(c),c.forEach(p),this.h()},h(){m(e,"class","max-w-full w-full h-full")},m(a,c){B(a,e,c),~t&&r[t].m(e,null),o=!0},p(a,c){let u=t;t=i(a),t===u?~t&&r[t].p(a,c):(n&&(Ae(),P(r[u],1,1,()=>{r[u]=null}),Le()),~t?(n=r[t],n?n.p(a,c):(n=r[t]=s[t](a),n.c()),C(n,1),n.m(e,null)):n=null)},i(a){o||(C(n),o=!0)},o(a){P(n),o=!1},d(a){a&&p(e),~t&&r[t].d()}}}function A0(l){let e,t;return e=new Ka({props:{className:" w-full h-full max-h-full overflow-hidden",svg:l[1][l[2]].content}}),{c(){te(e.$$.fragment)},l(n){oe(e.$$.fragment,n)},m(n,o){ne(e,n,o),t=!0},p(n,o){const s={};o&6&&(s.svg=n[1][n[2]].content),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){le(e,n)}}}function L0(l){let e,t,n,o;return{c(){e=V("iframe"),this.h()},l(s){e=N(s,"IFRAME",{title:!0,srcdoc:!0,class:!0,sandbox:!0}),S(e).forEach(p),this.h()},h(){m(e,"title","Content"),m(e,"srcdoc",t=l[1][l[2]].content),m(e,"class","w-full border-0 h-full rounded-none"),m(e,"sandbox","allow-scripts allow-forms allow-same-origin")},m(s,r){B(s,e,r),l[14](e),n||(o=ke(e,"load",l[9]),n=!0)},p(s,r){r&6&&t!==(t=s[1][s[2]].content)&&m(e,"srcdoc",t)},i:we,o:we,d(s){s&&p(e),l[14](null),n=!1,o()}}}function yi(l){let e,t,n,o,s,r,i,a,c,u=l[5].t("Version {{selectedVersion}} of {{totalVersions}}",{selectedVersion:l[2]+1,totalVersions:l[1].length})+"",f,h,d,_,b,v,g,w,y,E=(l[3]?l[5].t("Copied"):l[5].t("Copy"))+"",z,T,I,H,O,A=l[1][l[2]].type==="iframe"&&ki(l);return{c(){e=V("div"),t=V("div"),n=V("div"),o=V("button"),s=ze("svg"),r=ze("path"),a=$(),c=V("div"),f=Ce(u),h=$(),d=V("button"),_=ze("svg"),b=ze("path"),g=$(),w=V("div"),y=V("button"),z=Ce(E),T=$(),A&&A.c(),this.h()},l(F){e=N(F,"DIV",{class:!0});var j=S(e);t=N(j,"DIV",{class:!0});var Y=S(t);n=N(Y,"DIV",{class:!0,dir:!0});var M=S(n);o=N(M,"BUTTON",{class:!0});var K=S(o);s=Pe(K,"svg",{xmlns:!0,fill:!0,viewBox:!0,stroke:!0,"stroke-width":!0,class:!0});var D=S(s);r=Pe(D,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),S(r).forEach(p),D.forEach(p),K.forEach(p),a=ee(M),c=N(M,"DIV",{class:!0});var W=S(c);f=Me(W,u),W.forEach(p),h=ee(M),d=N(M,"BUTTON",{class:!0});var L=S(d);_=Pe(L,"svg",{xmlns:!0,fill:!0,viewBox:!0,stroke:!0,"stroke-width":!0,class:!0});var R=S(_);b=Pe(R,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),S(b).forEach(p),R.forEach(p),L.forEach(p),M.forEach(p),Y.forEach(p),g=ee(j),w=N(j,"DIV",{class:!0});var X=S(w);y=N(X,"BUTTON",{class:!0});var Q=S(y);z=Me(Q,E),Q.forEach(p),T=ee(X),A&&A.l(X),X.forEach(p),j.forEach(p),this.h()},h(){m(r,"stroke-linecap","round"),m(r,"stroke-linejoin","round"),m(r,"d","M15.75 19.5 8.25 12l7.5-7.5"),m(s,"xmlns","http://www.w3.org/2000/svg"),m(s,"fill","none"),m(s,"viewBox","0 0 24 24"),m(s,"stroke","currentColor"),m(s,"stroke-width","2.5"),m(s,"class","size-3.5"),m(o,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition disabled:cursor-not-allowed"),o.disabled=i=l[1].length<=1,m(c,"class","text-xs self-center dark:text-gray-100 min-w-fit"),m(b,"stroke-linecap","round"),m(b,"stroke-linejoin","round"),m(b,"d","m8.25 4.5 7.5 7.5-7.5 7.5"),m(_,"xmlns","http://www.w3.org/2000/svg"),m(_,"fill","none"),m(_,"viewBox","0 0 24 24"),m(_,"stroke","currentColor"),m(_,"stroke-width","2.5"),m(_,"class","size-3.5"),m(d,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition disabled:cursor-not-allowed"),d.disabled=v=l[1].length<=1,m(n,"class","flex items-center gap-0.5 self-center min-w-fit"),m(n,"dir","ltr"),m(t,"class","flex items-center space-x-2"),m(y,"class","copy-code-button bg-none border-none text-xs bg-gray-50 hover:bg-gray-100 dark:bg-gray-850 dark:hover:bg-gray-800 transition rounded-md px-1.5 py-0.5"),m(w,"class","flex items-center gap-1"),m(e,"class","flex justify-between items-center p-2.5 font-primar text-gray-900 dark:text-white")},m(F,j){B(F,e,j),k(e,t),k(t,n),k(n,o),k(o,s),k(s,r),k(n,a),k(n,c),k(c,f),k(n,h),k(n,d),k(d,_),k(_,b),k(e,g),k(e,w),k(w,y),k(y,z),k(w,T),A&&A.m(w,null),I=!0,H||(O=[ke(o,"click",l[15]),ke(d,"click",l[16]),ke(y,"click",l[17])],H=!0)},p(F,j){(!I||j&2&&i!==(i=F[1].length<=1))&&(o.disabled=i),(!I||j&38)&&u!==(u=F[5].t("Version {{selectedVersion}} of {{totalVersions}}",{selectedVersion:F[2]+1,totalVersions:F[1].length})+"")&&He(f,u),(!I||j&2&&v!==(v=F[1].length<=1))&&(d.disabled=v),(!I||j&40)&&E!==(E=(F[3]?F[5].t("Copied"):F[5].t("Copy"))+"")&&He(z,E),F[1][F[2]].type==="iframe"?A?(A.p(F,j),j&6&&C(A,1)):(A=ki(F),A.c(),C(A,1),A.m(w,null)):A&&(Ae(),P(A,1,1,()=>{A=null}),Le())},i(F){I||(C(A),I=!0)},o(F){P(A),I=!1},d(F){F&&p(e),A&&A.d(),H=!1,ln(O)}}}function ki(l){let e,t;return e=new Gt({props:{content:l[5].t("Open in full screen"),$$slots:{default:[R0]},$$scope:{ctx:l}}}),{c(){te(e.$$.fragment)},l(n){oe(e.$$.fragment,n)},m(n,o){ne(e,n,o),t=!0},p(n,o){const s={};o&32&&(s.content=n[5].t("Open in full screen")),o&1048576&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){le(e,n)}}}function R0(l){let e,t,n,o,s;return t=new O0({props:{className:"size-3.5"}}),{c(){e=V("button"),te(t.$$.fragment),this.h()},l(r){e=N(r,"BUTTON",{class:!0});var i=S(e);oe(t.$$.fragment,i),i.forEach(p),this.h()},h(){m(e,"class","bg-none border-none text-xs bg-gray-50 hover:bg-gray-100 dark:bg-gray-850 dark:hover:bg-gray-800 transition rounded-md p-0.5")},m(r,i){B(r,e,i),ne(t,e,null),n=!0,o||(s=ke(e,"click",l[10]),o=!0)},p:we,i(r){n||(C(t.$$.fragment,r),n=!0)},o(r){P(t.$$.fragment,r),n=!1},d(r){r&&p(e),le(t),o=!1,s()}}}function U0(l){let e,t,n,o,s,r,i,a,c,u,f,h,d,_,b,v,g,w,y,E=l[0]&&wi();r=new Ba({props:{className:"size-3.5  text-gray-900 dark:text-white"}}),u=new No({props:{className:"size-3.5 text-gray-900 dark:text-white"}});const z=[B0,H0],T=[];function I(O,A){return O[1].length>0?0:1}_=I(l),b=T[_]=z[_](l);let H=l[1].length>0&&yi(l);return{c(){e=V("div"),t=V("div"),E&&E.c(),n=$(),o=V("div"),s=V("button"),te(r.$$.fragment),i=$(),a=V("div"),c=V("button"),te(u.$$.fragment),f=$(),h=V("div"),d=V("div"),b.c(),v=$(),H&&H.c(),this.h()},l(O){e=N(O,"DIV",{class:!0});var A=S(e);t=N(A,"DIV",{class:!0});var F=S(t);E&&E.l(F),n=ee(F),o=N(F,"DIV",{class:!0});var j=S(o);s=N(j,"BUTTON",{class:!0});var Y=S(s);oe(r.$$.fragment,Y),Y.forEach(p),j.forEach(p),i=ee(F),a=N(F,"DIV",{class:!0});var M=S(a);c=N(M,"BUTTON",{class:!0});var K=S(c);oe(u.$$.fragment,K),K.forEach(p),M.forEach(p),f=ee(F),h=N(F,"DIV",{class:!0});var D=S(h);d=N(D,"DIV",{class:!0});var W=S(d);b.l(W),W.forEach(p),D.forEach(p),F.forEach(p),v=ee(A),H&&H.l(A),A.forEach(p),this.h()},h(){m(s,"class","self-center pointer-events-auto p-1 rounded-full bg-white dark:bg-gray-850"),m(o,"class","absolute pointer-events-none z-50 w-full flex items-center justify-start p-4"),m(c,"class","self-center pointer-events-auto p-1 rounded-full bg-white dark:bg-gray-850"),m(a,"class","absolute pointer-events-none z-50 w-full flex items-center justify-end p-4"),m(d,"class","h-full flex flex-col"),m(h,"class","flex-1 w-full h-full"),m(t,"class","w-full h-full flex-1 relative"),m(e,"class","w-full h-full relative flex flex-col bg-gray-50 dark:bg-gray-850")},m(O,A){B(O,e,A),k(e,t),E&&E.m(t,null),k(t,n),k(t,o),k(o,s),ne(r,s,null),k(t,i),k(t,a),k(a,c),ne(u,c,null),k(t,f),k(t,h),k(h,d),T[_].m(d,null),k(e,v),H&&H.m(e,null),g=!0,w||(y=[ke(s,"click",l[12]),ke(c,"click",l[13])],w=!0)},p(O,[A]){O[0]?E||(E=wi(),E.c(),E.m(t,n)):E&&(E.d(1),E=null);let F=_;_=I(O),_===F?T[_].p(O,A):(Ae(),P(T[F],1,1,()=>{T[F]=null}),Le(),b=T[_],b?b.p(O,A):(b=T[_]=z[_](O),b.c()),C(b,1),b.m(d,null)),O[1].length>0?H?(H.p(O,A),A&2&&C(H,1)):(H=yi(O),H.c(),C(H,1),H.m(e,null)):H&&(Ae(),P(H,1,1,()=>{H=null}),Le())},i(O){g||(C(r.$$.fragment,O),C(u.$$.fragment,O),C(b),C(H),g=!0)},o(O){P(r.$$.fragment,O),P(u.$$.fragment,O),P(b),P(H),g=!1},d(O){O&&p(e),E&&E.d(),le(r),le(u),T[_].d(),H&&H.d(),w=!1,ln(y)}}}function W0(l,e,t){let n;const o=Ut("i18n");ie(l,o,I=>t(5,n=I));const s=on();let{overlay:r=!1}=e,{history:i}=e,a=[],c=[],u=0,f=!1,h;const d=()=>{t(1,c=[]),a.forEach(I=>{if((I==null?void 0:I.role)!=="user"&&(I!=null&&I.content)){const H=I.content.match(/```[\s\S]*?```/g);let O=[];H&&H.forEach(D=>{const W=D.split(`
`)[0].replace("```","").trim().toLowerCase(),L=D.replace(/```[\s\S]*?\n/,"").replace(/```$/,"");O.push({lang:W,code:L})});let A="",F="",j="";O.forEach(D=>{const{lang:W,code:L}=D;W==="html"?A+=L+`
`:W==="css"?F+=L+`
`:(W==="javascript"||W==="js")&&(j+=L+`
`)});const Y=I.content.match(/<html>[\s\S]*?<\/html>/gi),M=I.content.match(/<style>[\s\S]*?<\/style>/gi),K=I.content.match(/<script>[\s\S]*?<\/script>/gi);if(Y&&Y.forEach(D=>{const W=D.replace(/<\/?html>/gi,"");A+=W+`
`}),M&&M.forEach(D=>{const W=D.replace(/<\/?style>/gi,"");F+=W+`
`}),K&&K.forEach(D=>{const W=D.replace(/<\/?script>/gi,"");j+=W+`
`}),A||F||j){const D=`
                        <!DOCTYPE html>
                        <html lang="en">
                        <head>
                            <meta charset="UTF-8">
                            <meta name="viewport" content="width=device-width, initial-scale=1.0">
							<style>
								body {
									background-color: white; /* Ensure the iframe has a white background */
								}

								${F}
							</style>
                        </head>
                        <body>
                            ${A}

							<script>
                            	${j}
							<\/script>
                        </body>
                        </html>
                    `;t(1,c=[...c,{type:"iframe",content:D}])}else for(const D of O)(D.lang==="svg"||D.lang==="xml"&&D.code.includes("<svg"))&&t(1,c=[...c,{type:"svg",content:D.code}])}}),c.length===0&&(Rt.set(!1),Yn.set(!1)),t(2,u=c?c.length-1:0)};function _(I){console.log(u),t(2,u=I==="prev"?Math.max(u-1,0):Math.min(u+1,c.length-1)),console.log(u)}const b=()=>{h.contentWindow.addEventListener("click",function(I){const H=I.target.closest("a");if(H&&H.href){I.preventDefault();const O=new URL(H.href,h.baseURI);O.origin===window.location.origin?h.contentWindow.history.pushState(null,"",O.pathname+O.search+O.hash):console.log("External navigation blocked:",O.href)}},!0),h.contentWindow.addEventListener("mouseenter",function(I){I.preventDefault(),h.contentWindow.addEventListener("dragstart",H=>{H.preventDefault()})})},v=()=>{h.requestFullscreen?h.requestFullscreen():h.webkitRequestFullscreen?h.webkitRequestFullscreen():h.msRequestFullscreen&&h.msRequestFullscreen()};hn(()=>{});const g=()=>{Yn.set(!1)},w=()=>{s("close"),Rt.set(!1),Yn.set(!1)};function y(I){We[I?"unshift":"push"](()=>{h=I,t(4,h)})}const E=()=>_("prev"),z=()=>_("next"),T=()=>{_o(c[u].content),t(3,f=!0),setTimeout(()=>{t(3,f=!1)},2e3)};return l.$$set=I=>{"overlay"in I&&t(0,r=I.overlay),"history"in I&&t(11,i=I.history)},l.$$.update=()=>{l.$$.dirty&2048&&(i?(a=Jo(i,i.currentId),d()):(a=[],d()))},[r,c,u,f,h,n,o,s,_,b,v,i,g,w,y,E,z,T]}class La extends Ve{constructor(e){super(),Ne(this,e,W0,U0,Be,{overlay:0,history:11})}}function j0(l){let e,t,n,o,s=l[16]&&Ei(l);function r(a){l[37](a)}let i={defaultSize:0,onResize:l[35],onCollapse:l[36],collapsible:!0,class:"pt-8",$$slots:{default:[G0]},$$scope:{ctx:l}};return l[4]!==void 0&&(i.pane=l[4]),t=new ji({props:i}),We.push(()=>$e(t,"pane",r)),{c(){s&&s.c(),e=$(),te(t.$$.fragment)},l(a){s&&s.l(a),e=ee(a),oe(t.$$.fragment,a)},m(a,c){s&&s.m(a,c),B(a,e,c),ne(t,a,c),o=!0},p(a,c){a[16]?s?c[0]&65536&&C(s,1):(s=Ei(a),s.c(),C(s,1),s.m(e.parentNode,e)):s&&(Ae(),P(s,1,1,()=>{s=null}),Le());const u={};c[0]&81936&&(u.onResize=a[35]),c[0]&503791|c[1]&4096&&(u.$$scope={dirty:c,ctx:a}),!n&&c[0]&16&&(n=!0,u.pane=a[4],xe(()=>n=!1)),t.$set(u)},i(a){o||(C(s),C(t.$$.fragment,a),o=!0)},o(a){P(s),P(t.$$.fragment,a),o=!1},d(a){a&&p(e),s&&s.d(a),le(t,a)}}}function F0(l){let e,t,n=l[16]&&Si(l);return{c(){n&&n.c(),e=Oe()},l(o){n&&n.l(o),e=Oe()},m(o,s){n&&n.m(o,s),B(o,e,s),t=!0},p(o,s){o[16]?n?(n.p(o,s),s[0]&65536&&C(n,1)):(n=Si(o),n.c(),C(n,1),n.m(e.parentNode,e)):n&&(Ae(),P(n,1,1,()=>{n=null}),Le())},i(o){t||(C(n),t=!0)},o(o){P(n),t=!1},d(o){o&&p(e),n&&n.d(o)}}}function Ei(l){let e,t;return e=new ec({props:{class:"relative flex w-2 items-center justify-center bg-background group",$$slots:{default:[Y0]},$$scope:{ctx:l}}}),{c(){te(e.$$.fragment)},l(n){oe(e.$$.fragment,n)},m(n,o){ne(e,n,o),t=!0},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){le(e,n)}}}function Y0(l){let e,t,n;return t=new tc({props:{className:"size-4 invisible group-hover:visible"}}),{c(){e=V("div"),te(t.$$.fragment),this.h()},l(o){e=N(o,"DIV",{class:!0});var s=S(e);oe(t.$$.fragment,s),s.forEach(p),this.h()},h(){m(e,"class","z-10 flex h-7 w-5 items-center justify-center rounded-sm")},m(o,s){B(o,e,s),ne(t,e,null),n=!0},p:we,i(o){n||(C(t.$$.fragment,o),n=!0)},o(o){P(t.$$.fragment,o),n=!1},d(o){o&&p(e),le(t)}}}function Ii(l){let e,t,n,o,s,r;const i=[q0,K0,X0,Z0],a=[];function c(u,f){return u[15]?0:u[18]?1:u[17]?2:3}return n=c(l),o=a[n]=i[n](l),{c(){e=V("div"),t=V("div"),o.c(),this.h()},l(u){e=N(u,"DIV",{class:!0});var f=S(e);t=N(f,"DIV",{class:!0});var h=S(t);o.l(h),h.forEach(p),f.forEach(p),this.h()},h(){m(t,"class",s="w-full "+((l[17]||l[18])&&!l[15]?" ":"px-4 py-4 bg-white dark:shadow-lg dark:bg-gray-850  border border-gray-50 dark:border-gray-850")+" rounded-xl z-40 pointer-events-auto overflow-y-auto scrollbar-hidden"),m(e,"class","pr-4 pb-8 flex max-h-full min-h-full")},m(u,f){B(u,e,f),k(e,t),a[n].m(t,null),r=!0},p(u,f){let h=n;n=c(u),n===h?a[n].p(u,f):(Ae(),P(a[h],1,1,()=>{a[h]=null}),Le(),o=a[n],o?o.p(u,f):(o=a[n]=i[n](u),o.c()),C(o,1),o.m(t,null)),(!r||f[0]&425984&&s!==(s="w-full "+((u[17]||u[18])&&!u[15]?" ":"px-4 py-4 bg-white dark:shadow-lg dark:bg-gray-850  border border-gray-50 dark:border-gray-850")+" rounded-xl z-40 pointer-events-auto overflow-y-auto scrollbar-hidden"))&&m(t,"class",s)},i(u){r||(C(o),r=!0)},o(u){P(o),r=!1},d(u){u&&p(e),a[n].d()}}}function Z0(l){let e,t,n,o;function s(a){l[32](a)}function r(a){l[33](a)}let i={models:l[5]};return l[1]!==void 0&&(i.chatFiles=l[1]),l[2]!==void 0&&(i.params=l[2]),e=new Oa({props:i}),We.push(()=>$e(e,"chatFiles",s)),We.push(()=>$e(e,"params",r)),e.$on("close",l[34]),{c(){te(e.$$.fragment)},l(a){oe(e.$$.fragment,a)},m(a,c){ne(e,a,c),o=!0},p(a,c){const u={};c[0]&32&&(u.models=a[5]),!t&&c[0]&2&&(t=!0,u.chatFiles=a[1],xe(()=>t=!1)),!n&&c[0]&4&&(n=!0,u.params=a[2],xe(()=>n=!1)),e.$set(u)},i(a){o||(C(e.$$.fragment,a),o=!0)},o(a){P(e.$$.fragment,a),o=!1},d(a){le(e,a)}}}function X0(l){let e,t;return e=new Aa({props:{history:l[0]}}),e.$on("nodeclick",l[30]),e.$on("close",l[31]),{c(){te(e.$$.fragment)},l(n){oe(e.$$.fragment,n)},m(n,o){ne(e,n,o),t=!0},p(n,o){const s={};o[0]&1&&(s.history=n[0]),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){le(e,n)}}}function K0(l){let e,t;return e=new La({props:{history:l[0],overlay:l[13]}}),{c(){te(e.$$.fragment)},l(n){oe(e.$$.fragment,n)},m(n,o){ne(e,n,o),t=!0},p(n,o){const s={};o[0]&1&&(s.history=n[0]),o[0]&8192&&(s.overlay=n[13]),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){le(e,n)}}}function q0(l){let e,t,n,o;function s(i){l[28](i)}let r={submitPrompt:l[8],stopResponse:l[9],modelId:l[11],chatId:l[6],eventTarget:l[7]};return l[3]!==void 0&&(r.files=l[3]),t=new Ha({props:r}),We.push(()=>$e(t,"files",s)),t.$on("close",l[29]),{c(){e=V("div"),te(t.$$.fragment),this.h()},l(i){e=N(i,"DIV",{class:!0});var a=S(e);oe(t.$$.fragment,a),a.forEach(p),this.h()},h(){m(e,"class","w-full h-full flex justify-center")},m(i,a){B(i,e,a),ne(t,e,null),o=!0},p(i,a){const c={};a[0]&256&&(c.submitPrompt=i[8]),a[0]&512&&(c.stopResponse=i[9]),a[0]&2048&&(c.modelId=i[11]),a[0]&64&&(c.chatId=i[6]),a[0]&128&&(c.eventTarget=i[7]),!n&&a[0]&8&&(n=!0,c.files=i[3],xe(()=>n=!1)),t.$set(c)},i(i){o||(C(t.$$.fragment,i),o=!0)},o(i){P(t.$$.fragment,i),o=!1},d(i){i&&p(e),le(t)}}}function G0(l){let e,t,n=l[16]&&Ii(l);return{c(){n&&n.c(),e=Oe()},l(o){n&&n.l(o),e=Oe()},m(o,s){n&&n.m(o,s),B(o,e,s),t=!0},p(o,s){o[16]?n?(n.p(o,s),s[0]&65536&&C(n,1)):(n=Ii(o),n.c(),C(n,1),n.m(e.parentNode,e)):n&&(Ae(),P(n,1,1,()=>{n=null}),Le())},i(o){t||(C(n),t=!0)},o(o){P(n),t=!1},d(o){o&&p(e),n&&n.d(o)}}}function Si(l){let e,t;return e=new nc({props:{show:l[16],$$slots:{default:[e_]},$$scope:{ctx:l}}}),e.$on("close",l[27]),{c(){te(e.$$.fragment)},l(n){oe(e.$$.fragment,n)},m(n,o){ne(e,n,o),t=!0},p(n,o){const s={};o[0]&65536&&(s.show=n[16]),o[0]&430063|o[1]&4096&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){le(e,n)}}}function J0(l){let e,t,n,o;function s(a){l[24](a)}function r(a){l[25](a)}let i={models:l[5]};return l[1]!==void 0&&(i.chatFiles=l[1]),l[2]!==void 0&&(i.params=l[2]),e=new Oa({props:i}),We.push(()=>$e(e,"chatFiles",s)),We.push(()=>$e(e,"params",r)),e.$on("close",l[26]),{c(){te(e.$$.fragment)},l(a){oe(e.$$.fragment,a)},m(a,c){ne(e,a,c),o=!0},p(a,c){const u={};c[0]&32&&(u.models=a[5]),!t&&c[0]&2&&(t=!0,u.chatFiles=a[1],xe(()=>t=!1)),!n&&c[0]&4&&(n=!0,u.params=a[2],xe(()=>n=!1)),e.$set(u)},i(a){o||(C(e.$$.fragment,a),o=!0)},o(a){P(e.$$.fragment,a),o=!1},d(a){le(e,a)}}}function Q0(l){let e,t;return e=new Aa({props:{history:l[0]}}),e.$on("nodeclick",l[22]),e.$on("close",l[23]),{c(){te(e.$$.fragment)},l(n){oe(e.$$.fragment,n)},m(n,o){ne(e,n,o),t=!0},p(n,o){const s={};o[0]&1&&(s.history=n[0]),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){le(e,n)}}}function x0(l){let e,t;return e=new La({props:{history:l[0]}}),{c(){te(e.$$.fragment)},l(n){oe(e.$$.fragment,n)},m(n,o){ne(e,n,o),t=!0},p(n,o){const s={};o[0]&1&&(s.history=n[0]),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){le(e,n)}}}function $0(l){let e,t,n,o;function s(i){l[20](i)}let r={submitPrompt:l[8],stopResponse:l[9],modelId:l[11],chatId:l[6],eventTarget:l[7]};return l[3]!==void 0&&(r.files=l[3]),t=new Ha({props:r}),We.push(()=>$e(t,"files",s)),t.$on("close",l[21]),{c(){e=V("div"),te(t.$$.fragment),this.h()},l(i){e=N(i,"DIV",{class:!0});var a=S(e);oe(t.$$.fragment,a),a.forEach(p),this.h()},h(){m(e,"class","h-full max-h-[100dvh] bg-white text-gray-700 dark:bg-black dark:text-gray-300 flex justify-center")},m(i,a){B(i,e,a),ne(t,e,null),o=!0},p(i,a){const c={};a[0]&256&&(c.submitPrompt=i[8]),a[0]&512&&(c.stopResponse=i[9]),a[0]&2048&&(c.modelId=i[11]),a[0]&64&&(c.chatId=i[6]),a[0]&128&&(c.eventTarget=i[7]),!n&&a[0]&8&&(n=!0,c.files=i[3],xe(()=>n=!1)),t.$set(c)},i(i){o||(C(t.$$.fragment,i),o=!0)},o(i){P(t.$$.fragment,i),o=!1},d(i){i&&p(e),le(t)}}}function e_(l){let e,t,n,o,s;const r=[$0,x0,Q0,J0],i=[];function a(c,u){return c[15]?0:c[18]?1:c[17]?2:3}return t=a(l),n=i[t]=r[t](l),{c(){e=V("div"),n.c(),this.h()},l(c){e=N(c,"DIV",{class:!0});var u=S(e);n.l(u),u.forEach(p),this.h()},h(){m(e,"class",o=(l[15]||l[17]||l[18]?" h-screen  w-screen":"px-6 py-4")+" h-full")},m(c,u){B(c,e,u),i[t].m(e,null),s=!0},p(c,u){let f=t;t=a(c),t===f?i[t].p(c,u):(Ae(),P(i[f],1,1,()=>{i[f]=null}),Le(),n=i[t],n?n.p(c,u):(n=i[t]=r[t](c),n.c()),C(n,1),n.m(e,null)),(!s||u[0]&425984&&o!==(o=(c[15]||c[17]||c[18]?" h-screen  w-screen":"px-6 py-4")+" h-full"))&&m(e,"class",o)},i(c){s||(C(n),s=!0)},o(c){P(n),s=!1},d(c){c&&p(e),i[t].d()}}}function t_(l){let e,t,n,o;const s=[F0,j0],r=[];function i(a,c){return a[12]?1:0}return e=i(l),t=r[e]=s[e](l),{c(){t.c(),n=Oe()},l(a){t.l(a),n=Oe()},m(a,c){r[e].m(a,c),B(a,n,c),o=!0},p(a,c){let u=e;e=i(a),e===u?r[e].p(a,c):(Ae(),P(r[u],1,1,()=>{r[u]=null}),Le(),t=r[e],t?t.p(a,c):(t=r[e]=s[e](a),t.c()),C(t,1),t.m(n.parentNode,n))},i(a){o||(C(t),o=!0)},o(a){P(t),o=!1},d(a){a&&p(n),r[e].d(a)}}}function n_(l){let e,t;return e=new F1({props:{$$slots:{default:[t_]},$$scope:{ctx:l}}}),{c(){te(e.$$.fragment)},l(n){oe(e.$$.fragment,n)},m(n,o){ne(e,n,o),t=!0},p(n,o){const s={};o[0]&524287|o[1]&4096&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){le(e,n)}}}function l_(l,e,t){let n,o,s,r;ie(l,vn,ae=>t(15,n=ae)),ie(l,Rt,ae=>t(16,o=ae)),ie(l,Jn,ae=>t(17,s=ae)),ie(l,Yn,ae=>t(18,r=ae));let{history:i}=e,{models:a=[]}=e,{chatId:c=null}=e,{chatFiles:u=[]}=e,{params:f={}}=e,{eventTarget:h}=e,{submitPrompt:d}=e,{stopResponse:_}=e,{showMessage:b}=e,{files:v}=e,{modelId:g}=e,{pane:w}=e,y,E=!1,z=!1,T=0;const I=()=>{parseInt(localStorage==null?void 0:localStorage.chatControlsSize)?w.resize(parseInt(localStorage==null?void 0:localStorage.chatControlsSize)):w.resize(T)},H=async ae=>{ae.matches?(t(12,E=!0),n&&(vn.set(!1),await qe(),vn.set(!0))):(t(12,E=!1),n&&(vn.set(!1),await qe(),vn.set(!0)),t(4,w=null))},O=ae=>{t(13,z=!0)},A=ae=>{t(13,z=!1)};hn(()=>{y=window.matchMedia("(min-width: 1024px)"),y.addEventListener("change",H),H(y);const ae=document.getElementById("chat-container");t(14,T=Math.floor(350/ae.clientWidth*100)),new ResizeObserver(ge=>{for(let _t of ge){const ct=350/_t.contentRect.width*100;t(14,T=Math.floor(ct)),o&&w&&w.isExpanded()&&w.getSize()<T&&w.resize(T)}}).observe(ae),document.addEventListener("mousedown",O),document.addEventListener("mouseup",A)}),il(()=>{Rt.set(!1),y.removeEventListener("change",H),document.removeEventListener("mousedown",O),document.removeEventListener("mouseup",A)});const F=()=>{Rt.set(!1),Jn.set(!1),Yn.set(!1),n&&vn.set(!1)};function j(ae){v=ae,t(3,v)}const Y=()=>{Rt.set(!1)},M=ae=>{b(ae.detail.node.data.message)},K=()=>{Rt.set(!1)};function D(ae){u=ae,t(1,u)}function W(ae){f=ae,t(2,f)}const L=()=>{Rt.set(!1)},R=()=>{Rt.set(!1)};function X(ae){v=ae,t(3,v)}const Q=()=>{Rt.set(!1)},G=ae=>{ae.detail.node.data.message.favorite?t(0,i.messages[ae.detail.node.data.message.id].favorite=!0,i):t(0,i.messages[ae.detail.node.data.message.id].favorite=null,i),b(ae.detail.node.data.message)},ce=()=>{Rt.set(!1)};function se(ae){u=ae,t(1,u)}function ye(ae){f=ae,t(2,f)}const Se=()=>{Rt.set(!1)},re=ae=>{console.log("size",ae,T),o&&w.isExpanded()&&(ae<T&&w.resize(T),ae<T?localStorage.chatControlsSize=0:localStorage.chatControlsSize=ae)},q=()=>{Rt.set(!1)};function Ee(ae){w=ae,t(4,w)}return l.$$set=ae=>{"history"in ae&&t(0,i=ae.history),"models"in ae&&t(5,a=ae.models),"chatId"in ae&&t(6,c=ae.chatId),"chatFiles"in ae&&t(1,u=ae.chatFiles),"params"in ae&&t(2,f=ae.params),"eventTarget"in ae&&t(7,h=ae.eventTarget),"submitPrompt"in ae&&t(8,d=ae.submitPrompt),"stopResponse"in ae&&t(9,_=ae.stopResponse),"showMessage"in ae&&t(10,b=ae.showMessage),"files"in ae&&t(3,v=ae.files),"modelId"in ae&&t(11,g=ae.modelId),"pane"in ae&&t(4,w=ae.pane)},l.$$.update=()=>{l.$$.dirty[0]&64&&(c||F())},[i,u,f,v,w,a,c,h,d,_,b,g,E,z,T,n,o,s,r,I,j,Y,M,K,D,W,L,R,X,Q,G,ce,se,ye,Se,re,q,Ee]}class o_ extends Ve{constructor(e){super(),Ne(this,e,l_,n_,Be,{history:0,models:5,chatId:6,chatFiles:1,params:2,eventTarget:7,submitPrompt:8,stopResponse:9,showMessage:10,files:3,modelId:11,pane:4,openPane:19},null,[-1,-1])}get openPane(){return this.$$.ctx[19]}}function Di(l,e,t){const n=l.slice();return n[31]=e[t],n[33]=t,n}function Ci(l){let e,t;return e=new Gt({props:{content:"This chat won't appear in history and your messages will not be saved.",className:"w-full flex justify-center mb-0.5",placement:"top",$$slots:{default:[s_]},$$scope:{ctx:l}}}),{c(){te(e.$$.fragment)},l(n){oe(e.$$.fragment,n)},m(n,o){ne(e,n,o),t=!0},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){le(e,n)}}}function s_(l){let e,t,n,o;return t=new Ga({props:{strokeWidth:"2.5",className:"size-5"}}),{c(){e=V("div"),te(t.$$.fragment),n=Ce(" Temporary Chat"),this.h()},l(s){e=N(s,"DIV",{class:!0});var r=S(e);oe(t.$$.fragment,r),n=Me(r," Temporary Chat"),r.forEach(p),this.h()},h(){m(e,"class","flex items-center gap-2 text-gray-500 font-medium text-lg my-2 w-fit")},m(s,r){B(s,e,r),ne(t,e,null),k(e,n),o=!0},p:we,i(s){o||(C(t.$$.fragment,s),o=!0)},o(s){P(t.$$.fragment,s),o=!1},d(s){s&&p(e),le(t)}}}function r_(l){let e,t,n,o,s,r;function i(){return l[21](l[33])}return{c(){e=V("button"),t=V("img"),o=$(),this.h()},l(a){e=N(a,"BUTTON",{});var c=S(e);t=N(c,"IMG",{crossorigin:!0,src:!0,class:!0,alt:!0,draggable:!0}),c.forEach(p),o=ee(a),this.h()},h(){var a,c,u;m(t,"crossorigin","anonymous"),Hn(t.src,n=((u=(c=(a=l[31])==null?void 0:a.info)==null?void 0:c.meta)==null?void 0:u.profile_image_url)??(l[13].language==="dg-DG"?"/doge.png":`${bl}/static/favicon.png`))||m(t,"src",n),m(t,"class","size-9 sm:size-10 rounded-full border-[1px] border-gray-200 dark:border-none"),m(t,"alt","logo"),m(t,"draggable","false")},m(a,c){B(a,e,c),k(e,t),B(a,o,c),s||(r=ke(e,"click",i),s=!0)},p(a,c){var u,f,h;l=a,c[0]&10240&&!Hn(t.src,n=((h=(f=(u=l[31])==null?void 0:u.info)==null?void 0:f.meta)==null?void 0:h.profile_image_url)??(l[13].language==="dg-DG"?"/doge.png":`${bl}/static/favicon.png`))&&m(t,"src",n)},d(a){a&&(p(e),p(o)),s=!1,r()}}}function Mi(l){var n,o,s;let e,t;return e=new Gt({props:{content:(((s=(o=(n=l[11][l[33]])==null?void 0:n.info)==null?void 0:o.meta)==null?void 0:s.tags)??[]).map(Ni).join(", "),placement:"top",$$slots:{default:[r_]},$$scope:{ctx:l}}}),{c(){te(e.$$.fragment)},l(r){oe(e.$$.fragment,r)},m(r,i){ne(e,r,i),t=!0},p(r,i){var c,u,f;const a={};i[0]&2048&&(a.content=(((f=(u=(c=r[11][r[33]])==null?void 0:c.info)==null?void 0:u.meta)==null?void 0:f.tags)??[]).map(Ni).join(", ")),i[0]&14336|i[1]&8&&(a.$$scope={dirty:i,ctx:r}),e.$set(a)},i(r){t||(C(e.$$.fragment,r),t=!0)},o(r){P(e.$$.fragment,r),t=!1},d(r){le(e,r)}}}function i_(l){let e=l[13].t("Hello, {{name}}",{name:l[15].name})+"",t;return{c(){t=Ce(e)},l(n){t=Me(n,e)},m(n,o){B(n,t,o)},p(n,o){o[0]&40960&&e!==(e=n[13].t("Hello, {{name}}",{name:n[15].name})+"")&&He(t,e)},d(n){n&&p(t)}}}function a_(l){var n;let e=((n=l[11][l[12]])==null?void 0:n.name)+"",t;return{c(){t=Ce(e)},l(o){t=Me(o,e)},m(o,s){B(o,t,s)},p(o,s){var r;s[0]&6144&&e!==(e=((r=o[11][o[12]])==null?void 0:r.name)+"")&&He(t,e)},d(o){o&&p(t)}}}function Ti(l){var r,i,a,c,u,f;let e,t,n,o;e=new Gt({props:{className:" w-fit",content:mo.parse(po(((a=(i=(r=l[11][l[12]])==null?void 0:r.info)==null?void 0:i.meta)==null?void 0:a.description)??"")),placement:"top",$$slots:{default:[c_]},$$scope:{ctx:l}}});let s=((f=(u=(c=l[11][l[12]])==null?void 0:c.info)==null?void 0:u.meta)==null?void 0:f.user)&&Vi(l);return{c(){te(e.$$.fragment),t=$(),s&&s.c(),n=Oe()},l(h){oe(e.$$.fragment,h),t=ee(h),s&&s.l(h),n=Oe()},m(h,d){ne(e,h,d),B(h,t,d),s&&s.m(h,d),B(h,n,d),o=!0},p(h,d){var b,v,g,w,y,E;const _={};d[0]&6144&&(_.content=mo.parse(po(((g=(v=(b=h[11][h[12]])==null?void 0:b.info)==null?void 0:v.meta)==null?void 0:g.description)??""))),d[0]&6144|d[1]&8&&(_.$$scope={dirty:d,ctx:h}),e.$set(_),(E=(y=(w=h[11][h[12]])==null?void 0:w.info)==null?void 0:y.meta)!=null&&E.user?s?s.p(h,d):(s=Vi(h),s.c(),s.m(n.parentNode,n)):s&&(s.d(1),s=null)},i(h){o||(C(e.$$.fragment,h),o=!0)},o(h){P(e.$$.fragment,h),o=!1},d(h){h&&(p(t),p(n)),le(e,h),s&&s.d(h)}}}function c_(l){var o,s,r;let e,t,n=mo.parse(po((r=(s=(o=l[11][l[12]])==null?void 0:o.info)==null?void 0:s.meta)==null?void 0:r.description))+"";return{c(){e=V("div"),t=new ja(!1),this.h()},l(i){e=N(i,"DIV",{class:!0});var a=S(e);t=Fa(a,!1),a.forEach(p),this.h()},h(){t.a=null,m(e,"class","mt-0.5 px-2 text-sm font-normal text-gray-500 dark:text-gray-400 line-clamp-2 max-w-xl markdown")},m(i,a){B(i,e,a),t.m(n,e)},p(i,a){var c,u,f;a[0]&6144&&n!==(n=mo.parse(po((f=(u=(c=i[11][i[12]])==null?void 0:c.info)==null?void 0:u.meta)==null?void 0:f.description))+"")&&t.p(n)},d(i){i&&p(e)}}}function Vi(l){let e,t;function n(r,i){var a,c,u;return(u=(c=(a=r[11][r[12]])==null?void 0:a.info)==null?void 0:c.meta)!=null&&u.user.community?f_:u_}let o=n(l),s=o(l);return{c(){e=V("div"),t=Ce(`By
								`),s.c(),this.h()},l(r){e=N(r,"DIV",{class:!0});var i=S(e);t=Me(i,`By
								`),s.l(i),i.forEach(p),this.h()},h(){m(e,"class","mt-0.5 text-sm font-normal text-gray-400 dark:text-gray-500")},m(r,i){B(r,e,i),k(e,t),s.m(e,null)},p(r,i){o===(o=n(r))&&s?s.p(r,i):(s.d(1),s=o(r),s&&(s.c(),s.m(e,null)))},d(r){r&&p(e),s.d()}}}function u_(l){var n,o,s;let e=((s=(o=(n=l[11][l[12]])==null?void 0:n.info)==null?void 0:o.meta)==null?void 0:s.user.name)+"",t;return{c(){t=Ce(e)},l(r){t=Me(r,e)},m(r,i){B(r,t,i)},p(r,i){var a,c,u;i[0]&6144&&e!==(e=((u=(c=(a=r[11][r[12]])==null?void 0:a.info)==null?void 0:c.meta)==null?void 0:u.user.name)+"")&&He(t,e)},d(r){r&&p(t)}}}function f_(l){var s,r,i,a,c,u,f,h,d;let e,t=((i=(r=(s=l[11][l[12]])==null?void 0:s.info)==null?void 0:r.meta)!=null&&i.user.name?(u=(c=(a=l[11][l[12]])==null?void 0:a.info)==null?void 0:c.meta)==null?void 0:u.user.name:`@${(d=(h=(f=l[11][l[12]])==null?void 0:f.info)==null?void 0:h.meta)==null?void 0:d.user.username}`)+"",n,o;return{c(){e=V("a"),n=Ce(t),this.h()},l(_){e=N(_,"A",{href:!0});var b=S(e);n=Me(b,t),b.forEach(p),this.h()},h(){var _,b,v;m(e,"href",o="https://openwebui.com/m/"+((v=(b=(_=l[11][l[12]])==null?void 0:_.info)==null?void 0:b.meta)==null?void 0:v.user.username))},m(_,b){B(_,e,b),k(e,n)},p(_,b){var v,g,w,y,E,z,T,I,H,O,A,F;b[0]&6144&&t!==(t=((w=(g=(v=_[11][_[12]])==null?void 0:v.info)==null?void 0:g.meta)!=null&&w.user.name?(z=(E=(y=_[11][_[12]])==null?void 0:y.info)==null?void 0:E.meta)==null?void 0:z.user.name:`@${(H=(I=(T=_[11][_[12]])==null?void 0:T.info)==null?void 0:I.meta)==null?void 0:H.user.username}`)+"")&&He(n,t),b[0]&6144&&o!==(o="https://openwebui.com/m/"+((F=(A=(O=_[11][_[12]])==null?void 0:O.info)==null?void 0:A.meta)==null?void 0:F.user.username))&&m(e,"href",o)},d(_){_&&p(e)}}}function d_(l){var Ie,ge,_t,me,ct,ut,Wt;let e,t,n,o,s,r,i,a,c,u,f,h,d,_,b,v,g,w,y,E,z,T,I,H,O,A,F,j,Y,M,K,D=l[14]&&Ci(l),W=wt(l[11]),L=[];for(let ve=0;ve<W.length;ve+=1)L[ve]=Mi(Di(l,W,ve));const R=ve=>P(L[ve],1,1,()=>{L[ve]=null});function X(ve,Ue){var st;return(st=ve[11][ve[12]])!=null&&st.name?a_:i_}let Q=X(l),G=Q(l),ce=(((_t=(ge=(Ie=l[11][l[12]])==null?void 0:Ie.info)==null?void 0:ge.meta)==null?void 0:_t.description)??null)&&Ti(l);function se(ve){l[22](ve)}function ye(ve){l[23](ve)}function Se(ve){l[24](ve)}function re(ve){l[25](ve)}function q(ve){l[26](ve)}function Ee(ve){l[27](ve)}let ae={history:l[10],selectedModels:l[9],transparentBackground:l[6],stopResponse:l[8],createMessagePair:l[7],placeholder:l[13].t("How can I help you today?")};return l[3]!==void 0&&(ae.files=l[3]),l[2]!==void 0&&(ae.prompt=l[2]),l[0]!==void 0&&(ae.autoScroll=l[0]),l[4]!==void 0&&(ae.selectedToolIds=l[4]),l[5]!==void 0&&(ae.webSearchEnabled=l[5]),l[1]!==void 0&&(ae.atSelectedModel=l[1]),w=new ea({props:ae}),We.push(()=>$e(w,"files",se)),We.push(()=>$e(w,"prompt",ye)),We.push(()=>$e(w,"autoScroll",Se)),We.push(()=>$e(w,"selectedToolIds",re)),We.push(()=>$e(w,"webSearchEnabled",q)),We.push(()=>$e(w,"atSelectedModel",Ee)),w.$on("upload",l[28]),w.$on("submit",l[29]),Y=new qa({props:{suggestionPrompts:((ut=(ct=(me=l[11][l[12]])==null?void 0:me.info)==null?void 0:ct.meta)==null?void 0:ut.suggestion_prompts)??((Wt=l[16])==null?void 0:Wt.default_prompt_suggestions)??[]}}),Y.$on("select",l[30]),{c(){e=V("div"),D&&D.c(),t=$(),n=V("div"),o=V("div"),s=V("div"),r=V("div"),i=V("div");for(let ve=0;ve<L.length;ve+=1)L[ve].c();c=$(),u=V("div"),G.c(),h=$(),d=V("div"),_=V("div"),ce&&ce.c(),v=$(),g=V("div"),te(w.$$.fragment),A=$(),F=V("div"),j=V("div"),te(Y.$$.fragment),this.h()},l(ve){e=N(ve,"DIV",{class:!0});var Ue=S(e);D&&D.l(Ue),t=ee(Ue),n=N(Ue,"DIV",{class:!0});var st=S(n);o=N(st,"DIV",{class:!0});var yt=S(o);s=N(yt,"DIV",{class:!0});var ft=S(s);r=N(ft,"DIV",{class:!0});var rt=S(r);i=N(rt,"DIV",{class:!0});var At=S(i);for(let ue=0;ue<L.length;ue+=1)L[ue].l(At);At.forEach(p),rt.forEach(p),c=ee(ft),u=N(ft,"DIV",{class:!0});var _e=S(u);G.l(_e),_e.forEach(p),ft.forEach(p),h=ee(yt),d=N(yt,"DIV",{class:!0});var St=S(d);_=N(St,"DIV",{});var pt=S(_);ce&&ce.l(pt),pt.forEach(p),St.forEach(p),v=ee(yt),g=N(yt,"DIV",{class:!0});var ht=S(g);oe(w.$$.fragment,ht),ht.forEach(p),yt.forEach(p),st.forEach(p),A=ee(Ue),F=N(Ue,"DIV",{class:!0});var be=S(F);j=N(be,"DIV",{class:!0});var Vt=S(j);oe(Y.$$.fragment,Vt),Vt.forEach(p),be.forEach(p),Ue.forEach(p),this.h()},h(){m(i,"class","flex -space-x-4 mb-0.5"),m(r,"class","flex flex-shrink-0 justify-center"),m(u,"class","text-3xl sm:text-4xl line-clamp-1"),m(s,"class","flex flex-row justify-center gap-3 sm:gap-3.5 w-fit px-5"),m(d,"class","flex mt-1 mb-2"),m(g,"class",O="text-base font-normal xl:translate-x-6 md:max-w-3xl w-full py-3 "+(l[1]?"mt-2":"")),m(o,"class","w-full flex flex-col justify-center items-center"),m(n,"class","w-full text-3xl text-gray-800 dark:text-gray-100 font-medium text-center flex items-center gap-4 font-primary"),m(j,"class","mx-5"),m(F,"class","mx-auto max-w-2xl font-primary"),m(e,"class","m-auto w-full max-w-6xl px-2 xl:px-20 translate-y-6 py-24 text-center")},m(ve,Ue){B(ve,e,Ue),D&&D.m(e,null),k(e,t),k(e,n),k(n,o),k(o,s),k(s,r),k(r,i);for(let st=0;st<L.length;st+=1)L[st]&&L[st].m(i,null);k(s,c),k(s,u),G.m(u,null),k(o,h),k(o,d),k(d,_),ce&&ce.m(_,null),k(o,v),k(o,g),ne(w,g,null),k(e,A),k(e,F),k(F,j),ne(Y,j,null),K=!0},p(ve,Ue){var ft,rt,At,_e,St,pt,ht;if(ve[14]?D?Ue[0]&16384&&C(D,1):(D=Ci(ve),D.c(),C(D,1),D.m(e,t)):D&&(Ae(),P(D,1,1,()=>{D=null}),Le()),Ue[0]&14336){W=wt(ve[11]);let be;for(be=0;be<W.length;be+=1){const Vt=Di(ve,W,be);L[be]?(L[be].p(Vt,Ue),C(L[be],1)):(L[be]=Mi(Vt),L[be].c(),C(L[be],1),L[be].m(i,null))}for(Ae(),be=W.length;be<L.length;be+=1)R(be);Le()}Q===(Q=X(ve))&&G?G.p(ve,Ue):(G.d(1),G=Q(ve),G&&(G.c(),G.m(u,null))),((At=(rt=(ft=ve[11][ve[12]])==null?void 0:ft.info)==null?void 0:rt.meta)==null?void 0:At.description)??null?ce?(ce.p(ve,Ue),Ue[0]&6144&&C(ce,1)):(ce=Ti(ve),ce.c(),C(ce,1),ce.m(_,null)):ce&&(Ae(),P(ce,1,1,()=>{ce=null}),Le());const st={};Ue[0]&1024&&(st.history=ve[10]),Ue[0]&512&&(st.selectedModels=ve[9]),Ue[0]&64&&(st.transparentBackground=ve[6]),Ue[0]&256&&(st.stopResponse=ve[8]),Ue[0]&128&&(st.createMessagePair=ve[7]),Ue[0]&8192&&(st.placeholder=ve[13].t("How can I help you today?")),!y&&Ue[0]&8&&(y=!0,st.files=ve[3],xe(()=>y=!1)),!E&&Ue[0]&4&&(E=!0,st.prompt=ve[2],xe(()=>E=!1)),!z&&Ue[0]&1&&(z=!0,st.autoScroll=ve[0],xe(()=>z=!1)),!T&&Ue[0]&16&&(T=!0,st.selectedToolIds=ve[4],xe(()=>T=!1)),!I&&Ue[0]&32&&(I=!0,st.webSearchEnabled=ve[5],xe(()=>I=!1)),!H&&Ue[0]&2&&(H=!0,st.atSelectedModel=ve[1],xe(()=>H=!1)),w.$set(st),(!K||Ue[0]&2&&O!==(O="text-base font-normal xl:translate-x-6 md:max-w-3xl w-full py-3 "+(ve[1]?"mt-2":"")))&&m(g,"class",O);const yt={};Ue[0]&71680&&(yt.suggestionPrompts=((pt=(St=(_e=ve[11][ve[12]])==null?void 0:_e.info)==null?void 0:St.meta)==null?void 0:pt.suggestion_prompts)??((ht=ve[16])==null?void 0:ht.default_prompt_suggestions)??[]),Y.$set(yt)},i(ve){if(!K){C(D);for(let Ue=0;Ue<W.length;Ue+=1)C(L[Ue]);ve&&(a||sl(()=>{a=to(i,Ml,{duration:100}),a.start()})),ve&&(f||sl(()=>{f=to(u,Ml,{duration:100}),f.start()})),C(ce),ve&&(b||sl(()=>{b=to(_,Ml,{duration:100,delay:50}),b.start()})),C(w.$$.fragment,ve),C(Y.$$.fragment,ve),ve&&(M||sl(()=>{M=to(F,Ml,{duration:200,delay:200}),M.start()})),K=!0}},o(ve){P(D),L=L.filter(Boolean);for(let Ue=0;Ue<L.length;Ue+=1)P(L[Ue]);P(ce),P(w.$$.fragment,ve),P(Y.$$.fragment,ve),K=!1},d(ve){ve&&p(e),D&&D.d(),Cn(L,ve),G.d(),ce&&ce.d(),le(w),le(Y)}}}const Ni=l=>l.name.toUpperCase();function h_(l,e,t){let n,o,s,r,i;ie(l,yl,L=>t(20,n=L)),ie(l,Mo,L=>t(14,s=L)),ie(l,al,L=>t(15,r=L)),ie(l,ql,L=>t(16,i=L));const a=on(),c=Ut("i18n");ie(l,c,L=>t(13,o=L));let{transparentBackground:u=!1}=e,{createMessagePair:f}=e,{stopResponse:h}=e,{autoScroll:d=!1}=e,{atSelectedModel:_}=e,{selectedModels:b}=e,{history:v}=e,{prompt:g=""}=e,{files:w=[]}=e,{selectedToolIds:y=[]}=e,{webSearchEnabled:E=!1}=e,z=[];const T=async L=>{let R=L;if(L.includes("{{CLIPBOARD}}")){const G=await navigator.clipboard.readText().catch(ce=>(nt.error(o.t("Failed to read clipboard contents")),"{{CLIPBOARD}}"));R=L.replaceAll("{{CLIPBOARD}}",G),console.log("Clipboard text:",G,R)}t(2,g=R),console.log(g),await qe();const X=document.getElementById("chat-input-container"),Q=document.getElementById("chat-input");X&&(X.style.height="",X.style.height=Math.min(X.scrollHeight,200)+"px"),await qe(),Q&&(Q.focus(),Q.dispatchEvent(new Event("input"))),await qe()};let I=0;hn(()=>{});const H=L=>{t(12,I=L)};function O(L){w=L,t(3,w)}function A(L){g=L,t(2,g)}function F(L){d=L,t(0,d)}function j(L){y=L,t(4,y)}function Y(L){E=L,t(5,E)}function M(L){_=L,t(1,_)}const K=L=>{a("upload",L.detail)},D=L=>{a("submit",L.detail)},W=L=>{T(L.detail)};return l.$$set=L=>{"transparentBackground"in L&&t(6,u=L.transparentBackground),"createMessagePair"in L&&t(7,f=L.createMessagePair),"stopResponse"in L&&t(8,h=L.stopResponse),"autoScroll"in L&&t(0,d=L.autoScroll),"atSelectedModel"in L&&t(1,_=L.atSelectedModel),"selectedModels"in L&&t(9,b=L.selectedModels),"history"in L&&t(10,v=L.history),"prompt"in L&&t(2,g=L.prompt),"files"in L&&t(3,w=L.files),"selectedToolIds"in L&&t(4,y=L.selectedToolIds),"webSearchEnabled"in L&&t(5,E=L.webSearchEnabled)},l.$$.update=()=>{l.$$.dirty[0]&1049088&&t(11,z=b.map(L=>n.find(R=>R.id===L))),l.$$.dirty[0]&2560&&b.length>0&&t(12,I=z.length-1)},[d,_,g,w,y,E,u,f,h,b,v,z,I,o,s,r,i,a,c,T,n,H,O,A,F,j,Y,M,K,D,W]}class m_ extends Ve{constructor(e){super(),Ne(this,e,h_,d_,Be,{transparentBackground:6,createMessagePair:7,stopResponse:8,autoScroll:0,atSelectedModel:1,selectedModels:9,history:10,prompt:2,files:3,selectedToolIds:4,webSearchEnabled:5},null,[-1,-1])}}const{document:Go}=Ri;function zi(l,e,t){const n=l.slice();return n[113]=e[t],n}function Pi(l){var h;let e,t,n,o,s,r,i,a,c=(((h=l[25])==null?void 0:h.backgroundImageUrl)??null)&&Oi(l);function u(d){l[52](d)}let f={chat:{id:l[24],chat:{title:l[28],models:l[1],system:l[25].system??void 0,params:l[23],history:l[19],timestamp:Date.now()}},title:l[28],shareEnabled:!!l[19].currentId,initNewChat:l[37]};return l[1]!==void 0&&(f.selectedModels=l[1]),n=new Fd({props:f}),l[51](n),We.push(()=>$e(n,"selectedModels",u)),r=new lc({props:{direction:"horizontal",class:"w-full h-full",$$slots:{default:[b_]},$$scope:{ctx:l}}}),{c(){e=V("div"),c&&c.c(),t=$(),te(n.$$.fragment),s=$(),te(r.$$.fragment),this.h()},l(d){e=N(d,"DIV",{class:!0,id:!0});var _=S(e);c&&c.l(_),t=ee(_),oe(n.$$.fragment,_),s=ee(_),oe(r.$$.fragment,_),_.forEach(p),this.h()},h(){m(e,"class",i="h-screen max-h-[100dvh] "+(l[30]?"md:max-w-[calc(100%-260px)]":"")+" w-full max-w-full flex flex-col"),m(e,"id","chat-container")},m(d,_){B(d,e,_),c&&c.m(e,null),k(e,t),ne(n,e,null),k(e,s),ne(r,e,null),a=!0},p(d,_){var g;((g=d[25])==null?void 0:g.backgroundImageUrl)??null?c?c.p(d,_):(c=Oi(d),c.c(),c.m(e,t)):c&&(c.d(1),c=null);const b={};_[0]&327680002&&(b.chat={id:d[24],chat:{title:d[28],models:d[1],system:d[25].system??void 0,params:d[23],history:d[19],timestamp:Date.now()}}),_[0]&268435456&&(b.title=d[28]),_[0]&524288&&(b.shareEnabled=!!d[19].currentId),!o&&_[0]&2&&(o=!0,b.selectedModels=d[1],xe(()=>o=!1)),n.$set(b);const v={};_[0]&268370166|_[1]&1|_[3]&8388608&&(v.$$scope={dirty:_,ctx:d}),r.$set(v),(!a||_[0]&1073741824&&i!==(i="h-screen max-h-[100dvh] "+(d[30]?"md:max-w-[calc(100%-260px)]":"")+" w-full max-w-full flex flex-col"))&&m(e,"class",i)},i(d){a||(C(n.$$.fragment,d),C(r.$$.fragment,d),a=!0)},o(d){P(n.$$.fragment,d),P(r.$$.fragment,d),a=!1},d(d){d&&p(e),c&&c.d(),l[51](null),le(n),le(r)}}}function Oi(l){let e,t,n,o;return{c(){e=V("div"),n=$(),o=V("div"),this.h()},l(s){e=N(s,"DIV",{class:!0,style:!0}),S(e).forEach(p),n=ee(s),o=N(s,"DIV",{class:!0}),S(o).forEach(p),this.h()},h(){m(e,"class",t="absolute "+(l[30]?"md:max-w-[calc(100%-260px)] md:translate-x-[260px]":"")+" top-0 left-0 w-full h-full bg-cover bg-center bg-no-repeat"),tt(e,"background-image","url("+l[25].backgroundImageUrl+")"),m(o,"class","absolute top-0 left-0 w-full h-full bg-gradient-to-t from-white to-white/85 dark:from-gray-900 dark:to-[#171717]/90 z-0")},m(s,r){B(s,e,r),B(s,n,r),B(s,o,r)},p(s,r){r[0]&1073741824&&t!==(t="absolute "+(s[30]?"md:max-w-[calc(100%-260px)] md:translate-x-[260px]":"")+" top-0 left-0 w-full h-full bg-cover bg-center bg-no-repeat")&&m(e,"class",t),r[0]&33554432&&tt(e,"background-image","url("+s[25].backgroundImageUrl+")")},d(s){s&&(p(e),p(n),p(o))}}}function Hi(l){let e,t,n,o=wt(l[31].filter(l[53])),s=[];for(let i=0;i<o.length;i+=1)s[i]=Bi(zi(l,o,i));const r=i=>P(s[i],1,1,()=>{s[i]=null});return{c(){e=V("div"),t=V("div");for(let i=0;i<s.length;i+=1)s[i].c();this.h()},l(i){e=N(i,"DIV",{class:!0});var a=S(e);t=N(a,"DIV",{class:!0});var c=S(t);for(let u=0;u<s.length;u+=1)s[u].l(c);c.forEach(p),a.forEach(p),this.h()},h(){m(t,"class","flex flex-col gap-1 w-full"),m(e,"class","absolute top-12 left-0 right-0 w-full z-30")},m(i,a){B(i,e,a),k(e,t);for(let c=0;c<s.length;c+=1)s[c]&&s[c].m(t,null);n=!0},p(i,a){if(a[1]&1){o=wt(i[31].filter(i[53]));let c;for(c=0;c<o.length;c+=1){const u=zi(i,o,c);s[c]?(s[c].p(u,a),C(s[c],1)):(s[c]=Bi(u),s[c].c(),C(s[c],1),s[c].m(t,null))}for(Ae(),c=o.length;c<s.length;c+=1)r(c);Le()}},i(i){if(!n){for(let a=0;a<o.length;a+=1)C(s[a]);n=!0}},o(i){s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)P(s[a]);n=!1},d(i){i&&p(e),Cn(s,i)}}}function Bi(l){let e,t;return e=new Lu({props:{banner:l[113]}}),e.$on("dismiss",l[54]),{c(){te(e.$$.fragment)},l(n){oe(e.$$.fragment,n)},m(n,o){ne(e,n,o),t=!0},p(n,o){const s={};o[1]&1&&(s.banner=n[113]),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){le(e,n)}}}function g_(l){var g;let e,t,n,o,s,r,i,a,c;function u(w){l[68](w)}function f(w){l[69](w)}function h(w){l[70](w)}function d(w){l[71](w)}function _(w){l[72](w)}function b(w){l[73](w)}let v={history:l[19],selectedModels:l[1],transparentBackground:((g=l[25])==null?void 0:g.backgroundImageUrl)??!1,stopResponse:l[43],createMessagePair:l[40]};return l[22]!==void 0&&(v.files=l[22]),l[20]!==void 0&&(v.prompt=l[20]),l[6]!==void 0&&(v.autoScroll=l[6]),l[17]!==void 0&&(v.selectedToolIds=l[17]),l[18]!==void 0&&(v.webSearchEnabled=l[18]),l[2]!==void 0&&(v.atSelectedModel=l[2]),t=new m_({props:v}),We.push(()=>$e(t,"files",u)),We.push(()=>$e(t,"prompt",f)),We.push(()=>$e(t,"autoScroll",h)),We.push(()=>$e(t,"selectedToolIds",d)),We.push(()=>$e(t,"webSearchEnabled",_)),We.push(()=>$e(t,"atSelectedModel",b)),t.$on("upload",l[74]),t.$on("submit",l[75]),{c(){e=V("div"),te(t.$$.fragment),this.h()},l(w){e=N(w,"DIV",{class:!0});var y=S(e);oe(t.$$.fragment,y),y.forEach(p),this.h()},h(){m(e,"class","overflow-auto w-full h-full flex items-center")},m(w,y){B(w,e,y),ne(t,e,null),c=!0},p(w,y){var z;const E={};y[0]&524288&&(E.history=w[19]),y[0]&2&&(E.selectedModels=w[1]),y[0]&33554432&&(E.transparentBackground=((z=w[25])==null?void 0:z.backgroundImageUrl)??!1),!n&&y[0]&4194304&&(n=!0,E.files=w[22],xe(()=>n=!1)),!o&&y[0]&1048576&&(o=!0,E.prompt=w[20],xe(()=>o=!1)),!s&&y[0]&64&&(s=!0,E.autoScroll=w[6],xe(()=>s=!1)),!r&&y[0]&131072&&(r=!0,E.selectedToolIds=w[17],xe(()=>r=!1)),!i&&y[0]&262144&&(i=!0,E.webSearchEnabled=w[18],xe(()=>i=!1)),!a&&y[0]&4&&(a=!0,E.atSelectedModel=w[2],xe(()=>a=!1)),t.$set(E)},i(w){c||(C(t.$$.fragment,w),c=!0)},o(w){P(t.$$.fragment,w),c=!1},d(w){w&&p(e),le(t)}}}function __(l){var L;let e,t,n,o,s,r,i,a,c,u,f,h,d,_,b,v,g,w=l[26].t("LLMs can make mistakes. Verify important information.")+"",y,E,z,T;function I(R){l[55](R)}function H(R){l[56](R)}function O(R){l[57](R)}let A={chatId:l[24],selectedModels:l[1],sendPrompt:l[42],showMessage:l[34],submitMessage:l[44],continueResponse:l[46],regenerateResponse:l[45],mergeResponses:l[47],chatActionHandler:l[39],bottomPadding:l[22].length>0};l[19]!==void 0&&(A.history=l[19]),l[6]!==void 0&&(A.autoScroll=l[6]),l[20]!==void 0&&(A.prompt=l[20]),n=new Qa({props:A}),We.push(()=>$e(n,"history",I)),We.push(()=>$e(n,"autoScroll",H)),We.push(()=>$e(n,"prompt",O));function F(R){l[60](R)}function j(R){l[61](R)}function Y(R){l[62](R)}function M(R){l[63](R)}function K(R){l[64](R)}function D(R){l[65](R)}let W={history:l[19],selectedModels:l[1],transparentBackground:((L=l[25])==null?void 0:L.backgroundImageUrl)??!1,stopResponse:l[43],createMessagePair:l[40]};return l[22]!==void 0&&(W.files=l[22]),l[20]!==void 0&&(W.prompt=l[20]),l[6]!==void 0&&(W.autoScroll=l[6]),l[17]!==void 0&&(W.selectedToolIds=l[17]),l[18]!==void 0&&(W.webSearchEnabled=l[18]),l[2]!==void 0&&(W.atSelectedModel=l[2]),c=new ea({props:W}),We.push(()=>$e(c,"files",F)),We.push(()=>$e(c,"prompt",j)),We.push(()=>$e(c,"autoScroll",Y)),We.push(()=>$e(c,"selectedToolIds",M)),We.push(()=>$e(c,"webSearchEnabled",K)),We.push(()=>$e(c,"atSelectedModel",D)),c.$on("upload",l[66]),c.$on("submit",l[67]),{c(){e=V("div"),t=V("div"),te(n.$$.fragment),i=$(),a=V("div"),te(c.$$.fragment),v=$(),g=V("div"),y=Ce(w),this.h()},l(R){e=N(R,"DIV",{class:!0,id:!0});var X=S(e);t=N(X,"DIV",{class:!0});var Q=S(t);oe(n.$$.fragment,Q),Q.forEach(p),X.forEach(p),i=ee(R),a=N(R,"DIV",{class:!0});var G=S(a);oe(c.$$.fragment,G),v=ee(G),g=N(G,"DIV",{class:!0});var ce=S(g);y=Me(ce,w),ce.forEach(p),G.forEach(p),this.h()},h(){m(t,"class","h-full w-full flex flex-col"),m(e,"class","pb-2.5 flex flex-col justify-between w-full flex-auto overflow-auto h-0 max-w-full z-10 scrollbar-hidden"),m(e,"id","messages-container"),m(g,"class","absolute bottom-1.5 text-xs text-gray-500 text-center line-clamp-1 right-0 left-0"),m(a,"class","pb-[1.6rem]")},m(R,X){B(R,e,X),k(e,t),ne(n,t,null),l[58](e),B(R,i,X),B(R,a,X),ne(c,a,null),k(a,v),k(a,g),k(g,y),E=!0,z||(T=ke(e,"scroll",l[59]),z=!0)},p(R,X){var ce;const Q={};X[0]&16777216&&(Q.chatId=R[24]),X[0]&2&&(Q.selectedModels=R[1]),X[0]&4194304&&(Q.bottomPadding=R[22].length>0),!o&&X[0]&524288&&(o=!0,Q.history=R[19],xe(()=>o=!1)),!s&&X[0]&64&&(s=!0,Q.autoScroll=R[6],xe(()=>s=!1)),!r&&X[0]&1048576&&(r=!0,Q.prompt=R[20],xe(()=>r=!1)),n.$set(Q);const G={};X[0]&524288&&(G.history=R[19]),X[0]&2&&(G.selectedModels=R[1]),X[0]&33554432&&(G.transparentBackground=((ce=R[25])==null?void 0:ce.backgroundImageUrl)??!1),!u&&X[0]&4194304&&(u=!0,G.files=R[22],xe(()=>u=!1)),!f&&X[0]&1048576&&(f=!0,G.prompt=R[20],xe(()=>f=!1)),!h&&X[0]&64&&(h=!0,G.autoScroll=R[6],xe(()=>h=!1)),!d&&X[0]&131072&&(d=!0,G.selectedToolIds=R[17],xe(()=>d=!1)),!_&&X[0]&262144&&(_=!0,G.webSearchEnabled=R[18],xe(()=>_=!1)),!b&&X[0]&4&&(b=!0,G.atSelectedModel=R[2],xe(()=>b=!1)),c.$set(G),(!E||X[0]&67108864)&&w!==(w=R[26].t("LLMs can make mistakes. Verify important information.")+"")&&He(y,w)},i(R){E||(C(n.$$.fragment,R),C(c.$$.fragment,R),E=!0)},o(R){P(n.$$.fragment,R),P(c.$$.fragment,R),E=!1},d(R){R&&(p(e),p(i),p(a)),le(n),l[58](null),le(c),z=!1,T()}}}function p_(l){let e,t,n,o,s,r,i=l[31].length>0&&!l[19].currentId&&!l[24]&&l[1].length<=1&&Hi(l);const a=[__,g_],c=[];function u(f,h){var d;return h[0]&34078720&&(n=null),n==null&&(n=((d=f[25])==null?void 0:d.landingPageMode)==="chat"||f[38](f[19].currentId).length>0),n?0:1}return o=u(l,[-1,-1,-1,-1]),s=c[o]=a[o](l),{c(){i&&i.c(),e=$(),t=V("div"),s.c(),this.h()},l(f){i&&i.l(f),e=ee(f),t=N(f,"DIV",{class:!0});var h=S(t);s.l(h),h.forEach(p),this.h()},h(){m(t,"class","flex flex-col flex-auto z-10 w-full")},m(f,h){i&&i.m(f,h),B(f,e,h),B(f,t,h),c[o].m(t,null),r=!0},p(f,h){f[31].length>0&&!f[19].currentId&&!f[24]&&f[1].length<=1?i?(i.p(f,h),h[0]&17301506|h[1]&1&&C(i,1)):(i=Hi(f),i.c(),C(i,1),i.m(e.parentNode,e)):i&&(Ae(),P(i,1,1,()=>{i=null}),Le());let d=o;o=u(f,h),o===d?c[o].p(f,h):(Ae(),P(c[d],1,1,()=>{c[d]=null}),Le(),s=c[o],s?s.p(f,h):(s=c[o]=a[o](f),s.c()),C(s,1),s.m(t,null))},i(f){r||(C(i),C(s),r=!0)},o(f){P(i),P(s),r=!1},d(f){f&&(p(e),p(t)),i&&i.d(f),c[o].d()}}}function b_(l){var v;let e,t,n,o,s,r,i,a,c;e=new ji({props:{defaultSize:50,class:"h-full flex w-full relative",$$slots:{default:[p_]},$$scope:{ctx:l}}});function u(g){l[78](g)}function f(g){l[79](g)}function h(g){l[80](g)}function d(g){l[81](g)}function _(g){l[82](g)}let b={chatId:l[24],modelId:((v=l[16])==null?void 0:v.at(0))??null,models:l[16].reduce(l[76],[]),submitPrompt:l[41],stopResponse:l[43],showMessage:l[34],eventTarget:l[33]};return l[19]!==void 0&&(b.history=l[19]),l[21]!==void 0&&(b.chatFiles=l[21]),l[23]!==void 0&&(b.params=l[23]),l[22]!==void 0&&(b.files=l[22]),l[4]!==void 0&&(b.pane=l[4]),n=new o_({props:b}),l[77](n),We.push(()=>$e(n,"history",u)),We.push(()=>$e(n,"chatFiles",f)),We.push(()=>$e(n,"params",h)),We.push(()=>$e(n,"files",d)),We.push(()=>$e(n,"pane",_)),{c(){te(e.$$.fragment),t=$(),te(n.$$.fragment)},l(g){oe(e.$$.fragment,g),t=ee(g),oe(n.$$.fragment,g)},m(g,w){ne(e,g,w),B(g,t,w),ne(n,g,w),c=!0},p(g,w){var z;const y={};w[0]&123601094|w[1]&1|w[3]&8388608&&(y.$$scope={dirty:w,ctx:g}),e.$set(y);const E={};w[0]&16777216&&(E.chatId=g[24]),w[0]&65536&&(E.modelId=((z=g[16])==null?void 0:z.at(0))??null),w[0]&134283264&&(E.models=g[16].reduce(g[76],[])),!o&&w[0]&524288&&(o=!0,E.history=g[19],xe(()=>o=!1)),!s&&w[0]&2097152&&(s=!0,E.chatFiles=g[21],xe(()=>s=!1)),!r&&w[0]&8388608&&(r=!0,E.params=g[23],xe(()=>r=!1)),!i&&w[0]&4194304&&(i=!0,E.files=g[22],xe(()=>i=!1)),!a&&w[0]&16&&(a=!0,E.pane=g[4],xe(()=>a=!1)),n.$set(E)},i(g){c||(C(e.$$.fragment,g),C(n.$$.fragment,g),c=!0)},o(g){P(e.$$.fragment,g),P(n.$$.fragment,g),c=!1},d(g){g&&p(t),le(e,g),l[77](null),le(n,g)}}}function v_(l){let e,t,n,o,s,r,i,a,c,u;Go.title=e=`
		`+(l[28]?`${l[28].length>30?`${l[28].slice(0,30)}...`:l[28]} | ${l[29]}`:`${l[29]}`)+`
	`;function f(_){l[48](_)}let h={title:l[10],message:l[11],input:l[12],inputPlaceholder:l[13],inputValue:l[14]};l[9]!==void 0&&(h.show=l[9]),r=new fu({props:h}),We.push(()=>$e(r,"show",f)),r.$on("confirm",l[49]),r.$on("cancel",l[50]);let d=(!l[0]||l[3]&&l[0])&&Pi(l);return{c(){t=$(),n=V("audio"),s=$(),te(r.$$.fragment),a=$(),d&&d.c(),c=Oe(),this.h()},l(_){Ya("svelte-8uu834",Go.head).forEach(p),t=ee(_),n=N(_,"AUDIO",{id:!0,src:!0,style:!0}),S(n).forEach(p),s=ee(_),oe(r.$$.fragment,_),a=ee(_),d&&d.l(_),c=Oe(),this.h()},h(){m(n,"id","audioElement"),Hn(n.src,o="")||m(n,"src",o),tt(n,"display","none")},m(_,b){B(_,t,b),B(_,n,b),B(_,s,b),ne(r,_,b),B(_,a,b),d&&d.m(_,b),B(_,c,b),u=!0},p(_,b){(!u||b[0]&805306368)&&e!==(e=`
		`+(_[28]?`${_[28].length>30?`${_[28].slice(0,30)}...`:_[28]} | ${_[29]}`:`${_[29]}`)+`
	`)&&(Go.title=e);const v={};b[0]&1024&&(v.title=_[10]),b[0]&2048&&(v.message=_[11]),b[0]&4096&&(v.input=_[12]),b[0]&8192&&(v.inputPlaceholder=_[13]),b[0]&16384&&(v.inputValue=_[14]),!i&&b[0]&512&&(i=!0,v.show=_[9],xe(()=>i=!1)),r.$set(v),!_[0]||_[3]&&_[0]?d?(d.p(_,b),b[0]&9&&C(d,1)):(d=Pi(_),d.c(),C(d,1),d.m(c.parentNode,c)):d&&(Ae(),P(d,1,1,()=>{d=null}),Le())},i(_){u||(C(r.$$.fragment,_),C(d),u=!0)},o(_){P(r.$$.fragment,_),P(d),u=!1},d(_){_&&(p(t),p(n),p(s),p(a),p(c)),le(r,_),d&&d.d(_)}}}function w_(l,e,t){let n,o,s,r,i,a,c,u,f,h,d,_,b,v,g,w,y;ie(l,gl,U=>t(87,n=U)),ie(l,Mo,U=>t(88,o=U)),ie(l,pl,U=>t(24,s=U)),ie(l,Gn,U=>t(25,r=U)),ie(l,yl,U=>t(27,a=U)),ie(l,ql,U=>t(89,c=U)),ie(l,vn,U=>t(90,u=U)),ie(l,ac,U=>t(91,f=U)),ie(l,al,U=>t(92,h=U)),ie(l,oc,U=>t(93,d=U)),ie(l,Co,U=>t(94,_=U)),ie(l,vl,U=>t(95,b=U)),ie(l,no,U=>t(28,v=U)),ie(l,Zi,U=>t(29,g=U)),ie(l,go,U=>t(30,w=U)),ie(l,cc,U=>t(31,y=U));const E=Ut("i18n");ie(l,E,U=>t(26,i=U));let{chatIdProp:z=""}=e,T=!1;const I=new EventTarget;let H,O,A=!1,F=!0,j,Y,M=!1,K="",D="",W=!1,L="",R="",X=null,Q,G=[""],ce,se=[],ye=[],Se=!1,re=null,q={messages:{},currentId:null},Ee="",ae=[],Ie=[],ge={};const _t=()=>{G.length===0||G.length===1&&G[0]===""||(sessionStorage.selectedModels=JSON.stringify(G),console.log("saveSessionSelectedModels",G,sessionStorage.selectedModels))},me=async()=>{var de,fe;if(b||vl.set(await os(localStorage.token)),G.length!==1)return;const U=a.find(pe=>pe.id===G[0]);U&&t(17,ye=(((fe=(de=U==null?void 0:U.info)==null?void 0:de.meta)==null?void 0:fe.toolIds)??[]).filter(pe=>b.find(De=>De.id===pe)))},ct=async U=>{const de=JSON.parse(JSON.stringify(s));let fe=JSON.parse(JSON.stringify(U.id)),pe=q.messages[fe].childrenIds;for(;pe.length!==0;)fe=pe.at(-1),pe=q.messages[fe].childrenIds;t(19,q.currentId=fe,q),await qe(),await qe(),await qe();const De=document.getElementById(`message-${U.id}`);De&&De.scrollIntoView({behavior:"smooth"}),await qe(),Z(de)},ut=async(U,de)=>{var fe,pe;if(U.chat_id===s){await qe(),console.log(U);let De=q.messages[U.message_id];const x=((fe=U==null?void 0:U.data)==null?void 0:fe.type)??null,Te=((pe=U==null?void 0:U.data)==null?void 0:pe.data)??null;if(x==="status")De!=null&&De.statusHistory?De.statusHistory.push(Te):De.statusHistory=[Te];else if(x==="source"||x==="citation")if((Te==null?void 0:Te.type)==="code_execution"){De!=null&&De.code_executions||(De.code_executions=[]);const Ye=De.code_executions.findIndex(vt=>vt.id===Te.id);Ye!==-1?De.code_executions[Ye]=Te:De.code_executions.push(Te),De.code_executions=De.code_executions}else De!=null&&De.sources?De.sources.push(Te):De.sources=[Te];else if(x==="message")De.content+=Te.content;else if(x==="replace")De.content=Te.content;else if(x==="action"){if(Te.action==="continue"){const Ye=document.getElementById("continue-response-button");Ye&&Ye.click()}}else if(x==="confirmation")t(15,X=de),t(12,W=!1),t(9,M=!0),t(10,K=Te.title),t(11,D=Te.message);else if(x==="execute"){t(15,X=de);try{const vt=await new Function(`return (async () => { ${Te.code} })()`)();de&&de(vt)}catch(Ye){console.error("Error executing code:",Ye)}}else x==="input"?(t(15,X=de),t(12,W=!0),t(9,M=!0),t(10,K=Te.title),t(11,D=Te.message),t(13,L=Te.placeholder),t(14,R=(Te==null?void 0:Te.value)??"")):console.log("Unknown message type",Te);t(19,q.messages[U.message_id]=De,q)}},Wt=async U=>{if(U.origin===window.origin){if(U.data.type==="input:prompt"){console.debug(U.data.text);const de=document.getElementById("chat-input");de&&(t(20,Ee=U.data.text),de.focus())}U.data.type==="action:submit"&&(console.debug(U.data.text),Ee!==""&&(await qe(),ht(Ee))),U.data.type==="input:prompt:submit"&&(console.debug(U.data.text),Ee!==""&&(await qe(),ht(U.data.text)))}};hn(async()=>{console.log("mounted"),window.addEventListener("message",Wt),f==null||f.on("chat-events",ut),s?o&&await jo("/"):Q=pl.subscribe(async de=>{de||await st()}),Rt.subscribe(async de=>{if(H&&!_)try{de?O.openPane():H.collapse()}catch{}de||(vn.set(!1),Jn.set(!1),Yn.set(!1))});const U=document.getElementById("chat-input");U==null||U.focus(),_l.subscribe(()=>{})}),il(()=>{Q==null||Q(),window.removeEventListener("message",Wt),f==null||f.off("chat-events")});const ve=async U=>{console.log(U);const de={type:"doc",name:U,collection_name:"",status:"uploading",url:U,error:""};try{t(22,Ie=[...Ie,de]);const fe=await Sc(localStorage.token,"",U);fe&&(de.status="uploaded",de.collection_name=fe.collection_name,de.file={...fe.file,...de.file},t(22,Ie))}catch(fe){t(22,Ie=Ie.filter(pe=>pe.name!==U)),nt.error(JSON.stringify(fe))}},Ue=async U=>{console.log(U);const de={type:"doc",name:U,collection_name:"",status:"uploading",context:"full",url:U,error:""};try{t(22,Ie=[...Ie,de]);const fe=await Dc(localStorage.token,U);fe&&(de.status="uploaded",de.collection_name=fe.collection_name,de.file={...fe.file,...de.file},t(22,Ie))}catch(fe){t(22,Ie=Ie.filter(pe=>pe.name!==U)),nt.error(fe)}},st=async()=>{var fe,pe,De,x;if(sessionStorage.selectedModels)t(1,G=JSON.parse(sessionStorage.selectedModels)),sessionStorage.removeItem("selectedModels");else if(d.url.searchParams.get("models"))t(1,G=(fe=d.url.searchParams.get("models"))==null?void 0:fe.split(","));else if(d.url.searchParams.get("model")){const Te=(pe=d.url.searchParams.get("model"))==null?void 0:pe.split(",");if(Te.length===1)if(a.find(vt=>vt.id===Te[0]))t(1,G=Te);else{const vt=document.getElementById("model-selector-0-button");if(vt){vt.click(),await qe();const it=document.getElementById("model-search-input");it&&(it.focus(),it.value=Te[0],it.dispatchEvent(new Event("input")))}}else t(1,G=Te)}else r!=null&&r.models?t(1,G=r==null?void 0:r.models):c!=null&&c.default_models&&(console.log((c==null?void 0:c.default_models.split(","))??""),t(1,G=c==null?void 0:c.default_models.split(",")));t(1,G=G.filter(Te=>a.map(Ye=>Ye.id).includes(Te))),(G.length===0||G.length===1&&G[0]==="")&&(a.length>0?t(1,G=[a[0].id]):t(1,G=[""])),await Rt.set(!1),await vn.set(!1),await Jn.set(!1),await Yn.set(!1),d.url.pathname.includes("/c/")&&window.history.replaceState(q.state,"","/"),t(6,F=!0),await pl.set(""),await no.set(""),t(19,q={messages:{},currentId:null}),t(21,ae=[]),t(23,ge={}),d.url.searchParams.get("youtube")&&Ue(`https://www.youtube.com/watch?v=${d.url.searchParams.get("youtube")}`),d.url.searchParams.get("web-search")==="true"&&t(18,Se=!0),d.url.searchParams.get("tools")?t(17,ye=(De=d.url.searchParams.get("tools"))==null?void 0:De.split(",").map(Te=>Te.trim()).filter(Te=>Te)):d.url.searchParams.get("tool-ids")&&t(17,ye=(x=d.url.searchParams.get("tool-ids"))==null?void 0:x.split(",").map(Te=>Te.trim()).filter(Te=>Te)),d.url.searchParams.get("call")==="true"&&(vn.set(!0),Rt.set(!0)),d.url.searchParams.get("q")&&(t(20,Ee=d.url.searchParams.get("q")??""),Ee&&(await qe(),ht(Ee))),t(1,G=G.map(Te=>a.map(Ye=>Ye.id).includes(Te)?Te:""));const U=await ys(localStorage.token);U?Gn.set(U.ui):Gn.set(JSON.parse(localStorage.getItem("settings")??"{}"));const de=document.getElementById("chat-input");setTimeout(()=>de==null?void 0:de.focus(),0)},yt=async()=>{if(pl.set(z),re=await Qo(localStorage.token,s).catch(async U=>(await jo("/"),null)),re){await vs(localStorage.token,s).catch(async de=>[]);const U=re.chat;if(U){console.log(U),t(1,G=((U==null?void 0:U.models)??void 0)!==void 0?U.models:[U.models??""]),t(19,q=((U==null?void 0:U.history)??void 0)!==void 0?U.history:bc(U.messages)),no.set(U.title);const de=await ys(localStorage.token);return de?await Gn.set(de.ui):await Gn.set(JSON.parse(localStorage.getItem("settings")??"{}")),t(23,ge=(U==null?void 0:U.params)??{}),t(21,ae=(U==null?void 0:U.files)??[]),t(6,F=!0),await qe(),q.currentId&&t(19,q.messages[q.currentId].done=!0,q),await qe(),!0}else return null}},ft=async()=>{await qe(),j&&t(7,j.scrollTop=j.scrollHeight,j)},rt=U=>{if(U===null)return[];const de=q.messages[U];return de!=null&&de.parentId?[...rt(de.parentId),de]:[de]},At=async(U,de,fe,pe)=>{await Ja.run({querySelector:".mermaid"});const De=await Rc(localStorage.token,{model:de,messages:pe.map(x=>({id:x.id,role:x.role,content:x.content,info:x.info?x.info:void 0,timestamp:x.timestamp,...x.sources?{sources:x.sources}:{}})),chat_id:U,session_id:f==null?void 0:f.id,id:fe}).catch(x=>(nt.error(x),pe.at(-1).error={content:x},null));if(De!==null)for(const x of De.messages)t(19,q.messages[x.id]={...q.messages[x.id],...q.messages[x.id].content!==x.content?{originalContent:q.messages[x.id].content}:{},...x},q);await qe(),s==U&&(o||(re=await oo(localStorage.token,U,{models:G,messages:pe,history:q,params:ge,files:ae}),gl.set(1),await _l.set(await Dl(localStorage.token,n))))},_e=async(U,de,fe,pe,De=null)=>{const x=rt(pe),Te=await Uc(localStorage.token,de,{model:fe,messages:x.map(Ye=>({id:Ye.id,role:Ye.role,content:Ye.content,info:Ye.info?Ye.info:void 0,timestamp:Ye.timestamp,...Ye.sources?{sources:Ye.sources}:{}})),...De?{event:De}:{},chat_id:U,session_id:f==null?void 0:f.id,id:pe}).catch(Ye=>(nt.error(Ye),x.at(-1).error={content:Ye},null));if(Te!==null)for(const Ye of Te.messages)t(19,q.messages[Ye.id]={...q.messages[Ye.id],...q.messages[Ye.id].content!==Ye.content?{originalContent:q.messages[Ye.id].content}:{},...Ye},q);s==U&&(o||(re=await oo(localStorage.token,U,{models:G,messages:x,history:q,params:ge,files:ae}),gl.set(1),await _l.set(await Dl(localStorage.token,n))))},St=async(U,de="")=>setInterval(()=>{f==null||f.emit("usage",{action:"chat",model:U,chat_id:de})},1e3),pt=async U=>{if(t(20,Ee=""),G.length===0)nt.error(i.t("Model not selected"));else{const de=G[0],fe=a.filter(it=>it.id===de).at(0),pe=rt(q.currentId),De=pe.length!==0?pe.at(-1):null,x=Cl(),Te=Cl(),Ye={id:x,parentId:De?De.id:null,childrenIds:[Te],role:"user",content:U||`[PROMPT] ${x}`,timestamp:Math.floor(Date.now()/1e3)},vt={id:Te,parentId:x,childrenIds:[],role:"assistant",content:`[RESPONSE] ${Te}`,done:!0,model:de,modelName:fe.name??fe.id,modelIdx:0,timestamp:Math.floor(Date.now()/1e3)};De&&(De.childrenIds.push(x),t(19,q.messages[De.id]=De,q)),t(19,q.messages[x]=Ye,q),t(19,q.messages[Te]=vt,q),t(19,q.currentId=Te,q),await qe(),F&&ft(),pe.length===0?await Xt():await Z(s)}},ht=async(U,{_raw:de=!1}={})=>{var Mt,at,Ot;console.log("submitPrompt",U,s);const fe=rt(q.currentId),pe=G.map(Lt=>a.map(Qt=>Qt.id).includes(Lt)?Lt:"");if(JSON.stringify(G)!==JSON.stringify(pe)&&t(1,G=pe),U===""){nt.error(i.t("Please enter a prompt"));return}if(G.includes("")){nt.error(i.t("Model not selected"));return}if(fe.length!=0&&fe.at(-1).done!=!0)return;if(fe.length!=0&&fe.at(-1).error){nt.error(i.t("Oops! There was an error in the previous response."));return}if(Ie.length>0&&Ie.filter(Lt=>Lt.type!=="image"&&Lt.status==="uploading").length>0){nt.error(i.t("Oops! There are files still uploading. Please wait for the upload to complete."));return}if((((Mt=c==null?void 0:c.file)==null?void 0:Mt.max_count)??null)!==null&&Ie.length+ae.length>((at=c==null?void 0:c.file)==null?void 0:at.max_count)){nt.error(i.t("You can only chat with a maximum of {{maxCount}} file(s) at a time.",{maxCount:(Ot=c==null?void 0:c.file)==null?void 0:Ot.max_count}));return}let De=[];t(20,Ee=""),await qe();const x=document.getElementById("chat-input-container");x&&(x.value="",x.style.height="");const Te=JSON.parse(JSON.stringify(Ie));ae.push(...Te.filter(Lt=>["doc","file","collection"].includes(Lt.type))),t(21,ae=ae.filter((Lt,Qt,mn)=>mn.findIndex(gn=>JSON.stringify(gn)===JSON.stringify(Lt))===Qt)),t(22,Ie=[]),t(20,Ee="");let Ye=Cl(),vt={id:Ye,parentId:fe.length!==0?fe.at(-1).id:null,childrenIds:[],role:"user",content:U,files:Te.length>0?Te:void 0,timestamp:Math.floor(Date.now()/1e3),models:G};t(19,q.messages[Ye]=vt,q),t(19,q.currentId=Ye,q),fe.length!==0&&q.messages[fe.at(-1).id].childrenIds.push(Ye),await qe();const it=document.getElementById("chat-input");return it==null||it.focus(),_t(),De=await be(U,Ye,{newChat:!0}),De},be=async(U,de,{modelId:fe=null,modelIdx:pe=null,newChat:De=!1}={})=>{De&&q.messages[q.currentId].parentId===null&&q.messages[q.currentId].role==="user"&&await Xt();let x=[],Te=fe?[fe]:ce!==void 0?[ce.id]:G;const Ye={};for(const[it,Mt]of Te.entries()){const at=a.filter(Ot=>Ot.id===Mt).at(0);if(at){let Ot=Cl(),Lt={parentId:de,id:Ot,childrenIds:[],role:"assistant",content:"",model:at.id,modelName:at.name??at.id,modelIdx:pe||it,userContext:null,timestamp:Math.floor(Date.now()/1e3)};t(19,q.messages[Ot]=Lt,q),t(19,q.currentId=Ot,q),de!==null&&t(19,q.messages[de].childrenIds=[...q.messages[de].childrenIds,Ot],q),Ye[`${Mt}-${pe||it}`]=Ot}}await qe();const vt=JSON.parse(JSON.stringify(s));return await Promise.all(Te.map(async(it,Mt)=>{var Ot,Lt,Qt;console.log("modelId",it);const at=a.filter(mn=>mn.id===it).at(0);if(at){rt(de).some(an=>{var cn;return(cn=an.files)==null?void 0:cn.some(sn=>sn.type==="image")})&&!(((Qt=(Lt=(Ot=at.info)==null?void 0:Ot.meta)==null?void 0:Lt.capabilities)==null?void 0:Qt.vision)??!0)&&nt.error(i.t("Model {{modelName}} is not vision capable",{modelName:at.name??at.id}));let _n=Ye[`${it}-${pe||Mt}`],kn=q.messages[_n],pn=null;if(((r==null?void 0:r.memory)??!1)&&pn===null){const an=await Pc(localStorage.token,U).catch(cn=>(nt.error(cn),null));an&&(an.documents[0].length>0&&(pn=an.documents[0].reduce((cn,sn,bn)=>{const Rn=an.metadatas[0][bn].created_at,In=new Date(Rn*1e3).toISOString().split("T")[0];return`${cn}${bn+1}. [${In}]. ${sn}
`},"")),console.log(pn))}kn.userContext=pn;const Nn=await St(at.id,vt);ft(),Se&&await Jt(at.id,de,_n);let En=null;(at==null?void 0:at.owned_by)==="ollama"?En=await Vt(at,U,_n,vt):at&&(En=await ue(at,U,_n,vt)),x.push(En),Nn&&clearInterval(Nn)}else nt.error(i.t("Model {{modelId}} not found",{modelId:it}))})),gl.set(1),_l.set(await Dl(localStorage.token,n)),x},Vt=async(U,de,fe,pe)=>{var mn,gn,_n,kn,pn,Nn,En,an,cn,sn,bn,Rn,In,nl,Un,ll;let De=null;const x=q.messages[fe],Te=q.messages[x.parentId];await qe(),ft();const Ye=[ge!=null&&ge.system||r.system||((x==null?void 0:x.userContext)??null)?{role:"system",content:`${bs((ge==null?void 0:ge.system)??(r==null?void 0:r.system)??"",h.name,r!=null&&r.userLocation?await ks(localStorage.token):void 0)}${(x==null?void 0:x.userContext)??null?`

User Context:
${(x==null?void 0:x.userContext)??""}`:""}`}:void 0,...rt(fe)].filter(Xe=>{var dt;return(dt=Xe==null?void 0:Xe.content)==null?void 0:dt.trim()}).map(Xe=>{var fn,mt;const dt={role:Xe.role,content:((fn=Xe==null?void 0:Xe.merged)==null?void 0:fn.content)??Xe.content},rn=(mt=Xe.files)==null?void 0:mt.filter(Tt=>Tt.type==="image").map(Tt=>Tt.url.slice(Tt.url.indexOf(",")+1));return rn&&rn.length>0&&Xe.role==="user"&&(dt.images=rn),dt});let vt=-1;Ye.forEach((Xe,dt)=>{Xe.images&&(vt=dt)}),Ye.forEach((Xe,dt)=>{dt!==vt&&delete Xe.images});let it=JSON.parse(JSON.stringify(ae));(((gn=(mn=U==null?void 0:U.info)==null?void 0:mn.meta)==null?void 0:gn.knowledge)??!1)&&(x.statusHistory=[{action:"knowledge_search",description:i.t('Searching Knowledge for "{{searchQuery}}"',{searchQuery:Te.content}),done:!1}],it.push(...U.info.meta.knowledge.map(Xe=>Xe!=null&&Xe.collection_name?{id:Xe.collection_name,name:Xe.name,legacy:!0}:Xe!=null&&Xe.collection_names?{name:Xe.name,type:"collection",collection_names:Xe.collection_names,legacy:!0}:Xe)),t(19,q.messages[fe]=x,q)),it.push(...((Te==null?void 0:Te.files)??[]).filter(Xe=>["doc","file","collection"].includes(Xe.type)),...((x==null?void 0:x.files)??[]).filter(Xe=>["web_search_results"].includes(Xe.type))),it=it.filter((Xe,dt,rn)=>rn.findIndex(fn=>JSON.stringify(fn)===JSON.stringify(Xe))===dt),ft(),I.dispatchEvent(new CustomEvent("chat:start",{detail:{id:fe}})),await qe();const Mt=((kn=(_n=U==null?void 0:U.info)==null?void 0:_n.params)==null?void 0:kn.stream_response)??((pn=r==null?void 0:r.params)==null?void 0:pn.stream_response)??(ge==null?void 0:ge.stream_response)??!0,[at,Ot]=await vc(localStorage.token,{stream:Mt,model:U.id,messages:Ye,options:{...(r==null?void 0:r.params)??{},...ge,stop:(ge==null?void 0:ge.stop)??((Nn=r==null?void 0:r.params)==null?void 0:Nn.stop)??void 0?((ge==null?void 0:ge.stop.split(",").map(Xe=>Xe.trim()))??r.params.stop).map(Xe=>decodeURIComponent(JSON.parse('"'+Xe.replace(/\"/g,'\\"')+'"'))):void 0,num_predict:(ge==null?void 0:ge.max_tokens)??((En=r==null?void 0:r.params)==null?void 0:En.max_tokens)??void 0,repeat_penalty:(ge==null?void 0:ge.frequency_penalty)??((an=r==null?void 0:r.params)==null?void 0:an.frequency_penalty)??void 0},format:r.requestFormat??void 0,keep_alive:r.keepAlive??void 0,tool_ids:ye.length>0?ye:void 0,files:it.length>0?it:void 0,session_id:f==null?void 0:f.id,chat_id:s,id:fe});if(at&&at.ok)if(Mt){console.log("controller",Ot);const Xe=at.body.pipeThrough(new TextDecoderStream).pipeThrough(pc(`
`)).getReader();for(;;){const{value:dt,done:rn}=await Xe.read();if(rn||A||pe!==s){x.done=!0,t(19,q.messages[fe]=x,q),A&&Ot.abort("User: Stop Response"),De=x.content;break}try{let fn=dt.split(`
`);for(const mt of fn)if(mt!==""){console.log(mt);let Tt=JSON.parse(mt);if("sources"in Tt){x.sources=Tt.sources,(((sn=(cn=U==null?void 0:U.info)==null?void 0:cn.meta)==null?void 0:sn.knowledge)??!1)&&(x.statusHistory=x.statusHistory.filter(un=>un.action!=="knowledge_search"));continue}if("detail"in Tt)throw Tt;if(Tt.done==!1){if(x.content==""&&Tt.message.content==`
`)continue;{x.content+=Tt.message.content,navigator.vibrate&&((r==null?void 0:r.hapticFeedback)??!1)&&navigator.vibrate(5);const un=lo(x.content,((Rn=(bn=c==null?void 0:c.audio)==null?void 0:bn.tts)==null?void 0:Rn.split_on)??"punctuation");un.pop(),un.length>0&&un[un.length-1]!==x.lastSentence&&(x.lastSentence=un[un.length-1],I.dispatchEvent(new CustomEvent("chat",{detail:{id:fe,content:un[un.length-1]}}))),t(19,q.messages[fe]=x,q)}}else{if(x.done=!0,x.content==""&&(x.error={code:400,content:"Oops! No text generated from Ollama, Please try again."}),x.context=Tt.context??null,x.info={total_duration:Tt.total_duration,load_duration:Tt.load_duration,sample_count:Tt.sample_count,sample_duration:Tt.sample_duration,prompt_eval_count:Tt.prompt_eval_count,prompt_eval_duration:Tt.prompt_eval_duration,eval_count:Tt.eval_count,eval_duration:Tt.eval_duration},t(19,q.messages[fe]=x,q),r.notificationEnabled&&!document.hasFocus()){const un=new Notification(`${U.id}`,{body:x.content,icon:`${bl}/static/favicon.png`})}((r==null?void 0:r.responseAutoCopy)??!1)&&_o(x.content),r.responseAutoPlayback&&!u&&(await qe(),(In=document.getElementById(`speak-button-${x.id}`))==null||In.click())}}}catch(fn){console.log(fn),"detail"in fn&&nt.error(fn.detail);break}F&&ft()}}else{const Xe=await at.json();console.log(Xe),x.content=Xe.message.content,x.info={eval_count:Xe.eval_count,eval_duration:Xe.eval_duration,load_duration:Xe.load_duration,prompt_eval_count:Xe.prompt_eval_count,prompt_eval_duration:Xe.prompt_eval_duration,total_duration:Xe.total_duration},x.done=!0}else{if(at!==null){const Xe=await at.json();console.log(Xe),"detail"in Xe?(nt.error(Xe.detail),x.error={content:Xe.detail}):(nt.error(Xe.error),x.error={content:Xe.error})}else nt.error(i.t("Uh-oh! There was an issue connecting to {{provider}}.",{provider:"Ollama"})),x.error={content:i.t("Uh-oh! There was an issue connecting to {{provider}}.",{provider:"Ollama"})};x.done=!0,x.statusHistory&&(x.statusHistory=x.statusHistory.filter(Xe=>Xe.action!=="knowledge_search"))}await Z(pe),t(19,q.messages[fe]=x,q),await At(pe,U.id,fe,rt(fe)),A=!1,await qe();let Lt=((ll=lo(x.content,((Un=(nl=c==null?void 0:c.audio)==null?void 0:nl.tts)==null?void 0:Un.split_on)??"punctuation"))==null?void 0:ll.at(-1))??"";Lt&&I.dispatchEvent(new CustomEvent("chat",{detail:{id:fe,content:Lt}})),I.dispatchEvent(new CustomEvent("chat:finish",{detail:{id:fe,content:x.content}})),F&&ft();const Qt=rt(fe);if(Qt.length==2&&Qt.at(-1).content!==""&&G[0]===U.id){window.history.replaceState(q.state,"",`/c/${pe}`);const Xe=await Nt(Qt);await Ht(pe,Xe),((r==null?void 0:r.autoTags)??!0)&&await zt(Qt)}return De},ue=async(U,de,fe,pe)=>{var Mt,at,Ot,Lt,Qt,mn,gn,_n,kn,pn,Nn,En,an,cn,sn,bn,Rn,In,nl,Un,ll,Xe;let De=null;const x=q.messages[fe],Te=q.messages[x.parentId];let Ye=JSON.parse(JSON.stringify(ae));(((at=(Mt=U==null?void 0:U.info)==null?void 0:Mt.meta)==null?void 0:at.knowledge)??!1)&&(x.statusHistory=[{action:"knowledge_search",description:i.t('Searching Knowledge for "{{searchQuery}}"',{searchQuery:Te.content}),done:!1}],Ye.push(...U.info.meta.knowledge.map(dt=>dt!=null&&dt.collection_name?{id:dt.collection_name,name:dt.name,legacy:!0}:dt!=null&&dt.collection_names?{name:dt.name,type:"collection",collection_names:dt.collection_names,legacy:!0}:dt)),t(19,q.messages[fe]=x,q)),Ye.push(...((Te==null?void 0:Te.files)??[]).filter(dt=>["doc","file","collection"].includes(dt.type)),...((x==null?void 0:x.files)??[]).filter(dt=>["web_search_results"].includes(dt.type))),Ye=Ye.filter((dt,rn,fn)=>fn.findIndex(mt=>JSON.stringify(mt)===JSON.stringify(dt))===rn),ft(),I.dispatchEvent(new CustomEvent("chat:start",{detail:{id:fe}})),await qe();try{const dt=((Lt=(Ot=U==null?void 0:U.info)==null?void 0:Ot.params)==null?void 0:Lt.stream_response)??((Qt=r==null?void 0:r.params)==null?void 0:Qt.stream_response)??(ge==null?void 0:ge.stream_response)??!0,[rn,fn]=await Ec(localStorage.token,{stream:dt,model:U.id,...dt&&(((_n=(gn=(mn=U.info)==null?void 0:mn.meta)==null?void 0:gn.capabilities)==null?void 0:_n.usage)??!1)?{stream_options:{include_usage:!0}}:{},messages:[ge!=null&&ge.system||r.system||((x==null?void 0:x.userContext)??null)?{role:"system",content:`${bs((ge==null?void 0:ge.system)??(r==null?void 0:r.system)??"",h.name,r!=null&&r.userLocation?await ks(localStorage.token):void 0)}${(x==null?void 0:x.userContext)??null?`

User Context:
${(x==null?void 0:x.userContext)??""}`:""}`}:void 0,...rt(fe)].filter(mt=>{var Tt;return(Tt=mt==null?void 0:mt.content)==null?void 0:Tt.trim()}).map((mt,Tt,un)=>{var $l,Rl,Ul;return{role:mt.role,...(($l=mt.files)==null?void 0:$l.filter(ol=>ol.type==="image").length)>0&&mt.role==="user"?{content:[{type:"text",text:((Rl=mt==null?void 0:mt.merged)==null?void 0:Rl.content)??mt.content},...mt.files.filter(ol=>ol.type==="image").map(ol=>({type:"image_url",image_url:{url:ol.url}}))]}:{content:((Ul=mt==null?void 0:mt.merged)==null?void 0:Ul.content)??mt.content}}}),seed:(ge==null?void 0:ge.seed)??((kn=r==null?void 0:r.params)==null?void 0:kn.seed)??void 0,stop:(ge==null?void 0:ge.stop)??((pn=r==null?void 0:r.params)==null?void 0:pn.stop)??void 0?((ge==null?void 0:ge.stop.split(",").map(mt=>mt.trim()))??r.params.stop).map(mt=>decodeURIComponent(JSON.parse('"'+mt.replace(/\"/g,'\\"')+'"'))):void 0,temperature:(ge==null?void 0:ge.temperature)??((Nn=r==null?void 0:r.params)==null?void 0:Nn.temperature)??void 0,top_p:(ge==null?void 0:ge.top_p)??((En=r==null?void 0:r.params)==null?void 0:En.top_p)??void 0,frequency_penalty:(ge==null?void 0:ge.frequency_penalty)??((an=r==null?void 0:r.params)==null?void 0:an.frequency_penalty)??void 0,max_tokens:(ge==null?void 0:ge.max_tokens)??((cn=r==null?void 0:r.params)==null?void 0:cn.max_tokens)??void 0,tool_ids:ye.length>0?ye:void 0,files:Ye.length>0?Ye:void 0,session_id:f==null?void 0:f.id,chat_id:s,id:fe},`${bl}/api`);if(await qe(),ft(),rn&&rn.ok&&rn.body){if(dt){const mt=await Ss(rn.body,r.splitLargeChunks);for await(const Tt of mt){const{value:un,done:$l,sources:Rl,selectedModelId:Ul,error:ol,usage:Ro}=Tt;if(ol){await Re(ol,null,U,x);break}if($l||A||pe!==s){x.done=!0,t(19,q.messages[fe]=x,q),A&&fn.abort("User: Stop Response"),De=x.content;break}if(Ro&&(x.info={...Ro,openai:!0,usage:Ro}),Ul){x.selectedModelId=Ul,x.arena=!0;continue}if(Rl){x.sources=Rl,(((bn=(sn=U==null?void 0:U.info)==null?void 0:sn.meta)==null?void 0:bn.knowledge)??!1)&&(x.statusHistory=x.statusHistory.filter(Wn=>Wn.action!=="knowledge_search"));continue}if(!(x.content==""&&un==`
`)){{x.content+=un,navigator.vibrate&&((r==null?void 0:r.hapticFeedback)??!1)&&navigator.vibrate(5);const Wn=lo(x.content,((In=(Rn=c==null?void 0:c.audio)==null?void 0:Rn.tts)==null?void 0:In.split_on)??"punctuation");Wn.pop(),Wn.length>0&&Wn[Wn.length-1]!==x.lastSentence&&(x.lastSentence=Wn[Wn.length-1],I.dispatchEvent(new CustomEvent("chat",{detail:{id:fe,content:Wn[Wn.length-1]}}))),t(19,q.messages[fe]=x,q)}F&&ft()}}}else{const mt=await rn.json();console.log(mt),x.content=mt.choices[0].message.content,x.info={...mt.usage,openai:!0},x.done=!0}if(r.notificationEnabled&&!document.hasFocus()){const mt=new Notification(`${U.id}`,{body:x.content,icon:`${bl}/static/favicon.png`})}r.responseAutoCopy&&_o(x.content),r.responseAutoPlayback&&!u&&(await qe(),(nl=document.getElementById(`speak-button-${x.id}`))==null||nl.click())}else await Re(null,rn,U,x)}catch(dt){await Re(dt,null,U,x)}await Z(pe),t(19,q.messages[fe]=x,q),await At(pe,U.id,fe,rt(fe)),A=!1,await qe();let vt=((Xe=lo(x.content,((ll=(Un=c==null?void 0:c.audio)==null?void 0:Un.tts)==null?void 0:ll.split_on)??"punctuation"))==null?void 0:Xe.at(-1))??"";vt&&I.dispatchEvent(new CustomEvent("chat",{detail:{id:fe,content:vt}})),I.dispatchEvent(new CustomEvent("chat:finish",{detail:{id:fe,content:x.content}})),F&&ft();const it=rt(fe);if(it.length==2&&G[0]===U.id){window.history.replaceState(q.state,"",`/c/${pe}`);const dt=await Nt(it);await Ht(pe,dt),((r==null?void 0:r.autoTags)??!0)&&await zt(it)}return De},Re=async(U,de,fe,pe)=>{let De="",x;U?x=U:de!==null&&(x=await de.json()),console.error(x),"detail"in x?(nt.error(x.detail),De=x.detail):"error"in x?"message"in x.error?(nt.error(x.error.message),De=x.error.message):(nt.error(x.error),De=x.error):"message"in x&&(nt.error(x.message),De=x.message),pe.error={content:i.t("Uh-oh! There was an issue connecting to {{provider}}.",{provider:fe.name??fe.id})+`
`+De},pe.done=!0,pe.statusHistory&&(pe.statusHistory=pe.statusHistory.filter(Te=>Te.action!=="knowledge_search")),t(19,q.messages[pe.id]=pe,q)},je=()=>{A=!0,console.log("stopResponse")},Ge=async(U,de)=>{let fe=de,pe=Cl(),De={id:pe,parentId:U,childrenIds:[],role:"user",content:fe,models:G};U!==null&&t(19,q.messages[U].childrenIds=[...q.messages[U].childrenIds,pe],q),t(19,q.messages[pe]=De,q),t(19,q.currentId=pe,q),await qe(),await be(fe,pe)},kt=async U=>{if(console.log("regenerateResponse"),q.currentId){let de=q.messages[U.parentId],fe=de.content;((de==null?void 0:de.models)??[...G]).length==1?await be(fe,de.id):await be(fe,de.id,{modelId:U.model,modelIdx:U.modelIdx})}},Dt=async()=>{console.log("continueResponse");const U=JSON.parse(JSON.stringify(s));if(q.currentId&&q.messages[q.currentId].done==!0){const de=q.messages[q.currentId];de.done=!1,await qe();const fe=a.filter(pe=>pe.id===((de==null?void 0:de.selectedModelId)??de.model)).at(0);fe&&((fe==null?void 0:fe.owned_by)==="openai"?await ue(fe,q.messages[de.parentId].content,de.id,U):await Vt(fe,q.messages[de.parentId].content,de.id,U))}},Ct=async(U,de,fe)=>{console.log("mergeResponses",U,de);const pe=q.messages[U],De={status:!0,content:""};pe.merged=De,t(19,q.messages[U]=pe,q);try{const[x,Te]=await Wc(localStorage.token,pe.model,q.messages[pe.parentId].content,de);if(x&&x.ok&&x.body){const Ye=await Ss(x.body,r.splitLargeChunks);for await(const vt of Ye){const{value:it,done:Mt,sources:at,error:Ot,usage:Lt}=vt;if(Ot||Mt)break;De.content==""&&it==`
`||(De.content+=it,t(19,q.messages[U]=pe,q),F&&ft())}await Z(fe)}else console.error(x)}catch(x){console.error(x)}},Nt=async U=>{var fe;const de=U.filter(pe=>pe.role==="user").at(-1);if(((fe=r==null?void 0:r.title)==null?void 0:fe.auto)??!0){const pe=G[0];return await Bc(localStorage.token,pe,U,s).catch(x=>(console.error(x),(de==null?void 0:de.content)??"New Chat"))}else return(de==null?void 0:de.content)??"New Chat"},Ht=async(U,de)=>{U===s&&no.set(de),o||(re=await oo(localStorage.token,U,{title:de}),gl.set(1),await _l.set(await Dl(localStorage.token,n)))},zt=async U=>{if(!o){const de=await vs(localStorage.token,s);de.length>0&&await wc(localStorage.token,s)&&_s.set(await ws(localStorage.token)),U.at(-1);const fe=G[0];let pe=await Ac(localStorage.token,fe,U,s).catch(De=>(console.error(De),[]));pe=pe.filter(De=>!de.find(x=>x.id===De.replaceAll(" ","_").toLowerCase())),console.log(pe);for(const De of pe)await yc(localStorage.token,s,De);re=await Qo(localStorage.token,s),_s.set(await ws(localStorage.token))}},Jt=async(U,de,fe)=>{const pe=q.messages[fe],De=q.messages[de],x=rt(q.currentId);pe.statusHistory=[{done:!1,action:"web_search",description:i.t("Generating search query")}],t(19,q.messages[fe]=pe,q);const Te=De.content;let Ye=await Lc(localStorage.token,U,x.filter(Mt=>{var at;return(at=Mt==null?void 0:Mt.content)==null?void 0:at.trim()}),Te).catch(Mt=>(console.log(Mt),[Te]));if(Ye.length===0){pe.statusHistory.push({done:!0,error:!0,action:"web_search",description:i.t("No search query generated")}),t(19,q.messages[fe]=pe,q);return}const vt=Ye[0];pe.statusHistory.push({done:!1,action:"web_search",description:i.t('Searching "{{searchQuery}}"',{searchQuery:vt})}),t(19,q.messages[fe]=pe,q);const it=await Ic(localStorage.token,vt).catch(Mt=>(console.log(Mt),nt.error(Mt),null));it?(pe.statusHistory.push({done:!0,action:"web_search",description:i.t("Searched {{count}} sites",{count:it.filenames.length}),query:vt,urls:it.filenames}),((pe==null?void 0:pe.files)??!0)&&(pe.files=[]),pe.files.push({collection_name:it.collection_name,name:vt,type:"web_search_results",urls:it.filenames}),t(19,q.messages[fe]=pe,q)):(pe.statusHistory.push({done:!0,error:!0,action:"web_search",description:"No search results found"}),t(19,q.messages[fe]=pe,q))},Xt=async()=>{o?await pl.set("local"):(re=await kc(localStorage.token,{id:s,title:i.t("New Chat"),models:G,system:r.system??void 0,params:ge,history:q,messages:rt(q.currentId),tags:[],timestamp:Date.now()}),gl.set(1),await _l.set(await Dl(localStorage.token,n)),await pl.set(re.id)),await qe()},Z=async U=>{s==U&&(o||(re=await oo(localStorage.token,U,{models:G,history:q,messages:rt(q.currentId),params:ge,files:ae}),gl.set(1),await _l.set(await Dl(localStorage.token,n))))};function Fe(U){M=U,t(9,M)}const Ke=U=>{U.detail?X(U.detail):X(!0)},Ze=()=>{X(!1)};function Qe(U){We[U?"unshift":"push"](()=>{Y=U,t(8,Y)})}function et(U){G=U,t(1,G)}const jt=U=>U.dismissible?!JSON.parse(localStorage.getItem("dismissedBannerIds")??"[]").includes(U.id):!0,Et=U=>{const de=U.detail;localStorage.setItem("dismissedBannerIds",JSON.stringify([de,...JSON.parse(localStorage.getItem("dismissedBannerIds")??"[]")].filter(fe=>y.find(pe=>pe.id===fe))))};function Ft(U){q=U,t(19,q)}function Xn(U){F=U,t(6,F)}function $n(U){Ee=U,t(20,Ee)}function cl(U){We[U?"unshift":"push"](()=>{j=U,t(7,j)})}const Mn=U=>{t(6,F=j.scrollHeight-j.scrollTop<=j.clientHeight+5)};function kl(U){Ie=U,t(22,Ie)}function ul(U){Ee=U,t(20,Ee)}function wn(U){F=U,t(6,F)}function An(U){ye=U,t(17,ye)}function Kn(U){Se=U,t(18,Se)}function el(U){ce=U,t(2,ce)}const fl=async U=>{const{type:de,data:fe}=U.detail;de==="web"?await ve(fe):de==="youtube"&&await Ue(fe)},Tn=async U=>{U.detail&&(await qe(),ht(U.detail.replaceAll(`

`,`
`)))};function El(U){Ie=U,t(22,Ie)}function dl(U){Ee=U,t(20,Ee)}function yn(U){F=U,t(6,F)}function Ln(U){ye=U,t(17,ye)}function qn(U){Se=U,t(18,Se)}function tl(U){ce=U,t(2,ce)}const hl=async U=>{const{type:de,data:fe}=U.detail;de==="web"?await ve(fe):de==="youtube"&&await Ue(fe)},Vn=async U=>{U.detail&&(await qe(),ht(U.detail.replaceAll(`

`,`
`)))},Il=(U,de,fe,pe)=>{const De=a.find(x=>x.id===de);return De?[...U,De]:U};function ml(U){We[U?"unshift":"push"](()=>{O=U,t(5,O)})}function J(U){q=U,t(19,q)}function Kt(U){ae=U,t(21,ae)}function Pt(U){ge=U,t(23,ge)}function Sl(U){Ie=U,t(22,Ie)}function xl(U){H=U,t(4,H)}return l.$$set=U=>{"chatIdProp"in U&&t(0,z=U.chatIdProp)},l.$$.update=()=>{l.$$.dirty[0]&6&&t(16,se=ce!==void 0?[ce.id]:G),l.$$.dirty[0]&1&&z&&(async()=>{if(console.log(z),z&&await yt()){await qe(),t(3,T=!0),window.setTimeout(()=>ft(),0);const U=document.getElementById("chat-input");U==null||U.focus()}else await jo("/")})(),l.$$.dirty[0]&3&&G&&z!==""&&_t(),l.$$.dirty[0]&2&&G&&me()},[z,G,ce,T,H,O,F,j,Y,M,K,D,W,L,R,X,se,ye,Se,q,Ee,ae,Ie,ge,s,r,i,a,v,g,w,y,E,I,ct,ve,Ue,st,rt,_e,pt,ht,be,je,Ge,kt,Dt,Ct,Fe,Ke,Ze,Qe,et,jt,Et,Ft,Xn,$n,cl,Mn,kl,ul,wn,An,Kn,el,fl,Tn,El,dl,yn,Ln,qn,tl,hl,Vn,Il,ml,J,Kt,Pt,Sl,xl]}class jp extends Ve{constructor(e){super(),Ne(this,e,w_,v_,Be,{chatIdProp:0},null,[-1,-1,-1,-1])}}function y_(l){let e,t,n,o=l[1].t("Keyboard shortcuts")+"",s,r,i,a='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5"><path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"></path></svg>',c,u,f,h,d,_,b=l[1].t("Open new chat")+"",v,g,w,y='<div class="h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">Ctrl/âŒ˜</div> <div class="h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">Shift</div> <div class="h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">O</div>',E,z,T,I=l[1].t("Focus chat input")+"",H,O,A,F='<div class="h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">Shift</div> <div class="h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">Esc</div>',j,Y,M,K=l[1].t("Copy last code block")+"",D,W,L,R='<div class="h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">Ctrl/âŒ˜</div> <div class="h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">Shift</div> <div class="h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">;</div>',X,Q,G,ce=l[1].t("Copy last response")+"",se,ye,Se,re='<div class="h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">Ctrl/âŒ˜</div> <div class="h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">Shift</div> <div class="h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">C</div>',q,Ee,ae,Ie,ge=l[1].t("Toggle settings")+"",_t,me,ct,ut='<div class="h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">Ctrl/âŒ˜</div> <div class="h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">.</div>',Wt,ve,Ue,st=l[1].t("Toggle sidebar")+"",yt,ft,rt,At='<div class="h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">Ctrl/âŒ˜</div> <div class="h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">Shift</div> <div class="h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">S</div>',_e,St,pt,ht=l[1].t("Delete chat")+"",be,Vt,ue,Re='<div class="h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">Ctrl/âŒ˜</div> <div class="h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">Shift</div> <div class="h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">âŒ«/Delete</div>',je,Ge,kt,Dt=l[1].t("Show shortcuts")+"",Ct,Nt,Ht,zt='<div class="h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">Ctrl/âŒ˜</div> <div class="h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">/</div>',Jt,Xt,Z,Fe=l[1].t("Input commands")+"",Ke,Ze,Qe,et,jt,Et,Ft,Xn=l[1].t("Attach file")+"",$n,cl,Mn,kl='<div class="h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">#</div>',ul,wn,An,Kn=l[1].t("Add custom prompt")+"",el,fl,Tn,El='<div class="h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">/</div>',dl,yn,Ln,qn=l[1].t("Select model")+"",tl,hl,Vn,Il='<div class="h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">@</div>',ml,J;return{c(){e=V("div"),t=V("div"),n=V("div"),s=Ce(o),r=$(),i=V("button"),i.innerHTML=a,c=$(),u=V("div"),f=V("div"),h=V("div"),d=V("div"),_=V("div"),v=Ce(b),g=$(),w=V("div"),w.innerHTML=y,E=$(),z=V("div"),T=V("div"),H=Ce(I),O=$(),A=V("div"),A.innerHTML=F,j=$(),Y=V("div"),M=V("div"),D=Ce(K),W=$(),L=V("div"),L.innerHTML=R,X=$(),Q=V("div"),G=V("div"),se=Ce(ce),ye=$(),Se=V("div"),Se.innerHTML=re,q=$(),Ee=V("div"),ae=V("div"),Ie=V("div"),_t=Ce(ge),me=$(),ct=V("div"),ct.innerHTML=ut,Wt=$(),ve=V("div"),Ue=V("div"),yt=Ce(st),ft=$(),rt=V("div"),rt.innerHTML=At,_e=$(),St=V("div"),pt=V("div"),be=Ce(ht),Vt=$(),ue=V("div"),ue.innerHTML=Re,je=$(),Ge=V("div"),kt=V("div"),Ct=Ce(Dt),Nt=$(),Ht=V("div"),Ht.innerHTML=zt,Jt=$(),Xt=V("div"),Z=V("div"),Ke=Ce(Fe),Ze=$(),Qe=V("div"),et=V("div"),jt=V("div"),Et=V("div"),Ft=V("div"),$n=Ce(Xn),cl=$(),Mn=V("div"),Mn.innerHTML=kl,ul=$(),wn=V("div"),An=V("div"),el=Ce(Kn),fl=$(),Tn=V("div"),Tn.innerHTML=El,dl=$(),yn=V("div"),Ln=V("div"),tl=Ce(qn),hl=$(),Vn=V("div"),Vn.innerHTML=Il,this.h()},l(Kt){e=N(Kt,"DIV",{class:!0});var Pt=S(e);t=N(Pt,"DIV",{class:!0});var Sl=S(t);n=N(Sl,"DIV",{class:!0});var xl=S(n);s=Me(xl,o),xl.forEach(p),r=ee(Sl),i=N(Sl,"BUTTON",{class:!0,"data-svelte-h":!0}),gt(i)!=="svelte-745w2y"&&(i.innerHTML=a),Sl.forEach(p),c=ee(Pt),u=N(Pt,"DIV",{class:!0});var U=S(u);f=N(U,"DIV",{class:!0});var de=S(f);h=N(de,"DIV",{class:!0});var fe=S(h);d=N(fe,"DIV",{class:!0});var pe=S(d);_=N(pe,"DIV",{class:!0});var De=S(_);v=Me(De,b),De.forEach(p),g=ee(pe),w=N(pe,"DIV",{class:!0,"data-svelte-h":!0}),gt(w)!=="svelte-lcmjz9"&&(w.innerHTML=y),pe.forEach(p),E=ee(fe),z=N(fe,"DIV",{class:!0});var x=S(z);T=N(x,"DIV",{class:!0});var Te=S(T);H=Me(Te,I),Te.forEach(p),O=ee(x),A=N(x,"DIV",{class:!0,"data-svelte-h":!0}),gt(A)!=="svelte-1c7wvdz"&&(A.innerHTML=F),x.forEach(p),j=ee(fe),Y=N(fe,"DIV",{class:!0});var Ye=S(Y);M=N(Ye,"DIV",{class:!0});var vt=S(M);D=Me(vt,K),vt.forEach(p),W=ee(Ye),L=N(Ye,"DIV",{class:!0,"data-svelte-h":!0}),gt(L)!=="svelte-1vgtrzt"&&(L.innerHTML=R),Ye.forEach(p),X=ee(fe),Q=N(fe,"DIV",{class:!0});var it=S(Q);G=N(it,"DIV",{class:!0});var Mt=S(G);se=Me(Mt,ce),Mt.forEach(p),ye=ee(it),Se=N(it,"DIV",{class:!0,"data-svelte-h":!0}),gt(Se)!=="svelte-m149u9"&&(Se.innerHTML=re),it.forEach(p),fe.forEach(p),q=ee(de),Ee=N(de,"DIV",{class:!0});var at=S(Ee);ae=N(at,"DIV",{class:!0});var Ot=S(ae);Ie=N(Ot,"DIV",{class:!0});var Lt=S(Ie);_t=Me(Lt,ge),Lt.forEach(p),me=ee(Ot),ct=N(Ot,"DIV",{class:!0,"data-svelte-h":!0}),gt(ct)!=="svelte-1lfzi34"&&(ct.innerHTML=ut),Ot.forEach(p),Wt=ee(at),ve=N(at,"DIV",{class:!0});var Qt=S(ve);Ue=N(Qt,"DIV",{class:!0});var mn=S(Ue);yt=Me(mn,st),mn.forEach(p),ft=ee(Qt),rt=N(Qt,"DIV",{class:!0,"data-svelte-h":!0}),gt(rt)!=="svelte-1egz3pd"&&(rt.innerHTML=At),Qt.forEach(p),_e=ee(at),St=N(at,"DIV",{class:!0});var gn=S(St);pt=N(gn,"DIV",{class:!0});var _n=S(pt);be=Me(_n,ht),_n.forEach(p),Vt=ee(gn),ue=N(gn,"DIV",{class:!0,"data-svelte-h":!0}),gt(ue)!=="svelte-tx0rkx"&&(ue.innerHTML=Re),gn.forEach(p),je=ee(at),Ge=N(at,"DIV",{class:!0});var kn=S(Ge);kt=N(kn,"DIV",{class:!0});var pn=S(kt);Ct=Me(pn,Dt),pn.forEach(p),Nt=ee(kn),Ht=N(kn,"DIV",{class:!0,"data-svelte-h":!0}),gt(Ht)!=="svelte-714lzr"&&(Ht.innerHTML=zt),kn.forEach(p),at.forEach(p),de.forEach(p),U.forEach(p),Jt=ee(Pt),Xt=N(Pt,"DIV",{class:!0});var Nn=S(Xt);Z=N(Nn,"DIV",{class:!0});var En=S(Z);Ke=Me(En,Fe),En.forEach(p),Nn.forEach(p),Ze=ee(Pt),Qe=N(Pt,"DIV",{class:!0});var an=S(Qe);et=N(an,"DIV",{class:!0});var cn=S(et);jt=N(cn,"DIV",{class:!0});var sn=S(jt);Et=N(sn,"DIV",{class:!0});var bn=S(Et);Ft=N(bn,"DIV",{class:!0});var Rn=S(Ft);$n=Me(Rn,Xn),Rn.forEach(p),cl=ee(bn),Mn=N(bn,"DIV",{class:!0,"data-svelte-h":!0}),gt(Mn)!=="svelte-11t0lmd"&&(Mn.innerHTML=kl),bn.forEach(p),ul=ee(sn),wn=N(sn,"DIV",{class:!0});var In=S(wn);An=N(In,"DIV",{class:!0});var nl=S(An);el=Me(nl,Kn),nl.forEach(p),fl=ee(In),Tn=N(In,"DIV",{class:!0,"data-svelte-h":!0}),gt(Tn)!=="svelte-1s9pky1"&&(Tn.innerHTML=El),In.forEach(p),dl=ee(sn),yn=N(sn,"DIV",{class:!0});var Un=S(yn);Ln=N(Un,"DIV",{class:!0});var ll=S(Ln);tl=Me(ll,qn),ll.forEach(p),hl=ee(Un),Vn=N(Un,"DIV",{class:!0,"data-svelte-h":!0}),gt(Vn)!=="svelte-oivy56"&&(Vn.innerHTML=Il),Un.forEach(p),sn.forEach(p),cn.forEach(p),an.forEach(p),Pt.forEach(p),this.h()},h(){m(n,"class","text-lg font-medium self-center"),m(i,"class","self-center"),m(t,"class","flex justify-between dark:text-gray-300 px-5 pt-4"),m(_,"class","text-sm"),m(w,"class","flex space-x-1 text-xs"),m(d,"class","w-full flex justify-between items-center"),m(T,"class","text-sm"),m(A,"class","flex space-x-1 text-xs"),m(z,"class","w-full flex justify-between items-center"),m(M,"class","text-sm"),m(L,"class","flex space-x-1 text-xs"),m(Y,"class","w-full flex justify-between items-center"),m(G,"class","text-sm"),m(Se,"class","flex space-x-1 text-xs"),m(Q,"class","w-full flex justify-between items-center"),m(h,"class","flex flex-col space-y-3 w-full self-start"),m(Ie,"class","text-sm"),m(ct,"class","flex space-x-1 text-xs"),m(ae,"class","w-full flex justify-between items-center"),m(Ue,"class","text-sm"),m(rt,"class","flex space-x-1 text-xs"),m(ve,"class","w-full flex justify-between items-center"),m(pt,"class","text-sm"),m(ue,"class","flex space-x-1 text-xs"),m(St,"class","w-full flex justify-between items-center"),m(kt,"class","text-sm"),m(Ht,"class","flex space-x-1 text-xs"),m(Ge,"class","w-full flex justify-between items-center"),m(Ee,"class","flex flex-col space-y-3 w-full self-start"),m(f,"class","flex flex-col w-full sm:flex-row sm:justify-center sm:space-x-6"),m(u,"class","flex flex-col md:flex-row w-full p-5 md:space-x-4 dark:text-gray-200"),m(Z,"class","text-lg font-medium self-center"),m(Xt,"class","flex justify-between dark:text-gray-300 px-5"),m(Ft,"class","text-sm"),m(Mn,"class","flex space-x-1 text-xs"),m(Et,"class","w-full flex justify-between items-center"),m(An,"class","text-sm"),m(Tn,"class","flex space-x-1 text-xs"),m(wn,"class","w-full flex justify-between items-center"),m(Ln,"class","text-sm"),m(Vn,"class","flex space-x-1 text-xs"),m(yn,"class","w-full flex justify-between items-center"),m(jt,"class","flex flex-col space-y-3 w-full self-start"),m(et,"class","flex flex-col w-full sm:flex-row sm:justify-center sm:space-x-6"),m(Qe,"class","flex flex-col md:flex-row w-full p-5 md:space-x-4 dark:text-gray-200"),m(e,"class","text-gray-700 dark:text-gray-100")},m(Kt,Pt){B(Kt,e,Pt),k(e,t),k(t,n),k(n,s),k(t,r),k(t,i),k(e,c),k(e,u),k(u,f),k(f,h),k(h,d),k(d,_),k(_,v),k(d,g),k(d,w),k(h,E),k(h,z),k(z,T),k(T,H),k(z,O),k(z,A),k(h,j),k(h,Y),k(Y,M),k(M,D),k(Y,W),k(Y,L),k(h,X),k(h,Q),k(Q,G),k(G,se),k(Q,ye),k(Q,Se),k(f,q),k(f,Ee),k(Ee,ae),k(ae,Ie),k(Ie,_t),k(ae,me),k(ae,ct),k(Ee,Wt),k(Ee,ve),k(ve,Ue),k(Ue,yt),k(ve,ft),k(ve,rt),k(Ee,_e),k(Ee,St),k(St,pt),k(pt,be),k(St,Vt),k(St,ue),k(Ee,je),k(Ee,Ge),k(Ge,kt),k(kt,Ct),k(Ge,Nt),k(Ge,Ht),k(e,Jt),k(e,Xt),k(Xt,Z),k(Z,Ke),k(e,Ze),k(e,Qe),k(Qe,et),k(et,jt),k(jt,Et),k(Et,Ft),k(Ft,$n),k(Et,cl),k(Et,Mn),k(jt,ul),k(jt,wn),k(wn,An),k(An,el),k(wn,fl),k(wn,Tn),k(jt,dl),k(jt,yn),k(yn,Ln),k(Ln,tl),k(yn,hl),k(yn,Vn),ml||(J=ke(i,"click",l[3]),ml=!0)},p(Kt,Pt){Pt&2&&o!==(o=Kt[1].t("Keyboard shortcuts")+"")&&He(s,o),Pt&2&&b!==(b=Kt[1].t("Open new chat")+"")&&He(v,b),Pt&2&&I!==(I=Kt[1].t("Focus chat input")+"")&&He(H,I),Pt&2&&K!==(K=Kt[1].t("Copy last code block")+"")&&He(D,K),Pt&2&&ce!==(ce=Kt[1].t("Copy last response")+"")&&He(se,ce),Pt&2&&ge!==(ge=Kt[1].t("Toggle settings")+"")&&He(_t,ge),Pt&2&&st!==(st=Kt[1].t("Toggle sidebar")+"")&&He(yt,st),Pt&2&&ht!==(ht=Kt[1].t("Delete chat")+"")&&He(be,ht),Pt&2&&Dt!==(Dt=Kt[1].t("Show shortcuts")+"")&&He(Ct,Dt),Pt&2&&Fe!==(Fe=Kt[1].t("Input commands")+"")&&He(Ke,Fe),Pt&2&&Xn!==(Xn=Kt[1].t("Attach file")+"")&&He($n,Xn),Pt&2&&Kn!==(Kn=Kt[1].t("Add custom prompt")+"")&&He(el,Kn),Pt&2&&qn!==(qn=Kt[1].t("Select model")+"")&&He(tl,qn)},d(Kt){Kt&&p(e),ml=!1,J()}}}function k_(l){let e,t,n;function o(r){l[4](r)}let s={$$slots:{default:[y_]},$$scope:{ctx:l}};return l[0]!==void 0&&(s.show=l[0]),e=new lu({props:s}),We.push(()=>$e(e,"show",o)),{c(){te(e.$$.fragment)},l(r){oe(e.$$.fragment,r)},m(r,i){ne(e,r,i),n=!0},p(r,[i]){const a={};i&35&&(a.$$scope={dirty:i,ctx:r}),!t&&i&1&&(t=!0,a.show=r[0],xe(()=>t=!1)),e.$set(a)},i(r){n||(C(e.$$.fragment,r),n=!0)},o(r){P(e.$$.fragment,r),n=!1},d(r){le(e,r)}}}function E_(l,e,t){let n;const o=Ut("i18n");ie(l,o,a=>t(1,n=a));let{show:s=!1}=e;const r=()=>{t(0,s=!1)};function i(a){s=a,t(0,s)}return l.$$set=a=>{"show"in a&&t(0,s=a.show)},[s,n,o,r,i]}class I_ extends Ve{constructor(e){super(),Ne(this,e,E_,k_,Be,{show:0})}}function S_(l){let e,t;return{c(){e=ze("svg"),t=ze("path"),this.h()},l(n){e=Pe(n,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var o=S(e);t=Pe(o,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),S(t).forEach(p),o.forEach(p),this.h()},h(){m(t,"stroke-linecap","round"),m(t,"stroke-linejoin","round"),m(t,"d","M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 5.25h.008v.008H12v-.008Z"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"fill","none"),m(e,"viewBox","0 0 24 24"),m(e,"stroke-width",l[1]),m(e,"stroke","currentColor"),m(e,"class",l[0])},m(n,o){B(n,e,o),k(e,t)},p(n,[o]){o&2&&m(e,"stroke-width",n[1]),o&1&&m(e,"class",n[0])},i:we,o:we,d(n){n&&p(e)}}}function D_(l,e,t){let{className:n="w-4 h-4"}=e,{strokeWidth:o="2"}=e;return l.$$set=s=>{"className"in s&&t(0,n=s.className),"strokeWidth"in s&&t(1,o=s.strokeWidth)},[n,o]}class C_ extends Ve{constructor(e){super(),Ne(this,e,D_,S_,Be,{className:0,strokeWidth:1})}}function M_(l){let e,t;return{c(){e=ze("svg"),t=ze("path"),this.h()},l(n){e=Pe(n,"svg",{"aria-hidden":!0,xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,class:!0});var o=S(e);t=Pe(o,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),S(t).forEach(p),o.forEach(p),this.h()},h(){m(t,"fill-rule","evenodd"),m(t,"d","M2 7a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V7Zm5.01 1H5v2.01h2.01V8Zm3 0H8v2.01h2.01V8Zm3 0H11v2.01h2.01V8Zm3 0H14v2.01h2.01V8Zm3 0H17v2.01h2.01V8Zm-12 3H5v2.01h2.01V11Zm3 0H8v2.01h2.01V11Zm3 0H11v2.01h2.01V11Zm3 0H14v2.01h2.01V11Zm3 0H17v2.01h2.01V11Zm-12 3H5v2.01h2.01V14ZM8 14l-.001 2 8.011.01V14H8Zm11.01 0H17v2.01h2.01V14Z"),m(t,"clip-rule","evenodd"),m(e,"aria-hidden","true"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"fill","currentColor"),m(e,"viewBox","0 0 24 24"),m(e,"stroke-width",l[1]),m(e,"class",l[0])},m(n,o){B(n,e,o),k(e,t)},p(n,[o]){o&2&&m(e,"stroke-width",n[1]),o&1&&m(e,"class",n[0])},i:we,o:we,d(n){n&&p(e)}}}function T_(l,e,t){let{className:n="size-4"}=e,{strokeWidth:o="2"}=e;return l.$$set=s=>{"className"in s&&t(0,n=s.className),"strokeWidth"in s&&t(1,o=s.strokeWidth)},[n,o]}class V_ extends Ve{constructor(e){super(),Ne(this,e,T_,M_,Be,{className:0,strokeWidth:1})}}function N_(l){let e;const t=l[5].default,n=xt(t,l,l[9],null);return{c(){n&&n.c()},l(o){n&&n.l(o)},m(o,s){n&&n.m(o,s),e=!0},p(o,s){n&&n.p&&(!e||s&512)&&$t(n,t,o,o[9],e?tn(t,o[9],s,null):en(o[9]),null)},i(o){e||(C(n,o),e=!0)},o(o){P(n,o),e=!1},d(o){n&&n.d(o)}}}function z_(l){let e,t,n,o=l[2].t("Documentation")+"",s,r;return e=new C_({props:{className:"size-5"}}),{c(){te(e.$$.fragment),t=$(),n=V("div"),s=Ce(o),this.h()},l(i){oe(e.$$.fragment,i),t=ee(i),n=N(i,"DIV",{class:!0});var a=S(n);s=Me(a,o),a.forEach(p),this.h()},h(){m(n,"class","flex items-center")},m(i,a){ne(e,i,a),B(i,t,a),B(i,n,a),k(n,s),r=!0},p(i,a){(!r||a&4)&&o!==(o=i[2].t("Documentation")+"")&&He(s,o)},i(i){r||(C(e.$$.fragment,i),r=!0)},o(i){P(e.$$.fragment,i),r=!1},d(i){i&&(p(t),p(n)),le(e,i)}}}function P_(l){let e,t,n,o=l[2].t("Keyboard shortcuts")+"",s,r;return e=new V_({props:{className:"size-5"}}),{c(){te(e.$$.fragment),t=$(),n=V("div"),s=Ce(o),this.h()},l(i){oe(e.$$.fragment,i),t=ee(i),n=N(i,"DIV",{class:!0});var a=S(n);s=Me(a,o),a.forEach(p),this.h()},h(){m(n,"class","flex items-center")},m(i,a){ne(e,i,a),B(i,t,a),B(i,n,a),k(n,s),r=!0},p(i,a){(!r||a&4)&&o!==(o=i[2].t("Keyboard shortcuts")+"")&&He(s,o)},i(i){r||(C(e.$$.fragment,i),r=!0)},o(i){P(e.$$.fragment,i),r=!1},d(i){i&&(p(t),p(n)),le(e,i)}}}function O_(l){let e,t,n,o;return e=new Sn({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",id:"chat-share-button",$$slots:{default:[z_]},$$scope:{ctx:l}}}),e.$on("click",l[6]),n=new Sn({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",id:"chat-share-button",$$slots:{default:[P_]},$$scope:{ctx:l}}}),n.$on("click",l[7]),{c(){te(e.$$.fragment),t=$(),te(n.$$.fragment)},l(s){oe(e.$$.fragment,s),t=ee(s),oe(n.$$.fragment,s)},m(s,r){ne(e,s,r),B(s,t,r),ne(n,s,r),o=!0},p(s,r){const i={};r&516&&(i.$$scope={dirty:r,ctx:s}),e.$set(i);const a={};r&516&&(a.$$scope={dirty:r,ctx:s}),n.$set(a)},i(s){o||(C(e.$$.fragment,s),C(n.$$.fragment,s),o=!0)},o(s){P(e.$$.fragment,s),P(n.$$.fragment,s),o=!1},d(s){s&&p(t),le(e,s),le(n,s)}}}function H_(l){let e,t,n;return t=new Vo({props:{class:"w-full max-w-[200px] rounded-xl px-1 py-1.5 border border-gray-300/30 dark:border-gray-700/50 z-50 bg-white dark:bg-gray-850 dark:text-white shadow-lg",sideOffset:4,side:"top",align:"end",transition:Gl,$$slots:{default:[O_]},$$scope:{ctx:l}}}),{c(){e=V("div"),te(t.$$.fragment),this.h()},l(o){e=N(o,"DIV",{slot:!0});var s=S(e);oe(t.$$.fragment,s),s.forEach(p),this.h()},h(){m(e,"slot","content")},m(o,s){B(o,e,s),ne(t,e,null),n=!0},p(o,s){const r={};s&517&&(r.$$scope={dirty:s,ctx:o}),t.$set(r)},i(o){n||(C(t.$$.fragment,o),n=!0)},o(o){P(t.$$.fragment,o),n=!1},d(o){o&&p(e),le(t)}}}function B_(l){let e,t;return e=new To({props:{$$slots:{content:[H_],default:[N_]},$$scope:{ctx:l}}}),e.$on("change",l[8]),{c(){te(e.$$.fragment)},l(n){oe(e.$$.fragment,n)},m(n,o){ne(e,n,o),t=!0},p(n,[o]){const s={};o&517&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){le(e,n)}}}function A_(l,e,t){let n,{$$slots:o={},$$scope:s}=e;const r=Ut("i18n");ie(l,r,d=>t(2,n=d));let{showDocsHandler:i}=e,{showShortcutsHandler:a}=e,{onClose:c=()=>{}}=e;const u=()=>{window.open("https://docs.openwebui.com","_blank")},f=()=>{a()},h=d=>{d.detail===!1&&c()};return l.$$set=d=>{"showDocsHandler"in d&&t(4,i=d.showDocsHandler),"showShortcutsHandler"in d&&t(0,a=d.showShortcutsHandler),"onClose"in d&&t(1,c=d.onClose),"$$scope"in d&&t(9,s=d.$$scope)},[a,c,n,r,i,o,u,f,h,s]}class L_ extends Ve{constructor(e){super(),Ne(this,e,A_,B_,Be,{showDocsHandler:4,showShortcutsHandler:0,onClose:1})}}function R_(l){let e,t="?";return{c(){e=V("button"),e.textContent=t,this.h()},l(n){e=N(n,"BUTTON",{class:!0,"data-svelte-h":!0}),gt(e)!=="svelte-oq3opr"&&(e.textContent=t),this.h()},h(){m(e,"class","text-gray-600 dark:text-gray-300 bg-gray-300/20 size-5 flex items-center justify-center text-[0.7rem] rounded-full")},m(n,o){B(n,e,o)},p:we,d(n){n&&p(e)}}}function U_(l){let e,t;return e=new Gt({props:{content:l[1].t("Help"),placement:"left",$$slots:{default:[R_]},$$scope:{ctx:l}}}),{c(){te(e.$$.fragment)},l(n){oe(e.$$.fragment,n)},m(n,o){ne(e,n,o),t=!0},p(n,o){const s={};o&2&&(s.content=n[1].t("Help")),o&128&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){le(e,n)}}}function W_(l){let e,t,n,o,s,r,i,a,c,u;o=new L_({props:{showDocsHandler:l[4],showShortcutsHandler:l[5],$$slots:{default:[U_]},$$scope:{ctx:l}}});function f(d){l[6](d)}let h={};return l[0]!==void 0&&(h.show=l[0]),r=new I_({props:h}),We.push(()=>$e(r,"show",f)),{c(){e=V("div"),t=V("button"),n=$(),te(o.$$.fragment),s=$(),te(r.$$.fragment),this.h()},l(d){e=N(d,"DIV",{class:!0});var _=S(e);t=N(_,"BUTTON",{id:!0,class:!0}),S(t).forEach(p),n=ee(_),oe(o.$$.fragment,_),_.forEach(p),s=ee(d),oe(r.$$.fragment,d),this.h()},h(){m(t,"id","show-shortcuts-button"),m(t,"class","hidden"),m(e,"class","hidden lg:flex fixed bottom-0 right-0 px-2 py-2 z-20")},m(d,_){B(d,e,_),k(e,t),k(e,n),ne(o,e,null),B(d,s,_),ne(r,d,_),a=!0,c||(u=ke(t,"click",l[3]),c=!0)},p(d,[_]){const b={};_&1&&(b.showDocsHandler=d[4]),_&1&&(b.showShortcutsHandler=d[5]),_&130&&(b.$$scope={dirty:_,ctx:d}),o.$set(b);const v={};!i&&_&1&&(i=!0,v.show=d[0],xe(()=>i=!1)),r.$set(v)},i(d){a||(C(o.$$.fragment,d),C(r.$$.fragment,d),a=!0)},o(d){P(o.$$.fragment,d),P(r.$$.fragment,d),a=!1},d(d){d&&(p(e),p(s)),le(o),le(r,d),c=!1,u()}}}function j_(l,e,t){let n;const o=Ut("i18n");ie(l,o,u=>t(1,n=u));let s=!1;const r=()=>{t(0,s=!s)},i=()=>{t(0,s=!s)},a=()=>{t(0,s=!s)};function c(u){s=u,t(0,s)}return[s,n,o,r,i,a,c]}class Fp extends Ve{constructor(e){super(),Ne(this,e,j_,W_,Be,{})}}export{jp as C,Fp as H};
//# sourceMappingURL=Help.D7QBHA9O.js.map
